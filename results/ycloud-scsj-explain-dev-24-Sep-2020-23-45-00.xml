<?xml version="1.0" encoding="UTF-8"?>
<testResults version="1.2">
<sample t="3991" lt="3929" ts="1600984577818" s="true" lb="query1" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="23071" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215614_dd5dd428-17fd-4486-8b5f-cde7ba215a50:205
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Reducer 6 (BROADCAST_EDGE)
        Map 7 &lt;- Map 4 (BROADCAST_EDGE), Reducer 3 (BROADCAST_EDGE)
        Map 9 &lt;- Reducer 8 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE), Reducer 2 (BROADCAST_EDGE)
      DagName: zabetak_20200924215614_dd5dd428-17fd-4486-8b5f-cde7ba215a50:205
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: (sr_store_sk is not null and sr_customer_sk is not null and sr_store_sk BETWEEN DynamicValue(RS_41_store_s_store_sk_min) AND DynamicValue(RS_41_store_s_store_sk_max) and in_bloom_filter(sr_store_sk, DynamicValue(RS_41_store_s_store_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 2778787720 Data size: 371465557264 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (sr_store_sk is not null and sr_customer_sk is not null and sr_store_sk BETWEEN DynamicValue(RS_41_store_s_store_sk_min) AND DynamicValue(RS_41_store_s_store_sk_max) and in_bloom_filter(sr_store_sk, DynamicValue(RS_41_store_s_store_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 2678913071 Data size: 358114414272 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_customer_sk (type: bigint), sr_store_sk (type: bigint), sr_fee (type: decimal(7,2)), sr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2678913071 Data size: 358114414272 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 491082691 Data size: 56640821064 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col2)
                          keys: _col1 (type: bigint), _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 491082691 Data size: 62081256120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint), _col1 (type: bigint)
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                            Statistics: Num rows: 491082691 Data size: 62081256120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2000) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: sr_returned_date_sk (bigint)
                            Target Input: store_returns
                            Partition key expr: sr_returned_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: sr_returned_date_sk (bigint)
                            Target Input: store_returns
                            Partition key expr: sr_returned_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_state = &apos;NM&apos;) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 141000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_state = &apos;NM&apos;) (type: boolean)
                    Statistics: Num rows: 42 Data size: 3948 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 42 Data size: 336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 42 Data size: 336 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 42 Data size: 336 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.97619045
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: (sr_store_sk is not null and sr_store_sk BETWEEN DynamicValue(RS_43_store_returns_sr_store_sk_min) AND DynamicValue(RS_43_store_returns_sr_store_sk_max) and in_bloom_filter(sr_store_sk, DynamicValue(RS_43_store_returns_sr_store_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 2778787720 Data size: 371465557264 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (sr_store_sk is not null and sr_store_sk BETWEEN DynamicValue(RS_43_store_returns_sr_store_sk_min) AND DynamicValue(RS_43_store_returns_sr_store_sk_max) and in_bloom_filter(sr_store_sk, DynamicValue(RS_43_store_returns_sr_store_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 2728337839 Data size: 364721467744 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_customer_sk (type: bigint), sr_store_sk (type: bigint), sr_fee (type: decimal(7,2)), sr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2728337839 Data size: 364721467744 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 500142951 Data size: 57685819368 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col2)
                          keys: _col1 (type: bigint), _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 500142951 Data size: 63226628040 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint), _col1 (type: bigint)
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 500142951 Data size: 63226628040 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: customer
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_123_container, bigKeyColName:c_customer_sk, smallTablePos:0, keyRatio:0.00701116923076923
                  Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_customer_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col7
                      input vertices:
                        0 Reducer 8
                      Statistics: Num rows: 455726 Data size: 184 Basic stats: COMPLETE Column stats: PARTIAL
                      Top N Key Operator
                        sort order: +
                        keys: _col7 (type: string)
                        null sort order: z
                        Statistics: Num rows: 455726 Data size: 184 Basic stats: COMPLETE Column stats: PARTIAL
                        top n: 100
                        Select Operator
                          expressions: _col7 (type: string)
                          outputColumnNames: _col0
                          Statistics: Num rows: 455726 Data size: -83853400 Basic stats: COMPLETE Column stats: PARTIAL
                          Reduce Output Operator
                            key expressions: _col0 (type: string)
                            null sort order: z
                            sort order: +
                            Statistics: Num rows: 455726 Data size: -83853400 Basic stats: PARTIAL Column stats: PARTIAL
                            TopN Hash Memory Usage: 0.04
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string)
                outputColumnNames: _col0
                Statistics: Num rows: 455726 Data size: -83853400 Basic stats: PARTIAL Column stats: PARTIAL
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: -18300 Basic stats: PARTIAL Column stats: PARTIAL
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: -18300 Basic stats: PARTIAL Column stats: PARTIAL
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 48416862 Data size: 6120719944 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col2 is not null (type: boolean)
                  Statistics: Num rows: 48416862 Data size: 6120719944 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: decimal(17,2))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 48416862 Data size: 6120719944 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      input vertices:
                        1 Map 5
                      Statistics: Num rows: 1357484 Data size: 152038224 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: bigint)
                        Statistics: Num rows: 1357484 Data size: 152038224 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col2 (type: decimal(17,2))
                      Select Operator
                        expressions: _col1 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1357484 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 48416862 Data size: 6120719944 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: bigint), _col2 (type: decimal(17,2))
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 48416862 Data size: 6120719944 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col2), count(_col2)
                    keys: _col1 (type: bigint)
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 141 Data size: 17944 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col1 is not null and _col2 is not null) (type: boolean)
                      Statistics: Num rows: 141 Data size: 17944 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: ((_col1 / _col2) * 1.2) (type: decimal(38,11)), _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 141 Data size: 16816 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col1 (type: bigint)
                          outputColumnNames: _col0, _col2, _col4
                          input vertices:
                            0 Reducer 2
                          Statistics: Num rows: 1367180 Data size: 306325896 Basic stats: COMPLETE Column stats: COMPLETE
                          Filter Operator
                            predicate: (_col2 &gt; _col4) (type: boolean)
                            Statistics: Num rows: 455726 Data size: 102108488 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: bigint)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: bigint)
                              Statistics: Num rows: 455726 Data size: 102108488 Basic stats: COMPLETE Column stats: COMPLETE

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query1
explain with customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 group by sr_customer_sk ,sr_store_sk) select  c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return &gt; (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = &apos;NM&apos; and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id limit 100

</samplerData>
</sample>
<sample t="3004" lt="2993" ts="1600984580833" s="true" lb="query2" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="35875" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215617_84533110-c021-4af0-ae6f-bc70ec112264:206
      Edges:
        Map 1 &lt;- Map 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 10 &lt;- Map 14 (BROADCAST_EDGE), Union 11 (CONTAINS)
        Map 13 &lt;- Map 14 (BROADCAST_EDGE), Union 11 (CONTAINS)
        Map 14 &lt;- Reducer 9 (BROADCAST_EDGE)
        Map 5 &lt;- Map 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 6 &lt;- Reducer 8 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Reducer 12 &lt;- Map 7 (BROADCAST_EDGE), Union 11 (SIMPLE_EDGE)
        Reducer 3 &lt;- Map 7 (BROADCAST_EDGE), Reducer 12 (BROADCAST_EDGE), Union 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Map 7 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215617_84533110-c021-4af0-ae6f-bc70ec112264:206
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 863678665832 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_sold_date_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 7198162681 Data size: 863678665832 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 21526116649 Data size: 3095529588768 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col3 (type: int), CASE WHEN (_col4) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col5) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col6) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col7) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col8) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col9) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col10) THEN (_col1) ELSE (null) END (type: decimal(7,2))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                        Statistics: Num rows: 21526116649 Data size: 3095529588768 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7)
                          keys: _col0 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                          Statistics: Num rows: 136603324 Data size: 107643419312 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: int)
                            Statistics: Num rows: 136603324 Data size: 107643419312 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 863678665832 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_sold_date_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 7198162681 Data size: 863678665832 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      input vertices:
                        1 Map 14
                      Statistics: Num rows: 21526116649 Data size: 3095529588768 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col3 (type: int), CASE WHEN (_col4) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col5) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col6) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col7) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col8) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col9) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col10) THEN (_col1) ELSE (null) END (type: decimal(7,2))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                        Statistics: Num rows: 21526116649 Data size: 3095529588768 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7)
                          keys: _col0 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                          Statistics: Num rows: 136603324 Data size: 107643419312 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: int)
                            Statistics: Num rows: 136603324 Data size: 107643419312 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1715324979472 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_sold_date_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 14327953968 Data size: 1715324979472 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      input vertices:
                        1 Map 14
                      Statistics: Num rows: 21526116649 Data size: 3095529588768 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col3 (type: int), CASE WHEN (_col4) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col5) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col6) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col7) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col8) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col9) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col10) THEN (_col1) ELSE (null) END (type: decimal(7,2))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                        Statistics: Num rows: 21526116649 Data size: 3095529588768 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7)
                          keys: _col0 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                          Statistics: Num rows: 136603324 Data size: 107643419312 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: int)
                            Statistics: Num rows: 136603324 Data size: 107643419312 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_47_date_dim_d_week_seq_min) AND DynamicValue(RS_47_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_47_date_dim_d_week_seq_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_47_date_dim_d_week_seq_min) AND DynamicValue(RS_47_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_47_date_dim_d_week_seq_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_week_seq (type: int), (d_day_name = &apos;Sunday   &apos;) (type: boolean), (d_day_name = &apos;Monday   &apos;) (type: boolean), (d_day_name = &apos;Tuesday  &apos;) (type: boolean), (d_day_name = &apos;Wednesday&apos;) (type: boolean), (d_day_name = &apos;Thursday &apos;) (type: boolean), (d_day_name = &apos;Friday   &apos;) (type: boolean), (d_day_name = &apos;Saturday &apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.50000685
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 10
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.50000685
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1715324979472 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_sold_date_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 14327953968 Data size: 1715324979472 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 21526116649 Data size: 3095529588768 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col3 (type: int), CASE WHEN (_col4) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col5) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col6) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col7) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col8) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col9) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col10) THEN (_col1) ELSE (null) END (type: decimal(7,2))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                        Statistics: Num rows: 21526116649 Data size: 3095529588768 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7)
                          keys: _col0 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                          Statistics: Num rows: 136603324 Data size: 107643419312 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: int)
                            Statistics: Num rows: 136603324 Data size: 107643419312 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_51_date_dim_d_week_seq_min) AND DynamicValue(RS_51_date_dim_d_week_seq_max) and (d_week_seq - 53) BETWEEN DynamicValue(RS_47_date_dim_d_week_seq_min) AND DynamicValue(RS_47_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_51_date_dim_d_week_seq_bloom_filter)) and in_bloom_filter((d_week_seq - 53), DynamicValue(RS_47_date_dim_d_week_seq_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_51_date_dim_d_week_seq_min) AND DynamicValue(RS_51_date_dim_d_week_seq_max) and (d_week_seq - 53) BETWEEN DynamicValue(RS_47_date_dim_d_week_seq_min) AND DynamicValue(RS_47_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_51_date_dim_d_week_seq_bloom_filter)) and in_bloom_filter((d_week_seq - 53), DynamicValue(RS_47_date_dim_d_week_seq_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_week_seq (type: int), (d_day_name = &apos;Sunday   &apos;) (type: boolean), (d_day_name = &apos;Monday   &apos;) (type: boolean), (d_day_name = &apos;Tuesday  &apos;) (type: boolean), (d_day_name = &apos;Wednesday&apos;) (type: boolean), (d_day_name = &apos;Thursday &apos;) (type: boolean), (d_day_name = &apos;Friday   &apos;) (type: boolean), (d_day_name = &apos;Saturday &apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.50000685
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.50000685
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 5
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (((d_year = 1999) and d_week_seq is not null) or ((d_year = 1998) and d_week_seq is not null)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1999) and d_week_seq is not null) (type: boolean)
                    Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_week_seq (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 1468 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 367 Data size: 1468 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: int)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 1468 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
                  Filter Operator
                    predicate: ((d_year = 1998) and d_week_seq is not null) (type: boolean)
                    Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_week_seq (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 1468 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 367 Data size: 1468 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: int)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 1468 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 11297 Data size: 8902036 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  input vertices:
                    1 Map 7
                  Statistics: Num rows: 367 Data size: 289196 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 367 Data size: 289196 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 11297 Data size: 8902036 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                  input vertices:
                    1 Map 7
                  Statistics: Num rows: 367 Data size: 289196 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 (_col0 - 53) (type: int)
                      1 _col0 (type: int)
                    outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16
                    input vertices:
                      1 Reducer 12
                    Statistics: Num rows: 11224 Data size: 17644128 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col9 (type: int), round((_col10 / _col1), 2) (type: decimal(20,2)), round((_col11 / _col2), 2) (type: decimal(20,2)), round((_col12 / _col3), 2) (type: decimal(20,2)), round((_col13 / _col4), 2) (type: decimal(20,2)), round((_col14 / _col5), 2) (type: decimal(20,2)), round((_col15 / _col6), 2) (type: decimal(20,2)), round((_col16 / _col7), 2) (type: decimal(20,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 11224 Data size: 8844512 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        null sort order: z
                        sort order: +
                        Statistics: Num rows: 11224 Data size: 8844512 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: decimal(20,2)), _col2 (type: decimal(20,2)), _col3 (type: decimal(20,2)), _col4 (type: decimal(20,2)), _col5 (type: decimal(20,2)), _col6 (type: decimal(20,2)), _col7 (type: decimal(20,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: int), VALUE._col0 (type: decimal(20,2)), VALUE._col1 (type: decimal(20,2)), VALUE._col2 (type: decimal(20,2)), VALUE._col3 (type: decimal(20,2)), VALUE._col4 (type: decimal(20,2)), VALUE._col5 (type: decimal(20,2)), VALUE._col6 (type: decimal(20,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 11224 Data size: 8844512 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 11224 Data size: 8844512 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
        Union 11 
            Vertex: Union 11
        Union 2 
            Vertex: Union 2

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query2
explain with wscs as (select sold_date_sk ,sales_price from (select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales) x union all (select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales)), wswscs as (select d_week_seq, sum(case when (d_day_name=&apos;Sunday&apos;) then sales_price else null end) sun_sales, sum(case when (d_day_name=&apos;Monday&apos;) then sales_price else null end) mon_sales, sum(case when (d_day_name=&apos;Tuesday&apos;) then sales_price else  null end) tue_sales, sum(case when (d_day_name=&apos;Wednesday&apos;) then sales_price else null end) wed_sales, sum(case when (d_day_name=&apos;Thursday&apos;) then sales_price else null end) thu_sales, sum(case when (d_day_name=&apos;Friday&apos;) then sales_price else null end) fri_sales, sum(case when (d_day_name=&apos;Saturday&apos;) then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1

</samplerData>
</sample>
<sample t="2168" lt="2162" ts="1600984583015" s="true" lb="query3" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="9788" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215620_2d227a4d-8e35-4afa-9ae8-ebefc8f5070c:207
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924215620_2d227a4d-8e35-4afa-9ae8-ebefc8f5070c:207
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_52_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:0.0010124378927295569
                  Statistics: Num rows: 27503885621 Data size: 3447926097536 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3447926097536 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col2, _col4, _col5
                      input vertices:
                        1 Map 4
                      Statistics: Num rows: 27845976 Data size: 3118749424 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col4, _col5, _col7
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 2320340 Data size: 250596832 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1)
                          keys: _col7 (type: int), _col4 (type: int), _col5 (type: char(50))
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 236810 Data size: 52098200 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: char(50))
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: char(50))
                            Statistics: Num rows: 236810 Data size: 52098200 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_manufact_id = 816) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 46623992 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_manufact_id = 816) (type: boolean)
                    Statistics: Num rows: 407 Data size: 47212 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand_id (type: int), i_brand (type: char(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 407 Data size: 45584 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 407 Data size: 45584 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: dt
                  filterExpr: (d_moy = 11) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_moy = 11) (type: boolean)
                    Statistics: Num rows: 6087 Data size: 97392 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_year (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 6087 Data size: 73044 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 6087 Data size: 73044 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 6087 Data size: 48696 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.50008214
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 3043 Data size: 24344 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 3043 Data size: 24344 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Top N Key Operator
                sort order: +
                keys: KEY._col0 (type: int)
                null sort order: z
                Statistics: Num rows: 236810 Data size: 52098200 Basic stats: COMPLETE Column stats: COMPLETE
                top n: 100
                Group By Operator
                  aggregations: sum(VALUE._col0)
                  keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: char(50))
                  mode: mergepartial
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 230044 Data size: 50609680 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: +-+
                    keys: _col0 (type: int), _col3 (type: decimal(17,2)), _col1 (type: int)
                    null sort order: zaz
                    Statistics: Num rows: 230044 Data size: 50609680 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col3 (type: decimal(17,2)), _col1 (type: int)
                      null sort order: zaz
                      sort order: +-+
                      Statistics: Num rows: 230044 Data size: 50609680 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col2 (type: char(50))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: char(50)), KEY.reducesinkkey1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 230044 Data size: 50609680 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 22000 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 22000 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query3
explain select  dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_sales_price) sum_agg from  date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manufact_id = 816 and dt.d_moy=11 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,sum_agg desc ,brand_id limit 100

</samplerData>
</sample>
<sample t="10241" lt="10228" ts="1600984593259" s="true" lb="query4" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="48814" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215623_a7d6e16a-0d3a-41ec-a1b3-18766929ea57:208
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE)
        Map 10 &lt;- Map 5 (BROADCAST_EDGE)
        Map 13 &lt;- Map 5 (BROADCAST_EDGE)
        Map 16 &lt;- Map 5 (BROADCAST_EDGE)
        Map 19 &lt;- Map 5 (BROADCAST_EDGE)
        Map 7 &lt;- Map 5 (BROADCAST_EDGE)
        Reducer 11 &lt;- Map 10 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 12 &lt;- Reducer 11 (SIMPLE_EDGE)
        Reducer 14 &lt;- Map 13 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 15 &lt;- Reducer 14 (SIMPLE_EDGE)
        Reducer 17 &lt;- Map 16 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 18 &lt;- Reducer 17 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 20 &lt;- Map 19 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 21 &lt;- Reducer 20 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 12 (BROADCAST_EDGE), Reducer 15 (BROADCAST_EDGE), Reducer 18 (BROADCAST_EDGE), Reducer 2 (SIMPLE_EDGE), Reducer 21 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 6 (CUSTOM_SIMPLE_EDGE), Map 7 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Reducer 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924215623_a7d6e16a-0d3a-41ec-a1b3-18766929ea57:208
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 12466238597424 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 12172466954552 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint), ((((ss_ext_list_price - ss_ext_wholesale_cost) - ss_ext_discount_amt) + ss_ext_sales_price) / 2) (type: decimal(14,6))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855746120 Data size: 3432472576584 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5397548198 Data size: 642642856984 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 5397548198 Data size: 642642856984 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(14,6))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 6631761254384 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 6615095429760 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_sold_date_sk (type: bigint), ((((cs_ext_list_price - cs_ext_wholesale_cost) - cs_ext_discount_amt) + cs_ext_sales_price) / 2) (type: decimal(14,6))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 14291947369 Data size: 1829081934336 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 2852133059 Data size: 341968638184 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 2852133059 Data size: 341968638184 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(14,6))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 3339537060976 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 3339120717056 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint), ((((ws_ext_list_price - ws_ext_wholesale_cost) - ws_ext_discount_amt) + ws_ext_sales_price) / 2) (type: decimal(14,6))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197265278 Data size: 921242777264 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 1446527908 Data size: 173576170640 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 1446527908 Data size: 173576170640 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(14,6))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 6631761254384 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 6615095429760 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_sold_date_sk (type: bigint), ((((cs_ext_list_price - cs_ext_wholesale_cost) - cs_ext_discount_amt) + cs_ext_sales_price) / 2) (type: decimal(14,6))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 14291947369 Data size: 1829081934336 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 2852133059 Data size: 341968638184 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 2852133059 Data size: 341968638184 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(14,6))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 3339537060976 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 3339120717056 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint), ((((ws_ext_list_price - ws_ext_wholesale_cost) - ws_ext_discount_amt) + ws_ext_sales_price) / 2) (type: decimal(14,6))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197265278 Data size: 921242777264 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 1446527908 Data size: 173576170640 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 1446527908 Data size: 173576170640 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(14,6))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) or (d_year = 1999)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: (d_year = 1999) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 10
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
                  Filter Operator
                    predicate: (d_year = 1999) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 16
                  Filter Operator
                    predicate: (d_year = 1999) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 19
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 65000000 Data size: 29562000184 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_customer_id (type: string), c_first_name (type: char(20)), c_last_name (type: char(30)), c_birth_country (type: varchar(20))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col5
                    Statistics: Num rows: 65000000 Data size: 29562000184 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 29562000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string), _col2 (type: char(20)), _col3 (type: char(30)), _col5 (type: varchar(20))
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_customer_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 12466238597424 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 12172466954552 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint), ((((ss_ext_list_price - ss_ext_wholesale_cost) - ss_ext_discount_amt) + ss_ext_sales_price) / 2) (type: decimal(14,6))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855746120 Data size: 3432472576584 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5397548198 Data size: 642642856984 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 5397548198 Data size: 642642856984 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(14,6))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5
                input vertices:
                  1 Map 6
                Statistics: Num rows: 2852133059 Data size: 843633385648 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19226371856 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19226371856 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(24,6))
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3845274888 Basic stats: COMPLETE Column stats: PARTIAL
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 13000001 Data size: 3845274888 Basic stats: COMPLETE Column stats: PARTIAL
                  value expressions: _col1 (type: decimal(24,6))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5
                input vertices:
                  1 Map 6
                Statistics: Num rows: 1446527908 Data size: 427574260952 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19213129008 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19213129008 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(24,6))
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3842626208 Basic stats: COMPLETE Column stats: PARTIAL
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 13000001 Data size: 3842626208 Basic stats: COMPLETE Column stats: PARTIAL
                  value expressions: _col1 (type: decimal(24,6))
        Reducer 17 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5
                input vertices:
                  1 Map 6
                Statistics: Num rows: 2852133059 Data size: 843633385648 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19226371856 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19226371856 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(24,6))
        Reducer 18 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3845274888 Basic stats: COMPLETE Column stats: PARTIAL
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 4333333 Data size: 1281758160 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 4333333 Data size: 1281758160 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(24,6))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5, _col6, _col7, _col9
                input vertices:
                  1 Map 6
                Statistics: Num rows: 5397548198 Data size: 3065209376648 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string), _col6 (type: char(20)), _col7 (type: char(30)), _col9 (type: varchar(20))
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 65000000 Data size: 36912798792 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                    null sort order: aaaa
                    sort order: ++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                    Statistics: Num rows: 65000000 Data size: 36912798792 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col4 (type: decimal(24,6))
        Reducer 20 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5
                input vertices:
                  1 Map 6
                Statistics: Num rows: 1446527908 Data size: 427574260952 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19213129008 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19213129008 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(24,6))
        Reducer 21 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3842626208 Basic stats: COMPLETE Column stats: PARTIAL
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 4333333 Data size: 1280875328 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 4333333 Data size: 1280875328 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(24,6))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string), KEY._col1 (type: char(20)), KEY._col2 (type: char(30)), KEY._col3 (type: varchar(20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 65000000 Data size: 36912798792 Basic stats: COMPLETE Column stats: PARTIAL
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: string)
                    1 _col0 (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6
                  input vertices:
                    1 Reducer 9
                  Statistics: Num rows: 21666665 Data size: 14726130992 Basic stats: COMPLETE Column stats: PARTIAL
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: string)
                      1 _col0 (type: string)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col8
                    input vertices:
                      1 Reducer 12
                    Statistics: Num rows: 21666666 Data size: 17152798264 Basic stats: COMPLETE Column stats: PARTIAL
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: string)
                        1 _col0 (type: string)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col8, _col10
                      input vertices:
                        1 Reducer 15
                      Statistics: Num rows: 21666667 Data size: 19579465760 Basic stats: COMPLETE Column stats: PARTIAL
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: string)
                          1 _col0 (type: string)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col8, _col10, _col12
                        input vertices:
                          1 Reducer 18
                        Statistics: Num rows: 21666667 Data size: 22006132464 Basic stats: COMPLETE Column stats: PARTIAL
                        Filter Operator
                          predicate: ((_col8 / _col12) &gt; (_col4 / _col6)) (type: boolean)
                          Statistics: Num rows: 7222222 Data size: 7335377272 Basic stats: COMPLETE Column stats: PARTIAL
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: string)
                              1 _col0 (type: string)
                            outputColumnNames: _col0, _col1, _col2, _col3, _col8, _col10, _col12, _col14
                            input vertices:
                              1 Reducer 21
                            Statistics: Num rows: 7222222 Data size: 6526488408 Basic stats: COMPLETE Column stats: PARTIAL
                            Filter Operator
                              predicate: ((_col8 / _col12) &gt; (_col10 / _col14)) (type: boolean)
                              Statistics: Num rows: 2407407 Data size: 2175495896 Basic stats: COMPLETE Column stats: PARTIAL
                              Top N Key Operator
                                sort order: ++++
                                keys: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                                null sort order: zzzz
                                Statistics: Num rows: 2407407 Data size: 2175495896 Basic stats: COMPLETE Column stats: PARTIAL
                                top n: 100
                                Select Operator
                                  expressions: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                                  outputColumnNames: _col0, _col1, _col2, _col3
                                  Statistics: Num rows: 2407407 Data size: 1096177344 Basic stats: COMPLETE Column stats: PARTIAL
                                  Reduce Output Operator
                                    key expressions: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                                    null sort order: zzzz
                                    sort order: ++++
                                    Statistics: Num rows: 2407407 Data size: 1096177344 Basic stats: COMPLETE Column stats: PARTIAL
                                    TopN Hash Memory Usage: 0.04
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: char(20)), KEY.reducesinkkey2 (type: char(30)), KEY.reducesinkkey3 (type: varchar(20))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 2407407 Data size: 1096177344 Basic stats: COMPLETE Column stats: PARTIAL
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 45600 Basic stats: COMPLETE Column stats: PARTIAL
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 45600 Basic stats: COMPLETE Column stats: PARTIAL
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5
                input vertices:
                  1 Map 6
                Statistics: Num rows: 5397548198 Data size: 1597076266792 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19232798792 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19232798792 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(24,6))
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3846560128 Basic stats: COMPLETE Column stats: PARTIAL
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 4333333 Data size: 1282186696 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 4333333 Data size: 1282186696 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(24,6))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query4
explain with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total ,&apos;s&apos; sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total ,&apos;c&apos; sale_type from customer ,catalog_sales ,date_dim where c_customer_sk = cs_bill_customer_sk and cs_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total ,&apos;w&apos; sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_c_firstyear ,year_total t_c_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_c_secyear.customer_id and t_s_firstyear.customer_id = t_c_firstyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.sale_type = &apos;s&apos; and t_c_firstyear.sale_type = &apos;c&apos; and t_w_firstyear.sale_type = &apos;w&apos; and t_s_secyear.sale_type = &apos;s&apos; and t_c_secyear.sale_type = &apos;c&apos; and t_w_secyear.sale_type = &apos;w&apos; and t_s_firstyear.dyear =  1999 and t_s_secyear.dyear = 1999+1 and t_c_firstyear.dyear =  1999 and t_c_secyear.dyear =  1999+1 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999+1 and t_s_firstyear.year_total &gt; 0 and t_c_firstyear.year_total &gt; 0 and t_w_firstyear.year_total &gt; 0 and case when t_c_firstyear.year_total &gt; 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end &gt; case when t_s_firstyear.year_total &gt; 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end and case when t_c_firstyear.year_total &gt; 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end &gt; case when t_w_firstyear.year_total &gt; 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country limit 100

</samplerData>
</sample>
<sample t="17269" lt="17256" ts="1600984610537" s="true" lb="query5" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="49747" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215633_faa79fba-5952-4be5-824c-eb43e0a52a04:209
      Edges:
        Map 1 &lt;- Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 10 &lt;- Map 14 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Union 11 (CONTAINS)
        Map 13 &lt;- Map 14 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Union 11 (CONTAINS)
        Map 15 &lt;- Map 22 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Union 16 (CONTAINS)
        Map 18 &lt;- Reducer 21 (BROADCAST_EDGE)
        Map 7 &lt;- Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Reducer 12 &lt;- Union 11 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 17 &lt;- Union 16 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 19 &lt;- Map 18 (CUSTOM_SIMPLE_EDGE), Map 20 (CUSTOM_SIMPLE_EDGE), Map 22 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Union 16 (CONTAINS)
        Reducer 21 &lt;- Map 20 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Union 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 5 &lt;- Union 4 (SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
      DagName: zabetak_20200924215633_faa79fba-5952-4be5-824c-eb43e0a52a04:209
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_222_container, bigKeyColName:store_sk, smallTablePos:1, keyRatio:0.1195083603201987
                  Statistics: Num rows: 27503885621 Data size: 6450573244720 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 6298666168912 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_store_sk (type: bigint), ss_sold_date_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_net_profit (type: decimal(7,2)), 0 (type: decimal(7,2)), 0 (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 26856185846 Data size: 12314451798416 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 3286944273 Data size: 1193738726040 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col3, _col4, _col5, _col8
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 3286944273 Data size: 1506653020132 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2), sum(_col4), sum(_col3), sum(_col5)
                            keys: _col8 (type: char(16))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4
                            Statistics: Num rows: 4543992 Data size: 2490107616 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(16))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: char(16))
                              Statistics: Num rows: 4543992 Data size: 2490107616 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_catalog_page_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_224_container, bigKeyColName:page_sk, smallTablePos:1, keyRatio:0.12176755180094531
                  Statistics: Num rows: 14327953968 Data size: 3434391687024 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_catalog_page_sk is not null (type: boolean)
                    Statistics: Num rows: 14291982891 Data size: 3425769467288 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_catalog_page_sk (type: bigint), cs_sold_date_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_net_profit (type: decimal(7,2)), 0 (type: decimal(7,2)), 0 (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 14291982891 Data size: 6627173634872 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 1744679877 Data size: 780412395424 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col3, _col4, _col5, _col8
                          input vertices:
                            1 Map 14
                          Statistics: Num rows: 1744679877 Data size: 1088275740368 Basic stats: COMPLETE Column stats: PARTIAL
                          Group By Operator
                            aggregations: sum(_col2), sum(_col4), sum(_col3), sum(_col5)
                            keys: _col8 (type: string)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4
                            Statistics: Num rows: 34020252 Data size: 21500792272 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 34020252 Data size: 21500792272 Basic stats: COMPLETE Column stats: PARTIAL
                              value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: cr_catalog_page_sk is not null (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 338925421432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cr_catalog_page_sk is not null (type: boolean)
                    Statistics: Num rows: 1411210978 Data size: 332141859464 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_catalog_page_sk (type: bigint), cr_returned_date_sk (type: bigint), 0 (type: decimal(7,2)), 0 (type: decimal(7,2)), cr_return_amount (type: decimal(7,2)), cr_net_loss (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 1411210978 Data size: 648253118536 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 1744679877 Data size: 780412395424 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col3, _col4, _col5, _col8
                          input vertices:
                            1 Map 14
                          Statistics: Num rows: 1744679877 Data size: 1088275740368 Basic stats: COMPLETE Column stats: PARTIAL
                          Group By Operator
                            aggregations: sum(_col2), sum(_col4), sum(_col3), sum(_col5)
                            keys: _col8 (type: string)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4
                            Statistics: Num rows: 34020252 Data size: 21500792272 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 34020252 Data size: 21500792272 Basic stats: COMPLETE Column stats: PARTIAL
                              value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: catalog_page
                  Statistics: Num rows: 40000 Data size: 7312184 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: cp_catalog_page_sk (type: bigint), cp_catalog_page_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 40000 Data size: 7312184 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 40000 Data size: 7312184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 40000 Data size: 7312184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_web_site_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_226_container, bigKeyColName:wsr_web_site_sk, smallTablePos:1, keyRatio:40.28740548882852
                  Statistics: Num rows: 7198162681 Data size: 1727450978120 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_web_site_sk is not null (type: boolean)
                    Statistics: Num rows: 7197261501 Data size: 1727234708480 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_web_site_sk (type: bigint), ws_sold_date_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_net_profit (type: decimal(7,2)), 0 (type: decimal(7,2)), 0 (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 7197261501 Data size: 3339421284704 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 289995298704 Data size: 132233998077680 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col3, _col4, _col5, _col8
                          input vertices:
                            1 Map 22
                          Statistics: Num rows: 289995298704 Data size: 183273199463376 Basic stats: COMPLETE Column stats: PARTIAL
                          Group By Operator
                            aggregations: sum(_col2), sum(_col4), sum(_col3), sum(_col5)
                            keys: _col8 (type: string)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4
                            Statistics: Num rows: 11454576 Data size: 7239292032 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 11454576 Data size: 7239292032 Basic stats: COMPLETE Column stats: PARTIAL
                              value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 18 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: (ws_web_site_sk is not null and ws_order_number BETWEEN DynamicValue(RS_59_web_returns_wr_order_number_min) AND DynamicValue(RS_59_web_returns_wr_order_number_max) and in_bloom_filter(ws_order_number, DynamicValue(RS_59_web_returns_wr_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 7199963324 Data size: 172784719088 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_web_site_sk is not null and ws_order_number BETWEEN DynamicValue(RS_59_web_returns_wr_order_number_min) AND DynamicValue(RS_59_web_returns_wr_order_number_max) and in_bloom_filter(ws_order_number, DynamicValue(RS_59_web_returns_wr_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 7198163237 Data size: 172741520600 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_web_site_sk (type: bigint), ws_order_number (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7198163237 Data size: 172741520600 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col2 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col2 (type: bigint)
                        Statistics: Num rows: 7198163237 Data size: 172741520600 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  Statistics: Num rows: 687618864 Data size: 166901847664 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: wr_item_sk (type: bigint), wr_order_number (type: bigint), wr_return_amt (type: decimal(7,2)), wr_net_loss (type: decimal(7,2)), wr_returned_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 687618864 Data size: 166901847664 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 687618864 Data size: 166901847664 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col2 (type: decimal(7,2)), _col3 (type: decimal(7,2)), _col4 (type: bigint)
                    Select Operator
                      expressions: _col1 (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 687618864 Data size: 11001901824 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 22 
            Map Operator Tree:
                TableScan
                  alias: web_site
                  Statistics: Num rows: 78 Data size: 14608 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: web_site_sk (type: bigint), web_site_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 78 Data size: 14608 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 78 Data size: 14608 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 78 Data size: 14608 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: sr_store_sk is not null (type: boolean)
                  Statistics: Num rows: 2778787720 Data size: 655225947872 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: sr_store_sk is not null (type: boolean)
                    Statistics: Num rows: 2728337839 Data size: 643330087408 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_store_sk (type: bigint), sr_returned_date_sk (type: bigint), 0 (type: decimal(7,2)), 0 (type: decimal(7,2)), sr_return_amt (type: decimal(7,2)), sr_net_loss (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 2728337839 Data size: 1254477763344 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 3286944273 Data size: 1193738726040 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col3, _col4, _col5, _col8
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 3286944273 Data size: 1506653020132 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2), sum(_col4), sum(_col3), sum(_col5)
                            keys: _col8 (type: char(16))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4
                            Statistics: Num rows: 4543992 Data size: 2490107616 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(16))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: char(16))
                              Statistics: Num rows: 4543992 Data size: 2490107616 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2000-08-19 00:00:00&apos; AND TIMESTAMP&apos;2000-09-02 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2000-08-19 00:00:00&apos; AND TIMESTAMP&apos;2000-09-02 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: sr_returned_date_sk (bigint)
                            Target Input: store_returns
                            Partition key expr: sr_returned_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 10
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cr_returned_date_sk (bigint)
                            Target Input: catalog_returns
                            Partition key expr: cr_returned_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 15
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: wr_returned_date_sk (bigint)
                            Target Input: web_returns
                            Partition key expr: wr_returned_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 20
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_store_id (type: char(16))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 8001 Data size: 5056632 Basic stats: COMPLETE Column stats: PARTIAL
                Select Operator
                  expressions: &apos;catalog channel&apos; (type: string), concat(&apos;catalog_page&apos;, _col0) (type: string), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), (_col3 - _col4) (type: decimal(18,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 8001 Data size: 4952619 Basic stats: COMPLETE Column stats: PARTIAL
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: string), _col1 (type: string)
                    null sort order: zz
                    Statistics: Num rows: 8788 Data size: 5438168 Basic stats: COMPLETE Column stats: PARTIAL
                    top n: 100
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        null sort order: zza
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 17 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 15 Data size: 9480 Basic stats: COMPLETE Column stats: PARTIAL
                Select Operator
                  expressions: &apos;web channel&apos; (type: string), concat(&apos;web_site&apos;, _col0) (type: string), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), (_col3 - _col4) (type: decimal(18,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 15 Data size: 9225 Basic stats: COMPLETE Column stats: PARTIAL
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: string), _col1 (type: string)
                    null sort order: zz
                    Statistics: Num rows: 8788 Data size: 5438168 Basic stats: COMPLETE Column stats: PARTIAL
                    top n: 100
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        null sort order: zza
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 19 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col1, _col5, _col6, _col7
                input vertices:
                  1 Map 20
                Statistics: Num rows: 2602939106152 Data size: 624701743448784 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col1 (type: bigint), _col7 (type: bigint), 0 (type: decimal(7,2)), 0 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 2602939106152 Data size: 1207760103226832 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col1 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col0, _col2, _col3, _col4, _col5
                    input vertices:
                      1 Map 8
                    Statistics: Num rows: 289995298704 Data size: 132233998077680 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col2, _col3, _col4, _col5, _col8
                      input vertices:
                        1 Map 22
                      Statistics: Num rows: 289995298704 Data size: 183273199463376 Basic stats: COMPLETE Column stats: PARTIAL
                      Group By Operator
                        aggregations: sum(_col2), sum(_col4), sum(_col3), sum(_col5)
                        keys: _col8 (type: string)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 11454576 Data size: 7239292032 Basic stats: COMPLETE Column stats: PARTIAL
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 11454576 Data size: 7239292032 Basic stats: COMPLETE Column stats: PARTIAL
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 21 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 772 Data size: 423056 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: &apos;store channel&apos; (type: string), concat(&apos;store&apos;, _col0) (type: string), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), (_col3 - _col4) (type: decimal(18,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 772 Data size: 476324 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: string), _col1 (type: string)
                    null sort order: zz
                    Statistics: Num rows: 8788 Data size: 5438168 Basic stats: COMPLETE Column stats: PARTIAL
                    top n: 100
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        null sort order: zza
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col3, _col4, _col5
                Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                pruneGroupingSetId: true
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 13182 Data size: 8159658 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string)
                    null sort order: zz
                    sort order: ++
                    Statistics: Num rows: 13182 Data size: 8159658 Basic stats: COMPLETE Column stats: PARTIAL
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col2 (type: decimal(27,2)), _col3 (type: decimal(27,2)), _col4 (type: decimal(28,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: decimal(27,2)), VALUE._col1 (type: decimal(27,2)), VALUE._col2 (type: decimal(28,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 13182 Data size: 8159658 Basic stats: COMPLETE Column stats: PARTIAL
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 61900 Basic stats: COMPLETE Column stats: PARTIAL
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 61900 Basic stats: COMPLETE Column stats: PARTIAL
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 11 
            Vertex: Union 11
        Union 16 
            Vertex: Union 16
        Union 2 
            Vertex: Union 2
        Union 4 
            Vertex: Union 4

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query5
explain with ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  ss_store_sk as store_sk, ss_sold_date_sk  as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between cast(&apos;2000-08-19&apos; as date) and (cast(&apos;2000-08-19&apos; as date) +  14 days) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  cs_catalog_page_sk as page_sk, cs_sold_date_sk  as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between cast(&apos;2000-08-19&apos; as date) and (cast(&apos;2000-08-19&apos; as date) +  14 days) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select  ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk  as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between cast(&apos;2000-08-19&apos; as date) and (cast(&apos;2000-08-19&apos; as date) +  14 days) and wsr_web_site_sk = web_site_sk group by web_site_id) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select &apos;store channel&apos; as channel , &apos;store&apos; || s_store_id as id , sales , returns , (profit - profit_loss) as profit from   ssr union all select &apos;catalog channel&apos; as channel , &apos;catalog_page&apos; || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from  csr union all select &apos;web channel&apos; as channel , &apos;web_site&apos; || web_site_id as id , sales , returns , (profit - profit_loss) as profit from   wsr ) x group by rollup (channel, id) order by channel ,id limit 100

</samplerData>
</sample>
<sample t="2585" lt="2577" ts="1600984613126" s="true" lb="query6" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="27265" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215650_c299ed9c-f040-48e9-acb6-0fb5a017b4f7:210
      Edges:
        Map 1 &lt;- Map 10 (BROADCAST_EDGE), Map 14 (BROADCAST_EDGE), Reducer 11 (BROADCAST_EDGE), Reducer 7 (BROADCAST_EDGE)
        Map 10 &lt;- Reducer 13 (BROADCAST_EDGE)
        Map 14 &lt;- Reducer 8 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Reducer 11 &lt;- Map 10 (CUSTOM_SIMPLE_EDGE)
        Reducer 13 &lt;- Map 12 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 15 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 6 &lt;- Map 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Map 5 (SIMPLE_EDGE)
        Reducer 9 &lt;- Reducer 8 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215650_c299ed9c-f040-48e9-acb6-0fb5a017b4f7:210
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: s
                  filterExpr: (ss_customer_sk is not null and ss_item_sk BETWEEN DynamicValue(RS_53_i_i_item_sk_min) AND DynamicValue(RS_53_i_i_item_sk_max) and in_bloom_filter(ss_item_sk, DynamicValue(RS_53_i_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 654908138904 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_customer_sk is not null and ss_item_sk BETWEEN DynamicValue(RS_53_i_i_item_sk_min) AND DynamicValue(RS_53_i_i_item_sk_max) and in_bloom_filter(ss_item_sk, DynamicValue(RS_53_i_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 639474980104 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855746120 Data size: 639474980104 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Reducer 7
                        Statistics: Num rows: 26855746120 Data size: 639474980104 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2
                          input vertices:
                            1 Map 10
                          Statistics: Num rows: 244952 Data size: 1959624 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1
                            input vertices:
                              1 Map 14
                            Statistics: Num rows: 244952 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col1 (type: bigint)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col1 (type: bigint)
                              Statistics: Num rows: 244952 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: i
                  filterExpr: (i_current_price is not null and i_category is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_150_container, bigKeyColName:i_category, smallTablePos:1, keyRatio:0.9974527363184079
                  Statistics: Num rows: 402000 Data size: 84306432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_current_price is not null and i_category is not null) (type: boolean)
                    Statistics: Num rows: 400985 Data size: 84093618 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_current_price (type: decimal(7,2)), i_category (type: char(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 400985 Data size: 84093618 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: char(50))
                          1 _col0 (type: char(50))
                        outputColumnNames: _col0, _col1, _col4
                        input vertices:
                          1 Reducer 13
                        Statistics: Num rows: 400985 Data size: 92915288 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator
                          predicate: (_col1 &gt; _col4) (type: boolean)
                          Statistics: Num rows: 133661 Data size: 30971720 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: _col0 (type: bigint)
                            outputColumnNames: _col0
                            Statistics: Num rows: 133661 Data size: 30971720 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: bigint)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: bigint)
                              Statistics: Num rows: 133661 Data size: 30971720 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: _col0 (type: bigint)
                              outputColumnNames: _col0
                              Statistics: Num rows: 133661 Data size: 1069288 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2
                                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  null sort order: 
                                  sort order: 
                                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: j
                  filterExpr: i_category is not null (type: boolean)
                  Statistics: Num rows: 402000 Data size: 81090432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: i_category is not null (type: boolean)
                    Statistics: Num rows: 402000 Data size: 81090432 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: sum(i_current_price), count(i_current_price)
                      keys: i_category (type: char(50))
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 11 Data size: 2310 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(50))
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: char(50))
                        Statistics: Num rows: 11 Data size: 2310 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: d
                  filterExpr: (d_month_seq is not null and d_month_seq BETWEEN DynamicValue(RS_44_date_dim_d_month_seq_min) AND DynamicValue(RS_44_date_dim_d_month_seq_max) and in_bloom_filter(d_month_seq, DynamicValue(RS_44_date_dim_d_month_seq_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_151_container, bigKeyColName:d_month_seq, smallTablePos:1, keyRatio:0.005722186477569851
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_month_seq is not null and d_month_seq BETWEEN DynamicValue(RS_44_date_dim_d_month_seq_min) AND DynamicValue(RS_44_date_dim_d_month_seq_max) and in_bloom_filter(d_month_seq, DynamicValue(RS_44_date_dim_d_month_seq_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_month_seq (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col0
                        input vertices:
                          1 Reducer 8
                        Statistics: Num rows: 449 Data size: 3592 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 449 Data size: 3592 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 449 Data size: 3592 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col0 (type: bigint)
                            minReductionHashAggr: 0.5011136
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 224 Data size: 1792 Basic stats: COMPLETE Column stats: COMPLETE
                            Dynamic Partitioning Event Operator
                              Target column: ss_sold_date_sk (bigint)
                              Target Input: s
                              Partition key expr: ss_sold_date_sk
                              Statistics: Num rows: 224 Data size: 1792 Basic stats: COMPLETE Column stats: COMPLETE
                              Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  Statistics: Num rows: 65000000 Data size: 6110000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ca_state (type: char(2)), c_customer_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 65000000 Data size: 6110000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col1 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col1 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 6110000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (((d_year = 2002) and (d_moy = 3)) or ((d_year = 2002) and (d_moy = 3) and d_month_seq is not null)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2002) and (d_moy = 3)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_month_seq (type: int)
                      outputColumnNames: d_month_seq
                      Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: d_month_seq (type: int)
                        minReductionHashAggr: 0.516129
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2002) and (d_moy = 3) and d_month_seq is not null) (type: boolean)
                    Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_month_seq (type: int)
                      outputColumnNames: d_month_seq
                      Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: d_month_seq (type: int)
                        minReductionHashAggr: 0.516129
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 13 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 11 Data size: 2310 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: CAST( (_col1 / _col2) AS decimal(16,6)) is not null (type: boolean)
                  Statistics: Num rows: 11 Data size: 2310 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: char(50)), (1.2 * CAST( (_col1 / _col2) AS decimal(16,6))) (type: decimal(19,7))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 11 Data size: 2222 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(50))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(50))
                      Statistics: Num rows: 11 Data size: 2222 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: decimal(19,7))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col12
                input vertices:
                  1 Map 15
                Statistics: Num rows: 244952 Data size: 21065872 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: count()
                  keys: _col12 (type: char(2))
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1 Data size: 94 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(2))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(2))
                    Statistics: Num rows: 1 Data size: 94 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: char(2))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 94 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt;= 10L) (type: boolean)
                  Statistics: Num rows: 1 Data size: 94 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: ++
                    keys: _col1 (type: bigint), _col0 (type: char(2))
                    null sort order: zz
                    Statistics: Num rows: 1 Data size: 94 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: _col1 (type: bigint), _col0 (type: char(2))
                      outputColumnNames: _col1, _col2
                      Statistics: Num rows: 1 Data size: 180 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint), _col2 (type: char(2))
                        null sort order: zz
                        sort order: ++
                        Statistics: Num rows: 1 Data size: 180 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: char(2)), KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 180 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 180 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 180 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    minReductionHashAggr: 0.93333334
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint)
        Reducer 7 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (sq_count_check(_col0) &lt;= 1) (type: boolean)
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                    minReductionHashAggr: 0.93333334
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query6
explain select  a.ca_state state, count(*) cnt from customer_address a ,customer c ,store_sales s ,date_dim d ,item i where       a.ca_address_sk = c.c_current_addr_sk and c.c_customer_sk = s.ss_customer_sk and s.ss_sold_date_sk = d.d_date_sk and s.ss_item_sk = i.i_item_sk and d.d_month_seq = (select distinct (d_month_seq) from date_dim where d_year = 2002 and d_moy = 3 ) and i.i_current_price &gt; 1.2 * (select avg(j.i_current_price) from item j where j.i_category = i.i_category) group by a.ca_state having count(*) &gt;= 10 order by cnt, a.ca_state limit 100

</samplerData>
</sample>
<sample t="6753" lt="6747" ts="1600984619881" s="true" lb="query7" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="3206" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215653_985733b2-642f-4130-99eb-014737cb5f26:211
      Edges:
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
      DagName: zabetak_20200924215653_985733b2-642f-4130-99eb-014737cb5f26:211
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.q7
                  Statistics: Num rows: 201000 Data size: 89244000 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: +
                    keys: i_item_id (type: char(16))
                    null sort order: z
                    Statistics: Num rows: 201000 Data size: 89244000 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: i_item_id (type: char(16)), agg1 (type: double), CAST( agg2 AS decimal(11,6)) (type: decimal(11,6)), CAST( agg3 AS decimal(11,6)) (type: decimal(11,6)), CAST( agg4 AS decimal(11,6)) (type: decimal(11,6))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 201000 Data size: 89244000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(16))
                        null sort order: z
                        sort order: +
                        Statistics: Num rows: 201000 Data size: 89244000 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col1 (type: double), _col2 (type: decimal(11,6)), _col3 (type: decimal(11,6)), _col4 (type: decimal(11,6))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), VALUE._col0 (type: double), VALUE._col1 (type: decimal(11,6)), VALUE._col2 (type: decimal(11,6)), VALUE._col3 (type: decimal(11,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 201000 Data size: 89244000 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 44400 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 44400 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query7
explain select  i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, item, promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = &apos;F&apos; and cd_marital_status = &apos;W&apos; and cd_education_status = &apos;College&apos; and (p_channel_email = &apos;N&apos; or p_channel_event = &apos;N&apos;) and d_year = 2001 group by i_item_id order by i_item_id limit 100

</samplerData>
</sample>
<sample t="2417" lt="2409" ts="1600984622299" s="true" lb="query8" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="26450" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215659_dca2a530-482f-4c36-acaa-191f095ac4b4:212
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Reducer 8 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 11 &lt;- Reducer 10 (SIMPLE_EDGE), Union 7 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 6 &lt;- Map 5 (SIMPLE_EDGE), Union 7 (CONTAINS)
        Reducer 8 &lt;- Map 12 (BROADCAST_EDGE), Union 7 (SIMPLE_EDGE)
      DagName: zabetak_20200924215659_dca2a530-482f-4c36-acaa-191f095ac4b4:212
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3442730411872 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3361656205024 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_store_sk (type: bigint), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26856185846 Data size: 3361656205024 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 1353086027 Data size: 86434739976 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col1 (type: bigint)
                          outputColumnNames: _col1, _col6
                          input vertices:
                            1 Reducer 8
                          Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                          Top N Key Operator
                            sort order: +
                            keys: _col6 (type: varchar(50))
                            null sort order: z
                            Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                            top n: 100
                            Group By Operator
                              aggregations: sum(_col1)
                              keys: _col6 (type: varchar(50))
                              minReductionHashAggr: 0.0
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: varchar(50))
                                null sort order: z
                                sort order: +
                                Map-reduce partition columns: _col0 (type: varchar(50))
                                Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                                TopN Hash Memory Usage: 0.04
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: substr(s_zip, 1, 2) is not null (type: boolean)
                  Statistics: Num rows: 1500 Data size: 277500 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: substr(s_zip, 1, 2) is not null (type: boolean)
                    Statistics: Num rows: 1500 Data size: 277500 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_store_name (type: varchar(50)), substr(s_zip, 1, 2) (type: string)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1500 Data size: 273000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col2 (type: string)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col2 (type: string)
                        Statistics: Num rows: 1500 Data size: 273000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col1 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 1998) and (d_qoy = 2)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_qoy = 2)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: ((substr(ca_zip, 1, 5)) IN (&apos;47602&apos;, &apos;16704&apos;, &apos;35863&apos;, &apos;28577&apos;, &apos;83910&apos;, &apos;36201&apos;, &apos;58412&apos;, &apos;48162&apos;, &apos;28055&apos;, &apos;41419&apos;, &apos;80332&apos;, &apos;38607&apos;, &apos;77817&apos;, &apos;24891&apos;, &apos;16226&apos;, &apos;18410&apos;, &apos;21231&apos;, &apos;59345&apos;, &apos;13918&apos;, &apos;51089&apos;, &apos;20317&apos;, &apos;17167&apos;, &apos;54585&apos;, &apos;67881&apos;, &apos;78366&apos;, &apos;47770&apos;, &apos;18360&apos;, &apos;51717&apos;, &apos;73108&apos;, &apos;14440&apos;, &apos;21800&apos;, &apos;89338&apos;, &apos;45859&apos;, &apos;65501&apos;, &apos;34948&apos;, &apos;25973&apos;, &apos;73219&apos;, &apos;25333&apos;, &apos;17291&apos;, &apos;10374&apos;, &apos;18829&apos;, &apos;60736&apos;, &apos;82620&apos;, &apos;41351&apos;, &apos;52094&apos;, &apos;19326&apos;, &apos;25214&apos;, &apos;54207&apos;, &apos;40936&apos;, &apos;21814&apos;, &apos;79077&apos;, &apos;25178&apos;, &apos;75742&apos;, &apos;77454&apos;, &apos;30621&apos;, &apos;89193&apos;, &apos;27369&apos;, &apos;41232&apos;, &apos;48567&apos;, &apos;83041&apos;, &apos;71948&apos;, &apos;37119&apos;, &apos;68341&apos;, &apos;14073&apos;, &apos;16891&apos;, &apos;62878&apos;, &apos;49130&apos;, &apos;19833&apos;, &apos;24286&apos;, &apos;27700&apos;, &apos;40979&apos;, &apos;50412&apos;, &apos;81504&apos;, &apos;94835&apos;, &apos;84844&apos;, &apos;71954&apos;, &apos;39503&apos;, &apos;57649&apos;, &apos;18434&apos;, &apos;24987&apos;, &apos;12350&apos;, &apos;86379&apos;, &apos;27413&apos;, &apos;44529&apos;, &apos;98569&apos;, &apos;16515&apos;, &apos;27287&apos;, &apos;24255&apos;, &apos;21094&apos;, &apos;16005&apos;, &apos;56436&apos;, &apos;91110&apos;, &apos;68293&apos;, &apos;56455&apos;, &apos;54558&apos;, &apos;10298&apos;, &apos;83647&apos;, &apos;32754&apos;, &apos;27052&apos;, &apos;51766&apos;, &apos;19444&apos;, &apos;13869&apos;, &apos;45645&apos;, &apos;94791&apos;, &apos;57631&apos;, &apos;20712&apos;, &apos;37788&apos;, &apos;41807&apos;, &apos;46507&apos;, &apos;21727&apos;, &apos;71836&apos;, &apos;81070&apos;, &apos;50632&apos;, &apos;88086&apos;, &apos;63991&apos;, &apos;20244&apos;, &apos;31655&apos;, &apos;51782&apos;, &apos;29818&apos;, &apos;63792&apos;, &apos;68605&apos;, &apos;94898&apos;, &apos;36430&apos;, &apos;57025&apos;, &apos;20601&apos;, &apos;82080&apos;, &apos;33869&apos;, &apos;22728&apos;, &apos;35834&apos;, &apos;29086&apos;, &apos;92645&apos;, &apos;98584&apos;, &apos;98072&apos;, &apos;11652&apos;, &apos;78093&apos;, &apos;57553&apos;, &apos;43830&apos;, &apos;71144&apos;, &apos;53565&apos;, &apos;18700&apos;, &apos;90209&apos;, &apos;71256&apos;, &apos;38353&apos;, &apos;54364&apos;, &apos;28571&apos;, &apos;96560&apos;, &apos;57839&apos;, &apos;56355&apos;, &apos;50679&apos;, &apos;45266&apos;, &apos;84680&apos;, &apos;34306&apos;, &apos;34972&apos;, &apos;48530&apos;, &apos;30106&apos;, &apos;15371&apos;, &apos;92380&apos;, &apos;84247&apos;, &apos;92292&apos;, &apos;68852&apos;, &apos;13338&apos;, &apos;34594&apos;, &apos;82602&apos;, &apos;70073&apos;, &apos;98069&apos;, &apos;85066&apos;, &apos;47289&apos;, &apos;11686&apos;, &apos;98862&apos;, &apos;26217&apos;, &apos;47529&apos;, &apos;63294&apos;, &apos;51793&apos;, &apos;35926&apos;, &apos;24227&apos;, &apos;14196&apos;, &apos;24594&apos;, &apos;32489&apos;, &apos;99060&apos;, &apos;49472&apos;, &apos;43432&apos;, &apos;49211&apos;, &apos;14312&apos;, &apos;88137&apos;, &apos;47369&apos;, &apos;56877&apos;, &apos;20534&apos;, &apos;81755&apos;, &apos;15794&apos;, &apos;12318&apos;, &apos;21060&apos;, &apos;73134&apos;, &apos;41255&apos;, &apos;63073&apos;, &apos;81003&apos;, &apos;73873&apos;, &apos;66057&apos;, &apos;51184&apos;, &apos;51195&apos;, &apos;45676&apos;, &apos;92696&apos;, &apos;70450&apos;, &apos;90669&apos;, &apos;98338&apos;, &apos;25264&apos;, &apos;38919&apos;, &apos;59226&apos;, &apos;58581&apos;, &apos;60298&apos;, &apos;17895&apos;, &apos;19489&apos;, &apos;52301&apos;, &apos;80846&apos;, &apos;95464&apos;, &apos;68770&apos;, &apos;51634&apos;, &apos;19988&apos;, &apos;18367&apos;, &apos;18421&apos;, &apos;11618&apos;, &apos;67975&apos;, &apos;25494&apos;, &apos;41352&apos;, &apos;95430&apos;, &apos;15734&apos;, &apos;62585&apos;, &apos;97173&apos;, &apos;33773&apos;, &apos;10425&apos;, &apos;75675&apos;, &apos;53535&apos;, &apos;17879&apos;, &apos;41967&apos;, &apos;12197&apos;, &apos;67998&apos;, &apos;79658&apos;, &apos;59130&apos;, &apos;72592&apos;, &apos;14851&apos;, &apos;43933&apos;, &apos;68101&apos;, &apos;50636&apos;, &apos;25717&apos;, &apos;71286&apos;, &apos;24660&apos;, &apos;58058&apos;, &apos;72991&apos;, &apos;95042&apos;, &apos;15543&apos;, &apos;33122&apos;, &apos;69280&apos;, &apos;11912&apos;, &apos;59386&apos;, &apos;27642&apos;, &apos;65177&apos;, &apos;17672&apos;, &apos;33467&apos;, &apos;64592&apos;, &apos;36335&apos;, &apos;54010&apos;, &apos;18767&apos;, &apos;63193&apos;, &apos;42361&apos;, &apos;49254&apos;, &apos;33113&apos;, &apos;33159&apos;, &apos;36479&apos;, &apos;59080&apos;, &apos;11855&apos;, &apos;81963&apos;, &apos;31016&apos;, &apos;49140&apos;, &apos;29392&apos;, &apos;41836&apos;, &apos;32958&apos;, &apos;53163&apos;, &apos;13844&apos;, &apos;73146&apos;, &apos;23952&apos;, &apos;65148&apos;, &apos;93498&apos;, &apos;14530&apos;, &apos;46131&apos;, &apos;58454&apos;, &apos;13376&apos;, &apos;13378&apos;, &apos;83986&apos;, &apos;12320&apos;, &apos;17193&apos;, &apos;59852&apos;, &apos;46081&apos;, &apos;98533&apos;, &apos;52389&apos;, &apos;13086&apos;, &apos;68843&apos;, &apos;31013&apos;, &apos;13261&apos;, &apos;60560&apos;, &apos;13443&apos;, &apos;45533&apos;, &apos;83583&apos;, &apos;11489&apos;, &apos;58218&apos;, &apos;19753&apos;, &apos;22911&apos;, &apos;25115&apos;, &apos;86709&apos;, &apos;27156&apos;, &apos;32669&apos;, &apos;13123&apos;, &apos;51933&apos;, &apos;39214&apos;, &apos;41331&apos;, &apos;66943&apos;, &apos;14155&apos;, &apos;69998&apos;, &apos;49101&apos;, &apos;70070&apos;, &apos;35076&apos;, &apos;14242&apos;, &apos;73021&apos;, &apos;59494&apos;, &apos;15782&apos;, &apos;29752&apos;, &apos;37914&apos;, &apos;74686&apos;, &apos;83086&apos;, &apos;34473&apos;, &apos;15751&apos;, &apos;81084&apos;, &apos;49230&apos;, &apos;91894&apos;, &apos;60624&apos;, &apos;17819&apos;, &apos;28810&apos;, &apos;63180&apos;, &apos;56224&apos;, &apos;39459&apos;, &apos;55233&apos;, &apos;75752&apos;, &apos;43639&apos;, &apos;55349&apos;, &apos;86057&apos;, &apos;62361&apos;, &apos;50788&apos;, &apos;31830&apos;, &apos;58062&apos;, &apos;18218&apos;, &apos;85761&apos;, &apos;60083&apos;, &apos;45484&apos;, &apos;21204&apos;, &apos;90229&apos;, &apos;70041&apos;, &apos;41162&apos;, &apos;35390&apos;, &apos;16364&apos;, &apos;39500&apos;, &apos;68908&apos;, &apos;26689&apos;, &apos;52868&apos;, &apos;81335&apos;, &apos;40146&apos;, &apos;11340&apos;, &apos;61527&apos;, &apos;61794&apos;, &apos;71997&apos;, &apos;30415&apos;, &apos;59004&apos;, &apos;29450&apos;, &apos;58117&apos;, &apos;69952&apos;, &apos;33562&apos;, &apos;83833&apos;, &apos;27385&apos;, &apos;61860&apos;, &apos;96435&apos;, &apos;48333&apos;, &apos;23065&apos;, &apos;32961&apos;, &apos;84919&apos;, &apos;61997&apos;, &apos;99132&apos;, &apos;22815&apos;, &apos;56600&apos;, &apos;68730&apos;, &apos;48017&apos;, &apos;95694&apos;, &apos;32919&apos;, &apos;88217&apos;, &apos;27116&apos;, &apos;28239&apos;, &apos;58032&apos;, &apos;18884&apos;, &apos;16791&apos;, &apos;21343&apos;, &apos;97462&apos;, &apos;18569&apos;, &apos;75660&apos;, &apos;15475&apos;) and substr(substr(ca_zip, 1, 5), 1, 2) is not null) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 2892500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((substr(ca_zip, 1, 5)) IN (&apos;47602&apos;, &apos;16704&apos;, &apos;35863&apos;, &apos;28577&apos;, &apos;83910&apos;, &apos;36201&apos;, &apos;58412&apos;, &apos;48162&apos;, &apos;28055&apos;, &apos;41419&apos;, &apos;80332&apos;, &apos;38607&apos;, &apos;77817&apos;, &apos;24891&apos;, &apos;16226&apos;, &apos;18410&apos;, &apos;21231&apos;, &apos;59345&apos;, &apos;13918&apos;, &apos;51089&apos;, &apos;20317&apos;, &apos;17167&apos;, &apos;54585&apos;, &apos;67881&apos;, &apos;78366&apos;, &apos;47770&apos;, &apos;18360&apos;, &apos;51717&apos;, &apos;73108&apos;, &apos;14440&apos;, &apos;21800&apos;, &apos;89338&apos;, &apos;45859&apos;, &apos;65501&apos;, &apos;34948&apos;, &apos;25973&apos;, &apos;73219&apos;, &apos;25333&apos;, &apos;17291&apos;, &apos;10374&apos;, &apos;18829&apos;, &apos;60736&apos;, &apos;82620&apos;, &apos;41351&apos;, &apos;52094&apos;, &apos;19326&apos;, &apos;25214&apos;, &apos;54207&apos;, &apos;40936&apos;, &apos;21814&apos;, &apos;79077&apos;, &apos;25178&apos;, &apos;75742&apos;, &apos;77454&apos;, &apos;30621&apos;, &apos;89193&apos;, &apos;27369&apos;, &apos;41232&apos;, &apos;48567&apos;, &apos;83041&apos;, &apos;71948&apos;, &apos;37119&apos;, &apos;68341&apos;, &apos;14073&apos;, &apos;16891&apos;, &apos;62878&apos;, &apos;49130&apos;, &apos;19833&apos;, &apos;24286&apos;, &apos;27700&apos;, &apos;40979&apos;, &apos;50412&apos;, &apos;81504&apos;, &apos;94835&apos;, &apos;84844&apos;, &apos;71954&apos;, &apos;39503&apos;, &apos;57649&apos;, &apos;18434&apos;, &apos;24987&apos;, &apos;12350&apos;, &apos;86379&apos;, &apos;27413&apos;, &apos;44529&apos;, &apos;98569&apos;, &apos;16515&apos;, &apos;27287&apos;, &apos;24255&apos;, &apos;21094&apos;, &apos;16005&apos;, &apos;56436&apos;, &apos;91110&apos;, &apos;68293&apos;, &apos;56455&apos;, &apos;54558&apos;, &apos;10298&apos;, &apos;83647&apos;, &apos;32754&apos;, &apos;27052&apos;, &apos;51766&apos;, &apos;19444&apos;, &apos;13869&apos;, &apos;45645&apos;, &apos;94791&apos;, &apos;57631&apos;, &apos;20712&apos;, &apos;37788&apos;, &apos;41807&apos;, &apos;46507&apos;, &apos;21727&apos;, &apos;71836&apos;, &apos;81070&apos;, &apos;50632&apos;, &apos;88086&apos;, &apos;63991&apos;, &apos;20244&apos;, &apos;31655&apos;, &apos;51782&apos;, &apos;29818&apos;, &apos;63792&apos;, &apos;68605&apos;, &apos;94898&apos;, &apos;36430&apos;, &apos;57025&apos;, &apos;20601&apos;, &apos;82080&apos;, &apos;33869&apos;, &apos;22728&apos;, &apos;35834&apos;, &apos;29086&apos;, &apos;92645&apos;, &apos;98584&apos;, &apos;98072&apos;, &apos;11652&apos;, &apos;78093&apos;, &apos;57553&apos;, &apos;43830&apos;, &apos;71144&apos;, &apos;53565&apos;, &apos;18700&apos;, &apos;90209&apos;, &apos;71256&apos;, &apos;38353&apos;, &apos;54364&apos;, &apos;28571&apos;, &apos;96560&apos;, &apos;57839&apos;, &apos;56355&apos;, &apos;50679&apos;, &apos;45266&apos;, &apos;84680&apos;, &apos;34306&apos;, &apos;34972&apos;, &apos;48530&apos;, &apos;30106&apos;, &apos;15371&apos;, &apos;92380&apos;, &apos;84247&apos;, &apos;92292&apos;, &apos;68852&apos;, &apos;13338&apos;, &apos;34594&apos;, &apos;82602&apos;, &apos;70073&apos;, &apos;98069&apos;, &apos;85066&apos;, &apos;47289&apos;, &apos;11686&apos;, &apos;98862&apos;, &apos;26217&apos;, &apos;47529&apos;, &apos;63294&apos;, &apos;51793&apos;, &apos;35926&apos;, &apos;24227&apos;, &apos;14196&apos;, &apos;24594&apos;, &apos;32489&apos;, &apos;99060&apos;, &apos;49472&apos;, &apos;43432&apos;, &apos;49211&apos;, &apos;14312&apos;, &apos;88137&apos;, &apos;47369&apos;, &apos;56877&apos;, &apos;20534&apos;, &apos;81755&apos;, &apos;15794&apos;, &apos;12318&apos;, &apos;21060&apos;, &apos;73134&apos;, &apos;41255&apos;, &apos;63073&apos;, &apos;81003&apos;, &apos;73873&apos;, &apos;66057&apos;, &apos;51184&apos;, &apos;51195&apos;, &apos;45676&apos;, &apos;92696&apos;, &apos;70450&apos;, &apos;90669&apos;, &apos;98338&apos;, &apos;25264&apos;, &apos;38919&apos;, &apos;59226&apos;, &apos;58581&apos;, &apos;60298&apos;, &apos;17895&apos;, &apos;19489&apos;, &apos;52301&apos;, &apos;80846&apos;, &apos;95464&apos;, &apos;68770&apos;, &apos;51634&apos;, &apos;19988&apos;, &apos;18367&apos;, &apos;18421&apos;, &apos;11618&apos;, &apos;67975&apos;, &apos;25494&apos;, &apos;41352&apos;, &apos;95430&apos;, &apos;15734&apos;, &apos;62585&apos;, &apos;97173&apos;, &apos;33773&apos;, &apos;10425&apos;, &apos;75675&apos;, &apos;53535&apos;, &apos;17879&apos;, &apos;41967&apos;, &apos;12197&apos;, &apos;67998&apos;, &apos;79658&apos;, &apos;59130&apos;, &apos;72592&apos;, &apos;14851&apos;, &apos;43933&apos;, &apos;68101&apos;, &apos;50636&apos;, &apos;25717&apos;, &apos;71286&apos;, &apos;24660&apos;, &apos;58058&apos;, &apos;72991&apos;, &apos;95042&apos;, &apos;15543&apos;, &apos;33122&apos;, &apos;69280&apos;, &apos;11912&apos;, &apos;59386&apos;, &apos;27642&apos;, &apos;65177&apos;, &apos;17672&apos;, &apos;33467&apos;, &apos;64592&apos;, &apos;36335&apos;, &apos;54010&apos;, &apos;18767&apos;, &apos;63193&apos;, &apos;42361&apos;, &apos;49254&apos;, &apos;33113&apos;, &apos;33159&apos;, &apos;36479&apos;, &apos;59080&apos;, &apos;11855&apos;, &apos;81963&apos;, &apos;31016&apos;, &apos;49140&apos;, &apos;29392&apos;, &apos;41836&apos;, &apos;32958&apos;, &apos;53163&apos;, &apos;13844&apos;, &apos;73146&apos;, &apos;23952&apos;, &apos;65148&apos;, &apos;93498&apos;, &apos;14530&apos;, &apos;46131&apos;, &apos;58454&apos;, &apos;13376&apos;, &apos;13378&apos;, &apos;83986&apos;, &apos;12320&apos;, &apos;17193&apos;, &apos;59852&apos;, &apos;46081&apos;, &apos;98533&apos;, &apos;52389&apos;, &apos;13086&apos;, &apos;68843&apos;, &apos;31013&apos;, &apos;13261&apos;, &apos;60560&apos;, &apos;13443&apos;, &apos;45533&apos;, &apos;83583&apos;, &apos;11489&apos;, &apos;58218&apos;, &apos;19753&apos;, &apos;22911&apos;, &apos;25115&apos;, &apos;86709&apos;, &apos;27156&apos;, &apos;32669&apos;, &apos;13123&apos;, &apos;51933&apos;, &apos;39214&apos;, &apos;41331&apos;, &apos;66943&apos;, &apos;14155&apos;, &apos;69998&apos;, &apos;49101&apos;, &apos;70070&apos;, &apos;35076&apos;, &apos;14242&apos;, &apos;73021&apos;, &apos;59494&apos;, &apos;15782&apos;, &apos;29752&apos;, &apos;37914&apos;, &apos;74686&apos;, &apos;83086&apos;, &apos;34473&apos;, &apos;15751&apos;, &apos;81084&apos;, &apos;49230&apos;, &apos;91894&apos;, &apos;60624&apos;, &apos;17819&apos;, &apos;28810&apos;, &apos;63180&apos;, &apos;56224&apos;, &apos;39459&apos;, &apos;55233&apos;, &apos;75752&apos;, &apos;43639&apos;, &apos;55349&apos;, &apos;86057&apos;, &apos;62361&apos;, &apos;50788&apos;, &apos;31830&apos;, &apos;58062&apos;, &apos;18218&apos;, &apos;85761&apos;, &apos;60083&apos;, &apos;45484&apos;, &apos;21204&apos;, &apos;90229&apos;, &apos;70041&apos;, &apos;41162&apos;, &apos;35390&apos;, &apos;16364&apos;, &apos;39500&apos;, &apos;68908&apos;, &apos;26689&apos;, &apos;52868&apos;, &apos;81335&apos;, &apos;40146&apos;, &apos;11340&apos;, &apos;61527&apos;, &apos;61794&apos;, &apos;71997&apos;, &apos;30415&apos;, &apos;59004&apos;, &apos;29450&apos;, &apos;58117&apos;, &apos;69952&apos;, &apos;33562&apos;, &apos;83833&apos;, &apos;27385&apos;, &apos;61860&apos;, &apos;96435&apos;, &apos;48333&apos;, &apos;23065&apos;, &apos;32961&apos;, &apos;84919&apos;, &apos;61997&apos;, &apos;99132&apos;, &apos;22815&apos;, &apos;56600&apos;, &apos;68730&apos;, &apos;48017&apos;, &apos;95694&apos;, &apos;32919&apos;, &apos;88217&apos;, &apos;27116&apos;, &apos;28239&apos;, &apos;58032&apos;, &apos;18884&apos;, &apos;16791&apos;, &apos;21343&apos;, &apos;97462&apos;, &apos;18569&apos;, &apos;75660&apos;, &apos;15475&apos;) and substr(substr(ca_zip, 1, 5), 1, 2) is not null) (type: boolean)
                    Statistics: Num rows: 16250000 Data size: 1446250000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: substr(ca_zip, 1, 5) (type: string)
                      outputColumnNames: _col0
                      Statistics: Num rows: 16250000 Data size: 1446250000 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        keys: _col0 (type: string)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 114456 Data size: 10987776 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: string)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: string)
                          Statistics: Num rows: 114456 Data size: 10987776 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: ((c_preferred_cust_flag = &apos;Y&apos;) and substr(substr(ca_zip, 1, 5), 1, 2) is not null) (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 11310000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((c_preferred_cust_flag = &apos;Y&apos;) and substr(substr(ca_zip, 1, 5), 1, 2) is not null) (type: boolean)
                    Statistics: Num rows: 21666667 Data size: 3770000058 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_zip (type: char(10))
                      outputColumnNames: ca_zip
                      Statistics: Num rows: 21666667 Data size: 3770000058 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        keys: ca_zip (type: char(10))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 429210 Data size: 41633370 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(10))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: char(10))
                          Statistics: Num rows: 429210 Data size: 41633370 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: char(10))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 9538 Data size: 925186 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt; 10L) (type: boolean)
                  Statistics: Num rows: 3179 Data size: 308363 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: substr(_col0, 1, 5) (type: string)
                    outputColumnNames: _col0
                    Statistics: Num rows: 3179 Data size: 308363 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: count()
                      keys: _col0 (type: string)
                      minReductionHashAggr: 0.5001573
                      mode: hash
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1589 Data size: 152544 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: string)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: string)
                        Statistics: Num rows: 1589 Data size: 152544 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1589 Data size: 152544 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col1)
                  keys: _col0 (type: string)
                  minReductionHashAggr: 0.50004494
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 5563 Data size: 534048 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 5563 Data size: 534048 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: bigint)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: varchar(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: varchar(50))
                  null sort order: z
                  sort order: +
                  Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col1 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: varchar(50)), VALUE._col0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 9538 Data size: 915648 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col1)
                  keys: _col0 (type: string)
                  minReductionHashAggr: 0.50004494
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 5563 Data size: 534048 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 5563 Data size: 534048 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: bigint)
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 5563 Data size: 534048 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 = 2L) (type: boolean)
                  Statistics: Num rows: 1 Data size: 96 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: substr(_col0, 1, 2) (type: string)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 86 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: string)
                        1 _col2 (type: string)
                      outputColumnNames: _col1, _col2
                      input vertices:
                        1 Map 12
                      Statistics: Num rows: 2 Data size: 192 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: bigint)
                        Statistics: Num rows: 2 Data size: 192 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: varchar(50))
        Union 7 
            Vertex: Union 7

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query8
explain select  s_store_name ,sum(ss_net_profit) from store_sales ,date_dim ,store, (select ca_zip from ( SELECT substr(ca_zip,1,5) ca_zip FROM customer_address WHERE substr(ca_zip,1,5) IN ( &apos;47602&apos;,&apos;16704&apos;,&apos;35863&apos;,&apos;28577&apos;,&apos;83910&apos;,&apos;36201&apos;, &apos;58412&apos;,&apos;48162&apos;,&apos;28055&apos;,&apos;41419&apos;,&apos;80332&apos;, &apos;38607&apos;,&apos;77817&apos;,&apos;24891&apos;,&apos;16226&apos;,&apos;18410&apos;, &apos;21231&apos;,&apos;59345&apos;,&apos;13918&apos;,&apos;51089&apos;,&apos;20317&apos;, &apos;17167&apos;,&apos;54585&apos;,&apos;67881&apos;,&apos;78366&apos;,&apos;47770&apos;, &apos;18360&apos;,&apos;51717&apos;,&apos;73108&apos;,&apos;14440&apos;,&apos;21800&apos;, &apos;89338&apos;,&apos;45859&apos;,&apos;65501&apos;,&apos;34948&apos;,&apos;25973&apos;, &apos;73219&apos;,&apos;25333&apos;,&apos;17291&apos;,&apos;10374&apos;,&apos;18829&apos;, &apos;60736&apos;,&apos;82620&apos;,&apos;41351&apos;,&apos;52094&apos;,&apos;19326&apos;, &apos;25214&apos;,&apos;54207&apos;,&apos;40936&apos;,&apos;21814&apos;,&apos;79077&apos;, &apos;25178&apos;,&apos;75742&apos;,&apos;77454&apos;,&apos;30621&apos;,&apos;89193&apos;, &apos;27369&apos;,&apos;41232&apos;,&apos;48567&apos;,&apos;83041&apos;,&apos;71948&apos;, &apos;37119&apos;,&apos;68341&apos;,&apos;14073&apos;,&apos;16891&apos;,&apos;62878&apos;, &apos;49130&apos;,&apos;19833&apos;,&apos;24286&apos;,&apos;27700&apos;,&apos;40979&apos;, &apos;50412&apos;,&apos;81504&apos;,&apos;94835&apos;,&apos;84844&apos;,&apos;71954&apos;, &apos;39503&apos;,&apos;57649&apos;,&apos;18434&apos;,&apos;24987&apos;,&apos;12350&apos;, &apos;86379&apos;,&apos;27413&apos;,&apos;44529&apos;,&apos;98569&apos;,&apos;16515&apos;, &apos;27287&apos;,&apos;24255&apos;,&apos;21094&apos;,&apos;16005&apos;,&apos;56436&apos;, &apos;91110&apos;,&apos;68293&apos;,&apos;56455&apos;,&apos;54558&apos;,&apos;10298&apos;, &apos;83647&apos;,&apos;32754&apos;,&apos;27052&apos;,&apos;51766&apos;,&apos;19444&apos;, &apos;13869&apos;,&apos;45645&apos;,&apos;94791&apos;,&apos;57631&apos;,&apos;20712&apos;, &apos;37788&apos;,&apos;41807&apos;,&apos;46507&apos;,&apos;21727&apos;,&apos;71836&apos;, &apos;81070&apos;,&apos;50632&apos;,&apos;88086&apos;,&apos;63991&apos;,&apos;20244&apos;, &apos;31655&apos;,&apos;51782&apos;,&apos;29818&apos;,&apos;63792&apos;,&apos;68605&apos;, &apos;94898&apos;,&apos;36430&apos;,&apos;57025&apos;,&apos;20601&apos;,&apos;82080&apos;, &apos;33869&apos;,&apos;22728&apos;,&apos;35834&apos;,&apos;29086&apos;,&apos;92645&apos;, &apos;98584&apos;,&apos;98072&apos;,&apos;11652&apos;,&apos;78093&apos;,&apos;57553&apos;, &apos;43830&apos;,&apos;71144&apos;,&apos;53565&apos;,&apos;18700&apos;,&apos;90209&apos;, &apos;71256&apos;,&apos;38353&apos;,&apos;54364&apos;,&apos;28571&apos;,&apos;96560&apos;, &apos;57839&apos;,&apos;56355&apos;,&apos;50679&apos;,&apos;45266&apos;,&apos;84680&apos;, &apos;34306&apos;,&apos;34972&apos;,&apos;48530&apos;,&apos;30106&apos;,&apos;15371&apos;, &apos;92380&apos;,&apos;84247&apos;,&apos;92292&apos;,&apos;68852&apos;,&apos;13338&apos;, &apos;34594&apos;,&apos;82602&apos;,&apos;70073&apos;,&apos;98069&apos;,&apos;85066&apos;, &apos;47289&apos;,&apos;11686&apos;,&apos;98862&apos;,&apos;26217&apos;,&apos;47529&apos;, &apos;63294&apos;,&apos;51793&apos;,&apos;35926&apos;,&apos;24227&apos;,&apos;14196&apos;, &apos;24594&apos;,&apos;32489&apos;,&apos;99060&apos;,&apos;49472&apos;,&apos;43432&apos;, &apos;49211&apos;,&apos;14312&apos;,&apos;88137&apos;,&apos;47369&apos;,&apos;56877&apos;, &apos;20534&apos;,&apos;81755&apos;,&apos;15794&apos;,&apos;12318&apos;,&apos;21060&apos;, &apos;73134&apos;,&apos;41255&apos;,&apos;63073&apos;,&apos;81003&apos;,&apos;73873&apos;, &apos;66057&apos;,&apos;51184&apos;,&apos;51195&apos;,&apos;45676&apos;,&apos;92696&apos;, &apos;70450&apos;,&apos;90669&apos;,&apos;98338&apos;,&apos;25264&apos;,&apos;38919&apos;, &apos;59226&apos;,&apos;58581&apos;,&apos;60298&apos;,&apos;17895&apos;,&apos;19489&apos;, &apos;52301&apos;,&apos;80846&apos;,&apos;95464&apos;,&apos;68770&apos;,&apos;51634&apos;, &apos;19988&apos;,&apos;18367&apos;,&apos;18421&apos;,&apos;11618&apos;,&apos;67975&apos;, &apos;25494&apos;,&apos;41352&apos;,&apos;95430&apos;,&apos;15734&apos;,&apos;62585&apos;, &apos;97173&apos;,&apos;33773&apos;,&apos;10425&apos;,&apos;75675&apos;,&apos;53535&apos;, &apos;17879&apos;,&apos;41967&apos;,&apos;12197&apos;,&apos;67998&apos;,&apos;79658&apos;, &apos;59130&apos;,&apos;72592&apos;,&apos;14851&apos;,&apos;43933&apos;,&apos;68101&apos;, &apos;50636&apos;,&apos;25717&apos;,&apos;71286&apos;,&apos;24660&apos;,&apos;58058&apos;, &apos;72991&apos;,&apos;95042&apos;,&apos;15543&apos;,&apos;33122&apos;,&apos;69280&apos;, &apos;11912&apos;,&apos;59386&apos;,&apos;27642&apos;,&apos;65177&apos;,&apos;17672&apos;, &apos;33467&apos;,&apos;64592&apos;,&apos;36335&apos;,&apos;54010&apos;,&apos;18767&apos;, &apos;63193&apos;,&apos;42361&apos;,&apos;49254&apos;,&apos;33113&apos;,&apos;33159&apos;, &apos;36479&apos;,&apos;59080&apos;,&apos;11855&apos;,&apos;81963&apos;,&apos;31016&apos;, &apos;49140&apos;,&apos;29392&apos;,&apos;41836&apos;,&apos;32958&apos;,&apos;53163&apos;, &apos;13844&apos;,&apos;73146&apos;,&apos;23952&apos;,&apos;65148&apos;,&apos;93498&apos;, &apos;14530&apos;,&apos;46131&apos;,&apos;58454&apos;,&apos;13376&apos;,&apos;13378&apos;, &apos;83986&apos;,&apos;12320&apos;,&apos;17193&apos;,&apos;59852&apos;,&apos;46081&apos;, &apos;98533&apos;,&apos;52389&apos;,&apos;13086&apos;,&apos;68843&apos;,&apos;31013&apos;, &apos;13261&apos;,&apos;60560&apos;,&apos;13443&apos;,&apos;45533&apos;,&apos;83583&apos;, &apos;11489&apos;,&apos;58218&apos;,&apos;19753&apos;,&apos;22911&apos;,&apos;25115&apos;, &apos;86709&apos;,&apos;27156&apos;,&apos;32669&apos;,&apos;13123&apos;,&apos;51933&apos;, &apos;39214&apos;,&apos;41331&apos;,&apos;66943&apos;,&apos;14155&apos;,&apos;69998&apos;, &apos;49101&apos;,&apos;70070&apos;,&apos;35076&apos;,&apos;14242&apos;,&apos;73021&apos;, &apos;59494&apos;,&apos;15782&apos;,&apos;29752&apos;,&apos;37914&apos;,&apos;74686&apos;, &apos;83086&apos;,&apos;34473&apos;,&apos;15751&apos;,&apos;81084&apos;,&apos;49230&apos;, &apos;91894&apos;,&apos;60624&apos;,&apos;17819&apos;,&apos;28810&apos;,&apos;63180&apos;, &apos;56224&apos;,&apos;39459&apos;,&apos;55233&apos;,&apos;75752&apos;,&apos;43639&apos;, &apos;55349&apos;,&apos;86057&apos;,&apos;62361&apos;,&apos;50788&apos;,&apos;31830&apos;, &apos;58062&apos;,&apos;18218&apos;,&apos;85761&apos;,&apos;60083&apos;,&apos;45484&apos;, &apos;21204&apos;,&apos;90229&apos;,&apos;70041&apos;,&apos;41162&apos;,&apos;35390&apos;, &apos;16364&apos;,&apos;39500&apos;,&apos;68908&apos;,&apos;26689&apos;,&apos;52868&apos;, &apos;81335&apos;,&apos;40146&apos;,&apos;11340&apos;,&apos;61527&apos;,&apos;61794&apos;, &apos;71997&apos;,&apos;30415&apos;,&apos;59004&apos;,&apos;29450&apos;,&apos;58117&apos;, &apos;69952&apos;,&apos;33562&apos;,&apos;83833&apos;,&apos;27385&apos;,&apos;61860&apos;, &apos;96435&apos;,&apos;48333&apos;,&apos;23065&apos;,&apos;32961&apos;,&apos;84919&apos;, &apos;61997&apos;,&apos;99132&apos;,&apos;22815&apos;,&apos;56600&apos;,&apos;68730&apos;, &apos;48017&apos;,&apos;95694&apos;,&apos;32919&apos;,&apos;88217&apos;,&apos;27116&apos;, &apos;28239&apos;,&apos;58032&apos;,&apos;18884&apos;,&apos;16791&apos;,&apos;21343&apos;, &apos;97462&apos;,&apos;18569&apos;,&apos;75660&apos;,&apos;15475&apos;) intersect select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag=&apos;Y&apos; group by ca_zip having count(*) &gt; 10)A1)A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1998 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name limit 100

</samplerData>
</sample>
<sample t="1973" lt="1964" ts="1600984624273" s="true" lb="query9" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="44880" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215702_1f1f53c1-360f-4870-9a1c-0956f92bce9f:213
      Edges:
        Map 1 &lt;- Reducer 10 (BROADCAST_EDGE), Reducer 11 (BROADCAST_EDGE), Reducer 12 (BROADCAST_EDGE), Reducer 13 (BROADCAST_EDGE), Reducer 14 (BROADCAST_EDGE), Reducer 15 (BROADCAST_EDGE), Reducer 16 (BROADCAST_EDGE), Reducer 17 (BROADCAST_EDGE), Reducer 3 (BROADCAST_EDGE), Reducer 4 (BROADCAST_EDGE), Reducer 5 (BROADCAST_EDGE), Reducer 6 (BROADCAST_EDGE), Reducer 7 (BROADCAST_EDGE), Reducer 8 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 11 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 12 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 13 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 14 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 15 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 16 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 17 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215702_1f1f53c1-360f-4870-9a1c-0956f92bce9f:213
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: reason
                  filterExpr: (r_reason_sk = 1L) (type: boolean)
                  Statistics: Num rows: 70 Data size: 560 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (r_reason_sk = 1L) (type: boolean)
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Left Outer Join 0 to 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col1
                        input vertices:
                          1 Reducer 5
                        Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Left Outer Join 0 to 1
                          keys:
                            0 
                            1 
                          outputColumnNames: _col1, _col2
                          input vertices:
                            1 Reducer 10
                          Statistics: Num rows: 1 Data size: 116 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Left Outer Join 0 to 1
                            keys:
                              0 
                              1 
                            outputColumnNames: _col1, _col2, _col3
                            input vertices:
                              1 Reducer 15
                            Statistics: Num rows: 1 Data size: 228 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Left Outer Join 0 to 1
                              keys:
                                0 
                                1 
                              outputColumnNames: _col1, _col2, _col3, _col4
                              input vertices:
                                1 Reducer 6
                              Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                              Map Join Operator
                                condition map:
                                     Left Outer Join 0 to 1
                                keys:
                                  0 
                                  1 
                                outputColumnNames: _col1, _col2, _col3, _col4, _col5
                                input vertices:
                                  1 Reducer 11
                                Statistics: Num rows: 1 Data size: 344 Basic stats: COMPLETE Column stats: COMPLETE
                                Map Join Operator
                                  condition map:
                                       Left Outer Join 0 to 1
                                  keys:
                                    0 
                                    1 
                                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6
                                  input vertices:
                                    1 Reducer 16
                                  Statistics: Num rows: 1 Data size: 456 Basic stats: COMPLETE Column stats: COMPLETE
                                  Map Join Operator
                                    condition map:
                                         Left Outer Join 0 to 1
                                    keys:
                                      0 
                                      1 
                                    outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7
                                    input vertices:
                                      1 Reducer 7
                                    Statistics: Num rows: 1 Data size: 460 Basic stats: COMPLETE Column stats: COMPLETE
                                    Map Join Operator
                                      condition map:
                                           Left Outer Join 0 to 1
                                      keys:
                                        0 
                                        1 
                                      outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                                      input vertices:
                                        1 Reducer 12
                                      Statistics: Num rows: 1 Data size: 572 Basic stats: COMPLETE Column stats: COMPLETE
                                      Map Join Operator
                                        condition map:
                                             Left Outer Join 0 to 1
                                        keys:
                                          0 
                                          1 
                                        outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                                        input vertices:
                                          1 Reducer 17
                                        Statistics: Num rows: 1 Data size: 684 Basic stats: COMPLETE Column stats: COMPLETE
                                        Map Join Operator
                                          condition map:
                                               Left Outer Join 0 to 1
                                          keys:
                                            0 
                                            1 
                                          outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                                          input vertices:
                                            1 Reducer 3
                                          Statistics: Num rows: 1 Data size: 688 Basic stats: COMPLETE Column stats: COMPLETE
                                          Map Join Operator
                                            condition map:
                                                 Left Outer Join 0 to 1
                                            keys:
                                              0 
                                              1 
                                            outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                                            input vertices:
                                              1 Reducer 8
                                            Statistics: Num rows: 1 Data size: 800 Basic stats: COMPLETE Column stats: COMPLETE
                                            Map Join Operator
                                              condition map:
                                                   Left Outer Join 0 to 1
                                              keys:
                                                0 
                                                1 
                                              outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                                              input vertices:
                                                1 Reducer 13
                                              Statistics: Num rows: 1 Data size: 912 Basic stats: COMPLETE Column stats: COMPLETE
                                              Map Join Operator
                                                condition map:
                                                     Left Outer Join 0 to 1
                                                keys:
                                                  0 
                                                  1 
                                                outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                                                input vertices:
                                                  1 Reducer 4
                                                Statistics: Num rows: 1 Data size: 916 Basic stats: COMPLETE Column stats: COMPLETE
                                                Map Join Operator
                                                  condition map:
                                                       Left Outer Join 0 to 1
                                                  keys:
                                                    0 
                                                    1 
                                                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                                                  input vertices:
                                                    1 Reducer 9
                                                  Statistics: Num rows: 1 Data size: 1028 Basic stats: COMPLETE Column stats: COMPLETE
                                                  Map Join Operator
                                                    condition map:
                                                         Left Outer Join 0 to 1
                                                    keys:
                                                      0 
                                                      1 
                                                    outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
                                                    input vertices:
                                                      1 Reducer 14
                                                    Statistics: Num rows: 1 Data size: 1140 Basic stats: COMPLETE Column stats: COMPLETE
                                                    Select Operator
                                                      expressions: CASE WHEN (_col1) THEN (_col2) ELSE (_col3) END (type: decimal(37,22)), CASE WHEN (_col4) THEN (_col5) ELSE (_col6) END (type: decimal(37,22)), CASE WHEN (_col7) THEN (_col8) ELSE (_col9) END (type: decimal(37,22)), CASE WHEN (_col10) THEN (_col11) ELSE (_col12) END (type: decimal(37,22)), CASE WHEN (_col13) THEN (_col14) ELSE (_col15) END (type: decimal(37,22))
                                                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                                                      Statistics: Num rows: 1 Data size: 560 Basic stats: COMPLETE Column stats: COMPLETE
                                                      File Output Operator
                                                        compressed: false
                                                        Statistics: Num rows: 1 Data size: 560 Basic stats: COMPLETE Column stats: COMPLETE
                                                        table:
                                                            input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                                            output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                                            serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_quantity BETWEEN 61 AND 80 or ss_quantity BETWEEN 81 AND 100 or ss_quantity BETWEEN 1 AND 20 or ss_quantity BETWEEN 21 AND 40 or ss_quantity BETWEEN 41 AND 60) (type: boolean)
                  Statistics: Num rows: 28800426268 Data size: 110016157168 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_quantity BETWEEN 61 AND 80 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 81 AND 100 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 1 AND 20 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 21 AND 40 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 41 AND 60 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 5760085254 Data size: 22003231440 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 61 AND 80 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_ext_discount_amt (type: decimal(7,2))
                      outputColumnNames: ss_ext_discount_amt
                      Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_ext_discount_amt), count(ss_ext_discount_amt)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 81 AND 100 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_ext_discount_amt (type: decimal(7,2))
                      outputColumnNames: ss_ext_discount_amt
                      Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_ext_discount_amt), count(ss_ext_discount_amt)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 1 AND 20 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_ext_discount_amt (type: decimal(7,2))
                      outputColumnNames: ss_ext_discount_amt
                      Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_ext_discount_amt), count(ss_ext_discount_amt)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 21 AND 40 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_ext_discount_amt (type: decimal(7,2))
                      outputColumnNames: ss_ext_discount_amt
                      Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_ext_discount_amt), count(ss_ext_discount_amt)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 41 AND 60 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_ext_discount_amt (type: decimal(7,2))
                      outputColumnNames: ss_ext_discount_amt
                      Statistics: Num rows: 5760085254 Data size: 638093076608 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_ext_discount_amt), count(ss_ext_discount_amt)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 61 AND 80 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_net_profit (type: decimal(7,2))
                      outputColumnNames: ss_net_profit
                      Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_net_profit), count(ss_net_profit)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 81 AND 100 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_net_profit (type: decimal(7,2))
                      outputColumnNames: ss_net_profit
                      Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_net_profit), count(ss_net_profit)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 1 AND 20 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_net_profit (type: decimal(7,2))
                      outputColumnNames: ss_net_profit
                      Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_net_profit), count(ss_net_profit)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 21 AND 40 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_net_profit (type: decimal(7,2))
                      outputColumnNames: ss_net_profit
                      Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_net_profit), count(ss_net_profit)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
                  Filter Operator
                    predicate: ss_quantity BETWEEN 41 AND 60 (type: boolean)
                    Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_net_profit (type: decimal(7,2))
                      outputColumnNames: ss_net_profit
                      Statistics: Num rows: 5760085254 Data size: 638088968112 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_net_profit), count(ss_net_profit)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 16 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 17 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 &gt; 96251173L) (type: boolean)
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 &gt; 80049606L) (type: boolean)
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 &gt; 98972190L) (type: boolean)
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 &gt; 160856845L) (type: boolean)
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 &gt; 12733327L) (type: boolean)
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22))
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22))

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query9
explain select case when (select count(*) from store_sales where ss_quantity between 1 and 20) &gt; 98972190 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_profit) from store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from store_sales where ss_quantity between 21 and 40) &gt; 160856845 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_profit) from store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from store_sales where ss_quantity between 41 and 60) &gt; 12733327 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_profit) from store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from store_sales where ss_quantity between 61 and 80) &gt; 96251173 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_profit) from store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from store_sales where ss_quantity between 81 and 100) &gt; 80049606 then (select avg(ss_ext_discount_amt) from store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_profit) from store_sales where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1

</samplerData>
</sample>
<sample t="4314" lt="4306" ts="1600984628591" s="true" lb="query10" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="25798" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215704_64dec215-8a81-48f1-90dd-d7e2c271e5f8:214
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Reducer 10 (BROADCAST_EDGE), Reducer 8 (BROADCAST_EDGE)
        Map 5 &lt;- Map 6 (BROADCAST_EDGE)
        Map 7 &lt;- Map 6 (BROADCAST_EDGE)
        Map 9 &lt;- Map 6 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE)
      DagName: zabetak_20200924215704_64dec215-8a81-48f1-90dd-d7e2c271e5f8:214
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: ((ca_county) IN (&apos;Fillmore County&apos;, &apos;McPherson County&apos;, &apos;Bonneville County&apos;, &apos;Boone County&apos;, &apos;Brown County&apos;) and c_current_cdemo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_140_container, bigKeyColName:c_customer_sk, smallTablePos:1, keyRatio:2.8904615384615386E-4
                  Statistics: Num rows: 65000000 Data size: 7391816528 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ca_county) IN (&apos;Fillmore County&apos;, &apos;McPherson County&apos;, &apos;Bonneville County&apos;, &apos;Boone County&apos;, &apos;Brown County&apos;) and c_current_cdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 162506 Data size: 18480228 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_cdemo_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 162506 Data size: 2554640 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 162506 Data size: 61589774 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Left Semi Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 18788 Data size: 7120652 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Left Outer Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col1 (type: bigint)
                            outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                            input vertices:
                              1 Reducer 8
                            Statistics: Num rows: 61653 Data size: 23613099 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Left Outer Join 0 to 1
                              keys:
                                0 _col0 (type: bigint)
                                1 _col1 (type: bigint)
                              outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col13
                              input vertices:
                                1 Reducer 10
                              Statistics: Num rows: 125760 Data size: 47663040 Basic stats: COMPLETE Column stats: COMPLETE
                              Filter Operator
                                predicate: (_col11 is not null or _col13 is not null) (type: boolean)
                                Statistics: Num rows: 125760 Data size: 47663040 Basic stats: COMPLETE Column stats: COMPLETE
                                Top N Key Operator
                                  sort order: ++++++++
                                  keys: _col3 (type: char(1)), _col4 (type: char(1)), _col5 (type: char(20)), _col6 (type: int), _col7 (type: char(10)), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                                  null sort order: zzzzzzzz
                                  Statistics: Num rows: 125760 Data size: 47663040 Basic stats: COMPLETE Column stats: COMPLETE
                                  top n: 100
                                  Select Operator
                                    expressions: _col3 (type: char(1)), _col4 (type: char(1)), _col5 (type: char(20)), _col6 (type: int), _col7 (type: char(10)), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                                    outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                                    Statistics: Num rows: 125760 Data size: 47663040 Basic stats: COMPLETE Column stats: COMPLETE
                                    Group By Operator
                                      aggregations: count()
                                      keys: _col3 (type: char(1)), _col4 (type: char(1)), _col5 (type: char(20)), _col6 (type: int), _col7 (type: char(10)), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                                      minReductionHashAggr: 0.99
                                      mode: hash
                                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                                      Statistics: Num rows: 1 Data size: 379 Basic stats: COMPLETE Column stats: COMPLETE
                                      Reduce Output Operator
                                        key expressions: _col0 (type: char(1)), _col1 (type: char(1)), _col2 (type: char(20)), _col3 (type: int), _col4 (type: char(10)), _col5 (type: int), _col6 (type: int), _col7 (type: int)
                                        null sort order: zzzzzzzz
                                        sort order: ++++++++
                                        Map-reduce partition columns: _col0 (type: char(1)), _col1 (type: char(1)), _col2 (type: char(20)), _col3 (type: int), _col4 (type: char(10)), _col5 (type: int), _col6 (type: int), _col7 (type: int)
                                        Statistics: Num rows: 1 Data size: 379 Basic stats: COMPLETE Column stats: COMPLETE
                                        TopN Hash Memory Usage: 0.04
                                        value expressions: _col8 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  Statistics: Num rows: 1920800 Data size: 727983200 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cd_demo_sk (type: bigint), cd_gender (type: char(1)), cd_marital_status (type: char(1)), cd_education_status (type: char(20)), cd_purchase_estimate (type: int), cd_credit_rating (type: char(10)), cd_dep_count (type: int), cd_dep_employed_count (type: int), cd_dep_college_count (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 1920800 Data size: 727983200 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 727983200 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(1)), _col2 (type: char(1)), _col3 (type: char(20)), _col4 (type: int), _col5 (type: char(10)), _col6 (type: int), _col7 (type: int), _col8 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 434877053936 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 1794280344 Data size: 9291315976 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 7514737 Data size: 38913544 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 7514737 Data size: 38913544 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) and d_moy BETWEEN 3 AND 6) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and d_moy BETWEEN 3 AND 6) (type: boolean)
                    Statistics: Num rows: 122 Data size: 1952 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 61 Data size: 488 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 61 Data size: 488 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 5
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 61 Data size: 488 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 61 Data size: 488 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 61 Data size: 488 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 61 Data size: 488 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 9
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 115163423680 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 480862143 Data size: 3839718824 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 924795 Data size: 7384560 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 924795 Data size: 7384560 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_ship_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 228959459440 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_ship_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291978461 Data size: 228384573968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_ship_customer_sk (type: bigint), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 14291978461 Data size: 228384573968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 948122598 Data size: 7297899376 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 3647040 Data size: 28072040 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 3647040 Data size: 28072040 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 125760 Data size: 968008 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: true (type: boolean), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 125760 Data size: 1471048 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 125760 Data size: 1471048 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: char(1)), KEY._col1 (type: char(1)), KEY._col2 (type: char(20)), KEY._col3 (type: int), KEY._col4 (type: char(10)), KEY._col5 (type: int), KEY._col6 (type: int), KEY._col7 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 1 Data size: 379 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(1)), _col1 (type: char(1)), _col2 (type: char(20)), _col8 (type: bigint), _col3 (type: int), _col4 (type: char(10)), _col5 (type: int), _col6 (type: int), _col7 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col8, _col10, _col12
                  Statistics: Num rows: 1 Data size: 419 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(1)), _col1 (type: char(1)), _col2 (type: char(20)), _col4 (type: int), _col6 (type: char(10)), _col8 (type: int), _col10 (type: int), _col12 (type: int)
                    null sort order: zzzzzzzz
                    sort order: ++++++++
                    Statistics: Num rows: 1 Data size: 419 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col3 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(1)), KEY.reducesinkkey1 (type: char(1)), KEY.reducesinkkey2 (type: char(20)), VALUE._col0 (type: bigint), KEY.reducesinkkey3 (type: int), VALUE._col0 (type: bigint), KEY.reducesinkkey4 (type: char(10)), VALUE._col0 (type: bigint), KEY.reducesinkkey5 (type: int), VALUE._col0 (type: bigint), KEY.reducesinkkey6 (type: int), VALUE._col0 (type: bigint), KEY.reducesinkkey7 (type: int), VALUE._col0 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                Statistics: Num rows: 1 Data size: 419 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 419 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 419 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 61653 Data size: 492312 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: true (type: boolean), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 61653 Data size: 738924 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 61653 Data size: 738924 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query10
explain select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in (&apos;Fillmore County&apos;,&apos;McPherson County&apos;,&apos;Bonneville County&apos;,&apos;Boone County&apos;,&apos;Brown County&apos;) and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2000 and d_moy between 3 and 3+3) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 2000 and d_moy between 3 ANd 3+3) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 2000 and d_moy between 3 and 3+3)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100

</samplerData>
</sample>
<sample t="5281" lt="5273" ts="1600984633873" s="true" lb="query11" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="33861" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215708_7c5348e7-2f45-454b-bd9e-c2691e7af26b:215
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE)
        Map 10 &lt;- Map 5 (BROADCAST_EDGE)
        Map 13 &lt;- Map 5 (BROADCAST_EDGE)
        Map 7 &lt;- Map 5 (BROADCAST_EDGE)
        Reducer 11 &lt;- Map 10 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 12 &lt;- Reducer 11 (SIMPLE_EDGE)
        Reducer 14 &lt;- Map 13 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 15 &lt;- Reducer 14 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 12 (BROADCAST_EDGE), Reducer 15 (BROADCAST_EDGE), Reducer 2 (SIMPLE_EDGE), Reducer 9 (BROADCAST_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 6 (CUSTOM_SIMPLE_EDGE), Map 7 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Reducer 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924215708_7c5348e7-2f45-454b-bd9e-c2691e7af26b:215
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 6450555952592 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 6298546153944 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint), (ss_ext_list_price - ss_ext_discount_amt) (type: decimal(8,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855746120 Data size: 3432472576584 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5397548198 Data size: 642642856984 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 5397548198 Data size: 642642856984 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(8,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 1727350291104 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 1727134940368 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint), (ws_ext_list_price - ws_ext_discount_amt) (type: decimal(8,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197265278 Data size: 921242777264 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 1446527908 Data size: 173576170640 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 1446527908 Data size: 173576170640 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(8,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 1727350291104 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 1727134940368 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint), (ws_ext_list_price - ws_ext_discount_amt) (type: decimal(8,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197265278 Data size: 921242777264 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 1446527908 Data size: 173576170640 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 1446527908 Data size: 173576170640 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(8,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) or (d_year = 1999)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: (d_year = 1999) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 10
                  Filter Operator
                    predicate: (d_year = 1999) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 65000000 Data size: 29562000184 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_customer_id (type: string), c_first_name (type: char(20)), c_last_name (type: char(30)), c_birth_country (type: varchar(20))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col5
                    Statistics: Num rows: 65000000 Data size: 29562000184 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 29562000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string), _col2 (type: char(20)), _col3 (type: char(30)), _col5 (type: varchar(20))
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_customer_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 6450555952592 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 6298546153944 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint), (ss_ext_list_price - ss_ext_discount_amt) (type: decimal(8,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855746120 Data size: 3432472576584 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5397548198 Data size: 642642856984 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 5397548198 Data size: 642642856984 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(8,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5
                input vertices:
                  1 Map 6
                Statistics: Num rows: 1446527908 Data size: 427574260952 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19213129008 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19213129008 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(18,2))
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3842626208 Basic stats: COMPLETE Column stats: PARTIAL
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 13000001 Data size: 3842626208 Basic stats: COMPLETE Column stats: PARTIAL
                  value expressions: _col1 (type: decimal(18,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5
                input vertices:
                  1 Map 6
                Statistics: Num rows: 1446527908 Data size: 427574260952 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19213129008 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19213129008 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(18,2))
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3842626208 Basic stats: COMPLETE Column stats: PARTIAL
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 4333333 Data size: 1280875328 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: decimal(18,2)), _col1 is not null (type: boolean), _col1 is null (type: boolean)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 4333333 Data size: 1315541992 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: string)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: string)
                      Statistics: Num rows: 4333333 Data size: 1315541992 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: decimal(18,2)), _col2 (type: boolean), _col3 (type: boolean)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5, _col6, _col7, _col9
                input vertices:
                  1 Map 6
                Statistics: Num rows: 5397548198 Data size: 3065209376648 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string), _col6 (type: char(20)), _col7 (type: char(30)), _col9 (type: varchar(20))
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 65000000 Data size: 36912798792 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                    null sort order: aaaa
                    sort order: ++++
                    Map-reduce partition columns: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                    Statistics: Num rows: 65000000 Data size: 36912798792 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col4 (type: decimal(18,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string), KEY._col1 (type: char(20)), KEY._col2 (type: char(30)), KEY._col3 (type: varchar(20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 65000000 Data size: 36912798792 Basic stats: COMPLETE Column stats: PARTIAL
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: string)
                    1 _col0 (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6
                  input vertices:
                    1 Reducer 9
                  Statistics: Num rows: 21666665 Data size: 14726130992 Basic stats: COMPLETE Column stats: PARTIAL
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: string)
                      1 _col0 (type: string)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col8
                    input vertices:
                      1 Reducer 12
                    Statistics: Num rows: 21666666 Data size: 17152798264 Basic stats: COMPLETE Column stats: PARTIAL
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: string)
                        1 _col0 (type: string)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col8, _col10, _col11, _col12
                      input vertices:
                        1 Reducer 15
                      Statistics: Num rows: 21666666 Data size: 19752798184 Basic stats: COMPLETE Column stats: PARTIAL
                      Filter Operator
                        predicate: ((((((_col8 / _col10) &gt; (_col4 / _col6)) and _col11) or ((0 &gt; (_col4 / _col6)) and _col12)) and _col6 is not null) or (((_col8 / _col10) &gt; 0) and _col6 is null and _col11)) (type: boolean)
                        Statistics: Num rows: 7222222 Data size: 6584266184 Basic stats: COMPLETE Column stats: PARTIAL
                        Top N Key Operator
                          sort order: ++++
                          keys: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                          null sort order: zzzz
                          Statistics: Num rows: 7222222 Data size: 6584266184 Basic stats: COMPLETE Column stats: PARTIAL
                          top n: 100
                          Select Operator
                            expressions: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 7222222 Data size: 3288532488 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: varchar(20))
                              null sort order: zzzz
                              sort order: ++++
                              Statistics: Num rows: 7222222 Data size: 3288532488 Basic stats: COMPLETE Column stats: PARTIAL
                              TopN Hash Memory Usage: 0.04
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: char(20)), KEY.reducesinkkey2 (type: char(30)), KEY.reducesinkkey3 (type: varchar(20))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 7222222 Data size: 3288532488 Basic stats: COMPLETE Column stats: PARTIAL
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 45600 Basic stats: COMPLETE Column stats: PARTIAL
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 45600 Basic stats: COMPLETE Column stats: PARTIAL
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col5
                input vertices:
                  1 Map 6
                Statistics: Num rows: 5397548198 Data size: 1597076266792 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19232798792 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19232798792 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(18,2))
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3846560128 Basic stats: COMPLETE Column stats: PARTIAL
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 4333333 Data size: 1282186696 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 4333333 Data size: 1282186696 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(18,2))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query11
explain with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total ,&apos;s&apos; sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total ,&apos;w&apos; sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = &apos;s&apos; and t_w_firstyear.sale_type = &apos;w&apos; and t_s_secyear.sale_type = &apos;s&apos; and t_w_secyear.sale_type = &apos;w&apos; and t_s_firstyear.dyear = 1999 and t_s_secyear.dyear = 1999+1 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999+1 and t_s_firstyear.year_total &gt; 0 and t_w_firstyear.year_total &gt; 0 and case when t_w_firstyear.year_total &gt; 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end &gt; case when t_s_firstyear.year_total &gt; 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country limit 100

</samplerData>
</sample>
<sample t="3223" lt="3215" ts="1600984637096" s="true" lb="query12" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="3542" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215713_44c16200-a388-4193-bfdb-63b74f10b2dc:216
      Edges:
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
      DagName: zabetak_20200924215713_44c16200-a388-4193-bfdb-63b74f10b2dc:216
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.q12
                  Statistics: Num rows: 60012 Data size: 48182468 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: +++++
                    keys: i_category (type: char(50)), i_class (type: char(50)), i_item_id (type: char(16)), i_item_desc (type: varchar(200)), revenueratio (type: decimal(38,17))
                    null sort order: zzzzz
                    Statistics: Num rows: 60012 Data size: 48182468 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: i_item_id (type: char(16)), i_item_desc (type: varchar(200)), i_category (type: char(50)), i_class (type: char(50)), i_current_price (type: decimal(7,2)), itemrevenue (type: decimal(17,2)), revenueratio (type: decimal(38,17))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 60012 Data size: 48175188 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col2 (type: char(50)), _col3 (type: char(50)), _col0 (type: char(16)), _col1 (type: varchar(200)), _col6 (type: decimal(38,17))
                        null sort order: zzzzz
                        sort order: +++++
                        Statistics: Num rows: 60012 Data size: 48175188 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col4 (type: decimal(7,2)), _col5 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey2 (type: char(16)), KEY.reducesinkkey3 (type: varchar(200)), KEY.reducesinkkey0 (type: char(50)), KEY.reducesinkkey1 (type: char(50)), VALUE._col0 (type: decimal(7,2)), VALUE._col1 (type: decimal(17,2)), KEY.reducesinkkey4 (type: decimal(38,17))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 60012 Data size: 48175188 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 80300 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 80300 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query12
explain select  i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in (&apos;Electronics&apos;, &apos;Books&apos;, &apos;Women&apos;) and ws_sold_date_sk = d_date_sk and d_date between cast(&apos;1998-01-06&apos; as date) and (cast(&apos;1998-01-06&apos; as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio limit 100

</samplerData>
</sample>
<sample t="5183" lt="5177" ts="1600984642280" s="true" lb="query13" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="16314" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215717_7301a114-50d3-40b3-b902-3a06aabd0d56:217
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215717_7301a114-50d3-40b3-b902-3a06aabd0d56:217
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_addr_sk is not null and ss_cdemo_sk is not null and ss_hdemo_sk is not null and ss_store_sk is not null and ((ss_sales_price &gt;= 100) or (ss_sales_price &lt;= 150) or (ss_sales_price &gt;= 50) or (ss_sales_price &lt;= 100) or (ss_sales_price &gt;= 150) or (ss_sales_price &lt;= 200)) and ((ss_net_profit &gt;= 100) or (ss_net_profit &lt;= 200) or (ss_net_profit &gt;= 150) or (ss_net_profit &lt;= 300) or (ss_net_profit &gt;= 50) or (ss_net_profit &lt;= 250))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_89_container, bigKeyColName:ss_hdemo_sk, smallTablePos:1, keyRatio:1.9899006545537728E-7
                  Statistics: Num rows: 27503885621 Data size: 13218236537752 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_addr_sk is not null and ss_cdemo_sk is not null and ss_hdemo_sk is not null and ss_store_sk is not null and ((ss_sales_price &gt;= 100) or (ss_sales_price &lt;= 150) or (ss_sales_price &gt;= 50) or (ss_sales_price &lt;= 100) or (ss_sales_price &gt;= 150) or (ss_sales_price &lt;= 200)) and ((ss_net_profit &gt;= 100) or (ss_net_profit &lt;= 200) or (ss_net_profit &gt;= 150) or (ss_net_profit &lt;= 300) or (ss_net_profit &gt;= 50) or (ss_net_profit &lt;= 250))) (type: boolean)
                    Statistics: Num rows: 25001775326 Data size: 12015734237588 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_cdemo_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: decimal(7,2)), ss_ext_wholesale_cost (type: decimal(7,2)), ss_sold_date_sk (type: bigint), ss_net_profit BETWEEN 100 AND 200 (type: boolean), ss_net_profit BETWEEN 150 AND 300 (type: boolean), ss_net_profit BETWEEN 50 AND 250 (type: boolean), ss_sales_price BETWEEN 100 AND 150 (type: boolean), ss_sales_price BETWEEN 50 AND 100 (type: boolean), ss_sales_price BETWEEN 150 AND 200 (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                      Statistics: Num rows: 25001775326 Data size: 6952026465196 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col6 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col7, _col8, _col9, _col10, _col11, _col12
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 5024931601 Data size: 1238403394488 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col7, _col8, _col9, _col10, _col11, _col12, _col15, _col16, _col17
                          input vertices:
                            1 Map 4
                          Statistics: Num rows: 426645143 Data size: 15359225392 Basic stats: COMPLETE Column stats: COMPLETE
                          Filter Operator
                            predicate: ((_col15 and _col7) or (_col16 and _col8) or (_col17 and _col9)) (type: boolean)
                            Statistics: Num rows: 319983855 Data size: 11519419024 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col1 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col0, _col3, _col4, _col5, _col10, _col11, _col12, _col19, _col20
                              input vertices:
                                1 Map 5
                              Statistics: Num rows: 63996772 Data size: 1279935676 Basic stats: COMPLETE Column stats: COMPLETE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col0 (type: bigint)
                                  1 _col0 (type: bigint)
                                outputColumnNames: _col3, _col4, _col5, _col10, _col11, _col12, _col19, _col20, _col22, _col23, _col24, _col25, _col26, _col27
                                input vertices:
                                  1 Map 6
                                Statistics: Num rows: 16456314 Data size: 724078044 Basic stats: COMPLETE Column stats: COMPLETE
                                Filter Operator
                                  predicate: ((_col22 and _col23 and _col10 and _col19) or (_col24 and _col25 and _col11 and _col20) or (_col26 and _col27 and _col12 and _col20)) (type: boolean)
                                  Statistics: Num rows: 3085557 Data size: 135764736 Basic stats: COMPLETE Column stats: COMPLETE
                                  Select Operator
                                    expressions: _col3 (type: int), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2))
                                    outputColumnNames: _col3, _col4, _col5
                                    Statistics: Num rows: 3085557 Data size: 135764736 Basic stats: COMPLETE Column stats: COMPLETE
                                    Group By Operator
                                      aggregations: sum(_col3), count(_col3), sum(_col4), count(_col4), sum(_col5), count(_col5)
                                      minReductionHashAggr: 0.99
                                      mode: hash
                                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                                      Statistics: Num rows: 1 Data size: 256 Basic stats: COMPLETE Column stats: COMPLETE
                                      Reduce Output Operator
                                        null sort order: 
                                        sort order: 
                                        Statistics: Num rows: 1 Data size: 256 Basic stats: COMPLETE Column stats: COMPLETE
                                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: decimal(17,2)), _col3 (type: bigint), _col4 (type: decimal(17,2)), _col5 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2001) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: ((ca_state) IN (&apos;TX&apos;, &apos;OK&apos;, &apos;MI&apos;, &apos;WA&apos;, &apos;NC&apos;, &apos;OH&apos;, &apos;MT&apos;, &apos;FL&apos;, &apos;GA&apos;) and (ca_country = &apos;United States&apos;)) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 6207500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ca_state) IN (&apos;TX&apos;, &apos;OK&apos;, &apos;MI&apos;, &apos;WA&apos;, &apos;NC&apos;, &apos;OH&apos;, &apos;MT&apos;, &apos;FL&apos;, &apos;GA&apos;) and (ca_country = &apos;United States&apos;)) (type: boolean)
                    Statistics: Num rows: 2759434 Data size: 527051894 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), (ca_state) IN (&apos;TX&apos;, &apos;OK&apos;, &apos;MI&apos;) (type: boolean), (ca_state) IN (&apos;WA&apos;, &apos;NC&apos;, &apos;OH&apos;) (type: boolean), (ca_state) IN (&apos;MT&apos;, &apos;FL&apos;, &apos;GA&apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2759434 Data size: 55188680 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2759434 Data size: 55188680 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: (hd_dep_count) IN (3, 1) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 86400 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (hd_dep_count) IN (3, 1) (type: boolean)
                    Statistics: Num rows: 1440 Data size: 17280 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint), (hd_dep_count = 3) (type: boolean), (hd_dep_count = 1) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1440 Data size: 23040 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1440 Data size: 23040 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  filterExpr: ((cd_marital_status) IN (&apos;U&apos;, &apos;W&apos;, &apos;D&apos;) and (cd_education_status) IN (&apos;Secondary           &apos;, &apos;College             &apos;, &apos;Primary             &apos;)) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 359189600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_marital_status) IN (&apos;U&apos;, &apos;W&apos;, &apos;D&apos;) and (cd_education_status) IN (&apos;Secondary           &apos;, &apos;College             &apos;, &apos;Primary             &apos;)) (type: boolean)
                    Statistics: Num rows: 493920 Data size: 92363040 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint), (cd_marital_status = &apos;U&apos;) (type: boolean), (cd_education_status = &apos;Secondary           &apos;) (type: boolean), (cd_marital_status = &apos;W&apos;) (type: boolean), (cd_education_status = &apos;College             &apos;) (type: boolean), (cd_marital_status = &apos;D&apos;) (type: boolean), (cd_education_status = &apos;Primary             &apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 493920 Data size: 15805440 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 493920 Data size: 15805440 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), count(VALUE._col3), sum(VALUE._col4), count(VALUE._col5)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1 Data size: 256 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (UDFToDouble(_col0) / _col1) (type: double), (_col2 / _col3) (type: decimal(37,22)), (_col4 / _col5) (type: decimal(37,22)), CAST( _col4 AS decimal(17,2)) (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 1 Data size: 344 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 344 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query13
explain select avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and  ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = &apos;U&apos; and cd_education_status = &apos;Secondary&apos; and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = &apos;W&apos; and cd_education_status = &apos;College&apos; and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = &apos;D&apos; and cd_education_status = &apos;Primary&apos; and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = &apos;United States&apos; and ca_state in (&apos;TX&apos;, &apos;OK&apos;, &apos;MI&apos;) and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = &apos;United States&apos; and ca_state in (&apos;WA&apos;, &apos;NC&apos;, &apos;OH&apos;) and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = &apos;United States&apos; and ca_state in (&apos;MT&apos;, &apos;FL&apos;, &apos;GA&apos;) and ss_net_profit between 50 and 250 ))

</samplerData>
</sample>
<sample t="9340" lt="9323" ts="1600984651622" s="true" lb="query14a" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="111458" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215722_5558bf85-741e-4923-8199-49d39fda6133:218
      Edges:
        Map 1 &lt;- Map 26 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Reducer 11 (BROADCAST_EDGE)
        Map 18 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Map 22 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Map 27 &lt;- Map 6 (BROADCAST_EDGE), Union 28 (CONTAINS)
        Map 30 &lt;- Map 31 (BROADCAST_EDGE), Union 28 (CONTAINS)
        Map 32 &lt;- Map 33 (BROADCAST_EDGE), Union 28 (CONTAINS)
        Map 34 &lt;- Map 26 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Reducer 14 (BROADCAST_EDGE)
        Map 36 &lt;- Map 6 (BROADCAST_EDGE), Union 37 (CONTAINS)
        Map 39 &lt;- Map 31 (BROADCAST_EDGE), Union 37 (CONTAINS)
        Map 40 &lt;- Map 33 (BROADCAST_EDGE), Union 37 (CONTAINS)
        Map 41 &lt;- Map 26 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Reducer 17 (BROADCAST_EDGE)
        Map 43 &lt;- Map 6 (BROADCAST_EDGE), Union 44 (CONTAINS)
        Map 46 &lt;- Map 31 (BROADCAST_EDGE), Union 44 (CONTAINS)
        Map 47 &lt;- Map 33 (BROADCAST_EDGE), Union 44 (CONTAINS)
        Map 8 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 11 &lt;- Union 10 (SIMPLE_EDGE)
        Reducer 12 &lt;- Map 8 (SIMPLE_EDGE), Union 13 (CONTAINS)
        Reducer 14 &lt;- Union 13 (SIMPLE_EDGE)
        Reducer 15 &lt;- Map 8 (SIMPLE_EDGE), Union 16 (CONTAINS)
        Reducer 17 &lt;- Union 16 (SIMPLE_EDGE)
        Reducer 19 &lt;- Map 18 (SIMPLE_EDGE), Union 10 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Reducer 29 (BROADCAST_EDGE), Union 3 (CONTAINS)
        Reducer 20 &lt;- Map 18 (SIMPLE_EDGE), Union 13 (CONTAINS)
        Reducer 21 &lt;- Map 18 (SIMPLE_EDGE), Union 16 (CONTAINS)
        Reducer 23 &lt;- Map 22 (SIMPLE_EDGE), Union 10 (CONTAINS)
        Reducer 24 &lt;- Map 22 (SIMPLE_EDGE), Union 13 (CONTAINS)
        Reducer 25 &lt;- Map 22 (SIMPLE_EDGE), Union 16 (CONTAINS)
        Reducer 29 &lt;- Union 28 (CUSTOM_SIMPLE_EDGE)
        Reducer 35 &lt;- Map 34 (SIMPLE_EDGE), Reducer 38 (BROADCAST_EDGE), Union 3 (CONTAINS)
        Reducer 38 &lt;- Union 37 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE)
        Reducer 42 &lt;- Map 41 (SIMPLE_EDGE), Reducer 45 (BROADCAST_EDGE), Union 3 (CONTAINS)
        Reducer 45 &lt;- Union 44 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
        Reducer 9 &lt;- Map 8 (SIMPLE_EDGE), Union 10 (CONTAINS)
      DagName: zabetak_20200924215722_5558bf85-741e-4923-8199-49d39fda6133:218
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_993_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.313632571697932E-7
                  Statistics: Num rows: 27503885621 Data size: 3555333258648 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_quantity (type: int), ss_list_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 27503885621 Data size: 3555333258648 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 466927013 Data size: 3735416220 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col6, _col7, _col8
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 463461078 Data size: 9269209812 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col6 (type: int), _col7 (type: int), _col8 (type: int)
                            1 _col0 (type: int), _col1 (type: int), _col2 (type: int)
                          outputColumnNames: _col0, _col1, _col2
                          input vertices:
                            1 Reducer 11
                          Statistics: Num rows: 481768 Data size: 3854260 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col2, _col13, _col14, _col15
                            input vertices:
                              1 Map 26
                            Statistics: Num rows: 481768 Data size: 5769380 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: _col13 (type: int), _col14 (type: int), _col15 (type: int), (CAST( _col1 AS decimal(10,0)) * _col2) (type: decimal(18,2))
                              outputColumnNames: _col0, _col1, _col2, _col3
                              Statistics: Num rows: 481768 Data size: 5769380 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col3), count()
                                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                minReductionHashAggr: 0.9849928
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                                Statistics: Num rows: 180081 Data size: 23766232 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                  null sort order: aaa
                                  sort order: +++
                                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                  Statistics: Num rows: 180081 Data size: 23766232 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col3 (type: decimal(28,2)), _col4 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 18 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  Statistics: Num rows: 14327953968 Data size: 229247263488 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_item_sk (type: bigint), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 14327953968 Data size: 229247263488 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 8577956114 Data size: 68623648912 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col6
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 8514283109 Data size: 102171385444 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col4 (type: int), _col5 (type: int), _col6 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 72032400 Data size: 1440647916 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 72032400 Data size: 1440647916 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 72032400 Data size: 1440647916 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 72032400 Data size: 1440647916 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 22 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  Statistics: Num rows: 7198162681 Data size: 115170602896 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_item_sk (type: bigint), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 7198162681 Data size: 115170602896 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 4340124944 Data size: 34720999552 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col6
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 4307908785 Data size: 51694893556 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col4 (type: int), _col5 (type: int), _col6 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 36376362 Data size: 727527156 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 36376362 Data size: 727527156 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 36376362 Data size: 727527156 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 36376362 Data size: 727527156 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 26 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 8028048 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 402000 Data size: 8028048 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 8028048 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 8028048 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 8028048 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 27 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_quantity (type: int), ss_list_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 16583440152 Data size: 1848499414308 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 30 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 31
                      Statistics: Num rows: 8577956114 Data size: 990867940296 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 31 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_year BETWEEN 2000 AND 2002 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_year BETWEEN 2000 AND 2002 (type: boolean)
                    Statistics: Num rows: 1101 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 30
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 39
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 46
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 32 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_quantity (type: int), ws_list_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 33
                      Statistics: Num rows: 4340124944 Data size: 503349948808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 33 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_year BETWEEN 2000 AND 2002 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_year BETWEEN 2000 AND 2002 (type: boolean)
                    Statistics: Num rows: 1101 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 32
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 40
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 47
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 34 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_1003_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:2.5048935863527054E-7
                  Statistics: Num rows: 14327953968 Data size: 1887114954848 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_item_sk (type: bigint), cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 14327953968 Data size: 1887114954848 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 241522832 Data size: 25773862240 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col6, _col7, _col8
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 239730041 Data size: 28428304784 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col6 (type: int), _col7 (type: int), _col8 (type: int)
                            1 _col0 (type: int), _col1 (type: int), _col2 (type: int)
                          outputColumnNames: _col0, _col1, _col2
                          input vertices:
                            1 Reducer 14
                          Statistics: Num rows: 249199 Data size: 1993708 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col2, _col13, _col14, _col15
                            input vertices:
                              1 Map 26
                            Statistics: Num rows: 249199 Data size: 2978552 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: _col13 (type: int), _col14 (type: int), _col15 (type: int), (CAST( _col1 AS decimal(10,0)) * _col2) (type: decimal(18,2))
                              outputColumnNames: _col0, _col1, _col2, _col3
                              Statistics: Num rows: 249199 Data size: 2978552 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col3), count()
                                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                minReductionHashAggr: 0.98662114
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                                Statistics: Num rows: 52624 Data size: 6943852 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                  null sort order: aaa
                                  sort order: +++
                                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                  Statistics: Num rows: 52624 Data size: 6943852 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col3 (type: decimal(28,2)), _col4 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 36 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_quantity (type: int), ss_list_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 16583440152 Data size: 1848499414308 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 39 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 31
                      Statistics: Num rows: 8577956114 Data size: 990867940296 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 40 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_quantity (type: int), ws_list_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 33
                      Statistics: Num rows: 4340124944 Data size: 503349948808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 41 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_1013_container, bigKeyColName:ws_item_sk, smallTablePos:1, keyRatio:5.019336405853592E-7
                  Statistics: Num rows: 7198162681 Data size: 950052929196 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_item_sk (type: bigint), ws_quantity (type: int), ws_list_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 7198162681 Data size: 950052929196 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 122201519 Data size: 15048443660 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col6, _col7, _col8
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 121294434 Data size: 16391486464 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col6 (type: int), _col7 (type: int), _col8 (type: int)
                            1 _col0 (type: int), _col1 (type: int), _col2 (type: int)
                          outputColumnNames: _col0, _col1, _col2
                          input vertices:
                            1 Reducer 17
                          Statistics: Num rows: 126085 Data size: 1008796 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col2, _col13, _col14, _col15
                            input vertices:
                              1 Map 26
                            Statistics: Num rows: 126085 Data size: 1501184 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: _col13 (type: int), _col14 (type: int), _col15 (type: int), (CAST( _col1 AS decimal(10,0)) * _col2) (type: decimal(18,2))
                              outputColumnNames: _col0, _col1, _col2, _col3
                              Statistics: Num rows: 126085 Data size: 1501184 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col3), count()
                                keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                                Statistics: Num rows: 10605 Data size: 1398868 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                  null sort order: aaa
                                  sort order: +++
                                  Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                  Statistics: Num rows: 10605 Data size: 1398868 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col3 (type: decimal(28,2)), _col4 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 43 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_quantity (type: int), ss_list_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 16583440152 Data size: 1848499414308 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 46 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 31
                      Statistics: Num rows: 8577956114 Data size: 990867940296 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 47 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_quantity (type: int), ws_list_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 33
                      Statistics: Num rows: 4340124944 Data size: 503349948808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (((d_year = 2002) and (d_moy = 11)) or d_year BETWEEN 2000 AND 2002) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2002) and (d_moy = 11)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 34
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 41
                  Filter Operator
                    predicate: d_year BETWEEN 2000 AND 2002 (type: boolean)
                    Statistics: Num rows: 1101 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 8
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 18
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 22
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 27
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 36
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 43
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_category_id is not null and i_brand_id is not null and i_class_id is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 8028048 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_category_id is not null and i_brand_id is not null and i_class_id is not null) (type: boolean)
                    Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 27503885621 Data size: 440062169936 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 27503885621 Data size: 440062169936 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 16583440152 Data size: 132667521216 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col6
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 16460343524 Data size: 197524110424 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col4 (type: int), _col5 (type: int), _col6 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 139022532 Data size: 2780450556 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 139022532 Data size: 2780450556 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 139022532 Data size: 2780450556 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 139022532 Data size: 2780450556 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col3 = 3L) (type: boolean)
                  Statistics: Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                      null sort order: aaa
                      sort order: +++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                      Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col3 = 3L) (type: boolean)
                  Statistics: Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                      null sort order: aaa
                      sort order: +++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                      Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 17 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col3 = 3L) (type: boolean)
                  Statistics: Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                      null sort order: aaa
                      sort order: +++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                      Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 19 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 180081 Data size: 23766232 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col3 is not null (type: boolean)
                  Statistics: Num rows: 180081 Data size: 23766232 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    input vertices:
                      1 Reducer 29
                    Statistics: Num rows: 180081 Data size: 43935304 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col3 &gt; _col5) (type: boolean)
                      Statistics: Num rows: 60027 Data size: 14645108 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: &apos;store&apos; (type: string), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: decimal(28,2)), _col4 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 60027 Data size: 13264487 Basic stats: COMPLETE Column stats: COMPLETE
                        Top N Key Operator
                          sort order: ++++
                          keys: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                          null sort order: zzzz
                          Statistics: Num rows: 81103 Data size: 17949143 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 100
                          Group By Operator
                            aggregations: sum(_col4), sum(_col5)
                            keys: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), 0L (type: bigint)
                            minReductionHashAggr: 0.9108541
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                            Statistics: Num rows: 202757 Data size: 46816079 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint)
                              null sort order: zzzza
                              sort order: +++++
                              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint)
                              Statistics: Num rows: 202757 Data size: 46816079 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
                              value expressions: _col5 (type: decimal(38,2)), _col6 (type: bigint)
        Reducer 20 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 21 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 23 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 24 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 25 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 29 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col0 is not null and _col1 is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (_col0 / _col1) (type: decimal(38,12))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(38,12))
        Reducer 35 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 52624 Data size: 6943852 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col3 is not null (type: boolean)
                  Statistics: Num rows: 52624 Data size: 6943852 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    input vertices:
                      1 Reducer 38
                    Statistics: Num rows: 52624 Data size: 12837740 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col3 &gt; _col5) (type: boolean)
                      Statistics: Num rows: 17541 Data size: 4279172 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: &apos;catalog&apos; (type: string), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: decimal(28,2)), _col4 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 17541 Data size: 3910811 Basic stats: COMPLETE Column stats: COMPLETE
                        Top N Key Operator
                          sort order: ++++
                          keys: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                          null sort order: zzzz
                          Statistics: Num rows: 81103 Data size: 17949143 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 100
                          Group By Operator
                            aggregations: sum(_col4), sum(_col5)
                            keys: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), 0L (type: bigint)
                            minReductionHashAggr: 0.9108541
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                            Statistics: Num rows: 202757 Data size: 46816079 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint)
                              null sort order: zzzza
                              sort order: +++++
                              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint)
                              Statistics: Num rows: 202757 Data size: 46816079 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
                              value expressions: _col5 (type: decimal(38,2)), _col6 (type: bigint)
        Reducer 38 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col0 is not null and _col1 is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (_col0 / _col1) (type: decimal(38,12))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(38,12))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int), KEY._col4 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6
                Statistics: Num rows: 202757 Data size: 46816079 Basic stats: COMPLETE Column stats: COMPLETE
                pruneGroupingSetId: true
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col5 (type: decimal(38,2)), _col6 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 202757 Data size: 45194023 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    null sort order: zzzz
                    sort order: ++++
                    Statistics: Num rows: 202757 Data size: 45194023 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col4 (type: decimal(38,2)), _col5 (type: bigint)
        Reducer 42 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 10605 Data size: 1398868 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col3 is not null (type: boolean)
                  Statistics: Num rows: 10605 Data size: 1398868 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    input vertices:
                      1 Reducer 45
                    Statistics: Num rows: 10605 Data size: 2586628 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col3 &gt; _col5) (type: boolean)
                      Statistics: Num rows: 3535 Data size: 862220 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: &apos;web&apos; (type: string), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: decimal(28,2)), _col4 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 3535 Data size: 773845 Basic stats: COMPLETE Column stats: COMPLETE
                        Top N Key Operator
                          sort order: ++++
                          keys: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                          null sort order: zzzz
                          Statistics: Num rows: 81103 Data size: 17949143 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 100
                          Group By Operator
                            aggregations: sum(_col4), sum(_col5)
                            keys: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), 0L (type: bigint)
                            minReductionHashAggr: 0.9108541
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                            Statistics: Num rows: 202757 Data size: 46816079 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint)
                              null sort order: zzzza
                              sort order: +++++
                              Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint)
                              Statistics: Num rows: 202757 Data size: 46816079 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
                              value expressions: _col5 (type: decimal(38,2)), _col6 (type: bigint)
        Reducer 45 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col0 is not null and _col1 is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (_col0 / _col1) (type: decimal(38,12))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(38,12))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: int), KEY.reducesinkkey3 (type: int), VALUE._col0 (type: decimal(38,2)), VALUE._col1 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 202757 Data size: 45194023 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 22300 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 22300 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Union 10 
            Vertex: Union 10
        Union 13 
            Vertex: Union 13
        Union 16 
            Vertex: Union 16
        Union 28 
            Vertex: Union 28
        Union 3 
            Vertex: Union 3
        Union 37 
            Vertex: Union 37
        Union 44 
            Vertex: Union 44

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query14a
explain with  cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2) x) select  channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales) from( select &apos;store&apos; channel, i_brand_id,i_class_id ,i_category_id,sum(ss_quantity*ss_list_price) sales , count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 2000+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) &gt; (select average_sales from avg_sales) union all select &apos;catalog&apos; channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales from catalog_sales ,item ,date_dim where cs_item_sk in (select ss_item_sk from cross_items) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 2000+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(cs_quantity*cs_list_price) &gt; (select average_sales from avg_sales) union all select &apos;web&apos; channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales from web_sales ,item ,date_dim where ws_item_sk in (select ss_item_sk from cross_items) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 2000+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ws_quantity*ws_list_price) &gt; (select average_sales from avg_sales) ) y group by rollup (channel, i_brand_id,i_class_id,i_category_id) order by channel,i_brand_id,i_class_id,i_category_id limit 100

</samplerData>
</sample>
<sample t="8437" lt="8423" ts="1600984660069" s="true" lb="query14b" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="80151" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215731_8c1b97d5-d48a-47b4-94a6-9269614ee117:219
      Edges:
        Map 1 &lt;- Map 20 (BROADCAST_EDGE), Map 21 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Map 15 &lt;- Map 10 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Map 17 &lt;- Map 10 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Map 20 &lt;- Reducer 11 (BROADCAST_EDGE), Reducer 12 (BROADCAST_EDGE)
        Map 21 &lt;- Reducer 13 (BROADCAST_EDGE), Reducer 14 (BROADCAST_EDGE)
        Map 22 &lt;- Map 10 (BROADCAST_EDGE), Union 23 (CONTAINS)
        Map 25 &lt;- Map 19 (BROADCAST_EDGE), Union 23 (CONTAINS)
        Map 26 &lt;- Map 27 (BROADCAST_EDGE), Union 23 (CONTAINS)
        Map 28 &lt;- Map 10 (BROADCAST_EDGE), Union 29 (CONTAINS)
        Map 31 &lt;- Map 19 (BROADCAST_EDGE), Union 29 (CONTAINS)
        Map 32 &lt;- Map 27 (BROADCAST_EDGE), Union 29 (CONTAINS)
        Map 6 &lt;- Map 10 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 11 &lt;- Map 10 (CUSTOM_SIMPLE_EDGE), Map 19 (BROADCAST_EDGE)
        Reducer 12 &lt;- Reducer 11 (CUSTOM_SIMPLE_EDGE)
        Reducer 13 &lt;- Map 10 (CUSTOM_SIMPLE_EDGE), Map 19 (BROADCAST_EDGE)
        Reducer 14 &lt;- Reducer 13 (CUSTOM_SIMPLE_EDGE)
        Reducer 16 &lt;- Map 15 (SIMPLE_EDGE), Union 8 (CONTAINS)
        Reducer 18 &lt;- Map 17 (SIMPLE_EDGE), Union 8 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Reducer 24 (BROADCAST_EDGE), Reducer 30 (BROADCAST_EDGE), Reducer 4 (BROADCAST_EDGE)
        Reducer 24 &lt;- Union 23 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 30 &lt;- Union 29 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 7 &lt;- Map 6 (SIMPLE_EDGE), Union 8 (CONTAINS)
        Reducer 9 &lt;- Map 5 (BROADCAST_EDGE), Union 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924215731_8c1b97d5-d48a-47b4-94a6-9269614ee117:219
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_818_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:7.737234037852385E-6
                  Statistics: Num rows: 27503885621 Data size: 3555333258648 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_quantity (type: int), ss_list_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 27503885621 Data size: 3555333258648 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
                      input vertices:
                        1 Map 5
                      Statistics: Num rows: 27299728007 Data size: 3855981177820 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col7
                        input vertices:
                          1 Reducer 9
                        Statistics: Num rows: 27299728007 Data size: 3637583353764 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col5, _col6, _col7
                          input vertices:
                            1 Map 20
                          Statistics: Num rows: 27299728007 Data size: 3419185529708 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: _col5 (type: int), _col6 (type: int), _col7 (type: int), (CAST( _col1 AS decimal(10,0)) * _col2) (type: decimal(18,2))
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 27299728007 Data size: 3419185529708 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col3), count()
                              keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4
                              Statistics: Num rows: 2405341917 Data size: 317505132012 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                null sort order: aaa
                                sort order: +++
                                Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                Statistics: Num rows: 2405341917 Data size: 317505132012 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col3 (type: decimal(28,2)), _col4 (type: bigint)
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col5, _col6, _col7
                          input vertices:
                            1 Map 21
                          Statistics: Num rows: 27299728007 Data size: 3419185529708 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: _col5 (type: int), _col6 (type: int), _col7 (type: int), (CAST( _col1 AS decimal(10,0)) * _col2) (type: decimal(18,2))
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 27299728007 Data size: 3419185529708 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col3), count()
                              keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4
                              Statistics: Num rows: 2405341917 Data size: 317505132012 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                null sort order: aaa
                                sort order: +++
                                Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                Statistics: Num rows: 2405341917 Data size: 317505132012 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col3 (type: decimal(28,2)), _col4 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: d1
                  filterExpr: (d_year BETWEEN 2000 AND 2002 or (((d_year = 2000) and (d_dom = 15) and (d_moy = 12)) or ((d_year = 2001) and (d_dom = 15) and (d_moy = 12)))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_year BETWEEN 2000 AND 2002 (type: boolean)
                    Statistics: Num rows: 1101 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 6
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 15
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 17
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 22
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 28
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_dom = 15) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.0
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_dom = 15) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.0
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  Statistics: Num rows: 14327953968 Data size: 229247263488 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_item_sk (type: bigint), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 14327953968 Data size: 229247263488 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 8577956114 Data size: 68623648912 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col6
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 8514283109 Data size: 102171385444 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col4 (type: int), _col5 (type: int), _col6 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 72032400 Data size: 1440647916 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 72032400 Data size: 1440647916 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  Statistics: Num rows: 7198162681 Data size: 115170602896 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_item_sk (type: bigint), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 7198162681 Data size: 115170602896 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 4340124944 Data size: 34720999552 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col6
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 4307908785 Data size: 51694893556 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col4 (type: int), _col5 (type: int), _col6 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 36376362 Data size: 727527156 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 36376362 Data size: 727527156 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (((d_year = 2000) and (d_dom = 15) and (d_moy = 12) and d_week_seq is not null) or ((d_year = 2001) and (d_dom = 15) and (d_moy = 12) and d_week_seq is not null) or d_year BETWEEN 2000 AND 2002) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_dom = 15) and (d_moy = 12) and d_week_seq is not null) (type: boolean)
                    Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_week_seq (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        null sort order: 
                        sort order: 
                        Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: int)
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_dom = 15) and (d_moy = 12) and d_week_seq is not null) (type: boolean)
                    Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_week_seq (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        null sort order: 
                        sort order: 
                        Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: int)
                  Filter Operator
                    predicate: d_year BETWEEN 2000 AND 2002 (type: boolean)
                    Statistics: Num rows: 1101 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 25
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 31
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_99_date_dim_d_week_seq_min) AND DynamicValue(RS_99_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_99_date_dim_d_week_seq_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_827_container, bigKeyColName:d_week_seq, smallTablePos:0, keyRatio:8.213664800339498E-5
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_99_date_dim_d_week_seq_min) AND DynamicValue(RS_99_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_99_date_dim_d_week_seq_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_week_seq (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: int)
                          1 _col1 (type: int)
                        outputColumnNames: _col2
                        input vertices:
                          0 Reducer 11
                        Statistics: Num rows: 6 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col2 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 6 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 6 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: _col0 (type: bigint)
                            outputColumnNames: _col0
                            Statistics: Num rows: 6 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              keys: _col0 (type: bigint)
                              minReductionHashAggr: 0.5
                              mode: hash
                              outputColumnNames: _col0
                              Statistics: Num rows: 3 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              Dynamic Partitioning Event Operator
                                Target column: ss_sold_date_sk (bigint)
                                Target Input: store_sales
                                Partition key expr: ss_sold_date_sk
                                Statistics: Num rows: 3 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_218_date_dim_d_week_seq_min) AND DynamicValue(RS_218_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_218_date_dim_d_week_seq_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_837_container, bigKeyColName:d_week_seq, smallTablePos:0, keyRatio:8.213664800339498E-5
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_218_date_dim_d_week_seq_min) AND DynamicValue(RS_218_date_dim_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_218_date_dim_d_week_seq_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_week_seq (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: int)
                          1 _col1 (type: int)
                        outputColumnNames: _col2
                        input vertices:
                          0 Reducer 13
                        Statistics: Num rows: 6 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col2 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 6 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 6 Data size: 48 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 22 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_quantity (type: int), ss_list_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 16583440152 Data size: 1848499414308 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 25 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 19
                      Statistics: Num rows: 8577956114 Data size: 990867940296 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 26 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_quantity (type: int), ws_list_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 27
                      Statistics: Num rows: 4340124944 Data size: 503349948808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 27 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_year BETWEEN 2000 AND 2002 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_year BETWEEN 2000 AND 2002 (type: boolean)
                    Statistics: Num rows: 1101 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 26
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 32
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 28 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_quantity (type: int), ss_list_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3335302173680 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 16583440152 Data size: 1848499414308 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 31 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 14327953968 Data size: 1772491323104 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 19
                      Statistics: Num rows: 8577956114 Data size: 990867940296 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 32 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_quantity (type: int), ws_list_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7198162681 Data size: 892467627748 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 27
                      Statistics: Num rows: 4340124944 Data size: 503349948808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: (CAST( _col0 AS decimal(10,0)) * _col1) (type: decimal(18,2))
                        outputColumnNames: _col0
                        Statistics: Num rows: 29501521210 Data size: 3342717303412 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col0), count(_col0)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: decimal(28,2)), _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_category_id is not null and i_brand_id is not null and i_class_id is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 8028048 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_category_id is not null and i_brand_id is not null and i_class_id is not null) (type: boolean)
                    Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Reduce Output Operator
                        key expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                        null sort order: aaa
                        sort order: +++
                        Map-reduce partition columns: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 399016 Data size: 7968456 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 27503885621 Data size: 440062169936 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 27503885621 Data size: 440062169936 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 16583440152 Data size: 132667521216 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col6
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 16460343524 Data size: 197524110424 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col4 (type: int), _col5 (type: int), _col6 (type: int)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 139022532 Data size: 2780450556 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                            Statistics: Num rows: 139022532 Data size: 2780450556 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (sq_count_check(_col0) &lt;= 1) (type: boolean)
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 
                        1 
                      outputColumnNames: _col1
                      input vertices:
                        1 Map 19
                      Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: int)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: int)
                        Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col1 (type: int)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.0
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
        Reducer 13 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (sq_count_check(_col0) &lt;= 1) (type: boolean)
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 
                        1 
                      outputColumnNames: _col1
                      input vertices:
                        1 Map 19
                      Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: int)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: int)
                        Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col1 (type: int)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.0
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
        Reducer 16 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 18 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 180081 Data size: 23770692 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col3 is not null (type: boolean)
                  Statistics: Num rows: 180081 Data size: 23770692 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: int), _col1 (type: int), _col2 (type: int)
                      1 _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col8, _col9
                    input vertices:
                      1 Reducer 4
                    Statistics: Num rows: 33710152 Data size: 8494958304 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 
                        1 
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col8, _col9, _col10
                      input vertices:
                        1 Reducer 24
                      Statistics: Num rows: 33710152 Data size: 12270495328 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: (_col8 &gt; _col10) (type: boolean)
                        Statistics: Num rows: 11236717 Data size: 4090164988 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 
                            1 
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col8, _col9, _col11
                          input vertices:
                            1 Reducer 30
                          Statistics: Num rows: 11236717 Data size: 4090164988 Basic stats: COMPLETE Column stats: COMPLETE
                          Filter Operator
                            predicate: (_col3 &gt; _col11) (type: boolean)
                            Statistics: Num rows: 3745572 Data size: 1363388208 Basic stats: COMPLETE Column stats: COMPLETE
                            Top N Key Operator
                              sort order: +++
                              keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                              null sort order: zzz
                              Statistics: Num rows: 3745572 Data size: 1363388208 Basic stats: COMPLETE Column stats: COMPLETE
                              top n: 100
                              Select Operator
                                expressions: _col8 (type: decimal(28,2)), _col9 (type: bigint), _col3 (type: decimal(28,2)), _col4 (type: bigint), _col0 (type: int), _col1 (type: int), _col2 (type: int)
                                outputColumnNames: _col3, _col4, _col8, _col9, _col10, _col11, _col12
                                Statistics: Num rows: 3745572 Data size: 1033777872 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col10 (type: int), _col11 (type: int), _col12 (type: int)
                                  null sort order: zzz
                                  sort order: +++
                                  Statistics: Num rows: 3745572 Data size: 1033777872 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col3 (type: decimal(28,2)), _col4 (type: bigint), _col8 (type: decimal(28,2)), _col9 (type: bigint)
        Reducer 24 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col0 is not null and _col1 is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (_col0 / _col1) (type: decimal(38,12))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(38,12))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: &apos;store&apos; (type: string), KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: decimal(28,2)), VALUE._col1 (type: bigint), &apos;store&apos; (type: string), KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: int), VALUE._col2 (type: decimal(28,2)), VALUE._col3 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                Statistics: Num rows: 3745572 Data size: 1655542824 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 44200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 44200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 30 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col0 is not null and _col1 is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (_col0 / _col1) (type: decimal(38,12))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(38,12))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 180081 Data size: 23770692 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col3 is not null (type: boolean)
                  Statistics: Num rows: 180081 Data size: 23770692 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 180081 Data size: 23770692 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: decimal(28,2)), _col4 (type: bigint)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 180081 Data size: 3601620 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col3)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                  minReductionHashAggr: 0.9873353
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    null sort order: aaa
                    sort order: +++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col3 (type: bigint)
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 153920 Data size: 3078400 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col3 = 3L) (type: boolean)
                  Statistics: Num rows: 1 Data size: 20 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: int), _col2 (type: int), _col3 (type: int)
                        1 _col0 (type: int), _col1 (type: int), _col2 (type: int)
                      outputColumnNames: _col0
                      input vertices:
                        0 Map 5
                      Statistics: Num rows: 414 Data size: 3312 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 414 Data size: 3312 Basic stats: COMPLETE Column stats: COMPLETE
        Union 23 
            Vertex: Union 23
        Union 29 
            Vertex: Union 29
        Union 8 
            Vertex: Union 8

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query14b
explain with  cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 2000 AND 2000 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 2000 AND 2000 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 2000 AND 2000 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 2000 and 2000 + 2) x) select  this_year.channel ty_channel ,this_year.i_brand_id ty_brand ,this_year.i_class_id ty_class ,this_year.i_category_id ty_category ,this_year.sales ty_sales ,this_year.number_sales ty_number_sales ,last_year.channel ly_channel ,last_year.i_brand_id ly_brand ,last_year.i_class_id ly_class ,last_year.i_category_id ly_category ,last_year.sales ly_sales ,last_year.number_sales ly_number_sales from (select &apos;store&apos; channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 2000 + 1 and d_moy = 12 and d_dom = 15) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) &gt; (select average_sales from avg_sales)) this_year, (select &apos;store&apos; channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 2000 and d_moy = 12 and d_dom = 15) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) &gt; (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id limit 100

</samplerData>
</sample>
<sample t="2383" lt="2376" ts="1600984662456" s="true" lb="query15" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="10262" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215740_de07834c-d3e7-4d7c-9247-dccd361c3e2c:220
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924215740_de07834c-d3e7-4d7c-9247-dccd361c3e2c:220
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_52_container, bigKeyColName:cs_bill_customer_sk, smallTablePos:1, keyRatio:0.04990078461982954
                  Statistics: Num rows: 14327953968 Data size: 1829659112624 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 1825061121680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint), (cs_sales_price &gt; 500) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291947369 Data size: 1882228911156 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col3
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 714976145 Data size: 84348900428 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col3, _col6, _col7, _col8
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 714976145 Data size: 148269106229 Basic stats: COMPLETE Column stats: COMPLETE
                          Filter Operator
                            predicate: (_col3 or _col7 or _col8) (type: boolean)
                            Statistics: Num rows: 714976145 Data size: 148269106229 Basic stats: COMPLETE Column stats: COMPLETE
                            Top N Key Operator
                              sort order: +
                              keys: _col6 (type: char(10))
                              null sort order: z
                              Statistics: Num rows: 714976145 Data size: 148269106229 Basic stats: COMPLETE Column stats: COMPLETE
                              top n: 100
                              Select Operator
                                expressions: _col1 (type: decimal(7,2)), _col6 (type: char(10))
                                outputColumnNames: _col1, _col6
                                Statistics: Num rows: 714976145 Data size: 148269106229 Basic stats: COMPLETE Column stats: COMPLETE
                                Group By Operator
                                  aggregations: sum(_col1)
                                  keys: _col6 (type: char(10))
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0, _col1
                                  Statistics: Num rows: 5532040 Data size: 1111940040 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: char(10))
                                    null sort order: z
                                    sort order: +
                                    Map-reduce partition columns: _col0 (type: char(10))
                                    Statistics: Num rows: 5532040 Data size: 1111940040 Basic stats: COMPLETE Column stats: COMPLETE
                                    TopN Hash Memory Usage: 0.04
                                    value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 1998) and (d_qoy = 2)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_qoy = 2)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  Statistics: Num rows: 65000000 Data size: 11895000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: c_customer_sk (type: bigint), ca_zip (type: char(10)), (ca_state) IN (&apos;CA&apos;, &apos;WA&apos;, &apos;GA&apos;) (type: boolean), (substr(ca_zip, 1, 5)) IN (&apos;85669&apos;, &apos;86197&apos;, &apos;88274&apos;, &apos;83405&apos;, &apos;86475&apos;, &apos;85392&apos;, &apos;85460&apos;, &apos;80348&apos;, &apos;81792&apos;) (type: boolean)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 65000000 Data size: 6825000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 6825000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(10)), _col2 (type: boolean), _col3 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(10))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 9538 Data size: 1917138 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: char(10))
                  null sort order: z
                  sort order: +
                  Statistics: Num rows: 9538 Data size: 1917138 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col1 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(10)), VALUE._col0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 9538 Data size: 1917138 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 20100 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 20100 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query15
explain select  ca_zip ,sum(cs_sales_price) from catalog_sales ,customer ,customer_address ,date_dim where cs_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ( substr(ca_zip,1,5) in (&apos;85669&apos;, &apos;86197&apos;,&apos;88274&apos;,&apos;83405&apos;,&apos;86475&apos;, &apos;85392&apos;, &apos;85460&apos;, &apos;80348&apos;, &apos;81792&apos;) or ca_state in (&apos;CA&apos;,&apos;WA&apos;,&apos;GA&apos;) or cs_sales_price &gt; 500) and cs_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1998 group by ca_zip order by ca_zip limit 100

</samplerData>
</sample>
<sample t="5890" lt="5882" ts="1600984668347" s="true" lb="query16" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="22214" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215742_2217a826-91ac-4c27-ad19-44742e3b58c8:221
      Edges:
        Map 1 &lt;- Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Map 10 &lt;- Reducer 6 (BROADCAST_EDGE)
        Map 11 &lt;- Reducer 6 (BROADCAST_EDGE)
        Reducer 12 &lt;- Map 11 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 10 (CUSTOM_SIMPLE_EDGE), Reducer 12 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
        Reducer 6 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215742_2217a826-91ac-4c27-ad19-44742e3b58c8:221
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: cs1
                  filterExpr: (cs_ship_date_sk is not null and cs_ship_addr_sk is not null and cs_call_center_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_127_container, bigKeyColName:cs_call_center_sk, smallTablePos:1, keyRatio:6.250015316877815E-10
                  Statistics: Num rows: 14399964710 Data size: 3791220945224 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_ship_date_sk is not null and cs_ship_addr_sk is not null and cs_call_center_sk is not null) (type: boolean)
                    Statistics: Num rows: 14185077093 Data size: 3734645359736 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_ship_date_sk (type: bigint), cs_ship_addr_sk (type: bigint), cs_call_center_sk (type: bigint), cs_warehouse_sk (type: bigint), cs_order_number (type: bigint), cs_ext_ship_cost (type: decimal(7,2)), cs_net_profit (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 14185077093 Data size: 3734645359736 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 267643153 Data size: 58868955984 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col3, _col4, _col5, _col6
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 59476257 Data size: 7137150968 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col3, _col4, _col5, _col6
                            input vertices:
                              1 Map 9
                            Statistics: Num rows: 6608021 Data size: 792962640 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col4 (type: bigint)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col4 (type: bigint)
                              Statistics: Num rows: 6608021 Data size: 792962640 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col3 (type: bigint), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
                            Select Operator
                              expressions: _col4 (type: bigint)
                              outputColumnNames: _col0
                              Statistics: Num rows: 6608021 Data size: 105728336 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2
                                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  null sort order: 
                                  sort order: 
                                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: cs2
                  filterExpr: (cs_warehouse_sk is not null and cs_order_number BETWEEN DynamicValue(RS_33_cs1_cs_order_number_min) AND DynamicValue(RS_33_cs1_cs_order_number_max) and in_bloom_filter(cs_order_number, DynamicValue(RS_33_cs1_cs_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14399964710 Data size: 229823404448 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_warehouse_sk is not null and cs_order_number BETWEEN DynamicValue(RS_33_cs1_cs_order_number_min) AND DynamicValue(RS_33_cs1_cs_order_number_max) and in_bloom_filter(cs_order_number, DynamicValue(RS_33_cs1_cs_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14327960845 Data size: 228674222928 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_order_number (type: bigint), cs_warehouse_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 14327960845 Data size: 228674222928 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint), _col1 (type: bigint)
                        minReductionHashAggr: 0.975622
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 14327960845 Data size: 228674222928 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 14327960845 Data size: 228674222928 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: cr1
                  filterExpr: (cr_order_number BETWEEN DynamicValue(RS_33_cs1_cs_order_number_min) AND DynamicValue(RS_33_cs1_cs_order_number_max) and in_bloom_filter(cr_order_number, DynamicValue(RS_33_cs1_cs_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 11520264896 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_order_number BETWEEN DynamicValue(RS_33_cs1_cs_order_number_min) AND DynamicValue(RS_33_cs1_cs_order_number_max) and in_bloom_filter(cr_order_number, DynamicValue(RS_33_cs1_cs_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 1440033112 Data size: 11520264896 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: cr_order_number (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 54372000 Data size: 434976000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 54372000 Data size: 434976000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_state = &apos;IL&apos;) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_state = &apos;IL&apos;) (type: boolean)
                    Statistics: Num rows: 613208 Data size: 57641552 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 613208 Data size: 57641552 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 613208 Data size: 57641552 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: call_center
                  filterExpr: (cc_county) IN (&apos;Richland County&apos;, &apos;Bronx County&apos;, &apos;Maverick County&apos;, &apos;Mesa County&apos;, &apos;Raleigh County&apos;) (type: boolean)
                  Statistics: Num rows: 54 Data size: 5724 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cc_county) IN (&apos;Richland County&apos;, &apos;Bronx County&apos;, &apos;Maverick County&apos;, &apos;Mesa County&apos;, &apos;Raleigh County&apos;) (type: boolean)
                    Statistics: Num rows: 12 Data size: 1272 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cc_call_center_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 12 Data size: 1272 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 12 Data size: 1272 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;1999-04-01 00:00:00&apos; AND TIMESTAMP&apos;1999-05-31 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;1999-04-01 00:00:00&apos; AND TIMESTAMP&apos;1999-05-31 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1182000 Data size: 9456000 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: true (type: boolean), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1182000 Data size: 14184000 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 1182000 Data size: 14184000 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Semi Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col3, _col4, _col5, _col6, _col14
                input vertices:
                  1 Map 10
                residual filter predicates: {(_col3 &lt;&gt; _col14)}
                Statistics: Num rows: 6608021 Data size: 792962648 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col4 (type: bigint), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
                  outputColumnNames: _col4, _col5, _col6
                  Statistics: Num rows: 6608021 Data size: 792962640 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Left Outer Join 0 to 1
                    keys:
                      0 _col4 (type: bigint)
                      1 _col1 (type: bigint)
                    outputColumnNames: _col4, _col5, _col6, _col13
                    input vertices:
                      1 Reducer 12
                    Statistics: Num rows: 13216042 Data size: 2352455592 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: _col13 is null (type: boolean)
                      Statistics: Num rows: 6608021 Data size: 1176227796 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col4 (type: bigint), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
                        outputColumnNames: _col4, _col5, _col6
                        Statistics: Num rows: 6608021 Data size: 1176227796 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col5), sum(_col6)
                          keys: _col4 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col2, _col3
                          Statistics: Num rows: 159555 Data size: 37016760 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 159555 Data size: 37016760 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 159555 Data size: 37016760 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col0), sum(_col1), sum(_col2)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: bigint), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col0 (type: bigint)
                  null sort order: z
                  Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col0 (type: bigint)
                    outputColumnNames: _col1, _col2, _col3
                    Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col3 (type: bigint)
                      null sort order: z
                      sort order: +
                      Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: decimal(17,2)), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query16
explain select count(distinct cs_order_number) as `order count` ,sum(cs_ext_ship_cost) as `total shipping cost` ,sum(cs_net_profit) as `total net profit` from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between &apos;1999-4-01&apos; and (cast(&apos;1999-4-01&apos; as date) + 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = &apos;IL&apos; and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in (&apos;Richland County&apos;,&apos;Bronx County&apos;,&apos;Maverick County&apos;,&apos;Mesa County&apos;, &apos;Raleigh County&apos; ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk &lt;&gt; cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) limit 100

</samplerData>
</sample>
<sample t="8462" lt="8454" ts="1600984676811" s="true" lb="query17" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="28983" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215748_5dd753be-72a2-4e21-8ded-474ee5c4cfc6:222
      Edges:
        Map 1 &lt;- Map 2 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Map 3 &lt;- Map 2 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Map 8 &lt;- Map 2 (BROADCAST_EDGE)
        Reducer 4 &lt;- Map 3 (CUSTOM_SIMPLE_EDGE), Map 8 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
        Reducer 9 &lt;- Map 8 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215748_5dd753be-72a2-4e21-8ded-474ee5c4cfc6:222
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_bill_customer_sk is not null and cs_bill_customer_sk BETWEEN DynamicValue(RS_26_store_returns_sr_customer_sk_min) AND DynamicValue(RS_26_store_returns_sr_customer_sk_max) and in_bloom_filter(cs_bill_customer_sk, DynamicValue(RS_26_store_returns_sr_customer_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 400750696400 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_bill_customer_sk is not null and cs_bill_customer_sk BETWEEN DynamicValue(RS_26_store_returns_sr_customer_sk_min) AND DynamicValue(RS_26_store_returns_sr_customer_sk_max) and in_bloom_filter(cs_bill_customer_sk, DynamicValue(RS_26_store_returns_sr_customer_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 399743597296 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_item_sk (type: bigint), cs_quantity (type: int), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291947369 Data size: 399743597296 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 2129385594 Data size: 42156782844 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 2129385594 Data size: 42156782844 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 141000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_state (type: char(2))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1500 Data size: 141000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 141000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_id (type: char(16)), i_item_desc (type: varchar(200))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16)), _col2 (type: varchar(200))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: d3
                  filterExpr: ((d_quarter_name) IN (&apos;2000Q1&apos;, &apos;2000Q2&apos;, &apos;2000Q3&apos;) or (d_quarter_name = &apos;2000Q1&apos;) or (d_quarter_name) IN (&apos;2000Q1&apos;, &apos;2000Q2&apos;, &apos;2000Q3&apos;)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 7158802 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_quarter_name) IN (&apos;2000Q1&apos;, &apos;2000Q2&apos;, &apos;2000Q3&apos;) (type: boolean)
                    Statistics: Num rows: 274 Data size: 26852 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 274 Data size: 2192 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 274 Data size: 2192 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 274 Data size: 2192 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 137 Data size: 1096 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 137 Data size: 1096 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: (d_quarter_name = &apos;2000Q1&apos;) (type: boolean)
                    Statistics: Num rows: 91 Data size: 8918 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 91 Data size: 728 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 91 Data size: 728 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 91 Data size: 728 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5054945
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 45 Data size: 360 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 45 Data size: 360 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 3
                  Filter Operator
                    predicate: (d_quarter_name) IN (&apos;2000Q1&apos;, &apos;2000Q2&apos;, &apos;2000Q3&apos;) (type: boolean)
                    Statistics: Num rows: 274 Data size: 26852 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 274 Data size: 2192 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 274 Data size: 2192 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 274 Data size: 2192 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 137 Data size: 1096 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: sr_returned_date_sk (bigint)
                            Target Input: store_returns
                            Partition key expr: sr_returned_date_sk
                            Statistics: Num rows: 137 Data size: 1096 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 8
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_customer_sk is not null and ss_store_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_26_store_returns_sr_customer_sk_min) AND DynamicValue(RS_26_store_returns_sr_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_26_store_returns_sr_customer_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 1197211838144 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_customer_sk is not null and ss_store_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_26_store_returns_sr_customer_sk_min) AND DynamicValue(RS_26_store_returns_sr_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_26_store_returns_sr_customer_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26223309636 Data size: 1141469869532 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 26223309636 Data size: 1141469869532 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col5 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 1306839221 Data size: 34690457504 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint), _col0 (type: bigint), _col3 (type: bigint)
                          null sort order: aaa
                          sort order: +++
                          Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint), _col3 (type: bigint)
                          Statistics: Num rows: 1306839221 Data size: 34690457504 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: bigint), _col4 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: sr_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 2778787720 Data size: 99431808020 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: sr_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 2728449035 Data size: 97630566984 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_customer_sk (type: bigint), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 2728449035 Data size: 97630566984 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 373418974 Data size: 9862132996 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint)
                          null sort order: aaa
                          sort order: +++
                          Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint)
                          Statistics: Num rows: 373418974 Data size: 9862132996 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col3 (type: int)
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 373418974 Data size: 5183875072 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: bigint)
                outputColumnNames: _col0, _col2, _col4, _col7, _col8, _col10
                input vertices:
                  1 Map 8
                Statistics: Num rows: 1457621504427 Data size: 58296854522280 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Reduce Output Operator
                  key expressions: _col8 (type: bigint), _col7 (type: bigint)
                  null sort order: aa
                  sort order: ++
                  Map-reduce partition columns: _col8 (type: bigint), _col7 (type: bigint)
                  Statistics: Num rows: 1457621504427 Data size: 58296854522280 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col2 (type: bigint), _col4 (type: int), _col10 (type: int)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col5, _col7, _col9, _col15
                input vertices:
                  0 Map 1
                Statistics: Num rows: 11003280002805772 Data size: 308091832324720944 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2, _col5, _col9, _col15, _col19
                  input vertices:
                    1 Map 10
                  Statistics: Num rows: 11003280002805772 Data size: 1166347677483915056 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col5 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2, _col9, _col15, _col19, _col21, _col22
                    input vertices:
                      1 Map 11
                    Statistics: Num rows: 11003280002805772 Data size: 4203252958258308176 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: +++
                      keys: _col21 (type: char(16)), _col22 (type: varchar(200)), _col19 (type: char(2))
                      null sort order: zzz
                      Statistics: Num rows: 11003280002805772 Data size: 4203252958258308176 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Select Operator
                        expressions: _col21 (type: char(16)), _col22 (type: varchar(200)), _col19 (type: char(2)), _col9 (type: int), _col15 (type: int), _col2 (type: int), UDFToDouble(_col9) (type: double), (UDFToDouble(_col9) * UDFToDouble(_col9)) (type: double), UDFToDouble(_col15) (type: double), (UDFToDouble(_col15) * UDFToDouble(_col15)) (type: double), UDFToDouble(_col2) (type: double), (UDFToDouble(_col2) * UDFToDouble(_col2)) (type: double)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                        Statistics: Num rows: 11003280002805772 Data size: 4203252958258308176 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count(_col3), sum(_col3), sum(_col7), sum(_col6), count(_col4), sum(_col4), sum(_col9), sum(_col8), count(_col5), sum(_col5), sum(_col11), sum(_col10)
                          keys: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(2))
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                          Statistics: Num rows: 11003280002805772 Data size: 5127528481307489792 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(2))
                            null sort order: zzz
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(2))
                            Statistics: Num rows: 11003280002805772 Data size: 5127528481307489792 Basic stats: COMPLETE Column stats: COMPLETE
                            TopN Hash Memory Usage: 0.04
                            value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: double), _col14 (type: double)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), count(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11)
                keys: KEY._col0 (type: char(16)), KEY._col1 (type: varchar(200)), KEY._col2 (type: char(2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                Statistics: Num rows: 2248803355968 Data size: 1047942363881088 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(2)), _col3 (type: bigint), (UDFToDouble(_col4) / _col3) (type: double), power(((_col5 - ((_col6 * _col6) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) (type: double), (power(((_col5 - ((_col6 * _col6) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col4) / _col3)) (type: double), _col7 (type: bigint), (UDFToDouble(_col8) / _col7) (type: double), power(((_col9 - ((_col10 * _col10) / _col7)) / CASE WHEN ((_col7 = 1L)) THEN (null) ELSE ((_col7 - 1)) END), 0.5) (type: double), (power(((_col9 - ((_col10 * _col10) / _col7)) / CASE WHEN ((_col7 = 1L)) THEN (null) ELSE ((_col7 - 1)) END), 0.5) / (UDFToDouble(_col8) / _col7)) (type: double), _col11 (type: bigint), (UDFToDouble(_col12) / _col11) (type: double), power(((_col13 - ((_col14 * _col14) / _col11)) / CASE WHEN ((_col11 = 1L)) THEN (null) ELSE ((_col11 - 1)) END), 0.5) (type: double), (power(((_col13 - ((_col14 * _col14) / _col11)) / CASE WHEN ((_col11 = 1L)) THEN (null) ELSE ((_col11 - 1)) END), 0.5) / (UDFToDouble(_col12) / _col11)) (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                  Statistics: Num rows: 2248803355968 Data size: 1047942363881088 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(2))
                    null sort order: zzz
                    sort order: +++
                    Statistics: Num rows: 2248803355968 Data size: 1047942363881088 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col3 (type: bigint), _col4 (type: double), _col5 (type: double), _col6 (type: double), _col7 (type: bigint), _col8 (type: double), _col9 (type: double), _col10 (type: double), _col11 (type: bigint), _col12 (type: double), _col13 (type: double), _col14 (type: double)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), KEY.reducesinkkey1 (type: varchar(200)), KEY.reducesinkkey2 (type: char(2)), VALUE._col0 (type: bigint), VALUE._col1 (type: double), VALUE._col2 (type: double), VALUE._col3 (type: double), VALUE._col4 (type: bigint), VALUE._col5 (type: double), VALUE._col6 (type: double), VALUE._col7 (type: double), VALUE._col8 (type: bigint), VALUE._col9 (type: double), VALUE._col10 (type: double), VALUE._col11 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                Statistics: Num rows: 2248803355968 Data size: 1047942363881088 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 46600 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 46600 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query17
explain select  i_item_id ,i_item_desc ,s_state ,count(ss_quantity) as store_sales_quantitycount ,avg(ss_quantity) as store_sales_quantityave ,stddev_samp(ss_quantity) as store_sales_quantitystdev ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov ,count(sr_return_quantity) as store_returns_quantitycount ,avg(sr_return_quantity) as store_returns_quantityave ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_quarter_name = &apos;2000Q1&apos; and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_quarter_name in (&apos;2000Q1&apos;,&apos;2000Q2&apos;,&apos;2000Q3&apos;) and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_quarter_name in (&apos;2000Q1&apos;,&apos;2000Q2&apos;,&apos;2000Q3&apos;) group by i_item_id ,i_item_desc ,s_state order by i_item_id ,i_item_desc ,s_state limit 100

</samplerData>
</sample>
<sample t="4828" lt="4821" ts="1600984681640" s="true" lb="query18" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="21199" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215756_ad10bbb0-b27c-448c-8313-79878a593d6d:223
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 7 &lt;- Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924215756_ad10bbb0-b27c-448c-8313-79878a593d6d:223
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_bill_customer_sk is not null and cs_bill_cdemo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_115_container, bigKeyColName:cs_bill_cdemo_sk, smallTablePos:1, keyRatio:1.8835906410835002E-6
                  Statistics: Num rows: 14327953968 Data size: 6921916750808 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_bill_customer_sk is not null and cs_bill_cdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 14256063176 Data size: 6887185896716 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_bill_cdemo_sk (type: bigint), cs_item_sk (type: bigint), cs_sold_date_sk (type: bigint), CAST( cs_quantity AS decimal(12,2)) (type: decimal(12,2)), CAST( cs_list_price AS decimal(12,2)) (type: decimal(12,2)), CAST( cs_coupon_amt AS decimal(12,2)) (type: decimal(12,2)), CAST( cs_sales_price AS decimal(12,2)) (type: decimal(12,2)), CAST( cs_net_profit AS decimal(12,2)) (type: decimal(12,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 14256063176 Data size: 8422973250848 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7, _col8
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 2844971929 Data size: 1644847457192 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8, _col11
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 203212290 Data size: 123480258928 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8, _col11, _col14, _col15, _col16, _col17
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 203212290 Data size: 201987381682 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col11, _col14, _col15, _col16, _col17, _col20
                              input vertices:
                                1 Map 8
                              Statistics: Num rows: 203212290 Data size: 220682912362 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col4), count(_col4), sum(_col5), count(_col5), sum(_col6), count(_col6), sum(_col7), count(_col7), sum(_col8), count(_col8), sum(_col17), count(_col17), sum(_col11), count(_col11)
                                keys: _col14 (type: varchar(30)), _col15 (type: char(2)), _col16 (type: varchar(20)), _col20 (type: char(16))
                                minReductionHashAggr: 0.9294468
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                                Statistics: Num rows: 203212290 Data size: 248122206090 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: varchar(30)), _col1 (type: char(2)), _col2 (type: varchar(20)), _col3 (type: char(16))
                                  null sort order: aaaa
                                  sort order: ++++
                                  Map-reduce partition columns: _col0 (type: varchar(30)), _col1 (type: char(2)), _col2 (type: varchar(20)), _col3 (type: char(16))
                                  Statistics: Num rows: 203212290 Data size: 248122206090 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col4 (type: decimal(22,2)), _col5 (type: bigint), _col6 (type: decimal(22,2)), _col7 (type: bigint), _col8 (type: decimal(22,2)), _col9 (type: bigint), _col10 (type: decimal(22,2)), _col11 (type: bigint), _col12 (type: decimal(22,2)), _col13 (type: bigint), _col14 (type: decimal(22,2)), _col15 (type: bigint), _col16 (type: decimal(22,2)), _col17 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2002) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2002) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: cd1
                  Statistics: Num rows: 1920800 Data size: 366872800 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_gender = &apos;M&apos;) and (cd_education_status = &apos;Unknown             &apos;)) (type: boolean)
                    Statistics: Num rows: 137200 Data size: 26205200 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint), CAST( cd_dep_count AS decimal(12,2)) (type: decimal(12,2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 137200 Data size: 16464000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 137200 Data size: 16464000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: decimal(12,2))
                  Select Operator
                    expressions: cd_demo_sk (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1920800 Data size: 15366400 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 15366400 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: ((ca_state) IN (&apos;AR&apos;, &apos;TX&apos;, &apos;NC&apos;, &apos;GA&apos;, &apos;MS&apos;, &apos;WV&apos;, &apos;AL&apos;) and (c_birth_month) IN (5, 1, 4, 7, 8, 9) and c_current_cdemo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_116_container, bigKeyColName:c_current_cdemo_sk, smallTablePos:1, keyRatio:0.06372850769230769
                  Statistics: Num rows: 65000000 Data size: 19788634336 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ca_state) IN (&apos;AR&apos;, &apos;TX&apos;, &apos;NC&apos;, &apos;GA&apos;, &apos;MS&apos;, &apos;WV&apos;, &apos;AL&apos;) and (c_birth_month) IN (5, 1, 4, 7, 8, 9) and c_current_cdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 4142353 Data size: 1261100149 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_cdemo_sk (type: bigint), ca_county (type: varchar(30)), ca_state (type: char(2)), ca_country (type: varchar(20)), CAST( c_birth_year AS decimal(12,2)) (type: decimal(12,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 4142353 Data size: 1676847209 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 4142353 Data size: 1644867185 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 4142353 Data size: 1644867185 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: varchar(30)), _col3 (type: char(2)), _col4 (type: varchar(20)), _col5 (type: decimal(12,2))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), count(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), count(VALUE._col7), sum(VALUE._col8), count(VALUE._col9), sum(VALUE._col10), count(VALUE._col11), sum(VALUE._col12), count(VALUE._col13)
                keys: KEY._col0 (type: varchar(30)), KEY._col1 (type: char(2)), KEY._col2 (type: varchar(20)), KEY._col3 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 203212290 Data size: 248122206090 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17)
                  keys: _col0 (type: varchar(30)), _col1 (type: char(2)), _col2 (type: varchar(20)), _col3 (type: char(16)), 0L (type: bigint)
                  minReductionHashAggr: 0.9294468
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
                  Statistics: Num rows: 1016061450 Data size: 1248739522050 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: varchar(30)), _col1 (type: char(2)), _col2 (type: varchar(20)), _col3 (type: char(16)), _col4 (type: bigint)
                    null sort order: aaaaa
                    sort order: +++++
                    Map-reduce partition columns: _col0 (type: varchar(30)), _col1 (type: char(2)), _col2 (type: varchar(20)), _col3 (type: char(16)), _col4 (type: bigint)
                    Statistics: Num rows: 1016061450 Data size: 1248739522050 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col5 (type: decimal(32,2)), _col6 (type: bigint), _col7 (type: decimal(32,2)), _col8 (type: bigint), _col9 (type: decimal(32,2)), _col10 (type: bigint), _col11 (type: decimal(32,2)), _col12 (type: bigint), _col13 (type: decimal(32,2)), _col14 (type: bigint), _col15 (type: decimal(32,2)), _col16 (type: bigint), _col17 (type: decimal(32,2)), _col18 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13)
                keys: KEY._col0 (type: varchar(30)), KEY._col1 (type: char(2)), KEY._col2 (type: varchar(20)), KEY._col3 (type: char(16)), KEY._col4 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18
                Statistics: Num rows: 1016061450 Data size: 1248739522050 Basic stats: COMPLETE Column stats: COMPLETE
                pruneGroupingSetId: true
                Top N Key Operator
                  sort order: ++++
                  keys: _col2 (type: varchar(20)), _col1 (type: char(2)), _col0 (type: varchar(30)), _col3 (type: char(16))
                  null sort order: zzzz
                  Statistics: Num rows: 1016061450 Data size: 1248739522050 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col3 (type: char(16)), _col2 (type: varchar(20)), _col1 (type: char(2)), _col0 (type: varchar(30)), (_col5 / COALESCE(_col6,0L)) (type: decimal(38,8)), (_col7 / COALESCE(_col8,0L)) (type: decimal(38,8)), (_col9 / COALESCE(_col10,0L)) (type: decimal(38,8)), (_col11 / COALESCE(_col12,0L)) (type: decimal(38,8)), (_col13 / COALESCE(_col14,0L)) (type: decimal(38,8)), (_col15 / COALESCE(_col16,0L)) (type: decimal(38,8)), (_col17 / COALESCE(_col18,0L)) (type: decimal(38,8))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                    Statistics: Num rows: 1016061450 Data size: 1183711589250 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col1 (type: varchar(20)), _col2 (type: char(2)), _col3 (type: varchar(30)), _col0 (type: char(16))
                      null sort order: zzzz
                      sort order: ++++
                      Statistics: Num rows: 1016061450 Data size: 1183711589250 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col4 (type: decimal(38,8)), _col5 (type: decimal(38,8)), _col6 (type: decimal(38,8)), _col7 (type: decimal(38,8)), _col8 (type: decimal(38,8)), _col9 (type: decimal(38,8)), _col10 (type: decimal(38,8))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey3 (type: char(16)), KEY.reducesinkkey0 (type: varchar(20)), KEY.reducesinkkey1 (type: char(2)), KEY.reducesinkkey2 (type: varchar(30)), VALUE._col0 (type: decimal(38,8)), VALUE._col1 (type: decimal(38,8)), VALUE._col2 (type: decimal(38,8)), VALUE._col3 (type: decimal(38,8)), VALUE._col4 (type: decimal(38,8)), VALUE._col5 (type: decimal(38,8)), VALUE._col6 (type: decimal(38,8))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                Statistics: Num rows: 1016061450 Data size: 1183711589250 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 116500 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 116500 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query18
explain select  i_item_id, ca_country, ca_state, ca_county, avg( cast(cs_quantity as decimal(12,2))) agg1, avg( cast(cs_list_price as decimal(12,2))) agg2, avg( cast(cs_coupon_amt as decimal(12,2))) agg3, avg( cast(cs_sales_price as decimal(12,2))) agg4, avg( cast(cs_net_profit as decimal(12,2))) agg5, avg( cast(c_birth_year as decimal(12,2))) agg6, avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7 from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd1.cd_demo_sk and cs_bill_customer_sk = c_customer_sk and cd1.cd_gender = &apos;M&apos; and cd1.cd_education_status = &apos;Unknown&apos; and c_current_cdemo_sk = cd2.cd_demo_sk and c_current_addr_sk = ca_address_sk and c_birth_month in (5,1,4,7,8,9) and d_year = 2002 and ca_state in (&apos;AR&apos;,&apos;TX&apos;,&apos;NC&apos; ,&apos;GA&apos;,&apos;MS&apos;,&apos;WV&apos;,&apos;AL&apos;) group by rollup (i_item_id, ca_country, ca_state, ca_county) order by ca_country, ca_state, ca_county, i_item_id limit 100

</samplerData>
</sample>
<sample t="3178" lt="3170" ts="1600984684819" s="true" lb="query19" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="15096" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215801_090297f0-b937-4492-80e5-a8a29d378be5:224
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 7 (CUSTOM_SIMPLE_EDGE), Map 8 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924215801_090297f0-b937-4492-80e5-a8a29d378be5:224
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_90_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.5562230220779902E-4
                  Statistics: Num rows: 27503885621 Data size: 3877600458528 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 26223309636 Data size: 3697060076208 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 26223309636 Data size: 3697060076208 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 445186975 Data size: 3561495928 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col3, _col7, _col8, _col9, _col10
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 4280218 Data size: 868884310 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col1 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col1 (type: bigint)
                            Statistics: Num rows: 4280218 Data size: 868884310 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: bigint), _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: char(50)), _col9 (type: int), _col10 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 1998) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_manager_id = 16) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 86418044 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_manager_id = 16) (type: boolean)
                    Statistics: Num rows: 3865 Data size: 830871 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand_id (type: int), i_brand (type: char(50)), i_manufact_id (type: int), i_manufact (type: char(50))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 3865 Data size: 815443 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 3865 Data size: 815443 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: char(50)), _col3 (type: int), _col4 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  Statistics: Num rows: 65000000 Data size: 6305000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: c_customer_sk (type: bigint), substr(ca_zip, 1, 5) (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 65000000 Data size: 6240000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 6240000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 145500 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), substr(s_zip, 1, 5) (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1500 Data size: 144000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 144000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10, _col12
                input vertices:
                  1 Map 7
                Statistics: Num rows: 4280218 Data size: 1245543486 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col3, _col7, _col8, _col9, _col10, _col12, _col14
                  input vertices:
                    1 Map 8
                  Statistics: Num rows: 4280218 Data size: 1622202662 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (_col12 &lt;&gt; _col14) (type: boolean)
                    Statistics: Num rows: 4280218 Data size: 1622202662 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: char(50)), _col9 (type: int), _col10 (type: char(50))
                      outputColumnNames: _col3, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 4280218 Data size: 1622202662 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col3)
                        keys: _col8 (type: char(50)), _col7 (type: int), _col9 (type: int), _col10 (type: char(50))
                        minReductionHashAggr: 0.90624005
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 3865 Data size: 1217475 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(50)), _col1 (type: int), _col2 (type: int), _col3 (type: char(50))
                          null sort order: aaaa
                          sort order: ++++
                          Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: int), _col2 (type: int), _col3 (type: char(50))
                          Statistics: Num rows: 3865 Data size: 1217475 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col4 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(50)), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3865 Data size: 1217475 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: -++++
                  keys: _col4 (type: decimal(17,2)), _col0 (type: char(50)), _col1 (type: int), _col2 (type: int), _col3 (type: char(50))
                  null sort order: azzzz
                  Statistics: Num rows: 3865 Data size: 1217475 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col2 (type: int), _col3 (type: char(50)), _col4 (type: decimal(17,2)), _col0 (type: char(50)), _col1 (type: int)
                    outputColumnNames: _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 3865 Data size: 1619435 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col4 (type: decimal(17,2)), _col5 (type: char(50)), _col6 (type: int), _col2 (type: int), _col3 (type: char(50))
                      null sort order: azzzz
                      sort order: -++++
                      Statistics: Num rows: 3865 Data size: 1619435 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey2 (type: int), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: char(50)), KEY.reducesinkkey0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3865 Data size: 1619435 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 41900 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 41900 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query19
explain select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item,customer,customer_address,store where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=16 and d_moy=12 and d_year=1998 and ss_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and substr(ca_zip,1,5) &lt;&gt; substr(s_zip,1,5) and ss_store_sk = s_store_sk group by i_brand ,i_brand_id ,i_manufact_id ,i_manufact order by ext_price desc ,i_brand ,i_brand_id ,i_manufact_id ,i_manufact limit 100

</samplerData>
</sample>
<sample t="2303" lt="2295" ts="1600984687123" s="true" lb="query20" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="13562" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215804_5f83f681-b912-4c16-b52e-9b473c738cc9:225
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924215804_5f83f681-b912-4c16-b52e-9b473c738cc9:225
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_55_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:0.2727263570030476
                  Statistics: Num rows: 14327953968 Data size: 1829948611216 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_item_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 14327953968 Data size: 1829948611216 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col7, _col8
                      input vertices:
                        1 Map 5
                      Statistics: Num rows: 3907610689 Data size: 2723482733322 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 434149244 Data size: 295533450760 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1)
                          keys: _col8 (type: char(50)), _col7 (type: char(50)), _col4 (type: char(16)), _col5 (type: varchar(200)), _col6 (type: decimal(7,2))
                          minReductionHashAggr: 0.9762746
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                          Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(16)), _col3 (type: varchar(200)), _col4 (type: decimal(7,2))
                            null sort order: aaaaa
                            sort order: +++++
                            Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(16)), _col3 (type: varchar(200)), _col4 (type: decimal(7,2))
                            Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col5 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_category) IN (&apos;Shoes                                             &apos;, &apos;Electronics                                       &apos;, &apos;Children                                          &apos;) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 235458432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_category) IN (&apos;Shoes                                             &apos;, &apos;Electronics                                       &apos;, &apos;Children                                          &apos;) (type: boolean)
                    Statistics: Num rows: 109636 Data size: 64215784 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16)), i_item_desc (type: varchar(200)), i_current_price (type: decimal(7,2)), i_class (type: char(50)), i_category (type: char(50))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 109636 Data size: 64215784 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 109636 Data size: 64215784 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16)), _col2 (type: varchar(200)), _col3 (type: decimal(7,2)), _col4 (type: char(50)), _col5 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2001-03-14 00:00:00&apos; AND TIMESTAMP&apos;2001-04-13 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2001-03-14 00:00:00&apos; AND TIMESTAMP&apos;2001-04-13 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(50)), KEY._col1 (type: char(50)), KEY._col2 (type: char(16)), KEY._col3 (type: varchar(200)), KEY._col4 (type: decimal(7,2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col1 (type: char(50))
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col1 (type: char(50))
                  Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: char(50)), _col2 (type: char(16)), _col3 (type: varchar(200)), _col4 (type: decimal(7,2)), _col5 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col1 (type: char(16)), VALUE._col2 (type: varchar(200)), VALUE._col3 (type: decimal(7,2)), VALUE._col4 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: char(50), _col1: char(50), _col2: char(16), _col3: varchar(200), _col4: decimal(7,2), _col5: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 ASC NULLS FIRST
                        partition by: _col1
                        raw input shape:
                        window functions:
                            window function definition
                              alias: sum_window_0
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumHiveDecimal
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: +++++
                    keys: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(16)), _col3 (type: varchar(200)), ((_col5 * 100) / sum_window_0) (type: decimal(38,17))
                    null sort order: zzzzz
                    Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: _col2 (type: char(16)), _col3 (type: varchar(200)), _col0 (type: char(50)), _col1 (type: char(50)), _col4 (type: decimal(7,2)), _col5 (type: decimal(17,2)), ((_col5 * 100) / sum_window_0) (type: decimal(38,17))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 109636 Data size: 87928072 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col2 (type: char(50)), _col3 (type: char(50)), _col0 (type: char(16)), _col1 (type: varchar(200)), _col6 (type: decimal(38,17))
                        null sort order: zzzzz
                        sort order: +++++
                        Statistics: Num rows: 109636 Data size: 87928072 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col4 (type: decimal(7,2)), _col5 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey2 (type: char(16)), KEY.reducesinkkey3 (type: varchar(200)), KEY.reducesinkkey0 (type: char(50)), KEY.reducesinkkey1 (type: char(50)), VALUE._col0 (type: decimal(7,2)), VALUE._col1 (type: decimal(17,2)), KEY.reducesinkkey4 (type: decimal(38,17))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 109636 Data size: 87928072 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 80200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 80200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query20
explain select  i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from	catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in (&apos;Shoes&apos;, &apos;Electronics&apos;, &apos;Children&apos;) and cs_sold_date_sk = d_date_sk and d_date between cast(&apos;2001-03-14&apos; as date) and (cast(&apos;2001-03-14&apos; as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio limit 100

</samplerData>
</sample>
<sample t="457" lt="451" ts="1600984687582" s="true" lb="query21" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="7612" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215807_56816272-c528-4633-aa41-776dbf12a9ec:226
      Edges:
        Map 2 &lt;- Map 1 (BROADCAST_EDGE)
        Reducer 3 &lt;- Map 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924215807_56816272-c528-4633-aa41-776dbf12a9ec:226
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_current_price BETWEEN 0.99 AND 1.49 (type: boolean)
                  Statistics: Num rows: 402000 Data size: 88326432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: i_current_price BETWEEN 0.99 AND 1.49 (type: boolean)
                    Statistics: Num rows: 8040 Data size: 1766672 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 8040 Data size: 868320 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8040 Data size: 868320 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.ware_inv_date_2
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;1999-02-18 00:00:00&apos; AND TIMESTAMP&apos;1999-04-19 00:00:00&apos; (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_35_container, bigKeyColName:inv_item_sk, smallTablePos:0, keyRatio:0.12222215963963855
                  Statistics: Num rows: 25211132 Data size: 4119499244 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;1999-02-18 00:00:00&apos; AND TIMESTAMP&apos;1999-04-19 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 2801236 Data size: 457721992 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: inv_item_sk (type: bigint), w_warehouse_name (type: varchar(20)), CASE WHEN ((d_date &lt; DATE&apos;1999-03-20&apos;)) THEN (inv_quantity_on_hand) ELSE (0) END (type: int), CASE WHEN ((d_date &gt;= DATE&apos;1999-03-20&apos;)) THEN (inv_quantity_on_hand) ELSE (0) END (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2801236 Data size: 457721992 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col3, _col4, _col5
                        input vertices:
                          0 Map 1
                        Statistics: Num rows: 3081359 Data size: 503494202 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(_col4), sum(_col5)
                          keys: _col3 (type: varchar(20)), _col1 (type: char(16))
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 3081359 Data size: 503494202 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: varchar(20)), _col1 (type: char(16))
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: varchar(20)), _col1 (type: char(16))
                            Statistics: Num rows: 3081359 Data size: 503494202 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col2 (type: bigint), _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: varchar(20)), KEY._col1 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 1540679 Data size: 251747019 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (CASE WHEN ((_col2 &gt; 0L)) THEN ((0.666667D &lt;= (UDFToDouble(_col3) / UDFToDouble(_col2)))) ELSE (false) END and CASE WHEN ((_col2 &gt; 0L)) THEN (((UDFToDouble(_col3) / UDFToDouble(_col2)) &lt;= 1.5D)) ELSE (false) END) (type: boolean)
                  Statistics: Num rows: 385169 Data size: 62936632 Basic stats: COMPLETE Column stats: NONE
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: varchar(20)), _col1 (type: char(16))
                    null sort order: zz
                    Statistics: Num rows: 385169 Data size: 62936632 Basic stats: COMPLETE Column stats: NONE
                    top n: 100
                    Reduce Output Operator
                      key expressions: _col0 (type: varchar(20)), _col1 (type: char(16))
                      null sort order: zz
                      sort order: ++
                      Statistics: Num rows: 385169 Data size: 62936632 Basic stats: COMPLETE Column stats: NONE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col2 (type: bigint), _col3 (type: bigint)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: varchar(20)), KEY.reducesinkkey1 (type: char(16)), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 385169 Data size: 62936632 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 16300 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 16300 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query21
explain select  * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) &lt; cast (&apos;1999-03-20&apos; as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) &gt;= cast (&apos;1999-03-20&apos; as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk          = inv_item_sk and inv_warehouse_sk   = w_warehouse_sk and inv_date_sk    = d_date_sk and d_date between (cast (&apos;1999-03-20&apos; as date) - 30 days) and (cast (&apos;1999-03-20&apos; as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before &gt; 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id limit 100

</samplerData>
</sample>
<sample t="282" lt="277" ts="1600984687865" s="true" lb="query22" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="9268" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215807_02a5a32a-8aca-4854-9986-4dbb8b9a2406:227
      Edges:
        Map 2 &lt;- Map 1 (BROADCAST_EDGE)
        Reducer 3 &lt;- Map 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924215807_02a5a32a-8aca-4854-9986-4dbb8b9a2406:227
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 159594000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_brand (type: char(50)), i_class (type: char(50)), i_category (type: char(50)), i_product_name (type: char(50))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 402000 Data size: 159594000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 159594000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50)), _col4 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.ware_inv_date_2
                  filterExpr: d_month_seq BETWEEN 1186 AND 1197 (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_37_container, bigKeyColName:inv_item_sk, smallTablePos:0, keyRatio:0.017539870879260795
                  Statistics: Num rows: 25211132 Data size: 383209232 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1186 AND 1197 (type: boolean)
                    Statistics: Num rows: 1 Data size: 15 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: inv_item_sk (type: bigint), inv_quantity_on_hand (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1 Data size: 15 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col4, _col6
                        input vertices:
                          0 Map 1
                        Statistics: Num rows: 442200 Data size: 175553403 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: sum(_col6), count(_col6)
                          keys: _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50)), _col4 (type: char(50))
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                          Statistics: Num rows: 442200 Data size: 175553403 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50))
                            null sort order: aaaa
                            sort order: ++++
                            Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50))
                            Statistics: Num rows: 442200 Data size: 175553403 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col4 (type: bigint), _col5 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: char(50)), KEY._col1 (type: char(50)), KEY._col2 (type: char(50)), KEY._col3 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 221100 Data size: 87776701 Basic stats: COMPLETE Column stats: NONE
                Group By Operator
                  aggregations: sum(_col4), sum(_col5)
                  keys: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50)), 0L (type: bigint)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 1105500 Data size: 438883505 Basic stats: COMPLETE Column stats: NONE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50)), _col4 (type: bigint)
                    null sort order: aaaaa
                    sort order: +++++
                    Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50)), _col4 (type: bigint)
                    Statistics: Num rows: 1105500 Data size: 438883505 Basic stats: COMPLETE Column stats: NONE
                    value expressions: _col5 (type: bigint), _col6 (type: bigint)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: char(50)), KEY._col1 (type: char(50)), KEY._col2 (type: char(50)), KEY._col3 (type: char(50)), KEY._col4 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6
                Statistics: Num rows: 552750 Data size: 219441752 Basic stats: COMPLETE Column stats: NONE
                pruneGroupingSetId: true
                Top N Key Operator
                  sort order: +++++
                  keys: (UDFToDouble(_col5) / COALESCE(_col6,0L)) (type: double), _col3 (type: char(50)), _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50))
                  null sort order: zzzzz
                  Statistics: Num rows: 552750 Data size: 219441752 Basic stats: COMPLETE Column stats: NONE
                  top n: 100
                  Select Operator
                    expressions: _col3 (type: char(50)), _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), (UDFToDouble(_col5) / COALESCE(_col6,0L)) (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 552750 Data size: 219441752 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col4 (type: double), _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50))
                      null sort order: zzzzz
                      sort order: +++++
                      Statistics: Num rows: 552750 Data size: 219441752 Basic stats: COMPLETE Column stats: NONE
                      TopN Hash Memory Usage: 0.04
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey2 (type: char(50)), KEY.reducesinkkey3 (type: char(50)), KEY.reducesinkkey4 (type: char(50)), KEY.reducesinkkey0 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 552750 Data size: 219441752 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 39700 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 39700 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query22
explain select  i_product_name ,i_brand ,i_class ,i_category ,avg(inv_quantity_on_hand) qoh from inventory ,date_dim ,item where inv_date_sk=d_date_sk and inv_item_sk=i_item_sk and d_month_seq between 1186 and 1186 + 11 group by rollup(i_product_name ,i_brand ,i_class ,i_category) order by qoh, i_product_name, i_brand, i_class, i_category limit 100

</samplerData>
</sample>
<sample t="10210" lt="10199" ts="1600984698076" s="true" lb="query23a" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="37290" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215807_7539993e-157e-43d5-858b-bd11f8ec7862:228
      Edges:
        Map 1 &lt;- Map 11 (BROADCAST_EDGE), Reducer 13 (BROADCAST_EDGE), Reducer 6 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 12 &lt;- Map 11 (BROADCAST_EDGE), Map 15 (BROADCAST_EDGE)
        Map 16 &lt;- Map 17 (BROADCAST_EDGE), Reducer 14 (BROADCAST_EDGE), Reducer 7 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 8 &lt;- Map 11 (BROADCAST_EDGE)
        Reducer 10 &lt;- Reducer 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 13 &lt;- Map 12 (SIMPLE_EDGE)
        Reducer 14 &lt;- Map 12 (SIMPLE_EDGE)
        Reducer 3 &lt;- Union 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 4 (SIMPLE_EDGE), Reducer 10 (BROADCAST_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 9 &lt;- Map 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924215807_7539993e-157e-43d5-858b-bd11f8ec7862:228
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_318_container, bigKeyColName:cs_bill_customer_sk, smallTablePos:1, keyRatio:0.01681439496093166
                  Statistics: Num rows: 14327953968 Data size: 2001450533808 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 1996420825680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_item_sk (type: bigint), cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 14291947369 Data size: 1996420825680 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 240915877 Data size: 27349089784 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col3
                          input vertices:
                            1 Reducer 6
                          Statistics: Num rows: 240915877 Data size: 25709091664 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Left Semi Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col3
                            input vertices:
                              1 Reducer 13
                            Statistics: Num rows: 240915877 Data size: 23781764648 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: (CAST( _col2 AS decimal(10,0)) * _col3) (type: decimal(18,2))
                              outputColumnNames: _col0
                              Statistics: Num rows: 240915877 Data size: 26982578224 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col0)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0
                                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  null sort order: 
                                  sort order: 
                                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col0 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year) IN (2000, 2001, 2002, 2003) or ((d_year = 2000) and (d_moy = 3))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year) IN (2000, 2001, 2002, 2003) (type: boolean)
                    Statistics: Num rows: 1468 Data size: 17616 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1468 Data size: 11744 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1468 Data size: 11744 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1468 Data size: 11744 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 734 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 734 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 8
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 3)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: (d_year) IN (2000, 2001, 2002, 2003) (type: boolean)
                    Statistics: Num rows: 1468 Data size: 99824 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_date (type: date)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1468 Data size: 93952 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1468 Data size: 93952 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1468 Data size: 11744 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 734 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 734 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 12
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 27503885621 Data size: 440062169936 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 27503885621 Data size: 440062169936 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col3
                      input vertices:
                        1 Map 11
                      Statistics: Num rows: 22111252853 Data size: 1415120182592 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col3, _col4
                        input vertices:
                          1 Map 15
                        Statistics: Num rows: 22111252853 Data size: 1415120182592 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col4 (type: bigint), _col3 (type: date)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 11055626426 Data size: 796005102672 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint), _col1 (type: date)
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: bigint), _col1 (type: date)
                            Statistics: Num rows: 11055626426 Data size: 796005102672 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: bigint)
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint), _col1 (type: date)
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: bigint), _col1 (type: date)
                            Statistics: Num rows: 11055626426 Data size: 796005102672 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 3216000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 402000 Data size: 77184000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 77184000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_320_container, bigKeyColName:ws_bill_customer_sk, smallTablePos:1, keyRatio:5.05684597766595E-7
                  Statistics: Num rows: 7198162681 Data size: 1007631051428 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 1007505428896 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_bill_customer_sk (type: bigint), ws_quantity (type: int), ws_list_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 7197265278 Data size: 1007505428896 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 17
                        Statistics: Num rows: 122186284 Data size: 16016879464 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col3
                          input vertices:
                            1 Reducer 7
                          Statistics: Num rows: 122186284 Data size: 15046567512 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Left Semi Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col3
                            input vertices:
                              1 Reducer 14
                            Statistics: Num rows: 122186284 Data size: 14069077240 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: (CAST( _col2 AS decimal(10,0)) * _col3) (type: decimal(18,2))
                              outputColumnNames: _col0
                              Statistics: Num rows: 122186284 Data size: 13684863808 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col0)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0
                                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  null sort order: 
                                  sort order: 
                                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col0 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) and (d_moy = 3)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 3)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 16
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 28800426268 Data size: 3410531270848 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 27504208767 Data size: 3257033878832 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), (CAST( ss_quantity AS decimal(10,0)) * ss_sales_price) (type: decimal(18,2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 27504208767 Data size: 3257033878832 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 27504208767 Data size: 3290602021744 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 27504208767 Data size: 3290602021744 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3550164109032 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 3466503144696 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_sold_date_sk (type: bigint), ss_customer_sk (type: bigint), (CAST( ss_quantity AS decimal(10,0)) * ss_sales_price) (type: decimal(18,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855746120 Data size: 3432472576584 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 21590192789 Data size: 2585760207904 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col2)
                          keys: _col1 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 10795096394 Data size: 1292880103896 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 10795096394 Data size: 1292880103896 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: max(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col0 is not null (type: boolean)
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (0.95 * _col0) (type: decimal(31,4))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(31,4))
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 5527813213 Data size: 398002551336 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 5527813213 Data size: 398002551336 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (_col2 &gt; 4L) (type: boolean)
                    Statistics: Num rows: 1842604404 Data size: 132667517088 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1842604404 Data size: 14740835232 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 9996822 Data size: 79974576 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 9996822 Data size: 79974576 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 5527813213 Data size: 398002551336 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 5527813213 Data size: 398002551336 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (_col2 &gt; 4L) (type: boolean)
                    Statistics: Num rows: 1842604404 Data size: 132667517088 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1842604404 Data size: 14740835232 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 9996822 Data size: 79974576 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 9996822 Data size: 79974576 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 65000001 Data size: 7776596544 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col1 is not null (type: boolean)
                  Statistics: Num rows: 65000001 Data size: 7776596544 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col1, _col2
                    input vertices:
                      1 Reducer 10
                    Statistics: Num rows: 65000001 Data size: 15056596656 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col1 &gt; _col2) (type: boolean)
                      Statistics: Num rows: 21666667 Data size: 5018865560 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 21666667 Data size: 5018865560 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2443849 Data size: 292688800 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: decimal(28,2))
                  outputColumnNames: _col1
                  Statistics: Num rows: 2443849 Data size: 292688800 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: max(_col1)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(28,2))
        Union 2 
            Vertex: Union 2

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query23a
explain with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (2000,2000+1,2000+2,2000+3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) &gt;4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (2000,2000+1,2000+2,2000+3) group by c_customer_sk) x), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) &gt; (95/100.0) * (select * from max_store_sales)) select  sum(sales) from (select cs_quantity*cs_list_price sales from catalog_sales ,date_dim where d_year = 2000 and d_moy = 3 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) union all select ws_quantity*ws_list_price sales from web_sales ,date_dim where d_year = 2000 and d_moy = 3 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) y limit 100

</samplerData>
</sample>
<sample t="9993" lt="9983" ts="1600984708071" s="true" lb="query23b" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="38233" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215818_94d1cb68-b57f-424a-bea6-cf28076a8c43:229
      Edges:
        Map 1 &lt;- Map 10 (BROADCAST_EDGE), Map 14 (BROADCAST_EDGE), Reducer 12 (BROADCAST_EDGE), Reducer 6 (BROADCAST_EDGE)
        Map 11 &lt;- Map 10 (BROADCAST_EDGE), Map 13 (BROADCAST_EDGE)
        Map 15 &lt;- Map 10 (BROADCAST_EDGE), Map 14 (BROADCAST_EDGE), Reducer 12 (BROADCAST_EDGE), Reducer 6 (BROADCAST_EDGE)
        Map 7 &lt;- Map 10 (BROADCAST_EDGE)
        Reducer 12 &lt;- Map 11 (SIMPLE_EDGE)
        Reducer 16 &lt;- Map 15 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 5 &lt;- Map 4 (SIMPLE_EDGE), Reducer 9 (BROADCAST_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE)
        Reducer 9 &lt;- Reducer 8 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215818_94d1cb68-b57f-424a-bea6-cf28076a8c43:229
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_379_container, bigKeyColName:cs_bill_customer_sk, smallTablePos:1, keyRatio:2.227463884325623E-6
                  Statistics: Num rows: 14327953968 Data size: 2001450533808 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 1996420825680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_item_sk (type: bigint), cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 14291947369 Data size: 1996420825680 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 10
                        Statistics: Num rows: 240915877 Data size: 27349089784 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2, _col3
                          input vertices:
                            1 Reducer 6
                          Statistics: Num rows: 240915877 Data size: 27349089784 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col2, _col3
                            input vertices:
                              1 Reducer 12
                            Statistics: Num rows: 240915877 Data size: 25421762768 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col0 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col2, _col3, _col9, _col10
                              input vertices:
                                1 Map 14
                              Statistics: Num rows: 240915877 Data size: 67146622508 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator
                                expressions: _col10 (type: char(30)), _col9 (type: char(20)), (CAST( _col2 AS decimal(10,0)) * _col3) (type: decimal(18,2))
                                outputColumnNames: _col0, _col1, _col2
                                Statistics: Num rows: 240915877 Data size: 67146622508 Basic stats: COMPLETE Column stats: COMPLETE
                                Group By Operator
                                  aggregations: sum(_col2)
                                  keys: _col0 (type: char(30)), _col1 (type: char(20))
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2
                                  Statistics: Num rows: 65000000 Data size: 18980000000 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: char(30)), _col1 (type: char(20))
                                    null sort order: aa
                                    sort order: ++
                                    Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20))
                                    Statistics: Num rows: 65000000 Data size: 18980000000 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions: _col2 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year) IN (2000, 2001, 2002, 2003) or ((d_year = 2000) and (d_moy = 3))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year) IN (2000, 2001, 2002, 2003) (type: boolean)
                    Statistics: Num rows: 1468 Data size: 17616 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1468 Data size: 11744 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1468 Data size: 11744 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1468 Data size: 11744 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 734 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 734 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 3)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 15
                  Filter Operator
                    predicate: (d_year) IN (2000, 2001, 2002, 2003) (type: boolean)
                    Statistics: Num rows: 1468 Data size: 99824 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_date (type: date)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1468 Data size: 93952 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1468 Data size: 93952 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1468 Data size: 11744 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 734 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 734 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 11
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 27503885621 Data size: 440062169936 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 27503885621 Data size: 440062169936 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col1 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col3
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 22111252853 Data size: 1415120182592 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col3, _col4
                        input vertices:
                          1 Map 13
                        Statistics: Num rows: 22111252853 Data size: 1415120182592 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: count()
                          keys: _col4 (type: bigint), _col3 (type: date)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 11055626426 Data size: 796005102672 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint), _col1 (type: date)
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 11055626426 Data size: 796005102672 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 3216000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 402000 Data size: 77184000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 77184000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_first_name (type: char(20)), c_last_name (type: char(30))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_387_container, bigKeyColName:ws_bill_customer_sk, smallTablePos:1, keyRatio:5.05684597766595E-7
                  Statistics: Num rows: 7198162681 Data size: 1007631051428 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 1007505428896 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_bill_customer_sk (type: bigint), ws_quantity (type: int), ws_list_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 7197265278 Data size: 1007505428896 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 10
                        Statistics: Num rows: 122186284 Data size: 16016879464 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2, _col3
                          input vertices:
                            1 Reducer 6
                          Statistics: Num rows: 122186284 Data size: 16016879464 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col2, _col3
                            input vertices:
                              1 Reducer 12
                            Statistics: Num rows: 122186284 Data size: 15039389192 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col1 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col2, _col3, _col9, _col10
                              input vertices:
                                1 Map 14
                              Statistics: Num rows: 122186284 Data size: 36062608360 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator
                                expressions: _col10 (type: char(30)), _col9 (type: char(20)), (CAST( _col2 AS decimal(10,0)) * _col3) (type: decimal(18,2))
                                outputColumnNames: _col0, _col1, _col2
                                Statistics: Num rows: 122186284 Data size: 36062608360 Basic stats: COMPLETE Column stats: COMPLETE
                                Group By Operator
                                  aggregations: sum(_col2)
                                  keys: _col0 (type: char(30)), _col1 (type: char(20))
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2
                                  Statistics: Num rows: 65000000 Data size: 18980000000 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: char(30)), _col1 (type: char(20))
                                    null sort order: aa
                                    sort order: ++
                                    Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20))
                                    Statistics: Num rows: 65000000 Data size: 18980000000 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions: _col2 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 28800426268 Data size: 3410531270848 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 27504208767 Data size: 3257033878832 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), (CAST( ss_quantity AS decimal(10,0)) * ss_sales_price) (type: decimal(18,2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 27504208767 Data size: 3257033878832 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 27504208767 Data size: 3290602021744 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 27504208767 Data size: 3290602021744 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3550164109032 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 3466503144696 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_sold_date_sk (type: bigint), ss_customer_sk (type: bigint), (CAST( ss_quantity AS decimal(10,0)) * ss_sales_price) (type: decimal(18,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855746120 Data size: 3432472576584 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2
                        input vertices:
                          1 Map 10
                        Statistics: Num rows: 21590192789 Data size: 2585760207904 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col2)
                          keys: _col1 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 10795096394 Data size: 1292880103896 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 10795096394 Data size: 1292880103896 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 5527813213 Data size: 398002551336 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 5527813213 Data size: 398002551336 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (_col2 &gt; 4L) (type: boolean)
                    Statistics: Num rows: 1842604404 Data size: 132667517088 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1842604404 Data size: 132667517088 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint)
                        mode: complete
                        outputColumnNames: _col0
                        Statistics: Num rows: 172359 Data size: 1378872 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 172359 Data size: 1378872 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 172359 Data size: 1378872 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 16 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 26424434 Data size: 7715934728 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 29200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 29200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 26424434 Data size: 7715934728 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 29200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 29200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 65000001 Data size: 7776596544 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col1 is not null (type: boolean)
                  Statistics: Num rows: 65000001 Data size: 7776596544 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col1, _col2
                    input vertices:
                      1 Reducer 9
                    Statistics: Num rows: 65000001 Data size: 15056596656 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col1 &gt; _col2) (type: boolean)
                      Statistics: Num rows: 21666667 Data size: 5018865560 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 21666667 Data size: 5018865560 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 10833333 Data size: 82766080 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2443849 Data size: 292688800 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: decimal(28,2))
                  outputColumnNames: _col1
                  Statistics: Num rows: 2443849 Data size: 292688800 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: max(_col1)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(28,2))
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: max(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col0 is not null (type: boolean)
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (0.95 * _col0) (type: decimal(31,4))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(31,4))
        Union 3 
            Vertex: Union 3

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query23b
explain with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (2000,2000 + 1,2000 + 2,2000 + 3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) &gt;4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (2000,2000+1,2000+2,2000+3) group by c_customer_sk) x), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) &gt; (95/100.0) * (select * from max_store_sales)) select  c_last_name,c_first_name,sales from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales from catalog_sales ,customer ,date_dim where d_year = 2000 and d_moy = 3 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name union all select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales from web_sales ,customer ,date_dim where d_year = 2000 and d_moy = 3 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name order by c_last_name,c_first_name,sales) y limit 100

</samplerData>
</sample>
<sample t="5718" lt="5711" ts="1600984713792" s="true" lb="query24a" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="33116" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215828_d30da65d-54f3-43e0-bf6b-c9a073797e96:230
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE), Reducer 7 (BROADCAST_EDGE)
        Map 12 &lt;- Reducer 5 (BROADCAST_EDGE)
        Map 4 &lt;- Map 6 (BROADCAST_EDGE)
        Map 8 &lt;- Reducer 2 (BROADCAST_EDGE)
        Reducer 10 &lt;- Reducer 15 (XPROD_EDGE), Reducer 9 (XPROD_EDGE)
        Reducer 11 &lt;- Reducer 10 (SIMPLE_EDGE)
        Reducer 13 &lt;- Map 12 (CUSTOM_SIMPLE_EDGE), Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 8 (CUSTOM_SIMPLE_EDGE)
        Reducer 14 &lt;- Reducer 13 (SIMPLE_EDGE)
        Reducer 15 &lt;- Reducer 14 (CUSTOM_SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 4 (CUSTOM_SIMPLE_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 5 &lt;- Map 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Map 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924215828_d30da65d-54f3-43e0-bf6b-c9a073797e96:230
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_store_sk is not null and ss_customer_sk is not null and ss_store_sk BETWEEN DynamicValue(RS_21_store_s_store_sk_min) AND DynamicValue(RS_21_store_s_store_sk_max) and in_bloom_filter(ss_store_sk, DynamicValue(RS_21_store_s_store_sk_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_247_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.5624768738231927E-9
                  Statistics: Num rows: 28800426268 Data size: 3981355111136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_store_sk is not null and ss_customer_sk is not null and ss_store_sk BETWEEN DynamicValue(RS_21_store_s_store_sk_min) AND DynamicValue(RS_21_store_s_store_sk_max) and in_bloom_filter(ss_store_sk, DynamicValue(RS_21_store_s_store_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_sales_price (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 276514573 Data size: 85166487456 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col1 (type: bigint)
                          Statistics: Num rows: 276514573 Data size: 85166487456 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: decimal(7,2)), _col6 (type: decimal(7,2)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_store_sk is not null and ss_customer_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_min) AND DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 28800426268 Data size: 3981355111136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_store_sk is not null and ss_customer_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_min) AND DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_sales_price (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col3 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col3 (type: bigint)
                        Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint), _col2 (type: bigint), _col4 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 156260484 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_color = &apos;snow                &apos;) (type: boolean)
                    Statistics: Num rows: 4232 Data size: 1645092 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_current_price (type: decimal(7,2)), i_size (type: char(20)), i_units (type: char(10)), i_manager_id (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 4232 Data size: 1268444 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 4232 Data size: 1268444 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: decimal(7,2)), _col2 (type: char(20)), _col3 (type: char(10)), _col4 (type: int)
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_current_price (type: decimal(7,2)), i_size (type: char(20)), i_color (type: char(20)), i_units (type: char(10)), i_manager_id (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 402000 Data size: 156260484 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 156260484 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: decimal(7,2)), _col2 (type: char(20)), _col3 (type: char(20)), _col4 (type: char(10)), _col5 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: ((upper(ca_country) &lt;&gt; c_birth_country) and ca_zip is not null) (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 35880000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((upper(ca_country) &lt;&gt; c_birth_country) and ca_zip is not null) (type: boolean)
                    Statistics: Num rows: 65000000 Data size: 35880000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_first_name (type: char(20)), c_last_name (type: char(30)), ca_state (type: char(2)), ca_zip (type: char(10))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 65000000 Data size: 23595000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 65000000 Data size: 23595000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: char(2)), _col4 (type: char(10))
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: char(10))
                          1 _col3 (type: char(10))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 1022226 Data size: 466135056 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col5 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col5 (type: bigint)
                          Statistics: Num rows: 1022226 Data size: 466135056 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: char(2)), _col6 (type: varchar(50)), _col7 (type: char(2))
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 1022226 Data size: 8177808 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1022226)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: ((s_market_id = 10) and s_zip is not null) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 412464 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((s_market_id = 10) and s_zip is not null) (type: boolean)
                    Statistics: Num rows: 150 Data size: 41250 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_store_name (type: varchar(50)), s_state (type: char(2)), s_zip (type: char(10))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 150 Data size: 40650 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col3 (type: char(10))
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col3 (type: char(10))
                        Statistics: Num rows: 150 Data size: 40650 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(50)), _col2 (type: char(2))
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 150 Data size: 1200 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                      Reduce Output Operator
                        key expressions: _col3 (type: char(10))
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col3 (type: char(10))
                        Statistics: Num rows: 150 Data size: 40650 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col1 (type: varchar(50)), _col2 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint), _col3 (type: bigint)
                        1 _col0 (type: bigint), _col1 (type: bigint)
                      outputColumnNames: _col4, _col6, _col7, _col8, _col9, _col11, _col12, _col13, _col16, _col17
                      input vertices:
                        0 Reducer 2
                      Statistics: Num rows: 129553821 Data size: 108856377880 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col4)
                        keys: _col11 (type: char(20)), _col12 (type: char(30)), _col16 (type: varchar(50)), _col6 (type: decimal(7,2)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int), _col13 (type: char(2)), _col17 (type: char(2))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                        Statistics: Num rows: 4348625 Data size: 3670239500 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: varchar(50)), _col3 (type: decimal(7,2)), _col4 (type: char(20)), _col5 (type: char(10)), _col6 (type: int), _col7 (type: char(2)), _col8 (type: char(2))
                          null sort order: aaaaaaaaa
                          sort order: +++++++++
                          Map-reduce partition columns: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: varchar(50))
                          Statistics: Num rows: 4348625 Data size: 3670239500 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col9 (type: decimal(17,2))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 
                  1 
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 73062 Data size: 35946504 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col3 &gt; _col4) (type: boolean)
                  Statistics: Num rows: 24354 Data size: 11982168 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: varchar(50)), _col3 (type: decimal(27,2))
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 24354 Data size: 9254520 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: varchar(50))
                      null sort order: zzz
                      sort order: +++
                      Statistics: Num rows: 24354 Data size: 9254520 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col3 (type: decimal(27,2))
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(30)), KEY.reducesinkkey1 (type: char(20)), KEY.reducesinkkey2 (type: varchar(50)), VALUE._col0 (type: decimal(27,2))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 24354 Data size: 9254520 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 24354 Data size: 9254520 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col4
                input vertices:
                  1 Map 8
                Statistics: Num rows: 72586293196 Data size: 9720427728496 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint), _col2 (type: bigint)
                    1 _col0 (type: bigint), _col5 (type: bigint)
                  outputColumnNames: _col0, _col4, _col8, _col9, _col10, _col13, _col14
                  input vertices:
                    1 Map 4
                  Statistics: Num rows: 1141532248 Data size: 511406447216 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col4, _col8, _col9, _col10, _col13, _col14, _col17, _col18, _col19, _col20, _col21
                    input vertices:
                      1 Map 3
                    Statistics: Num rows: 1141532248 Data size: 937197858204 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: sum(_col4)
                      keys: _col8 (type: char(20)), _col9 (type: char(30)), _col10 (type: char(2)), _col13 (type: varchar(50)), _col14 (type: char(2)), _col17 (type: decimal(7,2)), _col18 (type: char(20)), _col19 (type: char(20)), _col20 (type: char(10)), _col21 (type: int)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 1141532248 Data size: 1065049469868 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: char(2)), _col3 (type: varchar(50)), _col4 (type: char(2)), _col5 (type: decimal(7,2)), _col6 (type: char(20)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int)
                        null sort order: aaaaaaaaaa
                        sort order: ++++++++++
                        Map-reduce partition columns: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: char(2)), _col3 (type: varchar(50)), _col4 (type: char(2)), _col5 (type: decimal(7,2)), _col6 (type: char(20)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int)
                        Statistics: Num rows: 1141532248 Data size: 1065049469868 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col10 (type: decimal(17,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(20)), KEY._col1 (type: char(30)), KEY._col2 (type: char(2)), KEY._col3 (type: varchar(50)), KEY._col4 (type: char(2)), KEY._col5 (type: decimal(7,2)), KEY._col6 (type: char(20)), KEY._col7 (type: char(20)), KEY._col8 (type: char(10)), KEY._col9 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                Statistics: Num rows: 1141532248 Data size: 1065049469868 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col10 (type: decimal(17,2))
                  outputColumnNames: _col10
                  Statistics: Num rows: 1141532248 Data size: 1065049469868 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col10), count(_col10)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(27,2)), _col1 (type: bigint)
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col0 is not null and _col1 is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (0.05 * (_col0 / _col1)) (type: decimal(38,12))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(38,12))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7, _col8, _col9, _col11, _col12, _col13, _col14
                input vertices:
                  1 Map 4
                Statistics: Num rows: 276514573 Data size: 183329160863 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint), _col14 (type: char(10))
                    1 _col0 (type: bigint), _col3 (type: char(10))
                  outputColumnNames: _col0, _col3, _col4, _col6, _col7, _col8, _col9, _col11, _col12, _col13, _col16, _col17
                  input vertices:
                    1 Map 6
                  Statistics: Num rows: 4348625 Data size: 3252770456 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col3 (type: bigint)
                    null sort order: aa
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: bigint), _col3 (type: bigint)
                    Statistics: Num rows: 4348625 Data size: 3252770456 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col4 (type: decimal(7,2)), _col6 (type: decimal(7,2)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int), _col11 (type: char(20)), _col12 (type: char(30)), _col13 (type: char(2)), _col16 (type: varchar(50)), _col17 (type: char(2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1022226)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(20)), KEY._col1 (type: char(30)), KEY._col2 (type: varchar(50)), KEY._col3 (type: decimal(7,2)), KEY._col4 (type: char(20)), KEY._col5 (type: char(10)), KEY._col6 (type: int), KEY._col7 (type: char(2)), KEY._col8 (type: char(2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 4348625 Data size: 3670239500 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: varchar(50)), _col9 (type: decimal(17,2))
                  outputColumnNames: _col4, _col5, _col7, _col9
                  Statistics: Num rows: 4348625 Data size: 3670239500 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col9)
                    keys: _col4 (type: char(20)), _col5 (type: char(30)), _col7 (type: varchar(50))
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 73062 Data size: 27763560 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col1 (type: char(30)), _col0 (type: char(20)), _col2 (type: varchar(50)), _col3 (type: decimal(27,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 73062 Data size: 27763560 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: _col3 is not null (type: boolean)
                        Statistics: Num rows: 73062 Data size: 27763560 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 73062 Data size: 27763560 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: varchar(50)), _col3 (type: decimal(27,2))

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query24a
explain with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_sales_price) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country &lt;&gt; upper(ca_country) and s_zip = ca_zip and s_market_id=10 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = &apos;snow&apos; group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) &gt; (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name

</samplerData>
</sample>
<sample t="5695" lt="5685" ts="1600984719488" s="true" lb="query24b" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="33116" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215833_6976e087-e7c5-4595-a428-af3505e182a0:231
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE), Reducer 7 (BROADCAST_EDGE)
        Map 12 &lt;- Reducer 5 (BROADCAST_EDGE)
        Map 4 &lt;- Map 6 (BROADCAST_EDGE)
        Map 8 &lt;- Reducer 2 (BROADCAST_EDGE)
        Reducer 10 &lt;- Reducer 15 (XPROD_EDGE), Reducer 9 (XPROD_EDGE)
        Reducer 11 &lt;- Reducer 10 (SIMPLE_EDGE)
        Reducer 13 &lt;- Map 12 (CUSTOM_SIMPLE_EDGE), Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 8 (CUSTOM_SIMPLE_EDGE)
        Reducer 14 &lt;- Reducer 13 (SIMPLE_EDGE)
        Reducer 15 &lt;- Reducer 14 (CUSTOM_SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 4 (CUSTOM_SIMPLE_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 5 &lt;- Map 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Map 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924215833_6976e087-e7c5-4595-a428-af3505e182a0:231
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_store_sk is not null and ss_customer_sk is not null and ss_store_sk BETWEEN DynamicValue(RS_21_store_s_store_sk_min) AND DynamicValue(RS_21_store_s_store_sk_max) and in_bloom_filter(ss_store_sk, DynamicValue(RS_21_store_s_store_sk_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_247_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.5624768738231927E-9
                  Statistics: Num rows: 28800426268 Data size: 3981355111136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_store_sk is not null and ss_customer_sk is not null and ss_store_sk BETWEEN DynamicValue(RS_21_store_s_store_sk_min) AND DynamicValue(RS_21_store_s_store_sk_max) and in_bloom_filter(ss_store_sk, DynamicValue(RS_21_store_s_store_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_sales_price (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6, _col7, _col8, _col9
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 276514573 Data size: 85166487456 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col1 (type: bigint)
                          Statistics: Num rows: 276514573 Data size: 85166487456 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: decimal(7,2)), _col6 (type: decimal(7,2)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_store_sk is not null and ss_customer_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_min) AND DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 28800426268 Data size: 3981355111136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_store_sk is not null and ss_customer_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_min) AND DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_59_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_customer_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_sales_price (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col3 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col3 (type: bigint)
                        Statistics: Num rows: 26266271131 Data size: 3631034896704 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint), _col2 (type: bigint), _col4 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 156260484 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_color = &apos;chiffon             &apos;) (type: boolean)
                    Statistics: Num rows: 4232 Data size: 1645092 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_current_price (type: decimal(7,2)), i_size (type: char(20)), i_units (type: char(10)), i_manager_id (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 4232 Data size: 1268444 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 4232 Data size: 1268444 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: decimal(7,2)), _col2 (type: char(20)), _col3 (type: char(10)), _col4 (type: int)
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_current_price (type: decimal(7,2)), i_size (type: char(20)), i_color (type: char(20)), i_units (type: char(10)), i_manager_id (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 402000 Data size: 156260484 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 156260484 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: decimal(7,2)), _col2 (type: char(20)), _col3 (type: char(20)), _col4 (type: char(10)), _col5 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: ((upper(ca_country) &lt;&gt; c_birth_country) and ca_zip is not null) (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 35880000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((upper(ca_country) &lt;&gt; c_birth_country) and ca_zip is not null) (type: boolean)
                    Statistics: Num rows: 65000000 Data size: 35880000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_first_name (type: char(20)), c_last_name (type: char(30)), ca_state (type: char(2)), ca_zip (type: char(10))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 65000000 Data size: 23595000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 65000000 Data size: 23595000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: char(2)), _col4 (type: char(10))
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: char(10))
                          1 _col3 (type: char(10))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 1022226 Data size: 466135056 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col5 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col5 (type: bigint)
                          Statistics: Num rows: 1022226 Data size: 466135056 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(20)), _col2 (type: char(30)), _col3 (type: char(2)), _col6 (type: varchar(50)), _col7 (type: char(2))
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 1022226 Data size: 8177808 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1022226)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: ((s_market_id = 10) and s_zip is not null) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 412464 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((s_market_id = 10) and s_zip is not null) (type: boolean)
                    Statistics: Num rows: 150 Data size: 41250 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_store_name (type: varchar(50)), s_state (type: char(2)), s_zip (type: char(10))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 150 Data size: 40650 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col3 (type: char(10))
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col3 (type: char(10))
                        Statistics: Num rows: 150 Data size: 40650 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(50)), _col2 (type: char(2))
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 150 Data size: 1200 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                      Reduce Output Operator
                        key expressions: _col3 (type: char(10))
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col3 (type: char(10))
                        Statistics: Num rows: 150 Data size: 40650 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col1 (type: varchar(50)), _col2 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint), _col3 (type: bigint)
                        1 _col0 (type: bigint), _col1 (type: bigint)
                      outputColumnNames: _col4, _col6, _col7, _col8, _col9, _col11, _col12, _col13, _col16, _col17
                      input vertices:
                        0 Reducer 2
                      Statistics: Num rows: 129553821 Data size: 108856377880 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col4)
                        keys: _col11 (type: char(20)), _col12 (type: char(30)), _col16 (type: varchar(50)), _col6 (type: decimal(7,2)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int), _col13 (type: char(2)), _col17 (type: char(2))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                        Statistics: Num rows: 4348625 Data size: 3670239500 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: varchar(50)), _col3 (type: decimal(7,2)), _col4 (type: char(20)), _col5 (type: char(10)), _col6 (type: int), _col7 (type: char(2)), _col8 (type: char(2))
                          null sort order: aaaaaaaaa
                          sort order: +++++++++
                          Map-reduce partition columns: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: varchar(50))
                          Statistics: Num rows: 4348625 Data size: 3670239500 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col9 (type: decimal(17,2))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 
                  1 
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 73062 Data size: 35946504 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col3 &gt; _col4) (type: boolean)
                  Statistics: Num rows: 24354 Data size: 11982168 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: varchar(50)), _col3 (type: decimal(27,2))
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 24354 Data size: 9254520 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: varchar(50))
                      null sort order: zzz
                      sort order: +++
                      Statistics: Num rows: 24354 Data size: 9254520 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col3 (type: decimal(27,2))
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(30)), KEY.reducesinkkey1 (type: char(20)), KEY.reducesinkkey2 (type: varchar(50)), VALUE._col0 (type: decimal(27,2))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 24354 Data size: 9254520 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 24354 Data size: 9254520 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col4
                input vertices:
                  1 Map 8
                Statistics: Num rows: 72586293196 Data size: 9720427728496 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint), _col2 (type: bigint)
                    1 _col0 (type: bigint), _col5 (type: bigint)
                  outputColumnNames: _col0, _col4, _col8, _col9, _col10, _col13, _col14
                  input vertices:
                    1 Map 4
                  Statistics: Num rows: 1141532248 Data size: 511406447216 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col4, _col8, _col9, _col10, _col13, _col14, _col17, _col18, _col19, _col20, _col21
                    input vertices:
                      1 Map 3
                    Statistics: Num rows: 1141532248 Data size: 937197858204 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: sum(_col4)
                      keys: _col8 (type: char(20)), _col9 (type: char(30)), _col10 (type: char(2)), _col13 (type: varchar(50)), _col14 (type: char(2)), _col17 (type: decimal(7,2)), _col18 (type: char(20)), _col19 (type: char(20)), _col20 (type: char(10)), _col21 (type: int)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 1141532248 Data size: 1065049469868 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: char(2)), _col3 (type: varchar(50)), _col4 (type: char(2)), _col5 (type: decimal(7,2)), _col6 (type: char(20)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int)
                        null sort order: aaaaaaaaaa
                        sort order: ++++++++++
                        Map-reduce partition columns: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: char(2)), _col3 (type: varchar(50)), _col4 (type: char(2)), _col5 (type: decimal(7,2)), _col6 (type: char(20)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int)
                        Statistics: Num rows: 1141532248 Data size: 1065049469868 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col10 (type: decimal(17,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(20)), KEY._col1 (type: char(30)), KEY._col2 (type: char(2)), KEY._col3 (type: varchar(50)), KEY._col4 (type: char(2)), KEY._col5 (type: decimal(7,2)), KEY._col6 (type: char(20)), KEY._col7 (type: char(20)), KEY._col8 (type: char(10)), KEY._col9 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                Statistics: Num rows: 1141532248 Data size: 1065049469868 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col10 (type: decimal(17,2))
                  outputColumnNames: _col10
                  Statistics: Num rows: 1141532248 Data size: 1065049469868 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col10), count(_col10)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(27,2)), _col1 (type: bigint)
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col0 is not null and _col1 is not null) (type: boolean)
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: (0.05 * (_col0 / _col1)) (type: decimal(38,12))
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: decimal(38,12))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col3, _col4, _col6, _col7, _col8, _col9, _col11, _col12, _col13, _col14
                input vertices:
                  1 Map 4
                Statistics: Num rows: 276514573 Data size: 183329160863 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col2 (type: bigint), _col14 (type: char(10))
                    1 _col0 (type: bigint), _col3 (type: char(10))
                  outputColumnNames: _col0, _col3, _col4, _col6, _col7, _col8, _col9, _col11, _col12, _col13, _col16, _col17
                  input vertices:
                    1 Map 6
                  Statistics: Num rows: 4348625 Data size: 3252770456 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col3 (type: bigint)
                    null sort order: aa
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: bigint), _col3 (type: bigint)
                    Statistics: Num rows: 4348625 Data size: 3252770456 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col4 (type: decimal(7,2)), _col6 (type: decimal(7,2)), _col7 (type: char(20)), _col8 (type: char(10)), _col9 (type: int), _col11 (type: char(20)), _col12 (type: char(30)), _col13 (type: char(2)), _col16 (type: varchar(50)), _col17 (type: char(2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1022226)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(20)), KEY._col1 (type: char(30)), KEY._col2 (type: varchar(50)), KEY._col3 (type: decimal(7,2)), KEY._col4 (type: char(20)), KEY._col5 (type: char(10)), KEY._col6 (type: int), KEY._col7 (type: char(2)), KEY._col8 (type: char(2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 4348625 Data size: 3670239500 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(20)), _col1 (type: char(30)), _col2 (type: varchar(50)), _col9 (type: decimal(17,2))
                  outputColumnNames: _col4, _col5, _col7, _col9
                  Statistics: Num rows: 4348625 Data size: 3670239500 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col9)
                    keys: _col4 (type: char(20)), _col5 (type: char(30)), _col7 (type: varchar(50))
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 73062 Data size: 27763560 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col1 (type: char(30)), _col0 (type: char(20)), _col2 (type: varchar(50)), _col3 (type: decimal(27,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 73062 Data size: 27763560 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: _col3 is not null (type: boolean)
                        Statistics: Num rows: 73062 Data size: 27763560 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 73062 Data size: 27763560 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: varchar(50)), _col3 (type: decimal(27,2))

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query24b
explain with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_sales_price) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country &lt;&gt; upper(ca_country) and s_zip = ca_zip and s_market_id = 10 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = &apos;chiffon&apos; group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) &gt; (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name

</samplerData>
</sample>
<sample t="8371" lt="8364" ts="1600984727861" s="true" lb="query25" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="27470" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215839_234529a0-df8b-4b1c-b6fa-521c90d0f99a:232
      Edges:
        Map 1 &lt;- Map 2 (BROADCAST_EDGE), Reducer 8 (BROADCAST_EDGE)
        Map 3 &lt;- Map 2 (BROADCAST_EDGE), Reducer 10 (BROADCAST_EDGE)
        Map 9 &lt;- Map 2 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Map 3 (CUSTOM_SIMPLE_EDGE), Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 11 (BROADCAST_EDGE), Map 12 (BROADCAST_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 3 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215839_234529a0-df8b-4b1c-b6fa-521c90d0f99a:232
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_bill_customer_sk is not null and cs_item_sk BETWEEN DynamicValue(RS_25_store_sales_ss_item_sk_min) AND DynamicValue(RS_25_store_sales_ss_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_25_store_sales_ss_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1948313686864 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_bill_customer_sk is not null and cs_item_sk BETWEEN DynamicValue(RS_25_store_sales_ss_item_sk_min) AND DynamicValue(RS_25_store_sales_ss_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_25_store_sales_ss_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 1943417513288 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_item_sk (type: bigint), cs_net_profit (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291947369 Data size: 1943417513288 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 1663096680 Data size: 212589046144 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 1663096680 Data size: 212589046144 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_store_id (type: char(16)), s_store_name (type: varchar(50))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16)), _col2 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_id (type: char(16)), i_item_desc (type: varchar(200))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16)), _col2 (type: varchar(200))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: d3
                  filterExpr: (((d_year = 2000) and d_moy BETWEEN 4 AND 10) or ((d_year = 2000) and (d_moy = 4)) or ((d_year = 2000) and d_moy BETWEEN 4 AND 10)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and d_moy BETWEEN 4 AND 10) (type: boolean)
                    Statistics: Num rows: 214 Data size: 3424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 107 Data size: 856 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 107 Data size: 856 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 4)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 3
                  Filter Operator
                    predicate: ((d_year = 2000) and d_moy BETWEEN 4 AND 10) (type: boolean)
                    Statistics: Num rows: 214 Data size: 3424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 107 Data size: 856 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: sr_returned_date_sk (bigint)
                            Target Input: store_returns
                            Partition key expr: sr_returned_date_sk
                            Statistics: Num rows: 107 Data size: 856 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 9
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_customer_sk is not null and ss_store_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_26_store_returns_sr_customer_sk_min) AND DynamicValue(RS_26_store_returns_sr_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_26_store_returns_sr_customer_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 4097638550776 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_customer_sk is not null and ss_store_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_26_store_returns_sr_customer_sk_min) AND DynamicValue(RS_26_store_returns_sr_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_26_store_returns_sr_customer_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26223309636 Data size: 3906853234320 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 26223309636 Data size: 3906853234320 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col5 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 445186975 Data size: 7122991728 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint), _col0 (type: bigint), _col3 (type: bigint)
                          null sort order: aaa
                          sort order: +++
                          Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint), _col3 (type: bigint)
                          Statistics: Num rows: 445186975 Data size: 7122991728 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: bigint), _col4 (type: decimal(7,2))
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 445186975 Data size: 3561495800 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: sr_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 2778787720 Data size: 394105895264 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: sr_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 2728449035 Data size: 386966532928 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_customer_sk (type: bigint), sr_ticket_number (type: bigint), sr_net_loss (type: decimal(7,2)), sr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 2728449035 Data size: 386966532928 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 291648378 Data size: 33734051296 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint)
                          null sort order: aaa
                          sort order: +++
                          Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint)
                          Statistics: Num rows: 291648378 Data size: 33734051296 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col3 (type: decimal(7,2))
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 291648378 Data size: 3875545536 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: bigint)
                outputColumnNames: _col0, _col2, _col4, _col7, _col8, _col10
                input vertices:
                  1 Map 9
                Statistics: Num rows: 496550631656 Data size: 127057609138944 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Reduce Output Operator
                  key expressions: _col8 (type: bigint), _col7 (type: bigint)
                  null sort order: aa
                  sort order: ++
                  Map-reduce partition columns: _col8 (type: bigint), _col7 (type: bigint)
                  Statistics: Num rows: 496550631656 Data size: 127057609138944 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col2 (type: bigint), _col4 (type: decimal(7,2)), _col10 (type: decimal(7,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col5, _col7, _col9, _col15
                input vertices:
                  0 Map 1
                Statistics: Num rows: 3748356687798707 Data size: 1319421495147994112 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2, _col5, _col9, _col15, _col19, _col20
                  input vertices:
                    1 Map 11
                  Statistics: Num rows: 3748356687798707 Data size: 1994125702513257176 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col5 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2, _col9, _col15, _col19, _col20, _col22, _col23
                    input vertices:
                      1 Map 12
                    Statistics: Num rows: 3748356687798707 Data size: 3028672148345700288 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++++
                      keys: _col22 (type: char(16)), _col23 (type: varchar(200)), _col19 (type: char(16)), _col20 (type: varchar(50))
                      null sort order: zzzz
                      Statistics: Num rows: 3748356687798707 Data size: 3028672148345700288 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Group By Operator
                        aggregations: sum(_col9), sum(_col15), sum(_col2)
                        keys: _col22 (type: char(16)), _col23 (type: varchar(200)), _col19 (type: char(16)), _col20 (type: varchar(50))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                        Statistics: Num rows: 3748356687798707 Data size: 3028672203741355200 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(16)), _col3 (type: varchar(50))
                          null sort order: zzzz
                          sort order: ++++
                          Map-reduce partition columns: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(16)), _col3 (type: varchar(50))
                          Statistics: Num rows: 3748356687798707 Data size: 3028672203741355200 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
                          value expressions: _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: char(16)), KEY._col1 (type: varchar(200)), KEY._col2 (type: char(16)), KEY._col3 (type: varchar(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 530467724968896 Data size: 428617921774867968 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(16)), _col3 (type: varchar(50))
                  null sort order: zzzz
                  sort order: ++++
                  Statistics: Num rows: 530467724968896 Data size: 428617921774867968 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), KEY.reducesinkkey1 (type: varchar(200)), KEY.reducesinkkey2 (type: char(16)), KEY.reducesinkkey3 (type: varchar(50)), VALUE._col0 (type: decimal(17,2)), VALUE._col1 (type: decimal(17,2)), VALUE._col2 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 530467724968896 Data size: 428617921774867968 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 80800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 80800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query25
explain select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,sum(ss_net_profit) as store_sales_profit ,sum(sr_net_loss) as store_returns_loss ,sum(cs_net_profit) as catalog_sales_profit from store_sales ,store_returns ,catalog_sales ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,item where d1.d_moy = 4 and d1.d_year = 2000 and d1.d_date_sk = ss_sold_date_sk and i_item_sk = ss_item_sk and s_store_sk = ss_store_sk and ss_customer_sk = sr_customer_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and sr_returned_date_sk = d2.d_date_sk and d2.d_moy               between 4 and  10 and d2.d_year              = 2000 and sr_customer_sk = cs_bill_customer_sk and sr_item_sk = cs_item_sk and cs_sold_date_sk = d3.d_date_sk and d3.d_moy               between 4 and  10 and d3.d_year              = 2000 group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100

</samplerData>
</sample>
<sample t="4104" lt="4098" ts="1600984731966" s="true" lb="query26" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="14634" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215847_24ff9a61-3249-4c14-8d1d-4e31b4fd2010:233
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924215847_24ff9a61-3249-4c14-8d1d-4e31b4fd2010:233
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_promo_sk is not null and cs_bill_cdemo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_94_container, bigKeyColName:cs_bill_cdemo_sk, smallTablePos:1, keyRatio:0.002836587840159929
                  Statistics: Num rows: 14327953968 Data size: 5317186028256 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_promo_sk is not null and cs_bill_cdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 14256078371 Data size: 5290512581264 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_cdemo_sk (type: bigint), cs_item_sk (type: bigint), cs_promo_sk (type: bigint), cs_quantity (type: int), cs_list_price (type: decimal(7,2)), cs_sales_price (type: decimal(7,2)), cs_coupon_amt (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 14256078371 Data size: 5290512581264 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col7 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 2844974961 Data size: 1022822313056 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 40642500 Data size: 2006510308 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col3, _col4, _col5, _col6
                            input vertices:
                              1 Map 6
                            Statistics: Num rows: 40642500 Data size: 1967856836 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col1 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col3, _col4, _col5, _col6, _col12
                              input vertices:
                                1 Map 7
                              Statistics: Num rows: 40642500 Data size: 5706966836 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: +
                                keys: _col12 (type: char(16))
                                null sort order: z
                                Statistics: Num rows: 40642500 Data size: 5706966836 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 100
                                Group By Operator
                                  aggregations: sum(_col3), count(_col3), sum(_col4), count(_col4), sum(_col6), count(_col6), sum(_col5), count(_col5)
                                  keys: _col12 (type: char(16))
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                                  Statistics: Num rows: 4867122 Data size: 2316750072 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: char(16))
                                    null sort order: z
                                    sort order: +
                                    Map-reduce partition columns: _col0 (type: char(16))
                                    Statistics: Num rows: 4867122 Data size: 2316750072 Basic stats: COMPLETE Column stats: COMPLETE
                                    TopN Hash Memory Usage: 0.04
                                    value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: bigint), _col5 (type: decimal(17,2)), _col6 (type: bigint), _col7 (type: decimal(17,2)), _col8 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 1998) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 1998) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  filterExpr: ((cd_marital_status = &apos;S&apos;) and (cd_gender = &apos;F&apos;) and (cd_education_status = &apos;College             &apos;)) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 522457600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_marital_status = &apos;S&apos;) and (cd_gender = &apos;F&apos;) and (cd_education_status = &apos;College             &apos;)) (type: boolean)
                    Statistics: Num rows: 27440 Data size: 7463680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 27440 Data size: 219520 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 27440 Data size: 219520 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  filterExpr: ((p_channel_email = &apos;N&apos;) or (p_channel_event = &apos;N&apos;)) (type: boolean)
                  Statistics: Num rows: 2000 Data size: 356000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((p_channel_email = &apos;N&apos;) or (p_channel_event = &apos;N&apos;)) (type: boolean)
                    Statistics: Num rows: 2000 Data size: 356000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: p_promo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 2000 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2000 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), count(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), count(VALUE._col7)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 211614 Data size: 100728264 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), (UDFToDouble(_col1) / _col2) (type: double), (_col3 / _col4) (type: decimal(37,22)), (_col5 / _col6) (type: decimal(37,22)), (_col7 / _col8) (type: decimal(37,22))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 211614 Data size: 93956616 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: z
                    sort order: +
                    Statistics: Num rows: 211614 Data size: 93956616 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col1 (type: double), _col2 (type: decimal(37,22)), _col3 (type: decimal(37,22)), _col4 (type: decimal(37,22))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), VALUE._col0 (type: double), VALUE._col1 (type: decimal(37,22)), VALUE._col2 (type: decimal(37,22)), VALUE._col3 (type: decimal(37,22))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 211614 Data size: 93956616 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 44400 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 44400 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query26
explain select  i_item_id, avg(cs_quantity) agg1, avg(cs_list_price) agg2, avg(cs_coupon_amt) agg3, avg(cs_sales_price) agg4 from catalog_sales, customer_demographics, date_dim, item, promotion where cs_sold_date_sk = d_date_sk and cs_item_sk = i_item_sk and cs_bill_cdemo_sk = cd_demo_sk and cs_promo_sk = p_promo_sk and cd_gender = &apos;F&apos; and cd_marital_status = &apos;S&apos; and cd_education_status = &apos;College&apos; and (p_channel_email = &apos;N&apos; or p_channel_event = &apos;N&apos;) and d_year = 1998 group by i_item_id order by i_item_id limit 100

</samplerData>
</sample>
<sample t="3944" lt="3937" ts="1600984735911" s="true" lb="query27" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="15664" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215851_e0814c0a-58f1-4e6e-831b-2d65b790404b:234
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924215851_e0814c0a-58f1-4e6e-831b-2d65b790404b:234
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_cdemo_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_96_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:3.744925405061915E-9
                  Statistics: Num rows: 27503885621 Data size: 10000744086144 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_cdemo_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 26223244670 Data size: 9535087611568 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_cdemo_sk (type: bigint), ss_store_sk (type: bigint), ss_quantity (type: int), ss_list_price (type: decimal(7,2)), ss_sales_price (type: decimal(7,2)), ss_coupon_amt (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 26223244670 Data size: 9535087611568 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col7 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 5270426164 Data size: 1698475718024 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 75291803 Data size: 602334772 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col11
                            input vertices:
                              1 Map 6
                            Statistics: Num rows: 12565399 Data size: 1181147846 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col0 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col3, _col4, _col5, _col6, _col11, _col13
                              input vertices:
                                1 Map 7
                              Statistics: Num rows: 12565399 Data size: 2337164554 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: ++
                                keys: _col13 (type: char(16)), _col11 (type: char(2))
                                null sort order: zz
                                Statistics: Num rows: 12565399 Data size: 2337164554 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 100
                                Select Operator
                                  expressions: _col13 (type: char(16)), _col11 (type: char(2)), _col3 (type: int), _col4 (type: decimal(7,2)), _col6 (type: decimal(7,2)), _col5 (type: decimal(7,2))
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                                  Statistics: Num rows: 12565399 Data size: 2337164554 Basic stats: COMPLETE Column stats: COMPLETE
                                  Group By Operator
                                    aggregations: sum(_col2), count(_col2), sum(_col3), count(_col3), sum(_col4), count(_col4), sum(_col5), count(_col5)
                                    keys: _col0 (type: char(16)), _col1 (type: char(2)), 0L (type: bigint)
                                    minReductionHashAggr: 0.95874816
                                    mode: hash
                                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                                    Statistics: Num rows: 18848098 Data size: 10743415860 Basic stats: COMPLETE Column stats: COMPLETE
                                    Reduce Output Operator
                                      key expressions: _col0 (type: char(16)), _col1 (type: char(2)), _col2 (type: bigint)
                                      null sort order: zza
                                      sort order: +++
                                      Map-reduce partition columns: _col0 (type: char(16)), _col1 (type: char(2)), _col2 (type: bigint)
                                      Statistics: Num rows: 18848098 Data size: 10743415860 Basic stats: COMPLETE Column stats: COMPLETE
                                      TopN Hash Memory Usage: 0.04
                                      value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: decimal(17,2)), _col6 (type: bigint), _col7 (type: decimal(17,2)), _col8 (type: bigint), _col9 (type: decimal(17,2)), _col10 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2000) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  filterExpr: ((cd_marital_status = &apos;U&apos;) and (cd_gender = &apos;F&apos;) and (cd_education_status = &apos;2 yr Degree         &apos;)) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 522457600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_marital_status = &apos;U&apos;) and (cd_gender = &apos;F&apos;) and (cd_education_status = &apos;2 yr Degree         &apos;)) (type: boolean)
                    Statistics: Num rows: 27440 Data size: 7463680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 27440 Data size: 219520 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 27440 Data size: 219520 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_state) IN (&apos;AL&apos;, &apos;IN&apos;, &apos;SC&apos;, &apos;NY&apos;, &apos;OH&apos;, &apos;FL&apos;) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 141000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_state) IN (&apos;AL&apos;, &apos;IN&apos;, &apos;SC&apos;, &apos;NY&apos;, &apos;OH&apos;, &apos;FL&apos;) (type: boolean)
                    Statistics: Num rows: 250 Data size: 23500 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_state (type: char(2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 250 Data size: 23500 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 250 Data size: 23500 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), count(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), count(VALUE._col7)
                keys: KEY._col0 (type: char(16)), KEY._col1 (type: char(2)), KEY._col2 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                Statistics: Num rows: 3809052 Data size: 2171159640 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: char(2)), grouping(_col2, 0L) (type: bigint), (UDFToDouble(_col3) / _col4) (type: double), (_col5 / _col6) (type: decimal(37,22)), (_col7 / _col8) (type: decimal(37,22)), (_col9 / _col10) (type: decimal(37,22))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 3809052 Data size: 2049269976 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16)), _col1 (type: char(2))
                    null sort order: zz
                    sort order: ++
                    Statistics: Num rows: 3809052 Data size: 2049269976 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col2 (type: bigint), _col3 (type: double), _col4 (type: decimal(37,22)), _col5 (type: decimal(37,22)), _col6 (type: decimal(37,22))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), KEY.reducesinkkey1 (type: char(2)), VALUE._col0 (type: bigint), VALUE._col1 (type: double), VALUE._col2 (type: decimal(37,22)), VALUE._col3 (type: decimal(37,22)), VALUE._col4 (type: decimal(37,22))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 3809052 Data size: 2049269976 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 53800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 53800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query27
explain select  i_item_id, s_state, grouping(s_state) g_state, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, store, item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and ss_cdemo_sk = cd_demo_sk and cd_gender = &apos;F&apos; and cd_marital_status = &apos;U&apos; and cd_education_status = &apos;2 yr Degree&apos; and d_year = 2000 and s_state in (&apos;AL&apos;,&apos;IN&apos;, &apos;SC&apos;, &apos;NY&apos;, &apos;OH&apos;, &apos;FL&apos;) group by rollup (i_item_id, s_state) order by i_item_id ,s_state limit 100

</samplerData>
</sample>
<sample t="3011" lt="3002" ts="1600984738924" s="true" lb="query28" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="28639" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215855_44f3205c-5bdd-4fb9-9342-09c1bcf4ac8c:235
      Edges:
        Reducer 10 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 11 &lt;- Reducer 10 (CUSTOM_SIMPLE_EDGE)
        Reducer 12 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 13 &lt;- Reducer 12 (CUSTOM_SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 11 (BROADCAST_EDGE), Reducer 13 (BROADCAST_EDGE), Reducer 2 (CUSTOM_SIMPLE_EDGE), Reducer 5 (BROADCAST_EDGE), Reducer 7 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Reducer 4 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 9 &lt;- Reducer 8 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215855_44f3205c-5bdd-4fb9-9342-09c1bcf4ac8c:235
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ((ss_quantity BETWEEN 0 AND 5 and (ss_list_price BETWEEN 73 AND 83 or ss_coupon_amt BETWEEN 7826 AND 8826 or ss_wholesale_cost BETWEEN 70 AND 90)) or (ss_quantity BETWEEN 26 AND 30 and (ss_list_price BETWEEN 180 AND 190 or ss_coupon_amt BETWEEN 12592 AND 13592 or ss_wholesale_cost BETWEEN 22 AND 42)) or (ss_quantity BETWEEN 21 AND 25 and (ss_list_price BETWEEN 85 AND 95 or ss_coupon_amt BETWEEN 3310 AND 4310 or ss_wholesale_cost BETWEEN 37 AND 57)) or (ss_quantity BETWEEN 16 AND 20 and (ss_list_price BETWEEN 182 AND 192 or ss_coupon_amt BETWEEN 3262 AND 4262 or ss_wholesale_cost BETWEEN 20 AND 40)) or (ss_quantity BETWEEN 11 AND 15 and (ss_list_price BETWEEN 53 AND 63 or ss_coupon_amt BETWEEN 3430 AND 4430 or ss_wholesale_cost BETWEEN 13 AND 33)) or (ss_quantity BETWEEN 6 AND 10 and (ss_list_price BETWEEN 152 AND 162 or ss_coupon_amt BETWEEN 2196 AND 3196 or ss_wholesale_cost BETWEEN 56 AND 76))) (type: boolean)
                  Statistics: Num rows: 28800426268 Data size: 9351362178096 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_quantity BETWEEN 0 AND 5 and (ss_list_price BETWEEN 73 AND 83 or ss_coupon_amt BETWEEN 7826 AND 8826 or ss_wholesale_cost BETWEEN 70 AND 90)) (type: boolean)
                    Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_list_price (type: decimal(7,2))
                      outputColumnNames: ss_list_price
                      Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_list_price), count(ss_list_price)
                        keys: ss_list_price (type: decimal(7,2))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: decimal(7,2))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: decimal(7,2))
                          Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
                  Filter Operator
                    predicate: (ss_quantity BETWEEN 26 AND 30 and (ss_list_price BETWEEN 180 AND 190 or ss_coupon_amt BETWEEN 12592 AND 13592 or ss_wholesale_cost BETWEEN 22 AND 42)) (type: boolean)
                    Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_list_price (type: decimal(7,2))
                      outputColumnNames: ss_list_price
                      Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_list_price), count(ss_list_price)
                        keys: ss_list_price (type: decimal(7,2))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: decimal(7,2))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: decimal(7,2))
                          Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
                  Filter Operator
                    predicate: (ss_quantity BETWEEN 21 AND 25 and (ss_list_price BETWEEN 85 AND 95 or ss_coupon_amt BETWEEN 3310 AND 4310 or ss_wholesale_cost BETWEEN 37 AND 57)) (type: boolean)
                    Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_list_price (type: decimal(7,2))
                      outputColumnNames: ss_list_price
                      Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_list_price), count(ss_list_price)
                        keys: ss_list_price (type: decimal(7,2))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: decimal(7,2))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: decimal(7,2))
                          Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
                  Filter Operator
                    predicate: (ss_quantity BETWEEN 16 AND 20 and (ss_list_price BETWEEN 182 AND 192 or ss_coupon_amt BETWEEN 3262 AND 4262 or ss_wholesale_cost BETWEEN 20 AND 40)) (type: boolean)
                    Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_list_price (type: decimal(7,2))
                      outputColumnNames: ss_list_price
                      Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_list_price), count(ss_list_price)
                        keys: ss_list_price (type: decimal(7,2))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: decimal(7,2))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: decimal(7,2))
                          Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
                  Filter Operator
                    predicate: (ss_quantity BETWEEN 11 AND 15 and (ss_list_price BETWEEN 53 AND 63 or ss_coupon_amt BETWEEN 3430 AND 4430 or ss_wholesale_cost BETWEEN 13 AND 33)) (type: boolean)
                    Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_list_price (type: decimal(7,2))
                      outputColumnNames: ss_list_price
                      Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_list_price), count(ss_list_price)
                        keys: ss_list_price (type: decimal(7,2))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: decimal(7,2))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: decimal(7,2))
                          Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
                  Filter Operator
                    predicate: (ss_quantity BETWEEN 6 AND 10 and (ss_list_price BETWEEN 152 AND 162 or ss_coupon_amt BETWEEN 2196 AND 3196 or ss_wholesale_cost BETWEEN 56 AND 76)) (type: boolean)
                    Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_list_price (type: decimal(7,2))
                      outputColumnNames: ss_list_price
                      Statistics: Num rows: 1440021313 Data size: 467568108996 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_list_price), count(ss_list_price)
                        keys: ss_list_price (type: decimal(7,2))
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: decimal(7,2))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: decimal(7,2))
                          Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: decimal(7,2))
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1), count(_col2), count(_col0)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), count(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: decimal(7,2))
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1), count(_col2), count(_col0)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), count(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: decimal(7,2))
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1), count(_col2), count(_col0)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), count(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    input vertices:
                      1 Reducer 5
                    Statistics: Num rows: 1 Data size: 256 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 
                        1 
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      input vertices:
                        1 Reducer 7
                      Statistics: Num rows: 1 Data size: 384 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                        input vertices:
                          1 Reducer 9
                        Statistics: Num rows: 1 Data size: 512 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 
                            1 
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                          input vertices:
                            1 Reducer 11
                          Statistics: Num rows: 1 Data size: 640 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 
                              1 
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                            input vertices:
                              1 Reducer 13
                            Statistics: Num rows: 1 Data size: 768 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: _col0 (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint), _col15 (type: decimal(37,22)), _col16 (type: bigint), _col17 (type: bigint), _col12 (type: decimal(37,22)), _col13 (type: bigint), _col14 (type: bigint), _col9 (type: decimal(37,22)), _col10 (type: bigint), _col11 (type: bigint), _col6 (type: decimal(37,22)), _col7 (type: bigint), _col8 (type: bigint), _col3 (type: decimal(37,22)), _col4 (type: bigint), _col5 (type: bigint)
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                              Statistics: Num rows: 1 Data size: 768 Basic stats: COMPLETE Column stats: COMPLETE
                              Limit
                                Number of rows: 100
                                Statistics: Num rows: 1 Data size: 768 Basic stats: COMPLETE Column stats: COMPLETE
                                File Output Operator
                                  compressed: false
                                  Statistics: Num rows: 1 Data size: 768 Basic stats: COMPLETE Column stats: COMPLETE
                                  table:
                                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: decimal(7,2))
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1), count(_col2), count(_col0)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), count(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: decimal(7,2))
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1), count(_col2), count(_col0)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), count(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: decimal(7,2))
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 720010656 Data size: 163412377472 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1), count(_col2), count(_col0)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(17,2)), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), count(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: (_col0 / _col1) (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(37,22)), _col1 (type: bigint), _col2 (type: bigint)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query28
explain select  * from (select avg(ss_list_price) B1_LP ,count(ss_list_price) B1_CNT ,count(distinct ss_list_price) B1_CNTD from store_sales where ss_quantity between 0 and 5 and (ss_list_price between 73 and 73+10 or ss_coupon_amt between 7826 and 7826+1000 or ss_wholesale_cost between 70 and 70+20)) B1, (select avg(ss_list_price) B2_LP ,count(ss_list_price) B2_CNT ,count(distinct ss_list_price) B2_CNTD from store_sales where ss_quantity between 6 and 10 and (ss_list_price between 152 and 152+10 or ss_coupon_amt between 2196 and 2196+1000 or ss_wholesale_cost between 56 and 56+20)) B2, (select avg(ss_list_price) B3_LP ,count(ss_list_price) B3_CNT ,count(distinct ss_list_price) B3_CNTD from store_sales where ss_quantity between 11 and 15 and (ss_list_price between 53 and 53+10 or ss_coupon_amt between 3430 and 3430+1000 or ss_wholesale_cost between 13 and 13+20)) B3, (select avg(ss_list_price) B4_LP ,count(ss_list_price) B4_CNT ,count(distinct ss_list_price) B4_CNTD from store_sales where ss_quantity between 16 and 20 and (ss_list_price between 182 and 182+10 or ss_coupon_amt between 3262 and 3262+1000 or ss_wholesale_cost between 20 and 20+20)) B4, (select avg(ss_list_price) B5_LP ,count(ss_list_price) B5_CNT ,count(distinct ss_list_price) B5_CNTD from store_sales where ss_quantity between 21 and 25 and (ss_list_price between 85 and 85+10 or ss_coupon_amt between 3310 and 3310+1000 or ss_wholesale_cost between 37 and 37+20)) B5, (select avg(ss_list_price) B6_LP ,count(ss_list_price) B6_CNT ,count(distinct ss_list_price) B6_CNTD from store_sales where ss_quantity between 26 and 30 and (ss_list_price between 180 and 180+10 or ss_coupon_amt between 12592 and 12592+1000 or ss_wholesale_cost between 22 and 22+20)) B6 limit 100

</samplerData>
</sample>
<sample t="8361" lt="8354" ts="1600984747287" s="true" lb="query29" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="29331" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215858_6cb8ba1d-fe6d-40a9-a737-d54d05b82dce:236
      Edges:
        Map 1 &lt;- Map 2 (BROADCAST_EDGE), Reducer 8 (BROADCAST_EDGE)
        Map 3 &lt;- Map 2 (BROADCAST_EDGE), Reducer 10 (BROADCAST_EDGE)
        Map 9 &lt;- Map 2 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Map 3 (CUSTOM_SIMPLE_EDGE), Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 11 (BROADCAST_EDGE), Map 12 (BROADCAST_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 3 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215858_6cb8ba1d-fe6d-40a9-a737-d54d05b82dce:236
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_bill_customer_sk is not null and cs_item_sk BETWEEN DynamicValue(RS_25_store_sales_ss_item_sk_min) AND DynamicValue(RS_25_store_sales_ss_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_25_store_sales_ss_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 400750696400 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_bill_customer_sk is not null and cs_item_sk BETWEEN DynamicValue(RS_25_store_sales_ss_item_sk_min) AND DynamicValue(RS_25_store_sales_ss_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_25_store_sales_ss_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 399743597296 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_item_sk (type: bigint), cs_quantity (type: int), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291947369 Data size: 399743597296 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 8556399441 Data size: 170697059784 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 8556399441 Data size: 170697059784 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_store_id (type: char(16)), s_store_name (type: varchar(50))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16)), _col2 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_id (type: char(16)), i_item_desc (type: varchar(200))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 117384000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16)), _col2 (type: varchar(200))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: d3
                  filterExpr: ((d_year) IN (1998, 1999, 2000) or (((d_year = 1998) and (d_moy = 4)) or ((d_year = 1998) and d_moy BETWEEN 4 AND 7))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year) IN (1998, 1999, 2000) (type: boolean)
                    Statistics: Num rows: 1101 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1101 Data size: 8808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5004541
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 550 Data size: 4400 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_moy = 4)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 3
                  Filter Operator
                    predicate: ((d_year = 1998) and d_moy BETWEEN 4 AND 7) (type: boolean)
                    Statistics: Num rows: 122 Data size: 1952 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 122 Data size: 976 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 61 Data size: 488 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: sr_returned_date_sk (bigint)
                            Target Input: store_returns
                            Partition key expr: sr_returned_date_sk
                            Statistics: Num rows: 61 Data size: 488 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 9
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_customer_sk is not null and ss_store_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_26_store_returns_sr_customer_sk_min) AND DynamicValue(RS_26_store_returns_sr_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_26_store_returns_sr_customer_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 1197211838144 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_customer_sk is not null and ss_store_sk is not null and ss_customer_sk BETWEEN DynamicValue(RS_26_store_returns_sr_customer_sk_min) AND DynamicValue(RS_26_store_returns_sr_customer_sk_max) and in_bloom_filter(ss_customer_sk, DynamicValue(RS_26_store_returns_sr_customer_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26223309636 Data size: 1141469869532 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 26223309636 Data size: 1141469869532 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col5 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 445186975 Data size: 7122991620 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint), _col0 (type: bigint), _col3 (type: bigint)
                          null sort order: aaa
                          sort order: +++
                          Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint), _col3 (type: bigint)
                          Statistics: Num rows: 445186975 Data size: 7122991620 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: bigint), _col4 (type: int)
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 445186975 Data size: 3561495800 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: sr_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 2778787720 Data size: 99431808020 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: sr_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 2728449035 Data size: 97630566984 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_customer_sk (type: bigint), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 2728449035 Data size: 97630566984 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 166266832 Data size: 4061873020 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint)
                          null sort order: aaa
                          sort order: +++
                          Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint)
                          Statistics: Num rows: 166266832 Data size: 4061873020 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col3 (type: int)
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 166266832 Data size: 1869440800 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: bigint)
                outputColumnNames: _col0, _col2, _col4, _col7, _col8, _col10
                input vertices:
                  1 Map 9
                Statistics: Num rows: 496550755231 Data size: 19856094367276 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Reduce Output Operator
                  key expressions: _col8 (type: bigint), _col7 (type: bigint)
                  null sort order: aa
                  sort order: ++
                  Map-reduce partition columns: _col8 (type: bigint), _col7 (type: bigint)
                  Statistics: Num rows: 496550755231 Data size: 19856094367276 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col2 (type: bigint), _col4 (type: int), _col10 (type: int)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col5, _col7, _col9, _col15
                input vertices:
                  0 Map 1
                Statistics: Num rows: 3748359347183897 Data size: 104954056037121268 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col7 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2, _col5, _col9, _col15, _col19, _col20
                  input vertices:
                    1 Map 11
                  Statistics: Num rows: 3748359347183897 Data size: 779658742091718492 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col5 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2, _col9, _col15, _col19, _col20, _col22, _col23
                    input vertices:
                      1 Map 12
                    Statistics: Num rows: 3748359347183897 Data size: 1814205921914474068 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++++
                      keys: _col22 (type: char(16)), _col23 (type: varchar(200)), _col19 (type: char(16)), _col20 (type: varchar(50))
                      null sort order: zzzz
                      Statistics: Num rows: 3748359347183897 Data size: 1814205921914474068 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Select Operator
                        expressions: _col22 (type: char(16)), _col23 (type: varchar(200)), _col19 (type: char(16)), _col20 (type: varchar(50)), _col9 (type: int), _col15 (type: int), _col2 (type: int), UDFToDouble(_col9) (type: double), (UDFToDouble(_col9) * UDFToDouble(_col9)) (type: double), UDFToDouble(_col15) (type: double), (UDFToDouble(_col15) * UDFToDouble(_col15)) (type: double), UDFToDouble(_col2) (type: double), (UDFToDouble(_col2) * UDFToDouble(_col2)) (type: double)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                        Statistics: Num rows: 3748359347183897 Data size: 1814205921914474068 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col8), sum(_col7), count(_col4), sum(_col10), sum(_col9), count(_col5), sum(_col12), sum(_col11), count(_col6)
                          keys: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(16)), _col3 (type: varchar(50))
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                          Statistics: Num rows: 3748359347183897 Data size: 2039107484868039944 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(16)), _col3 (type: varchar(50))
                            null sort order: zzzz
                            sort order: ++++
                            Map-reduce partition columns: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(16)), _col3 (type: varchar(50))
                            Statistics: Num rows: 3748359347183897 Data size: 2039107484868039944 Basic stats: COMPLETE Column stats: COMPLETE
                            TopN Hash Memory Usage: 0.04
                            value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: bigint), _col7 (type: double), _col8 (type: double), _col9 (type: bigint), _col10 (type: double), _col11 (type: double), _col12 (type: bigint)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), count(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), count(VALUE._col8)
                keys: KEY._col0 (type: char(16)), KEY._col1 (type: varchar(200)), KEY._col2 (type: char(16)), KEY._col3 (type: varchar(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                Statistics: Num rows: 530467724968896 Data size: 288574442383079424 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(16)), _col3 (type: varchar(50)), power(((_col4 - ((_col5 * _col5) / _col6)) / CASE WHEN ((_col6 = 1L)) THEN (null) ELSE ((_col6 - 1)) END), 0.5) (type: double), power(((_col7 - ((_col8 * _col8) / _col9)) / CASE WHEN ((_col9 = 1L)) THEN (null) ELSE ((_col9 - 1)) END), 0.5) (type: double), power(((_col10 - ((_col11 * _col11) / _col12)) / CASE WHEN ((_col12 = 1L)) THEN (null) ELSE ((_col12 - 1)) END), 0.5) (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 530467724968896 Data size: 263111991584572416 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: char(16)), _col3 (type: varchar(50))
                    null sort order: zzzz
                    sort order: ++++
                    Statistics: Num rows: 530467724968896 Data size: 263111991584572416 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col4 (type: double), _col5 (type: double), _col6 (type: double)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), KEY.reducesinkkey1 (type: varchar(200)), KEY.reducesinkkey2 (type: char(16)), KEY.reducesinkkey3 (type: varchar(50)), VALUE._col0 (type: double), VALUE._col1 (type: double), VALUE._col2 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 530467724968896 Data size: 263111991584572416 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 49600 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 49600 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query29
explain select i_item_id ,i_item_desc ,s_store_id ,s_store_name ,stddev_samp(ss_quantity)        as store_sales_quantity ,stddev_samp(sr_return_quantity) as store_returns_quantity ,stddev_samp(cs_quantity)        as catalog_sales_quantity from store_sales ,store_returns ,catalog_sales ,date_dim             d1 ,date_dim             d2 ,date_dim             d3 ,store ,item where d1.d_moy               = 4 and d1.d_year              = 1998 and d1.d_date_sk           = ss_sold_date_sk and i_item_sk              = ss_item_sk and s_store_sk             = ss_store_sk and ss_customer_sk         = sr_customer_sk and ss_item_sk             = sr_item_sk and ss_ticket_number       = sr_ticket_number and sr_returned_date_sk    = d2.d_date_sk and d2.d_moy               between 4 and  4 + 3 and d2.d_year              = 1998 and sr_customer_sk         = cs_bill_customer_sk and sr_item_sk             = cs_item_sk and cs_sold_date_sk        = d3.d_date_sk and d3.d_year              in (1998,1998+1,1998+2) group by i_item_id ,i_item_desc ,s_store_id ,s_store_name order by i_item_id ,i_item_desc ,s_store_id ,s_store_name limit 100

</samplerData>
</sample>
<sample t="3359" lt="3352" ts="1600984750648" s="true" lb="query30" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="27374" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215907_9c81527f-7ba7-4e92-abc7-77472d13da53:237
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE)
        Map 4 &lt;- Map 3 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Reducer 2 (BROADCAST_EDGE)
        Map 7 &lt;- Map 3 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 1 (BROADCAST_EDGE), Map 4 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE), Reducer 5 (BROADCAST_EDGE)
        Reducer 9 &lt;- Reducer 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924215907_9c81527f-7ba7-4e92-abc7-77472d13da53:237
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: c_current_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_159_container, bigKeyColName:c_current_addr_sk, smallTablePos:1, keyRatio:0.01886793846153846
                  Statistics: Num rows: 65000000 Data size: 55191523008 Basic stats: COMPLETE Column stats: PARTIAL
                  Filter Operator
                    predicate: c_current_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 65000000 Data size: 55191523008 Basic stats: COMPLETE Column stats: PARTIAL
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_customer_id (type: string), c_current_addr_sk (type: bigint), c_salutation (type: char(10)), c_first_name (type: char(20)), c_last_name (type: char(30)), c_preferred_cust_flag (type: char(1)), c_birth_day (type: int), c_birth_month (type: int), c_birth_year (type: int), c_birth_country (type: varchar(20)), c_login (type: char(13)), c_email_address (type: char(50)), c_last_review_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                      Statistics: Num rows: 65000000 Data size: 55191523008 Basic stats: COMPLETE Column stats: PARTIAL
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 1226416 Data size: 793491356 Basic stats: COMPLETE Column stats: PARTIAL
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 1226416 Data size: 793491356 Basic stats: COMPLETE Column stats: PARTIAL
                          value expressions: _col1 (type: string), _col3 (type: char(10)), _col4 (type: char(20)), _col5 (type: char(30)), _col6 (type: char(1)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: varchar(20)), _col11 (type: char(13)), _col12 (type: char(50)), _col13 (type: bigint)
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 1226416 Data size: 9811328 Basic stats: COMPLETE Column stats: PARTIAL
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1226416)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: PARTIAL
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: ((ca_state = &apos;GA&apos;) or ca_state is not null) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_state = &apos;GA&apos;) (type: boolean)
                    Statistics: Num rows: 613208 Data size: 57641552 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 613208 Data size: 4905664 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 613208 Data size: 4905664 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ca_state is not null (type: boolean)
                    Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), ca_state (type: char(2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(2))
                  Filter Operator
                    predicate: ca_state is not null (type: boolean)
                    Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), ca_state (type: char(2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  filterExpr: (wr_returning_addr_sk is not null and wr_returning_customer_sk is not null and wr_returning_customer_sk BETWEEN DynamicValue(RS_57_customer_c_customer_sk_min) AND DynamicValue(RS_57_customer_c_customer_sk_max) and in_bloom_filter(wr_returning_customer_sk, DynamicValue(RS_57_customer_c_customer_sk_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_161_container, bigKeyColName:wr_returning_addr_sk, smallTablePos:1, keyRatio:1.1890162454879947E-4
                  Statistics: Num rows: 687618864 Data size: 91443426720 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (wr_returning_addr_sk is not null and wr_returning_customer_sk is not null and wr_returning_customer_sk BETWEEN DynamicValue(RS_57_customer_c_customer_sk_min) AND DynamicValue(RS_57_customer_c_customer_sk_max) and in_bloom_filter(wr_returning_customer_sk, DynamicValue(RS_57_customer_c_customer_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 655613725 Data size: 87187203184 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_returning_customer_sk (type: bigint), wr_returning_addr_sk (type: bigint), wr_return_amt (type: decimal(7,2)), wr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 655613725 Data size: 87187203184 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 110218476 Data size: 12131701512 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col6
                          input vertices:
                            1 Map 3
                          Statistics: Num rows: 110218476 Data size: 20852297512 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2)
                            keys: _col0 (type: bigint), _col6 (type: char(2))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 55109238 Data size: 11290764228 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: bigint), _col1 (type: char(2))
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: char(2))
                              Statistics: Num rows: 55109238 Data size: 11290764228 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2000) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: wr_returned_date_sk (bigint)
                            Target Input: web_returns
                            Partition key expr: wr_returned_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 4
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: wr_returned_date_sk (bigint)
                            Target Input: web_returns
                            Partition key expr: wr_returned_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  filterExpr: wr_returning_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_163_container, bigKeyColName:wr_returning_addr_sk, smallTablePos:1, keyRatio:1.1890162454879947E-4
                  Statistics: Num rows: 687618864 Data size: 91443426720 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: wr_returning_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 671420556 Data size: 89289284592 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_returning_customer_sk (type: bigint), wr_returning_addr_sk (type: bigint), wr_return_amt (type: decimal(7,2)), wr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 671420556 Data size: 89289284592 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 112875841 Data size: 12424196624 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col6
                          input vertices:
                            1 Map 3
                          Statistics: Num rows: 112875841 Data size: 21355045998 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2)
                            keys: _col6 (type: char(2)), _col0 (type: bigint)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 56437920 Data size: 11562984208 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(2)), _col1 (type: bigint)
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: char(2))
                              Statistics: Num rows: 56437920 Data size: 11562984208 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1226416)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: PARTIAL
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: PARTIAL
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: char(2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 4333280 Data size: 887801120 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col2 is not null (type: boolean)
                  Statistics: Num rows: 4333280 Data size: 887801120 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col16, _col17
                    input vertices:
                      0 Map 1
                    Statistics: Num rows: 4333280 Data size: 4260755820 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col16 (type: char(2))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col16 (type: char(2))
                      Statistics: Num rows: 4333280 Data size: 4260755820 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string), _col3 (type: char(10)), _col4 (type: char(20)), _col5 (type: char(30)), _col6 (type: char(1)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: varchar(20)), _col11 (type: char(13)), _col12 (type: char(50)), _col13 (type: bigint), _col17 (type: decimal(17,2))
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(2)), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 4333280 Data size: 887801120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(2)), _col2 (type: decimal(17,2))
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 4333280 Data size: 887801120 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col2), count(_col2)
                    keys: _col0 (type: char(2))
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 53 Data size: 10918 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col1 is not null and _col2 is not null) (type: boolean)
                      Statistics: Num rows: 53 Data size: 10918 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: ((_col1 / _col2) * 1.2) (type: decimal(38,11)), _col0 (type: char(2))
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 53 Data size: 10494 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col16 (type: char(2))
                            1 _col1 (type: char(2))
                          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col17, _col18
                          input vertices:
                            0 Reducer 5
                          Statistics: Num rows: 4333280 Data size: 4373421100 Basic stats: COMPLETE Column stats: PARTIAL
                          Filter Operator
                            predicate: (_col17 &gt; _col18) (type: boolean)
                            Statistics: Num rows: 1444426 Data size: 1457806526 Basic stats: COMPLETE Column stats: PARTIAL
                            Top N Key Operator
                              sort order: +++++++++++++
                              keys: _col1 (type: string), _col3 (type: char(10)), _col4 (type: char(20)), _col5 (type: char(30)), _col6 (type: char(1)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: varchar(20)), _col11 (type: char(13)), _col12 (type: char(50)), _col13 (type: bigint), _col17 (type: decimal(17,2))
                              null sort order: zzzzzzzzzzzzz
                              Statistics: Num rows: 1444426 Data size: 1457806526 Basic stats: COMPLETE Column stats: PARTIAL
                              top n: 100
                              Select Operator
                                expressions: _col1 (type: string), _col3 (type: char(10)), _col4 (type: char(20)), _col5 (type: char(30)), _col6 (type: char(1)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: varchar(20)), _col11 (type: char(13)), _col12 (type: char(50)), _col13 (type: bigint), _col17 (type: decimal(17,2))
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                                Statistics: Num rows: 1444426 Data size: 1212634594 Basic stats: COMPLETE Column stats: PARTIAL
                                Reduce Output Operator
                                  key expressions: _col0 (type: string), _col1 (type: char(10)), _col2 (type: char(20)), _col3 (type: char(30)), _col4 (type: char(1)), _col5 (type: int), _col6 (type: int), _col7 (type: int), _col8 (type: varchar(20)), _col9 (type: char(13)), _col10 (type: char(50)), _col11 (type: bigint), _col12 (type: decimal(17,2))
                                  null sort order: zzzzzzzzzzzzz
                                  sort order: +++++++++++++
                                  Statistics: Num rows: 1444426 Data size: 1212634594 Basic stats: COMPLETE Column stats: PARTIAL
                                  TopN Hash Memory Usage: 0.04
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: char(10)), KEY.reducesinkkey2 (type: char(20)), KEY.reducesinkkey3 (type: char(30)), KEY.reducesinkkey4 (type: char(1)), KEY.reducesinkkey5 (type: int), KEY.reducesinkkey6 (type: int), KEY.reducesinkkey7 (type: int), KEY.reducesinkkey8 (type: varchar(20)), KEY.reducesinkkey9 (type: char(13)), KEY.reducesinkkey10 (type: char(50)), KEY.reducesinkkey11 (type: bigint), KEY.reducesinkkey12 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                Statistics: Num rows: 1444426 Data size: 1212634594 Basic stats: COMPLETE Column stats: PARTIAL
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 84076 Basic stats: COMPLETE Column stats: PARTIAL
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 84076 Basic stats: COMPLETE Column stats: PARTIAL
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query30
explain with customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return &gt; (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = &apos;GA&apos; and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return limit 100

</samplerData>
</sample>
<sample t="4986" lt="4974" ts="1600984755635" s="true" lb="query31" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="44664" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215910_90617205-6e53-4f67-a692-dff7f204a252:238
      Edges:
        Map 1 &lt;- Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 11 &lt;- Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 13 &lt;- Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 3 &lt;- Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 5 &lt;- Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 9 &lt;- Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE), Reducer 12 (BROADCAST_EDGE), Reducer 14 (BROADCAST_EDGE), Reducer 2 (BROADCAST_EDGE)
        Reducer 12 &lt;- Map 11 (SIMPLE_EDGE)
        Reducer 14 &lt;- Map 13 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Reducer 4 (BROADCAST_EDGE), Reducer 6 (BROADCAST_EDGE)
        Reducer 4 &lt;- Map 3 (SIMPLE_EDGE)
        Reducer 6 &lt;- Map 5 (SIMPLE_EDGE)
      DagName: zabetak_20200924215910_90617205-6e53-4f67-a692-dff7f204a252:238
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_407_container, bigKeyColName:ws_bill_addr_sk, smallTablePos:1, keyRatio:0.05037635658848761
                  Statistics: Num rows: 7198162681 Data size: 921256764992 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 7197262394 Data size: 921141541816 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_addr_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197262394 Data size: 921141541816 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 362617210 Data size: 43406020584 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col5
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 362617210 Data size: 76048770868 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col5 (type: varchar(30))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 575140 Data size: 120779400 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: varchar(30))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: varchar(30))
                              Statistics: Num rows: 575140 Data size: 120779400 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_415_container, bigKeyColName:ss_addr_sk, smallTablePos:1, keyRatio:0.04919520560276402
                  Statistics: Num rows: 27503885621 Data size: 3442719162032 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 26855655526 Data size: 3361578838760 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_addr_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855655526 Data size: 3361578838760 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 1353059308 Data size: 86422048392 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col5
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 1353059308 Data size: 213261003480 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col5 (type: varchar(30))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 1609620 Data size: 338020200 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: varchar(30))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: varchar(30))
                              Statistics: Num rows: 1609620 Data size: 338020200 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_417_container, bigKeyColName:ss_addr_sk, smallTablePos:1, keyRatio:0.04919520560276402
                  Statistics: Num rows: 27503885621 Data size: 3442719162032 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 26855655526 Data size: 3361578838760 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_addr_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855655526 Data size: 3361578838760 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 1353059308 Data size: 86422048392 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col5
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 1353059308 Data size: 213261003480 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col5 (type: varchar(30))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 1609620 Data size: 338020200 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: varchar(30))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: varchar(30))
                              Statistics: Num rows: 1609620 Data size: 338020200 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_409_container, bigKeyColName:ws_bill_addr_sk, smallTablePos:1, keyRatio:0.05037635658848761
                  Statistics: Num rows: 7198162681 Data size: 921256764992 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 7197262394 Data size: 921141541816 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_addr_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197262394 Data size: 921141541816 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 362617210 Data size: 43406020584 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col5
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 362617210 Data size: 76048770868 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col5 (type: varchar(30))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 575140 Data size: 120779400 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: varchar(30))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: varchar(30))
                              Statistics: Num rows: 575140 Data size: 120779400 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_411_container, bigKeyColName:ws_bill_addr_sk, smallTablePos:1, keyRatio:0.05037635658848761
                  Statistics: Num rows: 7198162681 Data size: 921256764992 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 7197262394 Data size: 921141541816 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_addr_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197262394 Data size: 921141541816 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 362617210 Data size: 43406020584 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col5
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 362617210 Data size: 76048770868 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col5 (type: varchar(30))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 575140 Data size: 120779400 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: varchar(30))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: varchar(30))
                              Statistics: Num rows: 575140 Data size: 120779400 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (((d_year = 1999) and (d_qoy = 3)) or ((d_year = 1999) and (d_qoy = 2)) or ((d_year = 1999) and (d_qoy = 1))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1999) and (d_qoy = 3)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 5
                  Filter Operator
                    predicate: ((d_year = 1999) and (d_qoy = 2)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: ((d_year = 1999) and (d_qoy = 1)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 3
                  Filter Operator
                    predicate: ((d_year = 1999) and (d_qoy = 2)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 9
                  Filter Operator
                    predicate: ((d_year = 1999) and (d_qoy = 1)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 11
                  Filter Operator
                    predicate: ((d_year = 1999) and (d_qoy = 3)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: ca_county is not null (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ca_county is not null (type: boolean)
                    Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), ca_county (type: varchar(30))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(30))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(30))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(30))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(30))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(30))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3445000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_413_container, bigKeyColName:ss_addr_sk, smallTablePos:1, keyRatio:0.04919520560276402
                  Statistics: Num rows: 27503885621 Data size: 3442719162032 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 26855655526 Data size: 3361578838760 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_addr_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855655526 Data size: 3361578838760 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 1353059308 Data size: 86422048392 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col5
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 1353059308 Data size: 213261003480 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col5 (type: varchar(30))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 1609620 Data size: 338020200 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: varchar(30))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: varchar(30))
                              Statistics: Num rows: 1609620 Data size: 338020200 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: varchar(30))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1930 Data size: 405300 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 643 Data size: 135030 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: varchar(30))
                      1 _col0 (type: varchar(30))
                    outputColumnNames: _col0, _col1, _col3
                    input vertices:
                      1 Reducer 12
                    Statistics: Num rows: 643 Data size: 207046 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: varchar(30))
                        1 _col0 (type: varchar(30))
                      outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col9
                      input vertices:
                        0 Reducer 2
                      Statistics: Num rows: 643 Data size: 423094 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: ((_col1 / _col3) &gt; (_col7 / _col9)) (type: boolean)
                        Statistics: Num rows: 214 Data size: 140812 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col6 (type: varchar(30))
                            1 _col0 (type: varchar(30))
                          outputColumnNames: _col1, _col3, _col5, _col6, _col7, _col9, _col11
                          input vertices:
                            1 Reducer 14
                          Statistics: Num rows: 214 Data size: 164780 Basic stats: COMPLETE Column stats: COMPLETE
                          Filter Operator
                            predicate: ((_col5 / _col1) &gt; (_col11 / _col7)) (type: boolean)
                            Statistics: Num rows: 71 Data size: 54670 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: _col6 (type: varchar(30)), 1999 (type: int), (_col1 / _col3) (type: decimal(37,20)), (_col7 / _col9) (type: decimal(37,20)), (_col5 / _col1) (type: decimal(37,20)), (_col11 / _col7) (type: decimal(37,20))
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                              Statistics: Num rows: 71 Data size: 39050 Basic stats: COMPLETE Column stats: COMPLETE
                              File Output Operator
                                compressed: false
                                Statistics: Num rows: 71 Data size: 39050 Basic stats: COMPLETE Column stats: COMPLETE
                                table:
                                    input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                                    output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                                    serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: varchar(30))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1930 Data size: 405300 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 643 Data size: 135030 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: varchar(30))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: varchar(30))
                    Statistics: Num rows: 643 Data size: 135030 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(17,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: varchar(30))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1930 Data size: 405300 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: varchar(30))
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: varchar(30))
                  Statistics: Num rows: 1930 Data size: 405300 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col1 (type: decimal(17,2))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: varchar(30))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1930 Data size: 405300 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 643 Data size: 135030 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: varchar(30))
                      1 _col0 (type: varchar(30))
                    outputColumnNames: _col1, _col2, _col3
                    input vertices:
                      1 Reducer 4
                    Statistics: Num rows: 643 Data size: 207046 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: varchar(30))
                        1 _col0 (type: varchar(30))
                      outputColumnNames: _col1, _col2, _col3, _col5
                      input vertices:
                        1 Reducer 6
                      Statistics: Num rows: 643 Data size: 279062 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col2 (type: varchar(30))
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col2 (type: varchar(30))
                        Statistics: Num rows: 643 Data size: 279062 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col5 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: varchar(30))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1930 Data size: 405300 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 643 Data size: 135030 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: varchar(30))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: varchar(30))
                    Statistics: Num rows: 643 Data size: 135030 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(17,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: varchar(30))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1930 Data size: 405300 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: varchar(30))
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: varchar(30))
                  Statistics: Num rows: 1930 Data size: 405300 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col1 (type: decimal(17,2))

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query31
explain with ss as (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales from store_sales,date_dim,customer_address where ss_sold_date_sk = d_date_sk and ss_addr_sk=ca_address_sk group by ca_county,d_qoy, d_year), ws as (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales from web_sales,date_dim,customer_address where ws_sold_date_sk = d_date_sk and ws_bill_addr_sk=ca_address_sk group by ca_county,d_qoy, d_year) select ss1.ca_county ,ss1.d_year ,ws2.web_sales/ws1.web_sales web_q1_q2_increase ,ss2.store_sales/ss1.store_sales store_q1_q2_increase ,ws3.web_sales/ws2.web_sales web_q2_q3_increase ,ss3.store_sales/ss2.store_sales store_q2_q3_increase from ss ss1 ,ss ss2 ,ss ss3 ,ws ws1 ,ws ws2 ,ws ws3 where ss1.d_qoy = 1 and ss1.d_year = 1999 and ss1.ca_county = ss2.ca_county and ss2.d_qoy = 2 and ss2.d_year = 1999 and ss2.ca_county = ss3.ca_county and ss3.d_qoy = 3 and ss3.d_year = 1999 and ss1.ca_county = ws1.ca_county and ws1.d_qoy = 1 and ws1.d_year = 1999 and ws1.ca_county = ws2.ca_county and ws2.d_qoy = 2 and ws2.d_year = 1999 and ws1.ca_county = ws3.ca_county and ws3.d_qoy = 3 and ws3.d_year =1999 and case when ws1.web_sales &gt; 0 then ws2.web_sales/ws1.web_sales else null end &gt; case when ss1.store_sales &gt; 0 then ss2.store_sales/ss1.store_sales else null end and case when ws2.web_sales &gt; 0 then ws3.web_sales/ws2.web_sales else null end &gt; case when ss2.store_sales &gt; 0 then ss3.store_sales/ss2.store_sales else null end order by ss1.d_year

</samplerData>
</sample>
<sample t="2457" lt="2450" ts="1600984758094" s="true" lb="query32" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="17329" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215915_495bdf03-7f46-46f4-94a3-a909639108b7:239
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
        Map 5 &lt;- Map 4 (BROADCAST_EDGE), Reducer 2 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Map 1 (BROADCAST_EDGE), Map 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215915_495bdf03-7f46-46f4-94a3-a909639108b7:239
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_ext_discount_amt is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_92_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:0.0010098958324626576
                  Statistics: Num rows: 14327953968 Data size: 1829948875648 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_ext_discount_amt is not null (type: boolean)
                    Statistics: Num rows: 14291978679 Data size: 1825354155392 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_item_sk (type: bigint), cs_ext_discount_amt (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 14291978679 Data size: 1825354155392 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 14469741 Data size: 231515968 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col3
                          input vertices:
                            1 Map 4
                          Statistics: Num rows: 1607639 Data size: 12861224 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col3 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col3 (type: bigint)
                            Statistics: Num rows: 1607639 Data size: 12861224 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(7,2))
                          Select Operator
                            expressions: _col3 (type: bigint)
                            outputColumnNames: _col0
                            Statistics: Num rows: 1607639 Data size: 25722224 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                null sort order: 
                                sort order: 
                                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_manufact_id = 66) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 4820000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_manufact_id = 66) (type: boolean)
                    Statistics: Num rows: 407 Data size: 4884 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 407 Data size: 3256 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 407 Data size: 3256 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-03-29 00:00:00&apos; AND TIMESTAMP&apos;2002-06-27 00:00:00&apos; or CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-03-29 00:00:00&apos; AND TIMESTAMP&apos;2002-06-27 00:00:00&apos;) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-03-29 00:00:00&apos; AND TIMESTAMP&apos;2002-06-27 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-03-29 00:00:00&apos; AND TIMESTAMP&apos;2002-06-27 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 5
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_item_sk BETWEEN DynamicValue(RS_30_item_i_item_sk_min) AND DynamicValue(RS_30_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_30_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1829948875648 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_item_sk BETWEEN DynamicValue(RS_30_item_i_item_sk_min) AND DynamicValue(RS_30_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_30_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14327953968 Data size: 1829948875648 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_item_sk (type: bigint), cs_ext_discount_amt (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 14327953968 Data size: 1829948875648 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 1591885904 Data size: 186997076224 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), count(_col1)
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 17413151 Data size: 2228883328 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 17413151 Data size: 2228883328 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 6 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 23821 Data size: 3049088 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: CAST( (1.3 * (_col1 / _col2)) AS decimal(14,7)) is not null (type: boolean)
                  Statistics: Num rows: 23821 Data size: 3049088 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint), CAST( (1.3 * (_col1 / _col2)) AS decimal(14,7)) (type: decimal(14,7))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 23821 Data size: 2858520 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col6
                      input vertices:
                        0 Map 1
                      Statistics: Num rows: 23821 Data size: 2668064 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: (_col1 &gt; _col6) (type: boolean)
                        Statistics: Num rows: 7940 Data size: 889392 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col1 (type: decimal(7,2))
                          outputColumnNames: _col1
                          Statistics: Num rows: 7940 Data size: 889392 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
                              value expressions: _col0 (type: decimal(17,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query32
explain select  sum(cs_ext_discount_amt)  as `excess discount amount` from catalog_sales ,item ,date_dim where i_manufact_id = 66 and i_item_sk = cs_item_sk and d_date between &apos;2002-03-29&apos; and (cast(&apos;2002-03-29&apos; as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt &gt; ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between &apos;2002-03-29&apos; and (cast(&apos;2002-03-29&apos; as date) + 90 days) and d_date_sk = cs_sold_date_sk ) limit 100

</samplerData>
</sample>
<sample t="7433" lt="7425" ts="1600984765528" s="true" lb="query33" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="29977" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215918_087593e5-d49f-44ec-a6d3-ea0801eafae1:240
      Edges:
        Map 1 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 11 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 13 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 8 &lt;- Reducer 10 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 12 &lt;- Map 11 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 14 &lt;- Map 13 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924215918_087593e5-d49f-44ec-a6d3-ea0801eafae1:240
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_274_container, bigKeyColName:ss_addr_sk, smallTablePos:1, keyRatio:2.2069608940510507E-8
                  Statistics: Num rows: 27503885621 Data size: 3662750247000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 26855655526 Data size: 3576424082968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_addr_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26855655526 Data size: 3576424082968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 455922163 Data size: 3647377424 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 75987030 Data size: 607896352 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 186755 Data size: 743140 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: int)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 461 Data size: 53472 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: int)
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: int)
                                Statistics: Num rows: 461 Data size: 53472 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_283_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:6.8875151483875845E-6
                  Statistics: Num rows: 14327953968 Data size: 1944284201568 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 14291948793 Data size: 1939398347408 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_addr_sk (type: bigint), cs_item_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291948793 Data size: 1939398347408 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 240915901 Data size: 26530546888 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 40152652 Data size: 798947360 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 98684 Data size: 390856 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: int)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 244 Data size: 28300 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: int)
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: int)
                                Statistics: Num rows: 244 Data size: 28300 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_280_container, bigKeyColName:ws_bill_addr_sk, smallTablePos:1, keyRatio:8.432707440778109E-8
                  Statistics: Num rows: 7198162681 Data size: 978842066440 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 7197262394 Data size: 978719640968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_bill_addr_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 7197262394 Data size: 978719640968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 122186235 Data size: 15531793464 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 20364374 Data size: 2342881648 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 50050 Data size: 196320 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: int)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 125 Data size: 14496 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: int)
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: int)
                                Statistics: Num rows: 125 Data size: 14496 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 1998) and (d_moy = 5)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_moy = 5)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 11
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_gmt_offset = -6) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 3790780736 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_gmt_offset = -6) (type: boolean)
                    Statistics: Num rows: 5416667 Data size: 631796904 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_manufact_id is not null (type: boolean)
                  Statistics: Num rows: 402000 Data size: 4820000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: i_manufact_id is not null (type: boolean)
                    Statistics: Num rows: 400999 Data size: 4807996 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_manufact_id (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 400999 Data size: 4807996 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Reducer 10
                        Statistics: Num rows: 401405 Data size: 4812868 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 401405 Data size: 4812868 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: int)
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 401405 Data size: 4812868 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: int)
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 401405 Data size: 4812868 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_category = &apos;Home                                              &apos;) and i_manufact_id is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 37784000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_category = &apos;Home                                              &apos;) and i_manufact_id is not null) (type: boolean)
                    Statistics: Num rows: 36454 Data size: 3426316 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_manufact_id (type: int)
                      outputColumnNames: i_manufact_id
                      Statistics: Num rows: 36454 Data size: 3426316 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: i_manufact_id (type: int)
                        minReductionHashAggr: 0.97289735
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 988 Data size: 3948 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 988 Data size: 3948 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 988 Data size: 3948 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: int)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: int)
                  Statistics: Num rows: 988 Data size: 3948 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 244 Data size: 28300 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: int)
                  minReductionHashAggr: 0.49879515
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(27,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 125 Data size: 14496 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: int)
                  minReductionHashAggr: 0.49879515
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(27,2))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 461 Data size: 53472 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: int)
                  minReductionHashAggr: 0.49879515
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: int)
                    Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(27,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col1 (type: decimal(27,2))
                  null sort order: z
                  Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Reduce Output Operator
                    key expressions: _col1 (type: decimal(27,2))
                    null sort order: z
                    sort order: +
                    Statistics: Num rows: 415 Data size: 48128 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col0 (type: int)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), KEY.reducesinkkey0 (type: decimal(27,2))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 415 Data size: 48112 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 11596 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 11596 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 3 
            Vertex: Union 3

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query33
explain with ss as ( select i_manufact_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_manufact_id in (select i_manufact_id from item where i_category in (&apos;Home&apos;)) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 5 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id), cs as ( select i_manufact_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_manufact_id               in (select i_manufact_id from item where i_category in (&apos;Home&apos;)) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 5 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id), ws as ( select i_manufact_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_manufact_id               in (select i_manufact_id from item where i_category in (&apos;Home&apos;)) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 5 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_manufact_id) select  i_manufact_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_manufact_id order by total_sales limit 100

</samplerData>
</sample>
<sample t="2968" lt="2961" ts="1600984768498" s="true" lb="query34" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="14858" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215925_44b890eb-3d5e-40bb-aff1-c117a7369cc5:241
      Edges:
        Map 1 &lt;- Reducer 4 (BROADCAST_EDGE)
        Map 3 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 4 &lt;- Map 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924215925_44b890eb-3d5e-40bb-aff1-c117a7369cc5:241
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_92_container, bigKeyColName:c_customer_sk, smallTablePos:1, keyRatio:1.5384615384615385E-8
                  Statistics: Num rows: 65000000 Data size: 23400000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_salutation (type: char(10)), c_first_name (type: char(20)), c_last_name (type: char(30)), c_preferred_cust_flag (type: char(1))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 65000000 Data size: 23400000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col1 (type: bigint)
                      outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col7
                      input vertices:
                        1 Reducer 4
                      Statistics: Num rows: 6 Data size: 2208 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col3 (type: char(30)), _col2 (type: char(20)), _col1 (type: char(10)), _col4 (type: char(1)), _col5 (type: bigint), _col7 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 6 Data size: 2208 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: char(10)), _col3 (type: char(1)), _col4 (type: bigint)
                          null sort order: zzzaz
                          sort order: +++-+
                          Statistics: Num rows: 6 Data size: 2208 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col5 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_91_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:2.0393482133002213E-7
                  Statistics: Num rows: 27503885621 Data size: 1084603370712 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 25605320705 Data size: 1009734316368 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 25605320705 Data size: 1009734316368 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 3491586678 Data size: 97252261864 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col3
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 465544915 Data size: 3724359336 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col3
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 47238244 Data size: 377905960 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: count()
                              keys: _col0 (type: bigint), _col3 (type: bigint)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2
                              Statistics: Num rows: 47238244 Data size: 755811912 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: bigint), _col1 (type: bigint)
                                null sort order: aa
                                sort order: ++
                                Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                                Statistics: Num rows: 47238244 Data size: 755811912 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year) IN (2000, 2001, 2002) and (d_dom BETWEEN 1 AND 3 or d_dom BETWEEN 25 AND 28) and ((d_dom &gt;= 1) or (d_dom &lt;= 3) or (d_dom &gt;= 25) or (d_dom &lt;= 28))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year) IN (2000, 2001, 2002) and (d_dom BETWEEN 1 AND 3 or d_dom BETWEEN 25 AND 28) and ((d_dom &gt;= 1) or (d_dom &lt;= 3) or (d_dom &gt;= 25) or (d_dom &lt;= 28))) (type: boolean)
                    Statistics: Num rows: 249 Data size: 3984 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 249 Data size: 1992 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 249 Data size: 1992 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 249 Data size: 1992 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.502008
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 124 Data size: 992 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 124 Data size: 992 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 3
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: ((hd_vehicle_count &gt; 0) and (hd_buy_potential) IN (&apos;&gt;10000         &apos;, &apos;Unknown        &apos;) and CASE WHEN ((hd_vehicle_count &gt; 0)) THEN (((UDFToDouble(hd_dep_count) / UDFToDouble(hd_vehicle_count)) &gt; 1.2D)) ELSE (false) END) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 777600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((hd_vehicle_count &gt; 0) and (hd_buy_potential) IN (&apos;&gt;10000         &apos;, &apos;Unknown        &apos;) and CASE WHEN ((hd_vehicle_count &gt; 0)) THEN (((UDFToDouble(hd_dep_count) / UDFToDouble(hd_vehicle_count)) &gt; 1.2D)) ELSE (false) END) (type: boolean)
                    Statistics: Num rows: 960 Data size: 103680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 960 Data size: 7680 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 960 Data size: 7680 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_county) IN (&apos;Salem County&apos;, &apos;Terrell County&apos;, &apos;Arthur County&apos;, &apos;Oglethorpe County&apos;, &apos;Lunenburg County&apos;, &apos;Perry County&apos;, &apos;Halifax County&apos;, &apos;Sumner County&apos;) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 159000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_county) IN (&apos;Salem County&apos;, &apos;Terrell County&apos;, &apos;Arthur County&apos;, &apos;Oglethorpe County&apos;, &apos;Lunenburg County&apos;, &apos;Perry County&apos;, &apos;Halifax County&apos;, &apos;Sumner County&apos;) (type: boolean)
                    Statistics: Num rows: 152 Data size: 16112 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 152 Data size: 1216 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 152 Data size: 1216 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(30)), KEY.reducesinkkey1 (type: char(20)), KEY.reducesinkkey2 (type: char(10)), KEY.reducesinkkey3 (type: char(1)), KEY.reducesinkkey4 (type: bigint), VALUE._col0 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 6 Data size: 2208 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 6 Data size: 2208 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 35247630 Data size: 563962088 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 35247630 Data size: 563962088 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: _col2 BETWEEN 15L AND 20L (type: boolean)
                    Statistics: Num rows: 6 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col1 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col1 (type: bigint)
                      Statistics: Num rows: 6 Data size: 104 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint), _col2 (type: bigint)

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query34
explain select c_last_name ,c_first_name ,c_salutation ,c_preferred_cust_flag ,ss_ticket_number ,cnt from (select ss_ticket_number ,ss_customer_sk ,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28) and (household_demographics.hd_buy_potential = &apos;&gt;10000&apos; or household_demographics.hd_buy_potential = &apos;Unknown&apos;) and household_demographics.hd_vehicle_count &gt; 0 and (case when household_demographics.hd_vehicle_count &gt; 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end)  &gt; 1.2 and date_dim.d_year in (2000,2000+1,2000+2) and store.s_county in (&apos;Salem County&apos;,&apos;Terrell County&apos;,&apos;Arthur County&apos;,&apos;Oglethorpe County&apos;, &apos;Lunenburg County&apos;,&apos;Perry County&apos;,&apos;Halifax County&apos;,&apos;Sumner County&apos;) group by ss_ticket_number,ss_customer_sk) dn,customer where ss_customer_sk = c_customer_sk and cnt between 15 and 20 order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number

</samplerData>
</sample>
<sample t="4395" lt="4388" ts="1600984772895" s="true" lb="query35" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="27319" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215928_35946ae1-e365-4325-91e8-e5370c3ea600:242
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Reducer 10 (BROADCAST_EDGE), Reducer 8 (BROADCAST_EDGE)
        Map 5 &lt;- Map 6 (BROADCAST_EDGE)
        Map 7 &lt;- Map 6 (BROADCAST_EDGE)
        Map 9 &lt;- Map 6 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE)
      DagName: zabetak_20200924215928_35946ae1-e365-4325-91e8-e5370c3ea600:242
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: c_current_cdemo_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_141_container, bigKeyColName:c_customer_sk, smallTablePos:1, keyRatio:0.009399415384615384
                  Statistics: Num rows: 65000000 Data size: 6611816528 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: c_current_cdemo_sk is not null (type: boolean)
                    Statistics: Num rows: 62727065 Data size: 6380613006 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_cdemo_sk (type: bigint), ca_state (type: char(2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 62727065 Data size: 6380613006 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 62727065 Data size: 17312669940 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Left Semi Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 87850205 Data size: 24246656580 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Left Outer Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col1 (type: bigint)
                            outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8, _col9
                            input vertices:
                              1 Reducer 8
                            Statistics: Num rows: 185460 Data size: 51928800 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Left Outer Join 0 to 1
                              keys:
                                0 _col0 (type: bigint)
                                1 _col1 (type: bigint)
                              outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8, _col9, _col11
                              input vertices:
                                1 Reducer 10
                              Statistics: Num rows: 378308 Data size: 104413008 Basic stats: COMPLETE Column stats: COMPLETE
                              Filter Operator
                                predicate: (_col9 is not null or _col11 is not null) (type: boolean)
                                Statistics: Num rows: 378308 Data size: 104413008 Basic stats: COMPLETE Column stats: COMPLETE
                                Top N Key Operator
                                  sort order: ++++++
                                  keys: _col2 (type: char(2)), _col4 (type: char(1)), _col5 (type: char(1)), _col6 (type: int), _col7 (type: int), _col8 (type: int)
                                  null sort order: zzzzzz
                                  Statistics: Num rows: 378308 Data size: 104413008 Basic stats: COMPLETE Column stats: COMPLETE
                                  top n: 100
                                  Select Operator
                                    expressions: _col2 (type: char(2)), _col4 (type: char(1)), _col5 (type: char(1)), _col6 (type: int), _col7 (type: int), _col8 (type: int), UDFToDouble(_col6) (type: double), (UDFToDouble(_col6) * UDFToDouble(_col6)) (type: double), UDFToDouble(_col7) (type: double), (UDFToDouble(_col7) * UDFToDouble(_col7)) (type: double), UDFToDouble(_col8) (type: double), (UDFToDouble(_col8) * UDFToDouble(_col8)) (type: double)
                                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                                    Statistics: Num rows: 378308 Data size: 104413008 Basic stats: COMPLETE Column stats: COMPLETE
                                    Group By Operator
                                      aggregations: count(), sum(_col3), count(_col3), min(_col3), sum(_col7), sum(_col6), sum(_col4), count(_col4), min(_col4), sum(_col9), sum(_col8), sum(_col5), count(_col5), min(_col5), sum(_col11), sum(_col10)
                                      keys: _col0 (type: char(2)), _col1 (type: char(1)), _col2 (type: char(1)), _col3 (type: int), _col4 (type: int), _col5 (type: int)
                                      minReductionHashAggr: 0.99
                                      mode: hash
                                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21
                                      Statistics: Num rows: 1 Data size: 384 Basic stats: COMPLETE Column stats: COMPLETE
                                      Reduce Output Operator
                                        key expressions: _col0 (type: char(2)), _col1 (type: char(1)), _col2 (type: char(1)), _col3 (type: int), _col4 (type: int), _col5 (type: int)
                                        null sort order: zzzzzz
                                        sort order: ++++++
                                        Map-reduce partition columns: _col0 (type: char(2)), _col1 (type: char(1)), _col2 (type: char(1)), _col3 (type: int), _col4 (type: int), _col5 (type: int)
                                        Statistics: Num rows: 1 Data size: 384 Basic stats: COMPLETE Column stats: COMPLETE
                                        TopN Hash Memory Usage: 0.04
                                        value expressions: _col6 (type: bigint), _col7 (type: bigint), _col8 (type: bigint), _col9 (type: int), _col10 (type: double), _col11 (type: double), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: int), _col15 (type: double), _col16 (type: double), _col17 (type: bigint), _col18 (type: bigint), _col19 (type: int), _col20 (type: double), _col21 (type: double)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  Statistics: Num rows: 1920800 Data size: 364952000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cd_demo_sk (type: bigint), cd_gender (type: char(1)), cd_marital_status (type: char(1)), cd_dep_count (type: int), cd_dep_employed_count (type: int), cd_dep_college_count (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 1920800 Data size: 364952000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 364952000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(1)), _col2 (type: char(1)), _col3 (type: int), _col4 (type: int), _col5 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 434877053936 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 5397548198 Data size: 38117458808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 91033487 Data size: 642878048 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 91033487 Data size: 642878048 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2001) and (d_qoy &lt; 4)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_qoy &lt; 4)) (type: boolean)
                    Statistics: Num rows: 367 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 5
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 9
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 115163423680 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 1446527908 Data size: 11565044944 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 8531160 Data size: 68206952 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 8531160 Data size: 68206952 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_ship_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 228959459440 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_ship_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291978461 Data size: 228384573968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_ship_customer_sk (type: bigint), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 14291978461 Data size: 228384573968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 2852139264 Data size: 22530032704 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 33669412 Data size: 265966320 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 33669412 Data size: 265966320 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 378308 Data size: 2988392 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: true (type: boolean), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 378308 Data size: 4501624 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 378308 Data size: 4501624 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), count(VALUE._col2), min(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), count(VALUE._col7), min(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), count(VALUE._col12), min(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15)
                keys: KEY._col0 (type: char(2)), KEY._col1 (type: char(1)), KEY._col2 (type: char(1)), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21
                Statistics: Num rows: 1 Data size: 384 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(2)), _col1 (type: char(1)), _col2 (type: char(1)), _col3 (type: int), _col6 (type: bigint), (UDFToDouble(_col7) / _col8) (type: double), _col9 (type: int), power(((_col10 - ((_col11 * _col11) / _col8)) / CASE WHEN ((_col8 = 1L)) THEN (null) ELSE ((_col8 - 1)) END), 0.5) (type: double), _col4 (type: int), (UDFToDouble(_col12) / _col13) (type: double), _col14 (type: int), power(((_col15 - ((_col16 * _col16) / _col13)) / CASE WHEN ((_col13 = 1L)) THEN (null) ELSE ((_col13 - 1)) END), 0.5) (type: double), _col5 (type: int), (UDFToDouble(_col17) / _col18) (type: double), _col19 (type: int), power(((_col20 - ((_col21 * _col21) / _col18)) / CASE WHEN ((_col18 = 1L)) THEN (null) ELSE ((_col18 - 1)) END), 0.5) (type: double)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col10, _col11, _col12, _col13, _col15, _col16, _col17
                  Statistics: Num rows: 1 Data size: 352 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(2)), _col1 (type: char(1)), _col2 (type: char(1)), _col3 (type: int), _col8 (type: int), _col13 (type: int)
                    null sort order: zzzzzz
                    sort order: ++++++
                    Statistics: Num rows: 1 Data size: 352 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col4 (type: bigint), _col5 (type: double), _col6 (type: int), _col7 (type: double), _col10 (type: double), _col11 (type: int), _col12 (type: double), _col15 (type: double), _col16 (type: int), _col17 (type: double)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(2)), KEY.reducesinkkey1 (type: char(1)), KEY.reducesinkkey2 (type: char(1)), KEY.reducesinkkey3 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: double), VALUE._col2 (type: int), VALUE._col3 (type: double), KEY.reducesinkkey4 (type: int), VALUE._col0 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: int), VALUE._col6 (type: double), KEY.reducesinkkey5 (type: int), VALUE._col0 (type: bigint), VALUE._col7 (type: double), VALUE._col8 (type: int), VALUE._col9 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1 Data size: 352 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 352 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 352 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 185460 Data size: 1482768 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: true (type: boolean), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 185460 Data size: 2224608 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 185460 Data size: 2224608 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query35
explain select ca_state, cd_gender, cd_marital_status, cd_dep_count, count(*) cnt1, avg(cd_dep_count), min(cd_dep_count), stddev_samp(cd_dep_count), cd_dep_employed_count, count(*) cnt2, avg(cd_dep_employed_count), min(cd_dep_employed_count), stddev_samp(cd_dep_employed_count), cd_dep_college_count, count(*) cnt3, avg(cd_dep_college_count), min(cd_dep_college_count), stddev_samp(cd_dep_college_count) from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_qoy &lt; 4) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_qoy &lt; 4) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_qoy &lt; 4)) group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count limit 100

</samplerData>
</sample>
<sample t="2931" lt="2924" ts="1600984775827" s="true" lb="query36" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="15847" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215932_012d13c4-8a35-408c-abf7-7fe117f30dad:243
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924215932_012d13c4-8a35-408c-abf7-7fe117f30dad:243
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_74_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:3.482780626707581E-7
                  Statistics: Num rows: 27503885621 Data size: 6670604329688 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 6513515655680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_store_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 26856185846 Data size: 6513515655680 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5397636575 Data size: 1148614343872 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col3
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 1199876206 Data size: 136612420368 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col3, _col8, _col9
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 1199876206 Data size: 345390880212 Basic stats: COMPLETE Column stats: COMPLETE
                            Select Operator
                              expressions: _col9 (type: char(50)), _col8 (type: char(50)), _col3 (type: decimal(7,2)), _col2 (type: decimal(7,2))
                              outputColumnNames: _col0, _col1, _col2, _col3
                              Statistics: Num rows: 1199876206 Data size: 345390880212 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col2), sum(_col3)
                                keys: _col0 (type: char(50)), _col1 (type: char(50)), 0L (type: bigint)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                                Statistics: Num rows: 4410450 Data size: 1825926300 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: bigint)
                                  null sort order: aaa
                                  sort order: +++
                                  Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: bigint)
                                  Statistics: Num rows: 4410450 Data size: 1825926300 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: d1
                  filterExpr: (d_year = 1999) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 1999) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_state) IN (&apos;IN&apos;, &apos;AL&apos;, &apos;MI&apos;, &apos;MN&apos;, &apos;TN&apos;, &apos;LA&apos;, &apos;FL&apos;, &apos;NM&apos;) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 141000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_state) IN (&apos;IN&apos;, &apos;AL&apos;, &apos;MI&apos;, &apos;MN&apos;, &apos;TN&apos;, &apos;LA&apos;, &apos;FL&apos;, &apos;NM&apos;) (type: boolean)
                    Statistics: Num rows: 333 Data size: 31302 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 333 Data size: 2664 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 333 Data size: 2664 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 76380000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_class (type: char(50)), i_category (type: char(50))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 402000 Data size: 76380000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 76380000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50)), _col2 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: char(50)), KEY._col1 (type: char(50)), KEY._col2 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3267 Data size: 1352538 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 3267 Data size: 1352538 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: (grouping(_col4, 1L) + grouping(_col4, 0L)) (type: bigint), CASE WHEN ((grouping(_col4, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(50))) END (type: char(50)), (_col2 / _col3) (type: decimal(37,20))
                    null sort order: aaz
                    sort order: +++
                    Map-reduce partition columns: (grouping(_col4, 1L) + grouping(_col4, 0L)) (type: bigint), CASE WHEN ((grouping(_col4, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(50))) END (type: char(50))
                    Statistics: Num rows: 3267 Data size: 1352538 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: bigint)
        Reducer 3 
            Execution mode: llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: char(50)), VALUE._col1 (type: char(50)), VALUE._col2 (type: decimal(17,2)), VALUE._col3 (type: decimal(17,2)), VALUE._col4 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3267 Data size: 1352538 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: char(50), _col1: char(50), _col2: decimal(17,2), _col3: decimal(17,2), _col4: bigint
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: (_col2 / _col3) ASC NULLS LAST
                        partition by: (grouping(_col4, 1L) + grouping(_col4, 0L)), CASE WHEN ((grouping(_col4, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(50))) END
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: (_col2 / _col3)
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 3267 Data size: 1352538 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: -++
                    keys: (grouping(_col4, 1L) + grouping(_col4, 0L)) (type: bigint), CASE WHEN (((grouping(_col4, 1L) + grouping(_col4, 0L)) = 0L)) THEN (_col0) ELSE (null) END (type: char(50)), rank_window_0 (type: int)
                    null sort order: azz
                    Statistics: Num rows: 3267 Data size: 1352538 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: (_col2 / _col3) (type: decimal(37,20)), _col0 (type: char(50)), _col1 (type: char(50)), (grouping(_col4, 1L) + grouping(_col4, 0L)) (type: bigint), rank_window_0 (type: int), CASE WHEN (((grouping(_col4, 1L) + grouping(_col4, 0L)) = 0L)) THEN (_col0) ELSE (null) END (type: char(50))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 3267 Data size: 1437480 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col3 (type: bigint), _col5 (type: char(50)), _col4 (type: int)
                        null sort order: azz
                        sort order: -++
                        Statistics: Num rows: 3267 Data size: 1437480 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col0 (type: decimal(37,20)), _col1 (type: char(50)), _col2 (type: char(50))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: decimal(37,20)), VALUE._col1 (type: char(50)), VALUE._col2 (type: char(50)), KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey2 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3267 Data size: 1437480 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 44000 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 44000 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query36
explain select sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin ,i_category ,i_class ,grouping(i_category)+grouping(i_class) as lochierarchy ,rank() over ( partition by grouping(i_category)+grouping(i_class), case when grouping(i_class) = 0 then i_category end order by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent from store_sales ,date_dim       d1 ,item ,store where d1.d_year = 1999 and d1.d_date_sk = ss_sold_date_sk and i_item_sk  = ss_item_sk and s_store_sk  = ss_store_sk and s_state in (&apos;IN&apos;,&apos;AL&apos;,&apos;MI&apos;,&apos;MN&apos;, &apos;TN&apos;,&apos;LA&apos;,&apos;FL&apos;,&apos;NM&apos;) group by rollup(i_category,i_class) order by lochierarchy desc ,case when lochierarchy = 0 then i_category end ,rank_within_parent limit 100

</samplerData>
</sample>
<sample t="1619" lt="1613" ts="1600984777448" s="true" lb="query37" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="13526" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215935_318104d0-f8a5-4547-a483-e3454686162b:244
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
        Map 5 &lt;- Map 1 (BROADCAST_EDGE), Reducer 2 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Map 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
      DagName: zabetak_20200924215935_318104d0-f8a5-4547-a483-e3454686162b:244
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.ware_inv_date_2
                  filterExpr: inv_quantity_on_hand BETWEEN 100 AND 500 (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_81_container, bigKeyColName:inv_item_sk, smallTablePos:1, keyRatio:3.0383403648832587E-5
                  Statistics: Num rows: 25211132 Data size: 479011540 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: inv_quantity_on_hand BETWEEN 100 AND 500 (type: boolean)
                    Statistics: Num rows: 1 Data size: 19 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: d_date_sk (type: bigint), inv_item_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1 Data size: 19 Basic stats: COMPLETE Column stats: NONE
                      Select Operator
                        expressions: _col1 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 19 Basic stats: COMPLETE Column stats: NONE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 44 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 44 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 766 Data size: 309623 Basic stats: COMPLETE Column stats: NONE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col3, _col4, _col5
                          input vertices:
                            1 Map 4
                          Statistics: Num rows: 8927 Data size: 71420 Basic stats: COMPLETE Column stats: NONE
                          Reduce Output Operator
                            key expressions: _col2 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col2 (type: bigint)
                            Statistics: Num rows: 8927 Data size: 71420 Basic stats: COMPLETE Column stats: NONE
                            value expressions: _col3 (type: char(16)), _col4 (type: varchar(200)), _col5 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_current_price BETWEEN 39 AND 69 and (i_manufact_id) IN (765, 886, 889, 728)) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 163898432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_current_price BETWEEN 39 AND 69 and (i_manufact_id) IN (765, 886, 889, 728)) (type: boolean)
                    Statistics: Num rows: 697 Data size: 284260 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16)), i_item_desc (type: varchar(200)), i_current_price (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 697 Data size: 281476 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 697 Data size: 281476 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16)), _col2 (type: varchar(200)), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2001-01-16 00:00:00&apos; AND TIMESTAMP&apos;2001-03-17 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2001-01-16 00:00:00&apos; AND TIMESTAMP&apos;2001-03-17 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_item_sk BETWEEN DynamicValue(RS_11_tpcds_bin_partitioned_orc_10000.ware_inv_date_2_inv_item_sk_min) AND DynamicValue(RS_11_tpcds_bin_partitioned_orc_10000.ware_inv_date_2_inv_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_11_tpcds_bin_partitioned_orc_10000.ware_inv_date_2_inv_item_sk_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_83_container, bigKeyColName:cs_item_sk, smallTablePos:0, keyRatio:1.100000023819503
                  Statistics: Num rows: 14399964710 Data size: 115199717680 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_item_sk BETWEEN DynamicValue(RS_11_tpcds_bin_partitioned_orc_10000.ware_inv_date_2_inv_item_sk_min) AND DynamicValue(RS_11_tpcds_bin_partitioned_orc_10000.ware_inv_date_2_inv_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_11_tpcds_bin_partitioned_orc_10000.ware_inv_date_2_inv_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14399964710 Data size: 115199717680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_item_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 14399964710 Data size: 115199717680 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col3, _col4, _col5
                        input vertices:
                          0 Map 1
                        Statistics: Num rows: 15839961524 Data size: 126719692194 Basic stats: COMPLETE Column stats: NONE
                        Top N Key Operator
                          sort order: +++
                          keys: _col3 (type: char(16)), _col4 (type: varchar(200)), _col5 (type: decimal(7,2))
                          null sort order: zaa
                          Statistics: Num rows: 15839961524 Data size: 126719692194 Basic stats: COMPLETE Column stats: NONE
                          top n: 100
                          Group By Operator
                            keys: _col3 (type: char(16)), _col4 (type: varchar(200)), _col5 (type: decimal(7,2))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 15839961524 Data size: 126719692194 Basic stats: COMPLETE Column stats: NONE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: decimal(7,2))
                              null sort order: zaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(16)), _col1 (type: varchar(200)), _col2 (type: decimal(7,2))
                              Statistics: Num rows: 15839961524 Data size: 126719692194 Basic stats: COMPLETE Column stats: NONE
                              TopN Hash Memory Usage: 0.04
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 44 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 44 Basic stats: COMPLETE Column stats: NONE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(16)), KEY._col1 (type: varchar(200)), KEY._col2 (type: decimal(7,2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7919980762 Data size: 63359846097 Basic stats: COMPLETE Column stats: NONE
                Reduce Output Operator
                  key expressions: _col0 (type: char(16))
                  null sort order: z
                  sort order: +
                  Statistics: Num rows: 7919980762 Data size: 63359846097 Basic stats: COMPLETE Column stats: NONE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col1 (type: varchar(200)), _col2 (type: decimal(7,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), VALUE._col0 (type: varchar(200)), VALUE._col1 (type: decimal(7,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7919980762 Data size: 63359846097 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 800 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query37
explain select  i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 39 and 39 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast(&apos;2001-01-16&apos; as date) and (cast(&apos;2001-01-16&apos; as date) +  60 days) and i_manufact_id in (765,886,889,728) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100

</samplerData>
</sample>
<sample t="4366" lt="4357" ts="1600984781815" s="true" lb="query38" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="26717" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215937_ad3ae15d-f0d9-4e15-82fd-af9e07c76a6a:245
      Edges:
        Map 1 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Map 10 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Map 8 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 11 &lt;- Map 10 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Map 8 (SIMPLE_EDGE), Union 3 (CONTAINS)
      DagName: zabetak_20200924215937_ad3ae15d-f0d9-4e15-82fd-af9e07c76a6a:245
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_152_container, bigKeyColName:ss_customer_sk, smallTablePos:1, keyRatio:0.19196890740298356
                  Statistics: Num rows: 27503885621 Data size: 434877053936 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 5279890872 Data size: 332850089032 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col3, _col5, _col6
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 5279890872 Data size: 1246054245792 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col6 (type: char(30)), _col5 (type: char(20)), _col3 (type: date)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 2639945436 Data size: 623027122896 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              null sort order: aaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              Statistics: Num rows: 2639945436 Data size: 623027122896 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_156_container, bigKeyColName:ws_bill_customer_sk, smallTablePos:1, keyRatio:0.19657739533102947
                  Statistics: Num rows: 7198162681 Data size: 115163423680 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 1414996071 Data size: 90552570224 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col3, _col5, _col6
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 1414996071 Data size: 333939072756 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col6 (type: char(30)), _col5 (type: char(20)), _col3 (type: date)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 707498035 Data size: 166969536260 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              null sort order: aaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              Statistics: Num rows: 707498035 Data size: 166969536260 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_month_seq BETWEEN 1186 AND 1197 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4967332 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1186 AND 1197 (type: boolean)
                    Statistics: Num rows: 359 Data size: 24412 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_date (type: date)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 8
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 10
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_first_name (type: char(20)), c_last_name (type: char(30))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_154_container, bigKeyColName:cs_bill_customer_sk, smallTablePos:1, keyRatio:0.19472155195578444
                  Statistics: Num rows: 14327953968 Data size: 228959210704 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 228383829008 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 14291947369 Data size: 228383829008 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 2789961433 Data size: 178270202816 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col3, _col5, _col6
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 2789961433 Data size: 658430898188 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col6 (type: char(30)), _col5 (type: char(20)), _col3 (type: date)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1394980716 Data size: 329215448976 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              null sort order: aaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              Statistics: Num rows: 1394980716 Data size: 329215448976 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 353749017 Data size: 83484768012 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(20)), _col0 (type: char(30)), _col2 (type: date)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 353749017 Data size: 83484768012 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    keys: _col1 (type: char(30)), _col0 (type: char(20)), _col2 (type: date)
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 176874508 Data size: 43157379952 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: count(_col3)
                      keys: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 592803023 Data size: 144643937612 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                        null sort order: aaa
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                        Statistics: Num rows: 592803023 Data size: 144643937612 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: bigint)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1319972718 Data size: 311513561448 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(20)), _col0 (type: char(30)), _col2 (type: date)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1319972718 Data size: 311513561448 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    keys: _col1 (type: char(30)), _col0 (type: char(20)), _col2 (type: date)
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 659986359 Data size: 161036671596 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: count(_col3)
                      keys: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 592803023 Data size: 144643937612 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                        null sort order: aaa
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                        Statistics: Num rows: 592803023 Data size: 144643937612 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: bigint)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 296401511 Data size: 72321968684 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col3 (type: bigint)
                  outputColumnNames: _col3
                  Statistics: Num rows: 296401511 Data size: 2371212088 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (_col3 = 3L) (type: boolean)
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.0
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
                          value expressions: _col0 (type: bigint)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 697490358 Data size: 164607724488 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(20)), _col0 (type: char(30)), _col2 (type: date)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 697490358 Data size: 164607724488 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    keys: _col1 (type: char(30)), _col0 (type: char(20)), _col2 (type: date)
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 348745179 Data size: 85093823676 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: count(_col3)
                      keys: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 592803023 Data size: 144643937612 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                        null sort order: aaa
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                        Statistics: Num rows: 592803023 Data size: 144643937612 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: bigint)
        Union 3 
            Vertex: Union 3

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query38
explain select  count(*) from ( select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 intersect select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 intersect select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1186 and 1186 + 11 ) hot_cust limit 100

</samplerData>
</sample>
<sample t="470" lt="465" ts="1600984782287" s="true" lb="query39a" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="10023" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215941_03e9acb8-bbd3-46ac-a1d8-86d1ebfe324c:246
      Edges:
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Reducer 4 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Map 1 (SIMPLE_EDGE)
      DagName: zabetak_20200924215941_03e9acb8-bbd3-46ac-a1d8-86d1ebfe324c:246
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.ware_inv_date_2
                  filterExpr: (((d_moy = 2) and (d_year = 2000)) or ((d_year = 2000) and (d_moy = 3))) (type: boolean)
                  Statistics: Num rows: 25211132 Data size: 670616156 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((d_moy = 2) and (d_year = 2000)) (type: boolean)
                    Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: w_warehouse_sk (type: bigint), inv_item_sk (type: bigint), inv_quantity_on_hand (type: int), UDFToDouble(inv_quantity_on_hand) (type: double), (UDFToDouble(inv_quantity_on_hand) * UDFToDouble(inv_quantity_on_hand)) (type: double)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col2), count(_col2), sum(_col4), sum(_col3)
                        keys: _col0 (type: bigint), _col1 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: double), _col5 (type: double)
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 3)) (type: boolean)
                    Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: w_warehouse_sk (type: bigint), inv_item_sk (type: bigint), inv_quantity_on_hand (type: int), UDFToDouble(inv_quantity_on_hand) (type: double), (UDFToDouble(inv_quantity_on_hand) * UDFToDouble(inv_quantity_on_hand)) (type: double)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col2), count(_col2), sum(_col4), sum(_col3)
                        keys: _col0 (type: bigint), _col1 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: double), _col5 (type: double)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (false) ELSE (((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3)) &gt; 1.0D)) END (type: boolean)
                  Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col2) / _col3) (type: double), CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (null) ELSE ((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3))) END (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint), _col1 (type: bigint)
                        1 _col0 (type: bigint), _col1 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      input vertices:
                        1 Reducer 4
                      Statistics: Num rows: 1 Data size: 28 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col6 (type: double), _col7 (type: double)
                        null sort order: zzzzzz
                        sort order: ++++++
                        Statistics: Num rows: 1 Data size: 28 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col4 (type: bigint), _col5 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), 2 (type: int), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), 3 (type: int), KEY.reducesinkkey4 (type: double), KEY.reducesinkkey5 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 1 Data size: 28 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 28 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (false) ELSE (((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3)) &gt; 1.0D)) END (type: boolean)
                  Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col2) / _col3) (type: double), CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (null) ELSE ((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3))) END (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col2 (type: double), _col3 (type: double)

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query39a
explain with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =2000 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end &gt; 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk =  inv2.w_warehouse_sk and inv1.d_moy=2 and inv2.d_moy=2+1 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov

</samplerData>
</sample>
<sample t="451" lt="445" ts="1600984782739" s="true" lb="query39b" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="10254" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215942_697aecdf-38ab-482b-a308-a13eac26fe1d:247
      Edges:
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Reducer 4 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Map 1 (SIMPLE_EDGE)
      DagName: zabetak_20200924215942_697aecdf-38ab-482b-a308-a13eac26fe1d:247
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.ware_inv_date_2
                  filterExpr: (((d_moy = 2) and (d_year = 2000)) or ((d_year = 2000) and (d_moy = 3))) (type: boolean)
                  Statistics: Num rows: 25211132 Data size: 670616156 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: ((d_moy = 2) and (d_year = 2000)) (type: boolean)
                    Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: w_warehouse_sk (type: bigint), inv_item_sk (type: bigint), inv_quantity_on_hand (type: int), UDFToDouble(inv_quantity_on_hand) (type: double), (UDFToDouble(inv_quantity_on_hand) * UDFToDouble(inv_quantity_on_hand)) (type: double)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col2), count(_col2), sum(_col4), sum(_col3)
                        keys: _col0 (type: bigint), _col1 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: double), _col5 (type: double)
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 3)) (type: boolean)
                    Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: w_warehouse_sk (type: bigint), inv_item_sk (type: bigint), inv_quantity_on_hand (type: int), UDFToDouble(inv_quantity_on_hand) (type: double), (UDFToDouble(inv_quantity_on_hand) * UDFToDouble(inv_quantity_on_hand)) (type: double)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                      Group By Operator
                        aggregations: sum(_col2), count(_col2), sum(_col4), sum(_col3)
                        keys: _col0 (type: bigint), _col1 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: double), _col5 (type: double)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: (CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (false) ELSE (((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3)) &gt; 1.0D)) END and CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (false) ELSE (((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3)) &gt; 1.5D)) END) (type: boolean)
                  Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col2) / _col3) (type: double), CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (null) ELSE ((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3))) END (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint), _col1 (type: bigint)
                        1 _col0 (type: bigint), _col1 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      input vertices:
                        1 Reducer 4
                      Statistics: Num rows: 1 Data size: 28 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: double), _col3 (type: double), _col6 (type: double), _col7 (type: double)
                        null sort order: zzzzzz
                        sort order: ++++++
                        Statistics: Num rows: 1 Data size: 28 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col4 (type: bigint), _col5 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint), 2 (type: int), KEY.reducesinkkey2 (type: double), KEY.reducesinkkey3 (type: double), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), 3 (type: int), KEY.reducesinkkey4 (type: double), KEY.reducesinkkey5 (type: double)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 1 Data size: 28 Basic stats: COMPLETE Column stats: NONE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 28 Basic stats: COMPLETE Column stats: NONE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                Filter Operator
                  predicate: CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (false) ELSE (((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3)) &gt; 1.0D)) END (type: boolean)
                  Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: bigint), (UDFToDouble(_col2) / _col3) (type: double), CASE WHEN (((UDFToDouble(_col2) / _col3) = 0)) THEN (null) ELSE ((power(((_col4 - ((_col5 * _col5) / _col3)) / CASE WHEN ((_col3 = 1L)) THEN (null) ELSE ((_col3 - 1)) END), 0.5) / (UDFToDouble(_col2) / _col3))) END (type: double)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 1 Data size: 26 Basic stats: COMPLETE Column stats: NONE
                      value expressions: _col2 (type: double), _col3 (type: double)

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query39b
explain with inv as (select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory ,item ,warehouse ,date_dim where inv_item_sk = i_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_year =2000 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end &gt; 1) select inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov from inv inv1,inv inv2 where inv1.i_item_sk = inv2.i_item_sk and inv1.w_warehouse_sk =  inv2.w_warehouse_sk and inv1.d_moy=2 and inv2.d_moy=2+1 and inv1.cov &gt; 1.5 order by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov ,inv2.d_moy,inv2.mean, inv2.cov

</samplerData>
</sample>
<sample t="5384" lt="5377" ts="1600984788124" s="true" lb="query40" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="17912" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215942_3c1eec00-eabb-4ea1-8ee0-3116d2d425fa:248
      Edges:
        Map 1 &lt;- Reducer 7 (BROADCAST_EDGE)
        Map 5 &lt;- Reducer 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 5 (CUSTOM_SIMPLE_EDGE), Map 6 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 7 &lt;- Map 6 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924215942_3c1eec00-eabb-4ea1-8ee0-3116d2d425fa:248
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_warehouse_sk is not null and cs_item_sk BETWEEN DynamicValue(RS_17_item_i_item_sk_min) AND DynamicValue(RS_17_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_17_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 2058906421792 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_warehouse_sk is not null and cs_item_sk BETWEEN DynamicValue(RS_17_item_i_item_sk_min) AND DynamicValue(RS_17_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_17_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14291953079 Data size: 2053733145704 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_warehouse_sk (type: bigint), cs_item_sk (type: bigint), cs_order_number (type: bigint), cs_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 14291953079 Data size: 2053733145704 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint), _col2 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col1 (type: bigint), _col2 (type: bigint)
                        Statistics: Num rows: 14291953079 Data size: 2053733145704 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col3 (type: decimal(7,2)), _col4 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: (cr_item_sk BETWEEN DynamicValue(RS_17_item_i_item_sk_min) AND DynamicValue(RS_17_item_i_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_17_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 181099500848 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_item_sk BETWEEN DynamicValue(RS_17_item_i_item_sk_min) AND DynamicValue(RS_17_item_i_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_17_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 1440033112 Data size: 181099500848 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint), cr_refunded_cash (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1440033112 Data size: 181099500848 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 1440033112 Data size: 181099500848 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_current_price BETWEEN 0.99 AND 1.49 (type: boolean)
                  Statistics: Num rows: 402000 Data size: 88326432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: i_current_price BETWEEN 0.99 AND 1.49 (type: boolean)
                    Statistics: Num rows: 8040 Data size: 1766672 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 8040 Data size: 868320 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8040 Data size: 868320 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16))
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8040 Data size: 64320 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2000-02-17 00:00:00&apos; AND TIMESTAMP&apos;2000-04-17 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2000-02-17 00:00:00&apos; AND TIMESTAMP&apos;2000-04-17 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), (d_date &lt; DATE&apos;2000-03-18&apos;) (type: boolean), (d_date &gt;= DATE&apos;2000-03-18&apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 8116 Data size: 129856 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 129856 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: warehouse
                  Statistics: Num rows: 25 Data size: 2350 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: w_warehouse_sk (type: bigint), w_state (type: char(2))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 25 Data size: 2350 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 25 Data size: 2350 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col3, _col4, _col7
                input vertices:
                  1 Map 5
                Statistics: Num rows: 10846122282991 Data size: 2688859767264624 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col3, _col4, _col7, _col9
                  input vertices:
                    1 Map 6
                  Statistics: Num rows: 216922440812 Data size: 72775070958936 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col4 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col0, _col3, _col7, _col9, _col11, _col12
                    input vertices:
                      1 Map 8
                    Statistics: Num rows: 24100843465 Data size: 7215727860956 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col3, _col7, _col9, _col11, _col12, _col14
                      input vertices:
                        1 Map 9
                      Statistics: Num rows: 24100843465 Data size: 9095880934674 Basic stats: COMPLETE Column stats: COMPLETE
                      Top N Key Operator
                        sort order: ++
                        keys: _col14 (type: char(2)), _col9 (type: char(16))
                        null sort order: zz
                        Statistics: Num rows: 24100843465 Data size: 9095880934674 Basic stats: COMPLETE Column stats: COMPLETE
                        top n: 100
                        Select Operator
                          expressions: _col14 (type: char(2)), _col9 (type: char(16)), CASE WHEN (_col11) THEN ((_col3 - CASE WHEN (_col7 is not null) THEN (_col7) ELSE (0) END)) ELSE (0) END (type: decimal(8,2)), CASE WHEN (_col12) THEN ((_col3 - CASE WHEN (_col7 is not null) THEN (_col7) ELSE (0) END)) ELSE (0) END (type: decimal(8,2))
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 24100843465 Data size: 9095880934674 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2), sum(_col3)
                            keys: _col0 (type: char(2)), _col1 (type: char(16))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 444705996 Data size: 182329458360 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(2)), _col1 (type: char(16))
                              null sort order: zz
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: char(2)), _col1 (type: char(16))
                              Statistics: Num rows: 444705996 Data size: 182329458360 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
                              value expressions: _col2 (type: decimal(18,2)), _col3 (type: decimal(18,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: char(2)), KEY._col1 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 12516 Data size: 5131560 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: char(2)), _col1 (type: char(16))
                  null sort order: zz
                  sort order: ++
                  Statistics: Num rows: 12516 Data size: 5131560 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col2 (type: decimal(18,2)), _col3 (type: decimal(18,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(2)), KEY.reducesinkkey1 (type: char(16)), VALUE._col0 (type: decimal(18,2)), VALUE._col1 (type: decimal(18,2))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 12516 Data size: 5131560 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 41000 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 41000 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query40
explain select w_state ,i_item_id ,sum(case when (cast(d_date as date) &lt; cast (&apos;2000-03-18&apos; as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) &gt;= cast (&apos;2000-03-18&apos; as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk          = cs_item_sk and cs_warehouse_sk    = w_warehouse_sk and cs_sold_date_sk    = d_date_sk and d_date between (cast (&apos;2000-03-18&apos; as date) - 30 days) and (cast (&apos;2000-03-18&apos; as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id limit 100

</samplerData>
</sample>
<sample t="207" lt="200" ts="1600984788333" s="true" lb="query41" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="11956" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215948_0c8900e7-0b9e-4eb1-9284-4942285a4f94:249
      Edges:
        Map 1 &lt;- Reducer 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 5 &lt;- Map 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924215948_0c8900e7-0b9e-4eb1-9284-4942285a4f94:249
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: i1
                  filterExpr: (i_manufact_id BETWEEN 970 AND 1010 and i_manufact is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_43_container, bigKeyColName:i_manufact, smallTablePos:1, keyRatio:7.487562189054727E-4
                  Statistics: Num rows: 402000 Data size: 82808000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_manufact_id BETWEEN 970 AND 1010 and i_manufact is not null) (type: boolean)
                    Statistics: Num rows: 12626 Data size: 2600836 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_manufact (type: char(50)), i_product_name (type: char(50))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 12626 Data size: 2550452 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: char(50))
                          1 _col0 (type: char(50))
                        outputColumnNames: _col1
                        input vertices:
                          1 Reducer 5
                        Statistics: Num rows: 301 Data size: 32207 Basic stats: COMPLETE Column stats: COMPLETE
                        Top N Key Operator
                          sort order: +
                          keys: _col1 (type: char(50))
                          null sort order: z
                          Statistics: Num rows: 301 Data size: 32207 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 100
                          Group By Operator
                            keys: _col1 (type: char(50))
                            minReductionHashAggr: 0.5016611
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 150 Data size: 16050 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(50))
                              null sort order: z
                              sort order: +
                              Map-reduce partition columns: _col0 (type: char(50))
                              Statistics: Num rows: 150 Data size: 16050 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((((i_category = &apos;Women                                             &apos;) and (i_color) IN (&apos;frosted             &apos;, &apos;rose                &apos;) and (i_units) IN (&apos;Lb        &apos;, &apos;Gross     &apos;) and (i_size) IN (&apos;medium              &apos;, &apos;large               &apos;)) or ((i_category = &apos;Women                                             &apos;) and (i_color) IN (&apos;chocolate           &apos;, &apos;black               &apos;) and (i_units) IN (&apos;Box       &apos;, &apos;Dram      &apos;) and (i_size) IN (&apos;economy             &apos;, &apos;petite              &apos;)) or ((i_category = &apos;Men                                               &apos;) and (i_color) IN (&apos;slate               &apos;, &apos;magenta             &apos;) and (i_units) IN (&apos;Carton    &apos;, &apos;Bundle    &apos;) and (i_size) IN (&apos;N/A                 &apos;, &apos;small               &apos;)) or ((i_category = &apos;Men                                               &apos;) and (i_color) IN (&apos;cornflower          &apos;, &apos;firebrick           &apos;) and (i_units) IN (&apos;Pound     &apos;, &apos;Oz        &apos;) and (i_size) IN (&apos;medium              &apos;, &apos;large               &apos;)) or ((i_category = &apos;Women                                             &apos;) and (i_color) IN (&apos;almond              &apos;, &apos;steel               &apos;) and (i_units) IN (&apos;Tsp       &apos;, &apos;Case      &apos;) and (i_size) IN (&apos;medium              &apos;, &apos;large               &apos;)) or ((i_category = &apos;Women                                             &apos;) and (i_color) IN (&apos;purple              &apos;, &apos;aquamarine          &apos;) and (i_units) IN (&apos;Bunch     &apos;, &apos;Gram      &apos;) and (i_size) IN (&apos;economy             &apos;, &apos;petite              &apos;)) or ((i_category = &apos;Men                                               &apos;) and (i_color) IN (&apos;lavender            &apos;, &apos;papaya              &apos;) and (i_units) IN (&apos;Pallet    &apos;, &apos;Cup       &apos;) and (i_size) IN (&apos;N/A                 &apos;, &apos;small               &apos;)) or ((i_category = &apos;Men                                               &apos;) and (i_color) IN (&apos;maroon              &apos;, &apos;cyan                &apos;) and (i_units) IN (&apos;Each      &apos;, &apos;N/A       &apos;) and (i_size) IN (&apos;medium              &apos;, &apos;large               &apos;))) and i_manufact is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 180900000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((((i_category = &apos;Women                                             &apos;) and (i_color) IN (&apos;frosted             &apos;, &apos;rose                &apos;) and (i_units) IN (&apos;Lb        &apos;, &apos;Gross     &apos;) and (i_size) IN (&apos;medium              &apos;, &apos;large               &apos;)) or ((i_category = &apos;Women                                             &apos;) and (i_color) IN (&apos;chocolate           &apos;, &apos;black               &apos;) and (i_units) IN (&apos;Box       &apos;, &apos;Dram      &apos;) and (i_size) IN (&apos;economy             &apos;, &apos;petite              &apos;)) or ((i_category = &apos;Men                                               &apos;) and (i_color) IN (&apos;slate               &apos;, &apos;magenta             &apos;) and (i_units) IN (&apos;Carton    &apos;, &apos;Bundle    &apos;) and (i_size) IN (&apos;N/A                 &apos;, &apos;small               &apos;)) or ((i_category = &apos;Men                                               &apos;) and (i_color) IN (&apos;cornflower          &apos;, &apos;firebrick           &apos;) and (i_units) IN (&apos;Pound     &apos;, &apos;Oz        &apos;) and (i_size) IN (&apos;medium              &apos;, &apos;large               &apos;)) or ((i_category = &apos;Women                                             &apos;) and (i_color) IN (&apos;almond              &apos;, &apos;steel               &apos;) and (i_units) IN (&apos;Tsp       &apos;, &apos;Case      &apos;) and (i_size) IN (&apos;medium              &apos;, &apos;large               &apos;)) or ((i_category = &apos;Women                                             &apos;) and (i_color) IN (&apos;purple              &apos;, &apos;aquamarine          &apos;) and (i_units) IN (&apos;Bunch     &apos;, &apos;Gram      &apos;) and (i_size) IN (&apos;economy             &apos;, &apos;petite              &apos;)) or ((i_category = &apos;Men                                               &apos;) and (i_color) IN (&apos;lavender            &apos;, &apos;papaya              &apos;) and (i_units) IN (&apos;Pallet    &apos;, &apos;Cup       &apos;) and (i_size) IN (&apos;N/A                 &apos;, &apos;small               &apos;)) or ((i_category = &apos;Men                                               &apos;) and (i_color) IN (&apos;maroon              &apos;, &apos;cyan                &apos;) and (i_units) IN (&apos;Each      &apos;, &apos;N/A       &apos;) and (i_size) IN (&apos;medium              &apos;, &apos;large               &apos;))) and i_manufact is not null) (type: boolean)
                    Statistics: Num rows: 144 Data size: 64800 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_manufact (type: char(50))
                      outputColumnNames: i_manufact
                      Statistics: Num rows: 144 Data size: 64800 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        keys: i_manufact (type: char(50))
                        minReductionHashAggr: 0.5
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 72 Data size: 7416 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(50))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: char(50))
                          Statistics: Num rows: 72 Data size: 7416 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 150 Data size: 16050 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: char(50))
                  null sort order: z
                  sort order: +
                  Statistics: Num rows: 150 Data size: 16050 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(50))
                outputColumnNames: _col0
                Statistics: Num rows: 150 Data size: 16050 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 10700 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 10700 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 72 Data size: 7416 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt; 0L) (type: boolean)
                  Statistics: Num rows: 24 Data size: 2472 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: char(50))
                    outputColumnNames: _col0
                    Statistics: Num rows: 24 Data size: 2280 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(50))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(50))
                      Statistics: Num rows: 24 Data size: 2280 Basic stats: COMPLETE Column stats: COMPLETE

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query41
explain select  distinct(i_product_name) from item i1 where i_manufact_id between 970 and 970+40 and (select count(*) as item_cnt from item where (i_manufact = i1.i_manufact and ((i_category = &apos;Women&apos; and (i_color = &apos;frosted&apos; or i_color = &apos;rose&apos;) and (i_units = &apos;Lb&apos; or i_units = &apos;Gross&apos;) and (i_size = &apos;medium&apos; or i_size = &apos;large&apos;) ) or (i_category = &apos;Women&apos; and (i_color = &apos;chocolate&apos; or i_color = &apos;black&apos;) and (i_units = &apos;Box&apos; or i_units = &apos;Dram&apos;) and (i_size = &apos;economy&apos; or i_size = &apos;petite&apos;) ) or (i_category = &apos;Men&apos; and (i_color = &apos;slate&apos; or i_color = &apos;magenta&apos;) and (i_units = &apos;Carton&apos; or i_units = &apos;Bundle&apos;) and (i_size = &apos;N/A&apos; or i_size = &apos;small&apos;) ) or (i_category = &apos;Men&apos; and (i_color = &apos;cornflower&apos; or i_color = &apos;firebrick&apos;) and (i_units = &apos;Pound&apos; or i_units = &apos;Oz&apos;) and (i_size = &apos;medium&apos; or i_size = &apos;large&apos;) ))) or (i_manufact = i1.i_manufact and ((i_category = &apos;Women&apos; and (i_color = &apos;almond&apos; or i_color = &apos;steel&apos;) and (i_units = &apos;Tsp&apos; or i_units = &apos;Case&apos;) and (i_size = &apos;medium&apos; or i_size = &apos;large&apos;) ) or (i_category = &apos;Women&apos; and (i_color = &apos;purple&apos; or i_color = &apos;aquamarine&apos;) and (i_units = &apos;Bunch&apos; or i_units = &apos;Gram&apos;) and (i_size = &apos;economy&apos; or i_size = &apos;petite&apos;) ) or (i_category = &apos;Men&apos; and (i_color = &apos;lavender&apos; or i_color = &apos;papaya&apos;) and (i_units = &apos;Pallet&apos; or i_units = &apos;Cup&apos;) and (i_size = &apos;N/A&apos; or i_size = &apos;small&apos;) ) or (i_category = &apos;Men&apos; and (i_color = &apos;maroon&apos; or i_color = &apos;cyan&apos;) and (i_units = &apos;Each&apos; or i_units = &apos;N/A&apos;) and (i_size = &apos;medium&apos; or i_size = &apos;large&apos;) )))) &gt; 0 order by i_product_name limit 100

</samplerData>
</sample>
<sample t="2152" lt="2146" ts="1600984790487" s="true" lb="query42" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="9517" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215948_fcb63377-be97-4000-bc01-84de9c1a9cde:250
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924215948_fcb63377-be97-4000-bc01-84de9c1a9cde:250
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_48_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.6322188296814108E-4
                  Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 4
                      Statistics: Num rows: 466927013 Data size: 3735416216 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col5, _col6
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 4489236 Data size: 421988260 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1)
                          keys: _col5 (type: int), _col6 (type: char(50))
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 242 Data size: 49852 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: char(50))
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: char(50))
                            Statistics: Num rows: 242 Data size: 49852 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: dt
                  filterExpr: ((d_year = 1998) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_manager_id = 1) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 42604008 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_manager_id = 1) (type: boolean)
                    Statistics: Num rows: 3865 Data size: 409622 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_category_id (type: int), i_category (type: char(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 3865 Data size: 394194 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 3865 Data size: 394194 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 110 Data size: 22660 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: -++
                  keys: _col2 (type: decimal(17,2)), _col0 (type: int), _col1 (type: char(50))
                  null sort order: azz
                  Statistics: Num rows: 110 Data size: 22660 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col0 (type: int), _col1 (type: char(50)), _col2 (type: decimal(17,2))
                    outputColumnNames: _col0, _col1, _col3
                    Statistics: Num rows: 110 Data size: 34980 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col3 (type: decimal(17,2)), _col0 (type: int), _col1 (type: char(50))
                      null sort order: azz
                      sort order: -++
                      Statistics: Num rows: 110 Data size: 34980 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: 1998 (type: int), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: char(50)), KEY.reducesinkkey0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 110 Data size: 23100 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 21000 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 21000 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query42
explain select  dt.d_year ,item.i_category_id ,item.i_category ,sum(ss_ext_sales_price) from 	date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=1998 group by 	dt.d_year ,item.i_category_id ,item.i_category order by       sum(ss_ext_sales_price) desc,dt.d_year ,item.i_category_id ,item.i_category limit 100

</samplerData>
</sample>
<sample t="2162" lt="2156" ts="1600984792649" s="true" lb="query43" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="12777" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215950_dd342c96-80d3-4d2a-a7f3-dd684e94e6b3:251
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924215950_dd342c96-80d3-4d2a-a7f3-dd684e94e6b3:251
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_53_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:0.04912803756601981
                  Statistics: Num rows: 27503885621 Data size: 3442744499344 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3361669960752 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_store_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26856185846 Data size: 3361669960752 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 5397636575 Data size: 722928385564 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col12, _col13
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 1351211926 Data size: 372335258896 Basic stats: COMPLETE Column stats: COMPLETE
                          Top N Key Operator
                            sort order: ++
                            keys: _col13 (type: varchar(50)), _col12 (type: char(16))
                            null sort order: zz
                            Statistics: Num rows: 1351211926 Data size: 372335258896 Basic stats: COMPLETE Column stats: COMPLETE
                            top n: 100
                            Select Operator
                              expressions: _col13 (type: varchar(50)), _col12 (type: char(16)), CASE WHEN (_col4) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col5) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col6) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col7) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col8) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col9) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col10) THEN (_col1) ELSE (null) END (type: decimal(7,2))
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                              Statistics: Num rows: 1351211926 Data size: 372335258896 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8)
                                keys: _col0 (type: varchar(50)), _col1 (type: char(16))
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                                Statistics: Num rows: 6001875 Data size: 5833822500 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: varchar(50)), _col1 (type: char(16))
                                  null sort order: zz
                                  sort order: ++
                                  Map-reduce partition columns: _col0 (type: varchar(50)), _col1 (type: char(16))
                                  Statistics: Num rows: 6001875 Data size: 5833822500 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2)), _col8 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2001) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 37801 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), (d_day_name = &apos;Sunday   &apos;) (type: boolean), (d_day_name = &apos;Monday   &apos;) (type: boolean), (d_day_name = &apos;Tuesday  &apos;) (type: boolean), (d_day_name = &apos;Wednesday&apos;) (type: boolean), (d_day_name = &apos;Thursday &apos;) (type: boolean), (d_day_name = &apos;Friday   &apos;) (type: boolean), (d_day_name = &apos;Saturday &apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 367 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 13212 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_gmt_offset = -6) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 461440 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_gmt_offset = -6) (type: boolean)
                    Statistics: Num rows: 375 Data size: 115388 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_store_id (type: char(16)), s_store_name (type: varchar(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 375 Data size: 73500 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 375 Data size: 73500 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16)), _col2 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
                keys: KEY._col0 (type: varchar(50)), KEY._col1 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 4125 Data size: 4009500 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +++++++++
                  keys: _col0 (type: varchar(50)), _col1 (type: char(16)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2)), _col8 (type: decimal(17,2))
                  null sort order: zzzzzzzzz
                  Statistics: Num rows: 4125 Data size: 4009500 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Reduce Output Operator
                    key expressions: _col0 (type: varchar(50)), _col1 (type: char(16)), _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2)), _col8 (type: decimal(17,2))
                    null sort order: zzzzzzzzz
                    sort order: +++++++++
                    Statistics: Num rows: 4125 Data size: 4009500 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: varchar(50)), KEY.reducesinkkey1 (type: char(16)), KEY.reducesinkkey2 (type: decimal(17,2)), KEY.reducesinkkey3 (type: decimal(17,2)), KEY.reducesinkkey4 (type: decimal(17,2)), KEY.reducesinkkey5 (type: decimal(17,2)), KEY.reducesinkkey6 (type: decimal(17,2)), KEY.reducesinkkey7 (type: decimal(17,2)), KEY.reducesinkkey8 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 4125 Data size: 4009500 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 97200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 97200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query43
explain select  s_store_name, s_store_id, sum(case when (d_day_name=&apos;Sunday&apos;) then ss_sales_price else null end) sun_sales, sum(case when (d_day_name=&apos;Monday&apos;) then ss_sales_price else null end) mon_sales, sum(case when (d_day_name=&apos;Tuesday&apos;) then ss_sales_price else  null end) tue_sales, sum(case when (d_day_name=&apos;Wednesday&apos;) then ss_sales_price else null end) wed_sales, sum(case when (d_day_name=&apos;Thursday&apos;) then ss_sales_price else null end) thu_sales, sum(case when (d_day_name=&apos;Friday&apos;) then ss_sales_price else null end) fri_sales, sum(case when (d_day_name=&apos;Saturday&apos;) then ss_sales_price else null end) sat_sales from date_dim, store_sales, store where d_date_sk = ss_sold_date_sk and s_store_sk = ss_store_sk and s_gmt_offset = -6 and d_year = 2001 group by s_store_name, s_store_id order by s_store_name, s_store_id,sun_sales,mon_sales,tue_sales,wed_sales,thu_sales,fri_sales,sat_sales limit 100

</samplerData>
</sample>
<sample t="2736" lt="2729" ts="1600984795386" s="true" lb="query44" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="22993" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215952_f1385319-99ca-49d1-a159-d10a6af15ed0:252
      Edges:
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Reducer 8 (BROADCAST_EDGE)
        Reducer 3 &lt;- Map 10 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE), Reducer 2 (SIMPLE_EDGE), Reducer 5 (BROADCAST_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 6 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Map 1 (SIMPLE_EDGE), Reducer 7 (BROADCAST_EDGE)
      DagName: zabetak_20200924215952_f1385319-99ca-49d1-a159-d10a6af15ed0:252
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: ss1
                  filterExpr: ((ss_store_sk = 366L) or (ss_cdemo_sk is null and (ss_store_sk = 366L))) (type: boolean)
                  Statistics: Num rows: 28800426268 Data size: 3530865270224 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_store_sk = 366L) (type: boolean)
                    Statistics: Num rows: 37945226 Data size: 4651996536 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_net_profit (type: decimal(7,2))
                      outputColumnNames: ss_item_sk, ss_net_profit
                      Statistics: Num rows: 37945226 Data size: 4651996536 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(ss_net_profit), count(ss_net_profit)
                        keys: ss_item_sk (type: bigint)
                        minReductionHashAggr: 0.98943275
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 18972613 Data size: 2428494464 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 18972613 Data size: 2428494464 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
                  Filter Operator
                    predicate: (ss_cdemo_sk is null and (ss_store_sk = 366L)) (type: boolean)
                    Statistics: Num rows: 1707723 Data size: 26093832 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 1707723 Data size: 26093832 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: true (type: boolean)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1720 Data size: 6880 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: boolean)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: boolean)
                          Statistics: Num rows: 1720 Data size: 6880 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_cdemo_sk is null and (ss_store_sk = 366L)) (type: boolean)
                    Statistics: Num rows: 1707723 Data size: 208748136 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_net_profit (type: decimal(7,2))
                      outputColumnNames: _col1
                      Statistics: Num rows: 1707723 Data size: 208748136 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col1), count(_col1)
                        keys: true (type: boolean)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 13752 Data size: 1705248 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: boolean)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: boolean)
                          Statistics: Num rows: 13752 Data size: 1705248 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: i2
                  Statistics: Num rows: 402000 Data size: 46230000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_product_name (type: char(50))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 46230000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 46230000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: i1
                  Statistics: Num rows: 402000 Data size: 46230000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_product_name (type: char(50))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 46230000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 46230000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 400976 Data size: 51324928 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 is not null and _col2 is not null) (type: boolean)
                  Statistics: Num rows: 400976 Data size: 51324928 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint), (_col1 / _col2) (type: decimal(37,22))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 400976 Data size: 48117120 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 
                        1 
                      outputColumnNames: _col1, _col2, _col3
                      input vertices:
                        0 Reducer 8
                      Statistics: Num rows: 400976 Data size: 93026432 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: (_col3 &gt; _col1) (type: boolean)
                        Statistics: Num rows: 133658 Data size: 31008656 Basic stats: COMPLETE Column stats: COMPLETE
                        Top N Key Operator
                          sort order: +
                          keys: _col3 (type: decimal(37,22))
                          null sort order: z
                          Statistics: Num rows: 133658 Data size: 31008656 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 11
                          Reduce Output Operator
                            key expressions: 0 (type: int), _col3 (type: decimal(37,22))
                            null sort order: az
                            sort order: ++
                            Map-reduce partition columns: 0 (type: int)
                            Statistics: Num rows: 133658 Data size: 31008656 Basic stats: COMPLETE Column stats: COMPLETE
                            TopN Hash Memory Usage: 0.04
                            value expressions: _col2 (type: bigint)
                        Top N Key Operator
                          sort order: -
                          keys: _col3 (type: decimal(37,22))
                          null sort order: a
                          Statistics: Num rows: 133658 Data size: 31008656 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 11
                          Reduce Output Operator
                            key expressions: 0 (type: int), _col3 (type: decimal(37,22))
                            null sort order: aa
                            sort order: +-
                            Map-reduce partition columns: 0 (type: int)
                            Statistics: Num rows: 133658 Data size: 31008656 Basic stats: COMPLETE Column stats: COMPLETE
                            TopN Hash Memory Usage: 0.04
                            value expressions: _col2 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col2 (type: bigint), KEY.reducesinkkey1 (type: decimal(37,22))
                outputColumnNames: _col2, _col3
                Statistics: Num rows: 133658 Data size: 16038960 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col2: bigint, _col3: decimal(37,22)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col3 ASC NULLS LAST
                        partition by: 0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col3
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 133658 Data size: 16038960 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (rank_window_0 &lt; 11) (type: boolean)
                    Statistics: Num rows: 44552 Data size: 5346240 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col2 (type: bigint), rank_window_0 (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 44552 Data size: 534624 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: int)
                          1 _col1 (type: int)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Reducer 5
                        Statistics: Num rows: 44552 Data size: 891040 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col5
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 44552 Data size: 5301688 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col5, _col7
                            input vertices:
                              1 Map 10
                            Statistics: Num rows: 44552 Data size: 9712336 Basic stats: COMPLETE Column stats: COMPLETE
                            Top N Key Operator
                              sort order: +
                              keys: _col1 (type: int)
                              null sort order: z
                              Statistics: Num rows: 44552 Data size: 9712336 Basic stats: COMPLETE Column stats: COMPLETE
                              top n: 100
                              Select Operator
                                expressions: _col1 (type: int), _col5 (type: char(50)), _col7 (type: char(50))
                                outputColumnNames: _col0, _col1, _col2
                                Statistics: Num rows: 44552 Data size: 9712336 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: int)
                                  null sort order: z
                                  sort order: +
                                  Statistics: Num rows: 44552 Data size: 9712336 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col1 (type: char(50)), _col2 (type: char(50))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: int), VALUE._col0 (type: char(50)), VALUE._col1 (type: char(50))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 44552 Data size: 9712336 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 21800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 21800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col2 (type: bigint), KEY.reducesinkkey1 (type: decimal(37,22))
                outputColumnNames: _col2, _col3
                Statistics: Num rows: 133658 Data size: 16038960 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col2: bigint, _col3: decimal(37,22)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col3 DESC NULLS FIRST
                        partition by: 0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col3
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 133658 Data size: 16038960 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (rank_window_0 &lt; 11) (type: boolean)
                    Statistics: Num rows: 44552 Data size: 5346240 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col2 (type: bigint), rank_window_0 (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 44552 Data size: 534624 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: int)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: int)
                        Statistics: Num rows: 44552 Data size: 534624 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: boolean)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  Statistics: Num rows: 1 Data size: 4 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    minReductionHashAggr: 0.0
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint)
        Reducer 7 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (sq_count_check(_col0) &lt;= 1) (type: boolean)
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: boolean)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 124 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (_col1 is not null and _col2 is not null) (type: boolean)
                    Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: (0.9 * (_col1 / _col2)) (type: decimal(38,22))
                      outputColumnNames: _col0
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col1
                        input vertices:
                          0 Reducer 7
                        Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(38,22))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query44
explain select  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing from(select * from (select item_sk,rank() over (order by rank_col asc) rnk from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col from store_sales ss1 where ss_store_sk = 366 group by ss_item_sk having avg(ss_net_profit) &gt; 0.9*(select avg(ss_net_profit) rank_col from store_sales where ss_store_sk = 366 and ss_cdemo_sk is null group by ss_store_sk))V1)V11 where rnk  &lt; 11) asceding, (select * from (select item_sk,rank() over (order by rank_col desc) rnk from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col from store_sales ss1 where ss_store_sk = 366 group by ss_item_sk having avg(ss_net_profit) &gt; 0.9*(select avg(ss_net_profit) rank_col from store_sales where ss_store_sk = 366 and ss_cdemo_sk is null group by ss_store_sk))V2)V21 where rnk  &lt; 11) descending, item i1, item i2 where asceding.rnk = descending.rnk and i1.i_item_sk=asceding.item_sk and i2.i_item_sk=descending.item_sk order by asceding.rnk limit 100

</samplerData>
</sample>
<sample t="2561" lt="2551" ts="1600984797949" s="true" lb="query45" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="20756" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215955_e21374f5-e793-4d79-b1b2-b29b055dbcde:253
      Edges:
        Map 1 &lt;- Reducer 4 (BROADCAST_EDGE)
        Map 3 &lt;- Reducer 12 (BROADCAST_EDGE)
        Map 6 &lt;- Map 10 (BROADCAST_EDGE)
        Reducer 12 &lt;- Map 11 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Map 3 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Map 3 (BROADCAST_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE), Reducer 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Reducer 7 (SIMPLE_EDGE)
        Reducer 9 &lt;- Reducer 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924215955_e21374f5-e793-4d79-b1b2-b29b055dbcde:253
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: c_current_addr_sk is not null (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 1040000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: c_current_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 65000000 Data size: 1040000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_addr_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 65000000 Data size: 1040000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Reducer 4
                        Statistics: Num rows: 65000000 Data size: 1560000000 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col1 (type: bigint)
                          Statistics: Num rows: 65000000 Data size: 1560000000 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint), _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 1998) and (d_qoy = 1)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_qoy = 1)) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 6
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_item_sk) IN (2L, 3L, 5L, 7L, 11L, 13L, 17L, 19L, 23L, 29L) and i_item_id is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_item_sk) IN (2L, 3L, 5L, 7L, 11L, 13L, 17L, 19L, 23L, 29L) and i_item_id is not null) (type: boolean)
                    Statistics: Num rows: 10 Data size: 1080 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_id (type: char(16))
                      outputColumnNames: i_item_id
                      Statistics: Num rows: 10 Data size: 1080 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: i_item_id (type: char(16))
                        minReductionHashAggr: 0.5
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 5 Data size: 500 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(16))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: char(16))
                          Statistics: Num rows: 5 Data size: 500 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 3216000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_item_sk) IN (2L, 3L, 5L, 7L, 11L, 13L, 17L, 19L, 23L, 29L) (type: boolean)
                    Statistics: Num rows: 10 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 10 Data size: 80 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.9
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Left Outer Join 0 to 1
                      keys:
                        0 _col1 (type: char(16))
                        1 _col0 (type: char(16))
                      outputColumnNames: _col0, _col3
                      input vertices:
                        1 Reducer 12
                      Statistics: Num rows: 402009 Data size: 3216112 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402009 Data size: 3216112 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  Statistics: Num rows: 32500000 Data size: 6337500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ca_address_sk (type: bigint), ca_county (type: varchar(30)), ca_zip (type: char(10))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 32500000 Data size: 6337500000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 6337500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(30)), _col2 (type: char(10))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 978842154136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 978720120768 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_bill_customer_sk (type: bigint), ws_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 7197265278 Data size: 978720120768 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 10
                        Statistics: Num rows: 362617356 Data size: 46307064528 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col1 (type: bigint)
                          Statistics: Num rows: 362617356 Data size: 46307064528 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint), _col2 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 5 Data size: 500 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), true (type: boolean)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 5 Data size: 520 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(16))
                    Statistics: Num rows: 5 Data size: 520 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: boolean)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col4, _col5
                input vertices:
                  1 Map 5
                Statistics: Num rows: 65000000 Data size: 13195000000 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 65000000 Data size: 13195000000 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col2 (type: bigint), _col4 (type: varchar(30)), _col5 (type: char(10))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col4, _col5, _col6, _col8
                input vertices:
                  0 Reducer 2
                Statistics: Num rows: 362617356 Data size: 114123688420 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col6 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2, _col4, _col5, _col8, _col16
                  input vertices:
                    1 Map 3
                  Statistics: Num rows: 362617356 Data size: 112671611000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col8 (type: decimal(7,2)), _col4 (type: varchar(30)), _col5 (type: char(10)), _col2 (type: bigint), _col16 (type: boolean)
                    outputColumnNames: _col2, _col7, _col8, _col14, _col16
                    Statistics: Num rows: 362617356 Data size: 112671611000 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (((_col14 &lt;&gt; 0L) and _col16 is not null) or (substr(_col8, 1, 5)) IN (&apos;85669&apos;, &apos;86197&apos;, &apos;88274&apos;, &apos;83405&apos;, &apos;86475&apos;, &apos;85392&apos;, &apos;85460&apos;, &apos;80348&apos;, &apos;81792&apos;)) (type: boolean)
                      Statistics: Num rows: 362617356 Data size: 112671611000 Basic stats: COMPLETE Column stats: COMPLETE
                      Top N Key Operator
                        sort order: ++
                        keys: _col8 (type: char(10)), _col7 (type: varchar(30))
                        null sort order: zz
                        Statistics: Num rows: 362617356 Data size: 112671611000 Basic stats: COMPLETE Column stats: COMPLETE
                        top n: 100
                        Select Operator
                          expressions: _col2 (type: decimal(7,2)), _col7 (type: varchar(30)), _col8 (type: char(10))
                          outputColumnNames: _col2, _col7, _col8
                          Statistics: Num rows: 362617356 Data size: 112671611000 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2)
                            keys: _col8 (type: char(10)), _col7 (type: varchar(30))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 362617356 Data size: 108422589444 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(10)), _col1 (type: varchar(30))
                              null sort order: zz
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: char(10)), _col1 (type: varchar(30))
                              Statistics: Num rows: 362617356 Data size: 108422589444 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
                              value expressions: _col2 (type: decimal(17,2))
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(10)), KEY._col1 (type: varchar(30))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 18408340 Data size: 5504093660 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: char(10)), _col1 (type: varchar(30))
                  null sort order: zz
                  sort order: ++
                  Statistics: Num rows: 18408340 Data size: 5504093660 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col2 (type: decimal(17,2))
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(10)), KEY.reducesinkkey1 (type: varchar(30)), VALUE._col0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 18408340 Data size: 5504093660 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 29900 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 29900 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query45
explain select  ca_zip, ca_county, sum(ws_sales_price) from web_sales, customer, customer_address, date_dim, item where ws_bill_customer_sk = c_customer_sk and c_current_addr_sk = ca_address_sk and ws_item_sk = i_item_sk and ( substr(ca_zip,1,5) in (&apos;85669&apos;, &apos;86197&apos;,&apos;88274&apos;,&apos;83405&apos;,&apos;86475&apos;, &apos;85392&apos;, &apos;85460&apos;, &apos;80348&apos;, &apos;81792&apos;) or i_item_id in (select i_item_id from item where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29) ) ) and ws_sold_date_sk = d_date_sk and d_qoy = 1 and d_year = 1998 group by ca_zip, ca_county order by ca_zip, ca_county limit 100

</samplerData>
</sample>
<sample t="4123" lt="4115" ts="1600984802073" s="true" lb="query46" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="20227" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924215957_c96cac1b-3163-4f23-9d30-e68a3783659f:254
      Edges:
        Map 4 &lt;- Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 3 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 3 (CUSTOM_SIMPLE_EDGE), Map 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 2 (CUSTOM_SIMPLE_EDGE), Reducer 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Reducer 7 (SIMPLE_EDGE)
      DagName: zabetak_20200924215957_c96cac1b-3163-4f23-9d30-e68a3783659f:254
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: c_current_addr_sk is not null (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 12740000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: c_current_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 65000000 Data size: 12740000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_addr_sk (type: bigint), c_first_name (type: char(20)), c_last_name (type: char(30))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 65000000 Data size: 12740000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: bigint)
                        Statistics: Num rows: 65000000 Data size: 12740000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col2 (type: char(20)), _col3 (type: char(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_city) IN (&apos;Five Forks&apos;, &apos;Oakland&apos;, &apos;Fairview&apos;, &apos;Winchester&apos;, &apos;Farmington&apos;) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 151500 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_city) IN (&apos;Five Forks&apos;, &apos;Oakland&apos;, &apos;Fairview&apos;, &apos;Winchester&apos;, &apos;Farmington&apos;) (type: boolean)
                    Statistics: Num rows: 47 Data size: 4747 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 47 Data size: 376 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 47 Data size: 376 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: ((hd_vehicle_count = 1) or (hd_dep_count = 0)) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((hd_vehicle_count = 1) or (hd_dep_count = 0)) (type: boolean)
                    Statistics: Num rows: 1920 Data size: 30720 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1920 Data size: 15360 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1920 Data size: 15360 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: current_addr
                  Statistics: Num rows: 32500000 Data size: 3282500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ca_address_sk (type: bigint), ca_city (type: varchar(60))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 32500000 Data size: 3282500000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 3282500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(60))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 3282500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(60))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_addr_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_135_container, bigKeyColName:ss_hdemo_sk, smallTablePos:1, keyRatio:1.5954109395545322E-7
                  Statistics: Num rows: 27503885621 Data size: 7315150431472 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_addr_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 25001837266 Data size: 6649685909208 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_coupon_amt (type: decimal(7,2)), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 25001837266 Data size: 6649685909208 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col7 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                        input vertices:
                          1 Map 9
                        Statistics: Num rows: 4312962973 Data size: 987808397728 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6
                          input vertices:
                            1 Map 10
                          Statistics: Num rows: 135320057 Data size: 1082560704 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col2, _col4, _col5, _col6
                            input vertices:
                              1 Map 11
                            Statistics: Num rows: 36085351 Data size: 288683048 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col2 (type: bigint)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col2 (type: bigint)
                              Statistics: Num rows: 36085351 Data size: 288683048 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col4 (type: bigint), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year) IN (2000, 2001, 2002) and (d_dow) IN (6, 0)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year) IN (2000, 2001, 2002) and (d_dow) IN (6, 0)) (type: boolean)
                    Statistics: Num rows: 315 Data size: 5040 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 315 Data size: 2520 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 315 Data size: 2520 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 315 Data size: 2520 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5015873
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 157 Data size: 1256 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 157 Data size: 1256 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 4
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col3, _col5
                input vertices:
                  1 Map 3
                Statistics: Num rows: 65000000 Data size: 18265000000 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 65000000 Data size: 18265000000 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col2 (type: char(20)), _col3 (type: char(30)), _col5 (type: varchar(60))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col12
                input vertices:
                  1 Map 3
                Statistics: Num rows: 36085351 Data size: 3644620691 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col5), sum(_col6)
                  keys: _col0 (type: bigint), _col12 (type: varchar(60)), _col2 (type: bigint), _col4 (type: bigint)
                  minReductionHashAggr: 0.82791674
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 36085351 Data size: 11727739091 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col1 (type: varchar(60)), _col2 (type: bigint), _col3 (type: bigint)
                    null sort order: aaaa
                    sort order: ++++
                    Map-reduce partition columns: _col0 (type: bigint), _col1 (type: varchar(60)), _col2 (type: bigint), _col3 (type: bigint)
                    Statistics: Num rows: 36085351 Data size: 11727739091 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: varchar(60)), KEY._col2 (type: bigint), KEY._col3 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 36085351 Data size: 11727739091 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col3 (type: bigint), _col0 (type: bigint), _col1 (type: varchar(60)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 36085351 Data size: 11727739083 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 36085351 Data size: 11727739083 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: bigint), _col2 (type: varchar(60)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col2, _col3, _col5, _col6, _col8, _col9, _col10
                input vertices:
                  0 Reducer 2
                Statistics: Num rows: 36085351 Data size: 21579039898 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: (_col5 &lt;&gt; _col8) (type: boolean)
                  Statistics: Num rows: 36085351 Data size: 21579039898 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: +++++
                    keys: _col3 (type: char(30)), _col2 (type: char(20)), _col5 (type: varchar(60)), _col8 (type: varchar(60)), _col6 (type: bigint)
                    null sort order: zzzzz
                    Statistics: Num rows: 36085351 Data size: 21579039898 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: _col3 (type: char(30)), _col2 (type: char(20)), _col5 (type: varchar(60)), _col8 (type: varchar(60)), _col6 (type: bigint), _col9 (type: decimal(17,2)), _col10 (type: decimal(17,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 36085351 Data size: 21579039898 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: varchar(60)), _col3 (type: varchar(60)), _col4 (type: bigint)
                        null sort order: zzzzz
                        sort order: +++++
                        Statistics: Num rows: 36085351 Data size: 21579039898 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2))
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(30)), KEY.reducesinkkey1 (type: char(20)), KEY.reducesinkkey2 (type: varchar(60)), KEY.reducesinkkey3 (type: varchar(60)), KEY.reducesinkkey4 (type: bigint), VALUE._col0 (type: decimal(17,2)), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 36085351 Data size: 21579039898 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 59800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 59800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query46
explain select  c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number ,amt,profit from (select ss_ticket_number ,ss_customer_sk ,ca_city bought_city ,sum(ss_coupon_amt) amt ,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count= 1) and date_dim.d_dow in (6,0) and date_dim.d_year in (2000,2000+1,2000+2) and store.s_city in (&apos;Five Forks&apos;,&apos;Oakland&apos;,&apos;Fairview&apos;,&apos;Winchester&apos;,&apos;Farmington&apos;) group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city &lt;&gt; bought_city order by c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number limit 100

</samplerData>
</sample>
<sample t="2735" lt="2728" ts="1600984804809" s="true" lb="query47" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="30201" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220002_a2ece68b-67fd-467c-8441-247a55ffbbc3:255
      Edges:
        Map 1 &lt;- Map 10 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 3 (BROADCAST_EDGE), Reducer 4 (BROADCAST_EDGE), Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
      DagName: zabetak_20200924220002_a2ece68b-67fd-467c-8441-247a55ffbbc3:255
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3662775584312 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3576519447520 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_store_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26856185846 Data size: 3576519447520 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col5, _col6
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 6294791499 Data size: 780169816328 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col5, _col6, _col8, _col9
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 6294791499 Data size: 1861638737361 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col5, _col6, _col8, _col9, _col11, _col12
                            input vertices:
                              1 Map 10
                            Statistics: Num rows: 6294791499 Data size: 3007290790179 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col5 (type: int), _col6 (type: int), _col8 (type: varchar(50)), _col9 (type: varchar(50)), _col11 (type: char(50)), _col12 (type: char(50))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                              Statistics: Num rows: 3147395749 Data size: 1539076521261 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col4 (type: char(50)), _col5 (type: char(50))
                                null sort order: aaaaaa
                                sort order: ++++++
                                Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col4 (type: char(50)), _col5 (type: char(50))
                                Statistics: Num rows: 3147395749 Data size: 1539076521261 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col6 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_category is not null and i_brand is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 79596000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_category is not null and i_brand is not null) (type: boolean)
                    Statistics: Num rows: 402000 Data size: 79596000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand (type: char(50)), i_category (type: char(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 402000 Data size: 79596000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402000 Data size: 79596000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(50)), _col2 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year) IN (1999, 1998, 2000) and ((d_year = 1999) or (struct(d_year,d_moy)) IN (const struct(1998,12), const struct(2000,1)))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year) IN (1999, 1998, 2000) and ((d_year = 1999) or (struct(d_year,d_moy)) IN (const struct(1998,12), const struct(2000,1)))) (type: boolean)
                    Statistics: Num rows: 428 Data size: 6848 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_year (type: int), d_moy (type: int)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 428 Data size: 6848 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 428 Data size: 6848 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 428 Data size: 3424 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_store_name is not null and s_company_name is not null) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 280500 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_store_name is not null and s_company_name is not null) (type: boolean)
                    Statistics: Num rows: 1500 Data size: 280500 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_store_name (type: varchar(50)), s_company_name (type: varchar(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1500 Data size: 280500 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1500 Data size: 280500 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(50)), _col2 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: varchar(50)), KEY._col3 (type: varchar(50)), KEY._col4 (type: char(50)), KEY._col5 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col0 (type: int), _col1 (type: int)
                  null sort order: aaaazz
                  sort order: ++++++
                  Map-reduce partition columns: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50))
                  Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col6 (type: decimal(17,2))
                Reduce Output Operator
                  key expressions: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col0 (type: int), _col1 (type: int)
                  null sort order: aaaazz
                  sort order: ++++++
                  Map-reduce partition columns: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50))
                  Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col6 (type: decimal(17,2))
                Reduce Output Operator
                  key expressions: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col0 (type: int)
                  null sort order: aaaaa
                  sort order: +++++
                  Map-reduce partition columns: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col0 (type: int)
                  Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col1 (type: int), _col6 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey4 (type: int), KEY.reducesinkkey5 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey3 (type: varchar(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: varchar(50), _col3: varchar(50), _col4: char(50), _col5: char(50), _col6: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col0 ASC NULLS LAST, _col1 ASC NULLS LAST
                        partition by: _col5, _col4, _col2, _col3
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col0, _col1
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: rank_window_0 is not null (type: boolean)
                    Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col6 (type: decimal(17,2)), (rank_window_0 - 1) (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 4309536 Data size: 2090124960 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col5 (type: int)
                        null sort order: aaaaa
                        sort order: +++++
                        Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col5 (type: int)
                        Statistics: Num rows: 4309536 Data size: 2090124960 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col4 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey4 (type: int), KEY.reducesinkkey5 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey3 (type: varchar(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: varchar(50), _col3: varchar(50), _col4: char(50), _col5: char(50), _col6: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col0 ASC NULLS LAST, _col1 ASC NULLS LAST
                        partition by: _col5, _col4, _col2, _col3
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col0, _col1
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: rank_window_0 is not null (type: boolean)
                    Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col6 (type: decimal(17,2)), (rank_window_0 + 1) (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 4309536 Data size: 2090124960 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col5 (type: int)
                        null sort order: aaaaa
                        sort order: +++++
                        Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col5 (type: int)
                        Statistics: Num rows: 4309536 Data size: 2090124960 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col4 (type: decimal(17,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey4 (type: int), VALUE._col0 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey3 (type: varchar(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: varchar(50), _col3: varchar(50), _col4: char(50), _col5: char(50), _col6: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col5 ASC NULLS FIRST, _col4 ASC NULLS FIRST, _col2 ASC NULLS FIRST, _col3 ASC NULLS FIRST, _col0 ASC NULLS FIRST
                        partition by: _col5, _col4, _col2, _col3, _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: avg_window_0
                              arguments: _col6
                              name: avg
                              window function: GenericUDAFAverageEvaluatorDecimal
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: avg_window_0 (type: decimal(21,6)), _col0 (type: int), _col1 (type: int), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col4 (type: char(50)), _col5 (type: char(50)), _col6 (type: decimal(17,2))
                    outputColumnNames: avg_window_0, _col0, _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col0 (type: int), _col1 (type: int)
                      null sort order: aaaazz
                      sort order: ++++++
                      Map-reduce partition columns: _col5 (type: char(50)), _col4 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50))
                      Statistics: Num rows: 4309536 Data size: 2107363104 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: avg_window_0 (type: decimal(21,6)), _col6 (type: decimal(17,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: decimal(21,6)), KEY.reducesinkkey4 (type: int), KEY.reducesinkkey5 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey3 (type: varchar(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 4309536 Data size: 2590031136 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: decimal(21,6), _col1: int, _col2: int, _col3: varchar(50), _col4: varchar(50), _col5: char(50), _col6: char(50), _col7: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 ASC NULLS LAST, _col2 ASC NULLS LAST
                        partition by: _col6, _col5, _col3, _col4
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_1
                              arguments: _col1, _col2
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 4309536 Data size: 2590031136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((_col0 &gt; 0) and rank_window_1 is not null and (_col1 = 1999)) (type: boolean)
                    Statistics: Num rows: 718256 Data size: 431671856 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: rank_window_1 (type: int), _col0 (type: decimal(21,6)), _col1 (type: int), _col2 (type: int), _col3 (type: varchar(50)), _col4 (type: varchar(50)), _col5 (type: char(50)), _col6 (type: char(50)), _col7 (type: decimal(17,2))
                      outputColumnNames: rank_window_1, _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 718256 Data size: 431671856 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: CASE WHEN ((_col0 &gt; 0)) THEN (((abs((_col7 - _col0)) / _col0) &gt; 0.1)) ELSE (false) END (type: boolean)
                        Statistics: Num rows: 359128 Data size: 217272440 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col6 (type: char(50)), _col5 (type: char(50)), _col3 (type: varchar(50)), _col4 (type: varchar(50)), _col1 (type: int), _col2 (type: int), _col7 (type: decimal(17,2)), _col0 (type: decimal(21,6)), rank_window_1 (type: int)
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                          Statistics: Num rows: 359128 Data size: 217272440 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col5 (type: int)
                              1 _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col8 (type: int)
                            outputColumnNames: _col4, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                            input vertices:
                              0 Reducer 4
                            Statistics: Num rows: 359128 Data size: 257494776 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col6 (type: char(50)), _col7 (type: char(50)), _col8 (type: varchar(50)), _col9 (type: varchar(50)), _col14 (type: int)
                                1 _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: varchar(50)), _col3 (type: varchar(50)), _col5 (type: int)
                              outputColumnNames: _col4, _col8, _col10, _col11, _col12, _col13, _col19
                              input vertices:
                                1 Reducer 3
                              Statistics: Num rows: 359128 Data size: 195365632 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: ++
                                keys: (_col12 - _col13) (type: decimal(22,6)), _col12 (type: decimal(17,2))
                                null sort order: zz
                                Statistics: Num rows: 359128 Data size: 195365632 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 100
                                Select Operator
                                  expressions: _col8 (type: varchar(50)), _col10 (type: int), _col11 (type: int), _col13 (type: decimal(21,6)), _col12 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col19 (type: decimal(17,2)), (_col12 - _col13) (type: decimal(22,6))
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                                  Statistics: Num rows: 359128 Data size: 235587968 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col7 (type: decimal(22,6)), _col4 (type: decimal(17,2))
                                    null sort order: zz
                                    sort order: ++
                                    Statistics: Num rows: 359128 Data size: 235587968 Basic stats: COMPLETE Column stats: COMPLETE
                                    TopN Hash Memory Usage: 0.04
                                    value expressions: _col0 (type: varchar(50)), _col1 (type: int), _col2 (type: int), _col3 (type: decimal(21,6)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: varchar(50)), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: decimal(21,6)), KEY.reducesinkkey1 (type: decimal(17,2)), VALUE._col4 (type: decimal(17,2)), VALUE._col5 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 359128 Data size: 235587968 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 65600 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 65600 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query47
explain with v1 as( select i_category, i_brand, s_store_name, s_company_name, d_year, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name, d_year) avg_monthly_sales, rank() over (partition by i_category, i_brand, s_store_name, s_company_name order by d_year, d_moy) rn from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and ( d_year = 1999 or ( d_year = 1999-1 and d_moy =12) or ( d_year = 1999+1 and d_moy =1) ) group by i_category, i_brand, s_store_name, s_company_name, d_year, d_moy), v2 as( select v1.s_store_name ,v1.d_year, v1.d_moy ,v1.avg_monthly_sales ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum from v1, v1 v1_lag, v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1.s_store_name = v1_lag.s_store_name and v1.s_store_name = v1_lead.s_store_name and v1.s_company_name = v1_lag.s_company_name and v1.s_company_name = v1_lead.s_company_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select  * from v2 where  d_year = 1999 and avg_monthly_sales &gt; 0 and case when avg_monthly_sales &gt; 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end &gt; 0.1 order by sum_sales - avg_monthly_sales, sum_sales limit 100

</samplerData>
</sample>
<sample t="3643" lt="3635" ts="1600984808454" s="true" lb="query48" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="13047" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220004_81d6d913-ffad-461d-9708-6641e67e70d5:256
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220004_81d6d913-ffad-461d-9708-6641e67e70d5:256
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_addr_sk is not null and ss_cdemo_sk is not null and ss_store_sk is not null and ((ss_sales_price &gt;= 100) or (ss_sales_price &lt;= 150) or (ss_sales_price &gt;= 50) or (ss_sales_price &lt;= 100) or (ss_sales_price &gt;= 150) or (ss_sales_price &lt;= 200)) and ((ss_net_profit &gt;= 0) or (ss_net_profit &lt;= 2000) or (ss_net_profit &gt;= 150) or (ss_net_profit &lt;= 3000) or (ss_net_profit &gt;= 50) or (ss_net_profit &lt;= 25000))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_66_container, bigKeyColName:ss_addr_sk, smallTablePos:1, keyRatio:9.949139687778082E-7
                  Statistics: Num rows: 27503885621 Data size: 6987708147888 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_addr_sk is not null and ss_cdemo_sk is not null and ss_store_sk is not null and ((ss_sales_price &gt;= 100) or (ss_sales_price &lt;= 150) or (ss_sales_price &gt;= 50) or (ss_sales_price &lt;= 100) or (ss_sales_price &gt;= 150) or (ss_sales_price &lt;= 200)) and ((ss_net_profit &gt;= 0) or (ss_net_profit &lt;= 2000) or (ss_net_profit &gt;= 150) or (ss_net_profit &lt;= 3000) or (ss_net_profit &gt;= 50) or (ss_net_profit &lt;= 25000))) (type: boolean)
                    Statistics: Num rows: 25605197582 Data size: 6505322565708 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_cdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_quantity (type: int), ss_sold_date_sk (type: bigint), ss_net_profit BETWEEN 0 AND 2000 (type: boolean), ss_net_profit BETWEEN 150 AND 3000 (type: boolean), ss_net_profit BETWEEN 50 AND 25000 (type: boolean), ss_sales_price BETWEEN 100 AND 150 (type: boolean), ss_sales_price BETWEEN 50 AND 100 (type: boolean), ss_sales_price BETWEEN 150 AND 200 (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                      Statistics: Num rows: 25605197582 Data size: 1319401313244 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7, _col8, _col9
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 5146209211 Data size: 214364244264 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col8, _col9, _col12, _col13, _col14
                          input vertices:
                            1 Map 4
                          Statistics: Num rows: 436942299 Data size: 15729922776 Basic stats: COMPLETE Column stats: COMPLETE
                          Filter Operator
                            predicate: ((_col12 and _col4) or (_col13 and _col5) or (_col14 and _col6)) (type: boolean)
                            Statistics: Num rows: 327706722 Data size: 11797442004 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col0 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col2, _col7, _col8, _col9, _col16, _col17, _col18, _col19, _col20, _col21
                              input vertices:
                                1 Map 5
                              Statistics: Num rows: 84267448 Data size: 3033628132 Basic stats: COMPLETE Column stats: COMPLETE
                              Filter Operator
                                predicate: ((_col16 and _col17 and _col7) or (_col18 and _col19 and _col8) or (_col20 and _col21 and _col9)) (type: boolean)
                                Statistics: Num rows: 31600293 Data size: 1137610552 Basic stats: COMPLETE Column stats: COMPLETE
                                Select Operator
                                  expressions: _col2 (type: int)
                                  outputColumnNames: _col2
                                  Statistics: Num rows: 31600293 Data size: 1137610552 Basic stats: COMPLETE Column stats: COMPLETE
                                  Group By Operator
                                    aggregations: sum(_col2)
                                    minReductionHashAggr: 0.99
                                    mode: hash
                                    outputColumnNames: _col0
                                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                    Reduce Output Operator
                                      null sort order: 
                                      sort order: 
                                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                      value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 1998) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 1998) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: ((ca_state) IN (&apos;MI&apos;, &apos;GA&apos;, &apos;NH&apos;, &apos;TX&apos;, &apos;KY&apos;, &apos;SD&apos;, &apos;NY&apos;, &apos;OH&apos;, &apos;FL&apos;) and (ca_country = &apos;United States&apos;)) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 6207500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ca_state) IN (&apos;MI&apos;, &apos;GA&apos;, &apos;NH&apos;, &apos;TX&apos;, &apos;KY&apos;, &apos;SD&apos;, &apos;NY&apos;, &apos;OH&apos;, &apos;FL&apos;) and (ca_country = &apos;United States&apos;)) (type: boolean)
                    Statistics: Num rows: 2759434 Data size: 527051894 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), (ca_state) IN (&apos;MI&apos;, &apos;GA&apos;, &apos;NH&apos;) (type: boolean), (ca_state) IN (&apos;TX&apos;, &apos;KY&apos;, &apos;SD&apos;) (type: boolean), (ca_state) IN (&apos;NY&apos;, &apos;OH&apos;, &apos;FL&apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2759434 Data size: 55188680 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2759434 Data size: 55188680 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  filterExpr: ((cd_marital_status) IN (&apos;M&apos;, &apos;W&apos;, &apos;D&apos;) and (cd_education_status) IN (&apos;Unknown             &apos;, &apos;College             &apos;, &apos;Primary             &apos;)) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 359189600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_marital_status) IN (&apos;M&apos;, &apos;W&apos;, &apos;D&apos;) and (cd_education_status) IN (&apos;Unknown             &apos;, &apos;College             &apos;, &apos;Primary             &apos;)) (type: boolean)
                    Statistics: Num rows: 493920 Data size: 92363040 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint), (cd_marital_status = &apos;M&apos;) (type: boolean), (cd_education_status = &apos;Unknown             &apos;) (type: boolean), (cd_marital_status = &apos;W&apos;) (type: boolean), (cd_education_status = &apos;College             &apos;) (type: boolean), (cd_marital_status = &apos;D&apos;) (type: boolean), (cd_education_status = &apos;Primary             &apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 493920 Data size: 15805440 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 493920 Data size: 15805440 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query48
explain select sum (ss_quantity) from store_sales, store, customer_demographics, customer_address, date_dim where s_store_sk = ss_store_sk and  ss_sold_date_sk = d_date_sk and d_year = 1998 and ( ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = &apos;M&apos; and cd_education_status = &apos;Unknown&apos; and ss_sales_price between 100.00 and 150.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = &apos;W&apos; and cd_education_status = &apos;College&apos; and ss_sales_price between 50.00 and 100.00 ) or ( cd_demo_sk = ss_cdemo_sk and cd_marital_status = &apos;D&apos; and cd_education_status = &apos;Primary&apos; and ss_sales_price between 150.00 and 200.00 ) ) and ( ( ss_addr_sk = ca_address_sk and ca_country = &apos;United States&apos; and ca_state in (&apos;MI&apos;, &apos;GA&apos;, &apos;NH&apos;) and ss_net_profit between 0 and 2000 ) or (ss_addr_sk = ca_address_sk and ca_country = &apos;United States&apos; and ca_state in (&apos;TX&apos;, &apos;KY&apos;, &apos;SD&apos;) and ss_net_profit between 150 and 3000 ) or (ss_addr_sk = ca_address_sk and ca_country = &apos;United States&apos; and ca_state in (&apos;NY&apos;, &apos;OH&apos;, &apos;FL&apos;) and ss_net_profit between 50 and 25000 ) )

</samplerData>
</sample>
<sample t="17982" lt="17974" ts="1600984826437" s="true" lb="query49" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="58094" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220008_0f59320d-2ad5-437c-b411-eaf88b8c23d4:257
      Edges:
        Map 1 &lt;- Map 12 (BROADCAST_EDGE)
        Map 13 &lt;- Reducer 11 (BROADCAST_EDGE)
        Map 14 &lt;- Map 12 (BROADCAST_EDGE), Reducer 20 (BROADCAST_EDGE)
        Map 21 &lt;- Map 12 (BROADCAST_EDGE)
        Map 27 &lt;- Reducer 26 (BROADCAST_EDGE)
        Reducer 10 &lt;- Reducer 9 (SIMPLE_EDGE)
        Reducer 11 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
        Reducer 15 &lt;- Map 14 (CUSTOM_SIMPLE_EDGE), Map 19 (CUSTOM_SIMPLE_EDGE)
        Reducer 16 &lt;- Reducer 15 (SIMPLE_EDGE)
        Reducer 17 &lt;- Reducer 16 (SIMPLE_EDGE)
        Reducer 18 &lt;- Reducer 17 (SIMPLE_EDGE), Union 6 (CONTAINS)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 13 (CUSTOM_SIMPLE_EDGE)
        Reducer 20 &lt;- Map 19 (CUSTOM_SIMPLE_EDGE)
        Reducer 22 &lt;- Map 21 (CUSTOM_SIMPLE_EDGE), Map 27 (CUSTOM_SIMPLE_EDGE)
        Reducer 23 &lt;- Reducer 22 (SIMPLE_EDGE)
        Reducer 24 &lt;- Reducer 23 (SIMPLE_EDGE)
        Reducer 25 &lt;- Reducer 24 (SIMPLE_EDGE), Union 8 (CONTAINS)
        Reducer 26 &lt;- Map 21 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE), Union 6 (CONTAINS)
        Reducer 7 &lt;- Union 6 (SIMPLE_EDGE), Union 8 (CONTAINS)
        Reducer 9 &lt;- Union 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924220008_0f59320d-2ad5-437c-b411-eaf88b8c23d4:257
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: ws
                  filterExpr: ((ws_net_profit &gt; 1) and (ws_net_paid &gt; 0) and (ws_quantity &gt; 0)) (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 1813832765972 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ws_net_profit &gt; 1) and (ws_net_paid &gt; 0) and (ws_quantity &gt; 0)) (type: boolean)
                    Statistics: Num rows: 7198162681 Data size: 1813832765972 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_order_number (type: bigint), ws_quantity (type: int), ws_net_paid (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col5
                      Statistics: Num rows: 7198162681 Data size: 1813832765972 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col5 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 12
                        Statistics: Num rows: 122201519 Data size: 16026370868 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 122201519 Data size: 16026370868 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 122201519 Data size: 1955224304 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: ws
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: cs
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 14
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: sts
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 21
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: wr
                  filterExpr: ((wr_return_amt &gt; 10000) and wr_order_number BETWEEN DynamicValue(RS_12_ws_ws_order_number_min) AND DynamicValue(RS_12_ws_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_12_ws_ws_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((wr_return_amt &gt; 10000) and wr_order_number BETWEEN DynamicValue(RS_12_ws_ws_order_number_min) AND DynamicValue(RS_12_ws_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_12_ws_ws_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_item_sk (type: bigint), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: cs
                  filterExpr: ((cs_net_profit &gt; 1) and (cs_net_paid &gt; 0) and (cs_quantity &gt; 0) and cs_order_number BETWEEN DynamicValue(RS_45_cr_cr_order_number_min) AND DynamicValue(RS_45_cr_cr_order_number_max) and in_bloom_filter(cs_order_number, DynamicValue(RS_45_cr_cr_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 3606471063072 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cs_net_profit &gt; 1) and (cs_net_paid &gt; 0) and (cs_quantity &gt; 0) and cs_order_number BETWEEN DynamicValue(RS_45_cr_cr_order_number_min) AND DynamicValue(RS_45_cr_cr_order_number_max) and in_bloom_filter(cs_order_number, DynamicValue(RS_45_cr_cr_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14327953968 Data size: 3606471063072 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_item_sk (type: bigint), cs_order_number (type: bigint), cs_quantity (type: int), cs_net_paid (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col5
                      Statistics: Num rows: 14327953968 Data size: 3606471063072 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col5 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 12
                        Statistics: Num rows: 241522832 Data size: 27707676960 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 241522832 Data size: 27707676960 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: cr
                  filterExpr: (cr_return_amount &gt; 10000) (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_return_amount &gt; 10000) (type: boolean)
                    Statistics: Num rows: 950421854 Data size: 123251502924 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 950421854 Data size: 123251502924 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 950421854 Data size: 123251502924 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
                      Select Operator
                        expressions: _col1 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 950421854 Data size: 15206749664 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1182000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: sts
                  filterExpr: ((ss_net_profit &gt; 1) and (ss_net_paid &gt; 0) and (ss_quantity &gt; 0)) (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 6783266404976 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ss_net_profit &gt; 1) and (ss_net_paid &gt; 0) and (ss_quantity &gt; 0)) (type: boolean)
                    Statistics: Num rows: 27503885621 Data size: 6783266404976 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_net_paid (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col5
                      Statistics: Num rows: 27503885621 Data size: 6783266404976 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col5 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 12
                        Statistics: Num rows: 466927013 Data size: 7470832324 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 466927013 Data size: 7470832324 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 466927013 Data size: 7470832208 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 27 
            Map Operator Tree:
                TableScan
                  alias: sr
                  filterExpr: ((sr_return_amt &gt; 10000) and sr_ticket_number BETWEEN DynamicValue(RS_83_sts_ss_ticket_number_min) AND DynamicValue(RS_83_sts_ss_ticket_number_max) and in_bloom_filter(sr_ticket_number, DynamicValue(RS_83_sts_ss_ticket_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((sr_return_amt &gt; 10000) and sr_ticket_number BETWEEN DynamicValue(RS_83_sts_ss_ticket_number_min) AND DynamicValue(RS_83_sts_ss_ticket_number_max) and in_bloom_filter(sr_ticket_number, DynamicValue(RS_83_sts_ss_ticket_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey3 (type: bigint), VALUE._col0 (type: decimal(35,20)), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 7262 Data size: 1590378 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 21900 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 21900 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col2, _col3, _col9, _col10
                input vertices:
                  1 Map 19
                Statistics: Num rows: 194203534494 Data size: 46602470759892 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col0 (type: bigint), CASE WHEN (_col9 is not null) THEN (_col9) ELSE (0) END (type: int), CASE WHEN (_col2 is not null) THEN (_col2) ELSE (0) END (type: int), CASE WHEN (_col10 is not null) THEN (_col10) ELSE (0) END (type: decimal(7,2)), CASE WHEN (_col3 is not null) THEN (_col3) ELSE (0) END (type: decimal(7,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 194203534494 Data size: 46602470759892 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                    keys: _col0 (type: bigint)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 658078215 Data size: 163203397320 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 658078215 Data size: 163203397320 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 16 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3615 Data size: 896520 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
                  null sort order: az
                  sort order: ++
                  Map-reduce partition columns: 0 (type: int)
                  Statistics: Num rows: 3615 Data size: 896520 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 17 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: decimal(17,2)), VALUE._col4 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3615 Data size: 896520 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: decimal(17,2), _col4: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS LAST
                        partition by: 0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 3615 Data size: 896520 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: rank_window_0 (type: int), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
                    outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 3615 Data size: 896520 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
                      null sort order: az
                      sort order: ++
                      Map-reduce partition columns: 0 (type: int)
                      Statistics: Num rows: 3615 Data size: 896520 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: rank_window_0 (type: int), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 18 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: decimal(17,2)), VALUE._col5 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 3615 Data size: 910980 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS LAST
                        partition by: 0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_1
                              arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 3615 Data size: 910980 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((_col0 &lt;= 10) or (rank_window_1 &lt;= 10)) (type: boolean)
                    Statistics: Num rows: 2410 Data size: 607320 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: &apos;catalog&apos; (type: string), _col1 (type: bigint), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 2410 Data size: 527790 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: string), _col3 (type: int), _col4 (type: int), _col1 (type: bigint), _col2 (type: decimal(35,20))
                        minReductionHashAggr: 0.0
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 4836 Data size: 1059084 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: decimal(35,20))
                          null sort order: aaaaa
                          sort order: +++++
                          Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: decimal(35,20))
                          Statistics: Num rows: 4836 Data size: 1059084 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col2, _col3, _col9, _col10
                input vertices:
                  1 Map 13
                Statistics: Num rows: 2772085180 Data size: 661438234392 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col0 (type: bigint), CASE WHEN (_col9 is not null) THEN (_col9) ELSE (0) END (type: int), CASE WHEN (_col2 is not null) THEN (_col2) ELSE (0) END (type: int), CASE WHEN (_col10 is not null) THEN (_col10) ELSE (0) END (type: decimal(7,2)), CASE WHEN (_col3 is not null) THEN (_col3) ELSE (0) END (type: decimal(7,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 2772085180 Data size: 661438234392 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                    keys: _col0 (type: bigint)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 9405760 Data size: 2332628480 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 9405760 Data size: 2332628480 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 20 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1182000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 22 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col2, _col3, _col9, _col10
                input vertices:
                  1 Map 27
                Statistics: Num rows: 13910645060 Data size: 3272705063540 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col0 (type: bigint), CASE WHEN (_col9 is not null) THEN (_col9) ELSE (0) END (type: int), CASE WHEN (_col2 is not null) THEN (_col2) ELSE (0) END (type: int), CASE WHEN (_col10 is not null) THEN (_col10) ELSE (0) END (type: decimal(7,2)), CASE WHEN (_col3 is not null) THEN (_col3) ELSE (0) END (type: decimal(7,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 13910645060 Data size: 3272705063540 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col1), sum(_col2), sum(_col3), sum(_col4)
                    keys: _col0 (type: bigint)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 46537400 Data size: 11541275200 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 46537400 Data size: 11541275200 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 23 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
                  null sort order: az
                  sort order: ++
                  Map-reduce partition columns: 0 (type: int)
                  Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 24 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: decimal(17,2)), VALUE._col4 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: decimal(17,2), _col4: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS LAST
                        partition by: 0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: rank_window_0 (type: int), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
                    outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
                      null sort order: az
                      sort order: ++
                      Map-reduce partition columns: 0 (type: int)
                      Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: rank_window_0 (type: int), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 25 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: decimal(17,2)), VALUE._col5 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 3640 Data size: 917280 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS LAST
                        partition by: 0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_1
                              arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 3640 Data size: 917280 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((_col0 &lt;= 10) or (rank_window_1 &lt;= 10)) (type: boolean)
                    Statistics: Num rows: 2426 Data size: 611352 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: &apos;store&apos; (type: string), _col1 (type: bigint), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 2426 Data size: 526442 Basic stats: COMPLETE Column stats: COMPLETE
                      Top N Key Operator
                        sort order: +++++
                        keys: _col0 (type: string), _col3 (type: int), _col4 (type: int), _col1 (type: bigint), _col2 (type: decimal(35,20))
                        null sort order: zzzza
                        Statistics: Num rows: 7262 Data size: 1585526 Basic stats: COMPLETE Column stats: COMPLETE
                        top n: 100
                        Group By Operator
                          keys: _col0 (type: string), _col3 (type: int), _col4 (type: int), _col1 (type: bigint), _col2 (type: decimal(35,20))
                          minReductionHashAggr: 0.0
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4
                          Statistics: Num rows: 7262 Data size: 1590378 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: decimal(35,20))
                            null sort order: zzzza
                            sort order: +++++
                            Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: decimal(35,20))
                            Statistics: Num rows: 7262 Data size: 1590378 Basic stats: COMPLETE Column stats: COMPLETE
                            TopN Hash Memory Usage: 0.04
        Reducer 26 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: 0 (type: int), (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) (type: decimal(35,20))
                  null sort order: az
                  sort order: ++
                  Map-reduce partition columns: 0 (type: int)
                  Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: decimal(17,2)), VALUE._col4 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: bigint, _col1: bigint, _col2: bigint, _col3: decimal(17,2), _col4: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4))) ASC NULLS LAST
                        partition by: 0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: (CAST( _col1 AS decimal(15,4)) / CAST( _col2 AS decimal(15,4)))
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: rank_window_0 (type: int), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
                    outputColumnNames: rank_window_0, _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: 0 (type: int), (CAST( _col3 AS decimal(15,4)) / CAST( _col4 AS decimal(15,4))) (type: decimal(35,20))
                      null sort order: az
                      sort order: ++
                      Map-reduce partition columns: 0 (type: int)
                      Statistics: Num rows: 3640 Data size: 902720 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: rank_window_0 (type: int), _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: decimal(17,2)), VALUE._col5 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 3640 Data size: 917280 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4))) ASC NULLS LAST
                        partition by: 0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_1
                              arguments: (CAST( _col4 AS decimal(15,4)) / CAST( _col5 AS decimal(15,4)))
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 3640 Data size: 917280 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((_col0 &lt;= 10) or (rank_window_1 &lt;= 10)) (type: boolean)
                    Statistics: Num rows: 2426 Data size: 611352 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: &apos;web&apos; (type: string), _col1 (type: bigint), (CAST( _col2 AS decimal(15,4)) / CAST( _col3 AS decimal(15,4))) (type: decimal(35,20)), _col0 (type: int), rank_window_1 (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 2426 Data size: 521590 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: string), _col3 (type: int), _col4 (type: int), _col1 (type: bigint), _col2 (type: decimal(35,20))
                        minReductionHashAggr: 0.0
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 4836 Data size: 1059084 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: decimal(35,20))
                          null sort order: aaaaa
                          sort order: +++++
                          Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: decimal(35,20))
                          Statistics: Num rows: 4836 Data size: 1059084 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: bigint), KEY._col4 (type: decimal(35,20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 4836 Data size: 1059084 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: string), _col3 (type: bigint), _col4 (type: decimal(35,20)), _col1 (type: int), _col2 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 4836 Data size: 1059084 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: +++++
                    keys: _col0 (type: string), _col3 (type: int), _col4 (type: int), _col1 (type: bigint), _col2 (type: decimal(35,20))
                    null sort order: zzzza
                    Statistics: Num rows: 7262 Data size: 1585526 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Group By Operator
                      keys: _col0 (type: string), _col3 (type: int), _col4 (type: int), _col1 (type: bigint), _col2 (type: decimal(35,20))
                      minReductionHashAggr: 0.0
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 7262 Data size: 1590378 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: decimal(35,20))
                        null sort order: zzzza
                        sort order: +++++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: int), _col2 (type: int), _col3 (type: bigint), _col4 (type: decimal(35,20))
                        Statistics: Num rows: 7262 Data size: 1590378 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: string), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: bigint), KEY._col4 (type: decimal(35,20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 7262 Data size: 1590378 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: string), _col3 (type: bigint), _col4 (type: decimal(35,20)), _col1 (type: int), _col2 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 7262 Data size: 1590378 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col3 (type: int), _col4 (type: int), _col1 (type: bigint)
                    null sort order: zzzz
                    sort order: ++++
                    Statistics: Num rows: 7262 Data size: 1590378 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col2 (type: decimal(35,20))
        Union 6 
            Vertex: Union 6
        Union 8 
            Vertex: Union 8

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query49
explain select  channel, item, return_ratio, return_rank, currency_rank from (select &apos;web&apos; as channel ,web.item as item ,web.return_ratio as return_ratio ,web.return_rank as return_rank ,web.currency_rank as currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select ws.ws_item_sk as item ,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/ cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio from web_sales ws left outer join web_returns wr on (ws.ws_order_number = wr.wr_order_number and ws.ws_item_sk = wr.wr_item_sk) ,date_dim where wr.wr_return_amt &gt; 10000 and ws.ws_net_profit &gt; 1 and ws.ws_net_paid &gt; 0 and ws.ws_quantity &gt; 0 and ws_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 12 group by ws.ws_item_sk ) in_web ) web where ( web.return_rank &lt;= 10 or web.currency_rank &lt;= 10 ) union select &apos;catalog&apos; as channel ,catalog.item as item ,catalog.return_ratio as return_ratio ,catalog.return_rank as return_rank ,catalog.currency_rank as currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select cs.cs_item_sk as item ,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/ cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio from catalog_sales cs left outer join catalog_returns cr on (cs.cs_order_number = cr.cr_order_number and cs.cs_item_sk = cr.cr_item_sk) ,date_dim where cr.cr_return_amount &gt; 10000 and cs.cs_net_profit &gt; 1 and cs.cs_net_paid &gt; 0 and cs.cs_quantity &gt; 0 and cs_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 12 group by cs.cs_item_sk ) in_cat ) catalog where ( catalog.return_rank &lt;= 10 or catalog.currency_rank &lt;=10 ) union select &apos;store&apos; as channel ,store.item as item ,store.return_ratio as return_ratio ,store.return_rank as return_rank ,store.currency_rank as currency_rank from ( select item ,return_ratio ,currency_ratio ,rank() over (order by return_ratio) as return_rank ,rank() over (order by currency_ratio) as currency_rank from (	select sts.ss_item_sk as item ,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decimal(15,4) )) as return_ratio ,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15,4) )) as currency_ratio from store_sales sts left outer join store_returns sr on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk) ,date_dim where sr.sr_return_amt &gt; 10000 and sts.ss_net_profit &gt; 1 and sts.ss_net_paid &gt; 0 and sts.ss_quantity &gt; 0 and ss_sold_date_sk = d_date_sk and d_year = 2000 and d_moy = 12 group by sts.ss_item_sk ) in_store ) store where  ( store.return_rank &lt;= 10 or store.currency_rank &lt;= 10 ) ) y order by 1,4,5,2 limit 100

</samplerData>
</sample>
<sample t="5253" lt="5242" ts="1600984831693" s="true" lb="query50" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="15887" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220026_a1c3dec0-3898-40fd-a0c0-eeeb74cee392:258
      Edges:
        Map 1 &lt;- Map 2 (BROADCAST_EDGE)
        Map 3 &lt;- Map 1 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 4 &lt;- Map 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924220026_a1c3dec0-3898-40fd-a0c0-eeeb74cee392:258
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: sr_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 2778787720 Data size: 88518497568 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: sr_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 2728449035 Data size: 86914954864 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_customer_sk (type: bigint), sr_ticket_number (type: bigint), sr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2728449035 Data size: 86914954864 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 42248131 Data size: 1013955152 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                          null sort order: aaa
                          sort order: +++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                          Statistics: Num rows: 42248131 Data size: 1013955152 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: d2
                  filterExpr: ((d_year = 1998) and (d_moy = 9)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_moy = 9)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: sr_returned_date_sk (bigint)
                            Target Input: store_returns
                            Partition key expr: sr_returned_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_94_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:11.828759332448506
                  Statistics: Num rows: 27503885621 Data size: 1089788710648 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 26223309636 Data size: 1039048343600 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 26223309636 Data size: 1039048343600 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
                          1 _col0 (type: bigint), _col1 (type: bigint), _col3 (type: bigint)
                        outputColumnNames: _col3, _col7, _col9
                        input vertices:
                          0 Map 1
                        Statistics: Num rows: 325336843718 Data size: 7803143905320 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col7 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col3, _col9, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 325336843718 Data size: 271330927660776 Basic stats: COMPLETE Column stats: COMPLETE
                          Top N Key Operator
                            sort order: ++++++++++
                            keys: _col11 (type: varchar(50)), _col12 (type: int), _col13 (type: varchar(10)), _col14 (type: varchar(60)), _col15 (type: char(15)), _col16 (type: char(10)), _col17 (type: varchar(60)), _col18 (type: varchar(30)), _col19 (type: char(2)), _col20 (type: char(10))
                            null sort order: zzzzzzzzzz
                            Statistics: Num rows: 325336843718 Data size: 271330927660776 Basic stats: COMPLETE Column stats: COMPLETE
                            top n: 100
                            Select Operator
                              expressions: _col11 (type: varchar(50)), _col12 (type: int), _col13 (type: varchar(10)), _col14 (type: varchar(60)), _col15 (type: char(15)), _col16 (type: char(10)), _col17 (type: varchar(60)), _col18 (type: varchar(30)), _col19 (type: char(2)), _col20 (type: char(10)), CASE WHEN (((_col3 - _col9) &lt;= 30L)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col3 - _col9) &gt; 30L) and ((_col3 - _col9) &lt;= 60L))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col3 - _col9) &gt; 60L) and ((_col3 - _col9) &lt;= 90L))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((_col3 - _col9) &gt; 90L) and ((_col3 - _col9) &lt;= 120L))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((_col3 - _col9) &gt; 120L)) THEN (1) ELSE (0) END (type: int)
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                              Statistics: Num rows: 325336843718 Data size: 271330927660776 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14)
                                keys: _col0 (type: varchar(50)), _col1 (type: int), _col2 (type: varchar(10)), _col3 (type: varchar(60)), _col4 (type: char(15)), _col5 (type: char(10)), _col6 (type: varchar(60)), _col7 (type: varchar(30)), _col8 (type: char(2)), _col9 (type: char(10))
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                                Statistics: Num rows: 325336843718 Data size: 279139011909968 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: varchar(50)), _col1 (type: int), _col2 (type: varchar(10)), _col3 (type: varchar(60)), _col4 (type: char(15)), _col5 (type: char(10)), _col6 (type: varchar(60)), _col7 (type: varchar(30)), _col8 (type: char(2)), _col9 (type: char(10))
                                  null sort order: zzzzzzzzzz
                                  sort order: ++++++++++
                                  Map-reduce partition columns: _col0 (type: varchar(50)), _col1 (type: int), _col2 (type: varchar(10)), _col3 (type: varchar(60)), _col4 (type: char(15)), _col5 (type: char(10)), _col6 (type: varchar(60)), _col7 (type: varchar(30)), _col8 (type: char(2)), _col9 (type: char(10))
                                  Statistics: Num rows: 325336843718 Data size: 279139011909968 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 1238964 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_store_name (type: varchar(50)), s_company_id (type: int), s_street_number (type: varchar(10)), s_street_name (type: varchar(60)), s_street_type (type: char(15)), s_suite_number (type: char(10)), s_city (type: varchar(60)), s_county (type: varchar(30)), s_state (type: char(2)), s_zip (type: char(10))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                    Statistics: Num rows: 1500 Data size: 1238964 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 1238964 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(50)), _col2 (type: int), _col3 (type: varchar(10)), _col4 (type: varchar(60)), _col5 (type: char(15)), _col6 (type: char(10)), _col7 (type: varchar(60)), _col8 (type: varchar(30)), _col9 (type: char(2)), _col10 (type: char(10))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4)
                keys: KEY._col0 (type: varchar(50)), KEY._col1 (type: int), KEY._col2 (type: varchar(10)), KEY._col3 (type: varchar(60)), KEY._col4 (type: char(15)), KEY._col5 (type: char(10)), KEY._col6 (type: varchar(60)), KEY._col7 (type: varchar(30)), KEY._col8 (type: char(2)), KEY._col9 (type: char(10))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                Statistics: Num rows: 325336843718 Data size: 279139011909968 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: varchar(50)), _col1 (type: int), _col2 (type: varchar(10)), _col3 (type: varchar(60)), _col4 (type: char(15)), _col5 (type: char(10)), _col6 (type: varchar(60)), _col7 (type: varchar(30)), _col8 (type: char(2)), _col9 (type: char(10))
                  null sort order: zzzzzzzzzz
                  sort order: ++++++++++
                  Statistics: Num rows: 325336843718 Data size: 279139011909968 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col10 (type: bigint), _col11 (type: bigint), _col12 (type: bigint), _col13 (type: bigint), _col14 (type: bigint)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: varchar(50)), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: varchar(10)), KEY.reducesinkkey3 (type: varchar(60)), KEY.reducesinkkey4 (type: char(15)), KEY.reducesinkkey5 (type: char(10)), KEY.reducesinkkey6 (type: varchar(60)), KEY.reducesinkkey7 (type: varchar(30)), KEY.reducesinkkey8 (type: char(2)), KEY.reducesinkkey9 (type: char(10)), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                Statistics: Num rows: 325336843718 Data size: 279139011909968 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 85800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 85800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query50
explain select s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip ,sum(case when (sr_returned_date_sk - ss_sold_date_sk &lt;= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk &gt; 30) and (sr_returned_date_sk - ss_sold_date_sk &lt;= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk &gt; 60) and (sr_returned_date_sk - ss_sold_date_sk &lt;= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk &gt; 90) and (sr_returned_date_sk - ss_sold_date_sk &lt;= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  &gt; 120) then 1 else 0 end)  as `&gt;120 days` from store_sales ,store_returns ,store ,date_dim d1 ,date_dim d2 where d2.d_year = 1998 and d2.d_moy  = 9 and ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_sold_date_sk   = d1.d_date_sk and sr_returned_date_sk   = d2.d_date_sk and ss_customer_sk = sr_customer_sk and ss_store_sk = s_store_sk group by s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip order by s_store_name ,s_company_id ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip limit 100

</samplerData>
</sample>
<sample t="3827" lt="3820" ts="1600984835520" s="true" lb="query51" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="20091" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220031_86f64599-b741-47df-883c-b387c9a929e2:259
      Edges:
        Map 1 &lt;- Map 6 (BROADCAST_EDGE)
        Map 7 &lt;- Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (CUSTOM_SIMPLE_EDGE), Reducer 8 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE)
      DagName: zabetak_20200924220031_86f64599-b741-47df-883c-b387c9a929e2:259
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3447926097536 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3447926097536 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col4
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 5407316333 Data size: 879116412656 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col0 (type: bigint), _col4 (type: date)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 2703658166 Data size: 475843837216 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: date)
                          null sort order: az
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 2703658166 Data size: 475843837216 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_month_seq BETWEEN 1214 AND 1225 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4967332 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1214 AND 1225 (type: boolean)
                    Statistics: Num rows: 359 Data size: 24412 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_date (type: date)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 921264031904 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_item_sk (type: bigint), ws_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7198162681 Data size: 921264031904 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col4
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 1415172503 Data size: 248969569264 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col1)
                        keys: _col0 (type: bigint), _col4 (type: date)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 707586251 Data size: 124535180176 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: date)
                          null sort order: az
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 707586251 Data size: 124535180176 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1351829083 Data size: 237921918608 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: bigint, _col1: date, _col2: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: sum_window_0
                              arguments: _col2
                              name: sum
                              window function: GenericUDAFSumHiveDecimal
                              window frame: ROWS PRECEDING(MAX)~CURRENT
                  Statistics: Num rows: 1351829083 Data size: 237921918608 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: date), sum_window_0 (type: decimal(27,2))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1351829083 Data size: 237921918608 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: date)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: date)
                      Statistics: Num rows: 1351829083 Data size: 237921918608 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col2 (type: decimal(27,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Full Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: date)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: date)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                input vertices:
                  1 Reducer 8
                Statistics: Num rows: 11346535924188 Data size: 3993980645314176 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Reduce Output Operator
                  key expressions: CASE WHEN (_col3 is not null) THEN (_col3) ELSE (_col0) END (type: bigint), CASE WHEN (_col4 is not null) THEN (_col4) ELSE (_col1) END (type: date)
                  null sort order: az
                  sort order: ++
                  Map-reduce partition columns: CASE WHEN (_col3 is not null) THEN (_col3) ELSE (_col0) END (type: bigint)
                  Statistics: Num rows: 11346535924188 Data size: 3993980645314176 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: date), _col2 (type: decimal(27,2)), _col3 (type: bigint), _col4 (type: date), _col5 (type: decimal(27,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: bigint), VALUE._col1 (type: date), VALUE._col2 (type: decimal(27,2)), VALUE._col3 (type: bigint), VALUE._col4 (type: date), VALUE._col5 (type: decimal(27,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 11346535924188 Data size: 3993980645314176 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: bigint, _col1: date, _col2: decimal(27,2), _col3: bigint, _col4: date, _col5: decimal(27,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: CASE WHEN (_col4 is not null) THEN (_col4) ELSE (_col1) END ASC NULLS LAST
                        partition by: CASE WHEN (_col3 is not null) THEN (_col3) ELSE (_col0) END
                        raw input shape:
                        window functions:
                            window function definition
                              alias: max_window_0
                              arguments: _col5
                              name: max
                              window function: GenericUDAFMaxEvaluator
                              window frame: ROWS PRECEDING(MAX)~CURRENT
                            window function definition
                              alias: max_window_1
                              arguments: _col2
                              name: max
                              window function: GenericUDAFMaxEvaluator
                              window frame: ROWS PRECEDING(MAX)~CURRENT
                  Statistics: Num rows: 11346535924188 Data size: 3993980645314176 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (max_window_0 &gt; max_window_1) (type: boolean)
                    Statistics: Num rows: 3782178641396 Data size: 1331326881771392 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++
                      keys: CASE WHEN (_col3 is not null) THEN (_col3) ELSE (_col0) END (type: bigint), CASE WHEN (_col4 is not null) THEN (_col4) ELSE (_col1) END (type: date)
                      null sort order: zz
                      Statistics: Num rows: 3782178641396 Data size: 1331326881771392 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Select Operator
                        expressions: CASE WHEN (_col3 is not null) THEN (_col3) ELSE (_col0) END (type: bigint), CASE WHEN (_col4 is not null) THEN (_col4) ELSE (_col1) END (type: date), _col5 (type: decimal(27,2)), _col2 (type: decimal(27,2)), max_window_0 (type: decimal(27,2)), max_window_1 (type: decimal(27,2))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 3782178641396 Data size: 1936475464394752 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: date)
                          null sort order: zz
                          sort order: ++
                          Statistics: Num rows: 3782178641396 Data size: 1936475464394752 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
                          value expressions: _col2 (type: decimal(27,2)), _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(27,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: date), VALUE._col0 (type: decimal(27,2)), VALUE._col1 (type: decimal(27,2)), VALUE._col2 (type: decimal(27,2)), VALUE._col3 (type: decimal(27,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 3782178641396 Data size: 1936475464394752 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 51200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 51200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 353793125 Data size: 62267590000 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: bigint, _col1: date, _col2: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 ASC NULLS LAST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: sum_window_0
                              arguments: _col2
                              name: sum
                              window function: GenericUDAFSumHiveDecimal
                              window frame: ROWS PRECEDING(MAX)~CURRENT
                  Statistics: Num rows: 353793125 Data size: 62267590000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: date), sum_window_0 (type: decimal(27,2))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 353793125 Data size: 62267590000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: date)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: date)
                      Statistics: Num rows: 353793125 Data size: 62267590000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col2 (type: decimal(27,2))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query51
explain WITH web_v1 as ( select ws_item_sk item_sk, d_date, sum(sum(ws_sales_price)) over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from web_sales ,date_dim where ws_sold_date_sk=d_date_sk and d_month_seq between 1214 and 1214+11 and ws_item_sk is not NULL group by ws_item_sk, d_date), store_v1 as ( select ss_item_sk item_sk, d_date, sum(sum(ss_sales_price)) over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales from store_sales ,date_dim where ss_sold_date_sk=d_date_sk and d_month_seq between 1214 and 1214+11 and ss_item_sk is not NULL group by ss_item_sk, d_date) select  * from (select item_sk ,d_date ,web_sales ,store_sales ,max(web_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative ,max(store_sales) over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk ,case when web.d_date is not null then web.d_date else store.d_date end d_date ,web.cume_sales web_sales ,store.cume_sales store_sales from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk and web.d_date = store.d_date) )x )y where web_cumulative &gt; store_cumulative order by item_sk ,d_date limit 100

</samplerData>
</sample>
<sample t="2055" lt="2050" ts="1600984837576" s="true" lb="query52" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="9529" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220035_ebb04017-ea76-4eb4-b8b3-db5a9c0b93ab:260
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924220035_ebb04017-ea76-4eb4-b8b3-db5a9c0b93ab:260
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_48_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.6322188296814108E-4
                  Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 4
                      Statistics: Num rows: 466927013 Data size: 3735416216 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col5, _col6
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 4489236 Data size: 466880620 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1)
                          keys: _col5 (type: int), _col6 (type: char(50))
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 7730 Data size: 1669680 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: int), _col1 (type: char(50))
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: int), _col1 (type: char(50))
                            Statistics: Num rows: 7730 Data size: 1669680 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: dt
                  filterExpr: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_manager_id = 1) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 46624044 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_manager_id = 1) (type: boolean)
                    Statistics: Num rows: 3865 Data size: 448272 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand_id (type: int), i_brand (type: char(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 3865 Data size: 432844 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 3865 Data size: 432844 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 3865 Data size: 834840 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: -+
                  keys: _col2 (type: decimal(17,2)), _col0 (type: int)
                  null sort order: az
                  Statistics: Num rows: 3865 Data size: 834840 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Reduce Output Operator
                    key expressions: _col2 (type: decimal(17,2)), _col0 (type: int)
                    null sort order: az
                    sort order: -+
                    Statistics: Num rows: 3865 Data size: 834840 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col1 (type: char(50))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: int), VALUE._col0 (type: char(50)), KEY.reducesinkkey0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 3865 Data size: 834840 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 21600 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: 2000 (type: int), _col0 (type: int), _col1 (type: char(50)), _col2 (type: decimal(17,2))
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 100 Data size: 22000 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      Statistics: Num rows: 100 Data size: 22000 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query52
explain select  dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_ext_sales_price) ext_price from date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manager_id = 1 and dt.d_moy=12 and dt.d_year=2000 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,ext_price desc ,brand_id limit 100

</samplerData>
</sample>
<sample t="2476" lt="2470" ts="1600984840052" s="true" lb="query53" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="17150" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220037_843a2ad9-1788-4495-9841-658421247c5a:261
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924220037_843a2ad9-1788-4495-9841-658421247c5a:261
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_60_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.0201725816724738E-4
                  Statistics: Num rows: 27503885621 Data size: 3662775584312 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3576519447520 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26856185846 Data size: 3366729535456 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col4
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 2805871 Data size: 33670564 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col4, _col6
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 551640 Data size: 4413232 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col4 (type: int), _col6 (type: int)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 36 Data size: 4320 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: int), _col1 (type: int)
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: int)
                              Statistics: Num rows: 36 Data size: 4320 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_brand) IN (&apos;scholaramalgamalg #14                             &apos;, &apos;scholaramalgamalg #7                              &apos;, &apos;exportiunivamalg #9                               &apos;, &apos;scholaramalgamalg #9                              &apos;, &apos;amalgimporto #1                                   &apos;, &apos;edu packscholar #1                                &apos;, &apos;exportiimporto #1                                 &apos;, &apos;importoamalg #1                                   &apos;) and (i_class) IN (&apos;personal                                          &apos;, &apos;portable                                          &apos;, &apos;reference                                         &apos;, &apos;self-help                                         &apos;, &apos;accessories                                       &apos;, &apos;classical                                         &apos;, &apos;fragrances                                        &apos;, &apos;pants                                             &apos;) and (i_category) IN (&apos;Books                                             &apos;, &apos;Children                                          &apos;, &apos;Electronics                                       &apos;, &apos;Women                                             &apos;, &apos;Music                                             &apos;, &apos;Men                                               &apos;) and (((i_category) IN (&apos;Books                                             &apos;, &apos;Children                                          &apos;, &apos;Electronics                                       &apos;) and (i_class) IN (&apos;personal                                          &apos;, &apos;portable                                          &apos;, &apos;reference                                         &apos;, &apos;self-help                                         &apos;) and (i_brand) IN (&apos;scholaramalgamalg #14                             &apos;, &apos;scholaramalgamalg #7                              &apos;, &apos;exportiunivamalg #9                               &apos;, &apos;scholaramalgamalg #9                              &apos;)) or ((i_category) IN (&apos;Women                                             &apos;, &apos;Music                                             &apos;, &apos;Men                                               &apos;) and (i_class) IN (&apos;accessories                                       &apos;, &apos;classical                                         &apos;, &apos;fragrances                                        &apos;, &apos;pants                                             &apos;) and (i_brand) IN (&apos;amalgimporto #1                                   &apos;, &apos;edu packscholar #1                                &apos;, &apos;exportiimporto #1                                 &apos;, &apos;importoamalg #1                                   &apos;)))) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 118184000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_brand) IN (&apos;scholaramalgamalg #14                             &apos;, &apos;scholaramalgamalg #7                              &apos;, &apos;exportiunivamalg #9                               &apos;, &apos;scholaramalgamalg #9                              &apos;, &apos;amalgimporto #1                                   &apos;, &apos;edu packscholar #1                                &apos;, &apos;exportiimporto #1                                 &apos;, &apos;importoamalg #1                                   &apos;) and (i_class) IN (&apos;personal                                          &apos;, &apos;portable                                          &apos;, &apos;reference                                         &apos;, &apos;self-help                                         &apos;, &apos;accessories                                       &apos;, &apos;classical                                         &apos;, &apos;fragrances                                        &apos;, &apos;pants                                             &apos;) and (i_category) IN (&apos;Books                                             &apos;, &apos;Children                                          &apos;, &apos;Electronics                                       &apos;, &apos;Women                                             &apos;, &apos;Music                                             &apos;, &apos;Men                                               &apos;) and (((i_category) IN (&apos;Books                                             &apos;, &apos;Children                                          &apos;, &apos;Electronics                                       &apos;) and (i_class) IN (&apos;personal                                          &apos;, &apos;portable                                          &apos;, &apos;reference                                         &apos;, &apos;self-help                                         &apos;) and (i_brand) IN (&apos;scholaramalgamalg #14                             &apos;, &apos;scholaramalgamalg #7                              &apos;, &apos;exportiunivamalg #9                               &apos;, &apos;scholaramalgamalg #9                              &apos;)) or ((i_category) IN (&apos;Women                                             &apos;, &apos;Music                                             &apos;, &apos;Men                                               &apos;) and (i_class) IN (&apos;accessories                                       &apos;, &apos;classical                                         &apos;, &apos;fragrances                                        &apos;, &apos;pants                                             &apos;) and (i_brand) IN (&apos;amalgimporto #1                                   &apos;, &apos;edu packscholar #1                                &apos;, &apos;exportiimporto #1                                 &apos;, &apos;importoamalg #1                                   &apos;)))) (type: boolean)
                    Statistics: Num rows: 42 Data size: 12348 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_manufact_id (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 42 Data size: 504 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 42 Data size: 504 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_month_seq) IN (1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_month_seq) IN (1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223) (type: boolean)
                    Statistics: Num rows: 359 Data size: 5744 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_qoy (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 36 Data size: 4320 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: int), _col2 (type: decimal(17,2))
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 36 Data size: 4176 Basic stats: COMPLETE Column stats: COMPLETE
                  PTF Operator
                    Function definitions:
                        Input definition
                          input alias: ptf_0
                          output shape: _col0: int, _col2: decimal(17,2)
                          type: WINDOWING
                        Windowing table definition
                          input alias: ptf_1
                          name: windowingtablefunction
                          order by: _col0 ASC NULLS FIRST
                          partition by: _col0
                          raw input shape:
                          window functions:
                              window function definition
                                alias: avg_window_0
                                arguments: _col2
                                name: avg
                                window function: GenericUDAFAverageEvaluatorDecimal
                                window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                    Statistics: Num rows: 36 Data size: 4176 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: avg_window_0 (type: decimal(21,6)), _col0 (type: int), _col2 (type: decimal(17,2))
                      outputColumnNames: avg_window_0, _col0, _col2
                      Statistics: Num rows: 36 Data size: 4176 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: CASE WHEN ((avg_window_0 &gt; 0)) THEN (((abs((_col2 - avg_window_0)) / avg_window_0) &gt; 0.1)) ELSE (false) END (type: boolean)
                        Statistics: Num rows: 18 Data size: 4104 Basic stats: COMPLETE Column stats: COMPLETE
                        Top N Key Operator
                          sort order: +++
                          keys: avg_window_0 (type: decimal(21,6)), _col2 (type: decimal(17,2)), _col0 (type: int)
                          null sort order: zzz
                          Statistics: Num rows: 18 Data size: 4104 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 100
                          Select Operator
                            expressions: _col0 (type: int), _col2 (type: decimal(17,2)), avg_window_0 (type: decimal(21,6))
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 18 Data size: 4104 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col2 (type: decimal(21,6)), _col1 (type: decimal(17,2)), _col0 (type: int)
                              null sort order: zzz
                              sort order: +++
                              Statistics: Num rows: 18 Data size: 4104 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey2 (type: int), KEY.reducesinkkey1 (type: decimal(17,2)), KEY.reducesinkkey0 (type: decimal(21,6))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 18 Data size: 4104 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 18 Data size: 4104 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 18 Data size: 4104 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query53
explain select  * from (select i_manufact_id, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and ((i_category in (&apos;Books&apos;,&apos;Children&apos;,&apos;Electronics&apos;) and i_class in (&apos;personal&apos;,&apos;portable&apos;,&apos;reference&apos;,&apos;self-help&apos;) and i_brand in (&apos;scholaramalgamalg #14&apos;,&apos;scholaramalgamalg #7&apos;, &apos;exportiunivamalg #9&apos;,&apos;scholaramalgamalg #9&apos;)) or(i_category in (&apos;Women&apos;,&apos;Music&apos;,&apos;Men&apos;) and i_class in (&apos;accessories&apos;,&apos;classical&apos;,&apos;fragrances&apos;,&apos;pants&apos;) and i_brand in (&apos;amalgimporto #1&apos;,&apos;edu packscholar #1&apos;,&apos;exportiimporto #1&apos;, &apos;importoamalg #1&apos;))) group by i_manufact_id, d_qoy ) tmp1 where case when avg_quarterly_sales &gt; 0 then abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales else null end &gt; 0.1 order by avg_quarterly_sales, sum_sales, i_manufact_id limit 100

</samplerData>
</sample>
<sample t="6032" lt="6022" ts="1600984846085" s="true" lb="query54" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="44654" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220040_59fac093-a2e6-45c7-bf9d-06cef1a4177a:262
      Edges:
        Map 1 &lt;- Reducer 12 (BROADCAST_EDGE), Reducer 20 (BROADCAST_EDGE), Reducer 7 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Map 14 &lt;- Map 15 (BROADCAST_EDGE)
        Map 16 &lt;- Map 22 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Union 17 (CONTAINS)
        Map 21 &lt;- Map 22 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Reducer 23 (BROADCAST_EDGE), Union 17 (CONTAINS)
        Reducer 10 &lt;- Map 5 (SIMPLE_EDGE)
        Reducer 11 &lt;- Map 5 (XPROD_EDGE), Reducer 10 (XPROD_EDGE)
        Reducer 12 &lt;- Reducer 11 (XPROD_EDGE), Reducer 13 (XPROD_EDGE)
        Reducer 13 &lt;- Map 5 (SIMPLE_EDGE)
        Reducer 18 &lt;- Map 24 (CUSTOM_SIMPLE_EDGE), Union 17 (CUSTOM_SIMPLE_EDGE)
        Reducer 19 &lt;- Reducer 18 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 20 &lt;- Map 14 (CUSTOM_SIMPLE_EDGE), Reducer 19 (CUSTOM_SIMPLE_EDGE)
        Reducer 23 &lt;- Map 22 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 6 &lt;- Map 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Map 5 (SIMPLE_EDGE)
        Reducer 9 &lt;- Reducer 8 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220040_59fac093-a2e6-45c7-bf9d-06cef1a4177a:262
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3442719886784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 3361590886264 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26855746120 Data size: 3361590886264 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Reducer 7
                        Statistics: Num rows: 26855746120 Data size: 3361590886264 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 
                            1 
                          outputColumnNames: _col0, _col1, _col2
                          input vertices:
                            1 Reducer 9
                          Statistics: Num rows: 26855746120 Data size: 3361590886264 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col2, _col5
                            input vertices:
                              1 Reducer 20
                            Statistics: Num rows: 26855746120 Data size: 3366653813040 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col1, _col5
                              input vertices:
                                1 Reducer 12
                              Statistics: Num rows: 26855746120 Data size: 3151807844080 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col1)
                                keys: _col5 (type: bigint)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1
                                Statistics: Num rows: 12312 Data size: 1477440 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: bigint)
                                  null sort order: a
                                  sort order: +
                                  Map-reduce partition columns: _col0 (type: bigint)
                                  Statistics: Num rows: 12312 Data size: 1477440 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_county is not null and ca_state is not null) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 6240000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_county is not null and ca_state is not null) (type: boolean)
                    Statistics: Num rows: 32500000 Data size: 6240000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), ca_county (type: varchar(30)), ca_state (type: char(2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 32500000 Data size: 6240000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: varchar(30)), _col2 (type: char(2))
                          1 _col0 (type: varchar(30)), _col1 (type: char(2))
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 15
                        Statistics: Num rows: 25259067 Data size: 202072536 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 25259067 Data size: 202072536 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_county is not null and s_state is not null) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 276000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_county is not null and s_state is not null) (type: boolean)
                    Statistics: Num rows: 1500 Data size: 276000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_county (type: varchar(30)), s_state (type: char(2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1500 Data size: 276000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: varchar(30)), _col1 (type: char(2))
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: varchar(30)), _col1 (type: char(2))
                        Statistics: Num rows: 1500 Data size: 276000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_278_container, bigKeyColName:item_sk, smallTablePos:1, keyRatio:2.3206593261160037E-5
                  Statistics: Num rows: 14327953968 Data size: 343582842448 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 342719407960 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_sold_date_sk (type: bigint), cs_bill_customer_sk (type: bigint), cs_item_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 14291947369 Data size: 342719407960 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 362238426 Data size: 5213978688 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1
                          input vertices:
                            1 Map 22
                          Statistics: Num rows: 332503 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col1 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col1 (type: bigint)
                            Statistics: Num rows: 332503 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: (ws_bill_customer_sk is not null and ws_item_sk BETWEEN DynamicValue(RS_60_item_i_item_sk_min) AND DynamicValue(RS_60_item_i_item_sk_max) and in_bloom_filter(ws_item_sk, DynamicValue(RS_60_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 172748725128 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_bill_customer_sk is not null and ws_item_sk BETWEEN DynamicValue(RS_60_item_i_item_sk_min) AND DynamicValue(RS_60_item_i_item_sk_max) and in_bloom_filter(ws_item_sk, DynamicValue(RS_60_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 172727188352 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_sold_date_sk (type: bigint), ws_bill_customer_sk (type: bigint), ws_item_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197265278 Data size: 172727188352 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 362238426 Data size: 5213978688 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1
                          input vertices:
                            1 Map 22
                          Statistics: Num rows: 332503 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col1 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col1 (type: bigint)
                            Statistics: Num rows: 332503 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 22 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_class = &apos;business                                          &apos;) and (i_category = &apos;Books                                             &apos;)) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 76380000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_class = &apos;business                                          &apos;) and (i_category = &apos;Books                                             &apos;)) (type: boolean)
                    Statistics: Num rows: 369 Data size: 70110 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 369 Data size: 2952 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 369 Data size: 2952 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 369 Data size: 2952 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 369 Data size: 2952 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 24 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: c_current_addr_sk is not null (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 1040000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: c_current_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 65000000 Data size: 1040000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_addr_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 65000000 Data size: 1040000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 65000000 Data size: 1040000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (((d_year = 2000) and (d_moy = 2)) or ((d_year = 2000) and (d_moy = 2) and d_month_seq is not null) or ((d_year = 2000) and (d_moy = 2)) or d_month_seq is not null) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 2)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: (d_month_seq + 3) (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: int)
                        minReductionHashAggr: 0.516129
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: (d_month_seq + 1) (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: int)
                        minReductionHashAggr: 0.516129
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 2) and d_month_seq is not null) (type: boolean)
                    Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: (d_month_seq + 1) (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: int)
                        minReductionHashAggr: 0.516129
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 2) and d_month_seq is not null) (type: boolean)
                    Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: (d_month_seq + 3) (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 372 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: int)
                        minReductionHashAggr: 0.516129
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 2)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 16
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 21
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq is not null (type: boolean)
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_month_seq (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        null sort order: 
                        sort order: 
                        Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col1 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int)
        Reducer 11 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 
                  1 
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1095735 Data size: 17531760 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col2 &lt;= _col1) (type: boolean)
                  Statistics: Num rows: 365245 Data size: 5843920 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 365245 Data size: 5843920 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: bigint), _col1 (type: int)
        Reducer 12 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 
                  1 
                outputColumnNames: _col0, _col1, _col3
                Statistics: Num rows: 5478675 Data size: 87658800 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &lt;= _col3) (type: boolean)
                  Statistics: Num rows: 1826225 Data size: 29219600 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1826225 Data size: 29219600 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1826225 Data size: 29219600 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1826225 Data size: 14609800 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.9628469
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 67850 Data size: 542800 Basic stats: COMPLETE Column stats: COMPLETE
                        Dynamic Partitioning Event Operator
                          Target column: ss_sold_date_sk (bigint)
                          Target Input: store_sales
                          Partition key expr: ss_sold_date_sk
                          Statistics: Num rows: 67850 Data size: 542800 Basic stats: COMPLETE Column stats: COMPLETE
                          Target Vertex: Map 1
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int)
        Reducer 18 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col5, _col6
                input vertices:
                  1 Map 24
                Statistics: Num rows: 332503 Data size: 5320048 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Group By Operator
                  keys: _col6 (type: bigint), _col5 (type: bigint)
                  minReductionHashAggr: 0.5612701
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 145879 Data size: 2334064 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col1 (type: bigint)
                    null sort order: aa
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                    Statistics: Num rows: 145879 Data size: 2334064 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 19 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 145879 Data size: 2334064 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: bigint), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 145879 Data size: 2334064 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 145879 Data size: 2334064 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: bigint)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: UDFToInteger((_col1 / 50)) (type: int)
                  outputColumnNames: _col0
                  Statistics: Num rows: 1 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    keys: _col0 (type: int)
                    minReductionHashAggr: 0.0
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: int)
                      Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: bigint)
        Reducer 20 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col5
                input vertices:
                  0 Map 14
                Statistics: Num rows: 145879 Data size: 1167032 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col5 (type: bigint)
                  outputColumnNames: _col0
                  Statistics: Num rows: 145879 Data size: 1167032 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 145879 Data size: 1167032 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 23 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Top N Key Operator
                sort order: +
                keys: KEY._col0 (type: int)
                null sort order: z
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                top n: 100
                Group By Operator
                  aggregations: count(VALUE._col0)
                  keys: KEY._col0 (type: int)
                  mode: mergepartial
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: int), _col1 (type: bigint)
                    null sort order: zz
                    Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: _col0 (type: int), _col1 (type: bigint), (_col0 * 50) (type: int)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: int), _col1 (type: bigint)
                        null sort order: zz
                        sort order: ++
                        Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col2 (type: int)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: bigint), VALUE._col0 (type: int)
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    minReductionHashAggr: 0.93333334
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint)
        Reducer 7 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (sq_count_check(_col0) &lt;= 1) (type: boolean)
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  Statistics: Num rows: 15 Data size: 60 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    minReductionHashAggr: 0.93333334
                    mode: hash
                    outputColumnNames: _col0
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint)
        Reducer 9 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (sq_count_check(_col0) &lt;= 1) (type: boolean)
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
        Union 17 
            Vertex: Union 17

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query54
explain with my_customers as ( select distinct c_customer_sk , c_current_addr_sk from ( select cs_sold_date_sk sold_date_sk, cs_bill_customer_sk customer_sk, cs_item_sk item_sk from   catalog_sales union all select ws_sold_date_sk sold_date_sk, ws_bill_customer_sk customer_sk, ws_item_sk item_sk from   web_sales ) cs_or_ws_sales, item, date_dim, customer where   sold_date_sk = d_date_sk and item_sk = i_item_sk and i_category = &apos;Books&apos; and i_class = &apos;business&apos; and c_customer_sk = cs_or_ws_sales.customer_sk and d_moy = 2 and d_year = 2000 ) , my_revenue as ( select c_customer_sk, sum(ss_ext_sales_price) as revenue from   my_customers, store_sales, customer_address, store, date_dim where  c_current_addr_sk = ca_address_sk and ca_county = s_county and ca_state = s_state and ss_sold_date_sk = d_date_sk and c_customer_sk = ss_customer_sk and d_month_seq between (select distinct d_month_seq+1 from   date_dim where d_year = 2000 and d_moy = 2) and  (select distinct d_month_seq+3 from   date_dim where d_year = 2000 and d_moy = 2) group by c_customer_sk ) , segments as (select cast((revenue/50) as int) as segment from   my_revenue ) select  segment, count(*) as num_customers, segment*50 as segment_base from segments group by segment order by segment, num_customers limit 100

</samplerData>
</sample>
<sample t="3074" lt="3067" ts="1600984849161" s="true" lb="query55" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="2898" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220046_303e4053-3245-48b0-9868-cee5e4f86209:263
      Edges:
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
      DagName: zabetak_20200924220046_303e4053-3245-48b0-9868-cee5e4f86209:263
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.q55
                  Statistics: Num rows: 249 Data size: 59500 Basic stats: COMPLETE Column stats: NONE
                  Top N Key Operator
                    sort order: -+
                    keys: ext_price (type: decimal(17,2)), brand_id (type: int)
                    null sort order: az
                    Statistics: Num rows: 249 Data size: 59500 Basic stats: COMPLETE Column stats: NONE
                    top n: 100
                    Select Operator
                      expressions: brand (type: char(50)), ext_price (type: decimal(17,2)), brand_id (type: int)
                      outputColumnNames: _col1, _col2, _col3
                      Statistics: Num rows: 249 Data size: 59500 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col2 (type: decimal(17,2)), _col3 (type: int)
                        null sort order: az
                        sort order: -+
                        Statistics: Num rows: 249 Data size: 59500 Basic stats: COMPLETE Column stats: NONE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col1 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: int), VALUE._col0 (type: char(50)), KEY.reducesinkkey0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 249 Data size: 59500 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 23800 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 23800 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query55
explain select  i_brand_id brand_id, i_brand brand, sum(ss_ext_sales_price) ext_price from date_dim, store_sales, item where d_date_sk = ss_sold_date_sk and ss_item_sk = i_item_sk and i_manager_id=13 and d_moy=11 and d_year=1999 group by i_brand, i_brand_id order by ext_price desc, i_brand_id limit 100

</samplerData>
</sample>
<sample t="7210" lt="7203" ts="1600984856372" s="true" lb="query56" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="30179" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220049_4032383c-4179-4c30-a8ae-3448e333be11:264
      Edges:
        Map 1 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 11 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 13 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 8 &lt;- Reducer 10 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 12 &lt;- Map 11 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 14 &lt;- Map 13 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924220049_4032383c-4179-4c30-a8ae-3448e333be11:264
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_274_container, bigKeyColName:ss_addr_sk, smallTablePos:1, keyRatio:2.2069608940510507E-8
                  Statistics: Num rows: 27503885621 Data size: 3662750247000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 26855655526 Data size: 3576424082968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_addr_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26855655526 Data size: 3576424082968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 455922163 Data size: 3647377424 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 75987030 Data size: 607896352 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 1199726 Data size: 119972712 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: char(16))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(16))
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: char(16))
                                Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_283_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:4.424588475199378E-5
                  Statistics: Num rows: 14327953968 Data size: 1944284201568 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 14291948793 Data size: 1939398347408 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_addr_sk (type: bigint), cs_item_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291948793 Data size: 1939398347408 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 240915901 Data size: 26530546888 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 40152652 Data size: 798947360 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 633953 Data size: 63395412 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: char(16))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(16))
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: char(16))
                                Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_280_container, bigKeyColName:ws_bill_addr_sk, smallTablePos:1, keyRatio:8.432707440778109E-8
                  Statistics: Num rows: 7198162681 Data size: 978842066440 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 7197262394 Data size: 978719640968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_bill_addr_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 7197262394 Data size: 978719640968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 122186235 Data size: 15531793464 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 20364374 Data size: 2342881648 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 321525 Data size: 32152612 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: char(16))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(16))
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: char(16))
                                Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2001) and (d_moy = 5)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_moy = 5)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 11
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_gmt_offset = -6) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 3790780736 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_gmt_offset = -6) (type: boolean)
                    Statistics: Num rows: 5416667 Data size: 631796904 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_item_id is not null (type: boolean)
                  Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: i_item_id is not null (type: boolean)
                    Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: char(16))
                          1 _col0 (type: char(16))
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Reducer 10
                        Statistics: Num rows: 12057 Data size: 1302156 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 12057 Data size: 1302156 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(16))
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 12057 Data size: 1302156 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(16))
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 12057 Data size: 1302156 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_color) IN (&apos;chiffon             &apos;, &apos;smoke               &apos;, &apos;lace                &apos;) and i_item_id is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 75978000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_color) IN (&apos;chiffon             &apos;, &apos;smoke               &apos;, &apos;lace                &apos;) and i_item_id is not null) (type: boolean)
                    Statistics: Num rows: 12695 Data size: 2399355 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_id (type: char(16))
                      outputColumnNames: i_item_id
                      Statistics: Num rows: 12695 Data size: 2399355 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: i_item_id (type: char(16))
                        minReductionHashAggr: 0.5000394
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 6347 Data size: 634700 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(16))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: char(16))
                          Statistics: Num rows: 6347 Data size: 634700 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 6347 Data size: 634700 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: char(16))
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: char(16))
                  Statistics: Num rows: 6347 Data size: 634700 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: char(16))
                  minReductionHashAggr: 0.6666666
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(16))
                    Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(27,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: char(16))
                  minReductionHashAggr: 0.6666666
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(16))
                    Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(27,2))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col0 (type: char(16))
                  minReductionHashAggr: 0.6666666
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(16))
                    Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(27,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: ++
                  keys: _col1 (type: decimal(27,2)), _col0 (type: char(16))
                  null sort order: zz
                  Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Reduce Output Operator
                    key expressions: _col1 (type: decimal(27,2)), _col0 (type: char(16))
                    null sort order: zz
                    sort order: ++
                    Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: char(16)), KEY.reducesinkkey0 (type: decimal(27,2))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 191 Data size: 40492 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 21200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 21200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 3 
            Vertex: Union 3

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query56
explain with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_item_id in (select i_item_id from item where i_color in (&apos;chiffon&apos;,&apos;smoke&apos;,&apos;lace&apos;)) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 5 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -6 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_color in (&apos;chiffon&apos;,&apos;smoke&apos;,&apos;lace&apos;)) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 5 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_color in (&apos;chiffon&apos;,&apos;smoke&apos;,&apos;lace&apos;)) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 2001 and     d_moy                   = 5 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -6 group by i_item_id) select  i_item_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by total_sales, i_item_id limit 100

</samplerData>
</sample>
<sample t="2914" lt="2907" ts="1600984859287" s="true" lb="query57" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="29068" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220056_81a31ad1-dbc6-41cd-a6aa-33dc139eb7dd:265
      Edges:
        Map 1 &lt;- Map 10 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 3 (BROADCAST_EDGE), Reducer 4 (BROADCAST_EDGE), Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
      DagName: zabetak_20200924220056_81a31ad1-dbc6-41cd-a6aa-33dc139eb7dd:265
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_call_center_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1944282913272 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_call_center_sk is not null (type: boolean)
                    Statistics: Num rows: 14291968482 Data size: 1939399734120 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_call_center_sk (type: bigint), cs_item_sk (type: bigint), cs_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291968482 Data size: 1939399734120 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col5, _col6
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 3326198273 Data size: 448054985696 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col5, _col6, _col8
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 3326198273 Data size: 747699991106 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col5, _col6, _col8, _col10, _col11
                            input vertices:
                              1 Map 10
                            Statistics: Num rows: 3326198273 Data size: 1353068076792 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col5 (type: int), _col6 (type: int), _col8 (type: varchar(50)), _col10 (type: char(50)), _col11 (type: char(50))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                              Statistics: Num rows: 1663099136 Data size: 678544447488 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: varchar(50)), _col3 (type: char(50)), _col4 (type: char(50))
                                null sort order: aaaaa
                                sort order: +++++
                                Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: varchar(50)), _col3 (type: char(50)), _col4 (type: char(50))
                                Statistics: Num rows: 1663099136 Data size: 678544447488 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col5 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_category is not null and i_brand is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 79596000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_category is not null and i_brand is not null) (type: boolean)
                    Statistics: Num rows: 402000 Data size: 79596000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand (type: char(50)), i_category (type: char(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 402000 Data size: 79596000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402000 Data size: 79596000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(50)), _col2 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year) IN (1999, 1998, 2000) and ((d_year = 1999) or (struct(d_year,d_moy)) IN (const struct(1998,12), const struct(2000,1)))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year) IN (1999, 1998, 2000) and ((d_year = 1999) or (struct(d_year,d_moy)) IN (const struct(1998,12), const struct(2000,1)))) (type: boolean)
                    Statistics: Num rows: 428 Data size: 6848 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_year (type: int), d_moy (type: int)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 428 Data size: 6848 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 428 Data size: 6848 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 428 Data size: 3424 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 214 Data size: 1712 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: call_center
                  filterExpr: cc_name is not null (type: boolean)
                  Statistics: Num rows: 54 Data size: 5724 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cc_name is not null (type: boolean)
                    Statistics: Num rows: 54 Data size: 5724 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cc_call_center_sk (type: bigint), cc_name (type: varchar(50))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 54 Data size: 5724 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 54 Data size: 5724 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: varchar(50)), KEY._col3 (type: char(50)), KEY._col4 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50)), _col0 (type: int), _col1 (type: int)
                  null sort order: aaazz
                  sort order: +++++
                  Map-reduce partition columns: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50))
                  Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col5 (type: decimal(17,2))
                Reduce Output Operator
                  key expressions: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50)), _col0 (type: int), _col1 (type: int)
                  null sort order: aaazz
                  sort order: +++++
                  Map-reduce partition columns: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50))
                  Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col5 (type: decimal(17,2))
                Reduce Output Operator
                  key expressions: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50)), _col0 (type: int)
                  null sort order: aaaa
                  sort order: ++++
                  Map-reduce partition columns: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50)), _col0 (type: int)
                  Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col1 (type: int), _col5 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: varchar(50), _col3: char(50), _col4: char(50), _col5: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col0 ASC NULLS LAST, _col1 ASC NULLS LAST
                        partition by: _col4, _col3, _col2
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col0, _col1
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: rank_window_0 is not null (type: boolean)
                    Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50)), _col5 (type: decimal(17,2)), (rank_window_0 - 1) (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 5288976 Data size: 2136746304 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col4 (type: int), _col2 (type: varchar(50))
                        null sort order: aaaa
                        sort order: ++++
                        Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col4 (type: int), _col2 (type: varchar(50))
                        Statistics: Num rows: 5288976 Data size: 2136746304 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: varchar(50), _col3: char(50), _col4: char(50), _col5: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col0 ASC NULLS LAST, _col1 ASC NULLS LAST
                        partition by: _col4, _col3, _col2
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col0, _col1
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: rank_window_0 is not null (type: boolean)
                    Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50)), _col5 (type: decimal(17,2)), (rank_window_0 + 1) (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 5288976 Data size: 2136746304 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col4 (type: int), _col2 (type: varchar(50))
                        null sort order: aaaa
                        sort order: ++++
                        Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col4 (type: int), _col2 (type: varchar(50))
                        Statistics: Num rows: 5288976 Data size: 2136746304 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: decimal(17,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey3 (type: int), VALUE._col0 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: varchar(50), _col3: char(50), _col4: char(50), _col5: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col4 ASC NULLS FIRST, _col3 ASC NULLS FIRST, _col2 ASC NULLS FIRST, _col0 ASC NULLS FIRST
                        partition by: _col4, _col3, _col2, _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: avg_window_0
                              arguments: _col5
                              name: avg
                              window function: GenericUDAFAverageEvaluatorDecimal
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: avg_window_0 (type: decimal(21,6)), _col0 (type: int), _col1 (type: int), _col2 (type: varchar(50)), _col3 (type: char(50)), _col4 (type: char(50)), _col5 (type: decimal(17,2))
                    outputColumnNames: avg_window_0, _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50)), _col0 (type: int), _col1 (type: int)
                      null sort order: aaazz
                      sort order: +++++
                      Map-reduce partition columns: _col4 (type: char(50)), _col3 (type: char(50)), _col2 (type: varchar(50))
                      Statistics: Num rows: 5288976 Data size: 2157902208 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: avg_window_0 (type: decimal(21,6)), _col5 (type: decimal(17,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: decimal(21,6)), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 5288976 Data size: 2750267520 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: decimal(21,6), _col1: int, _col2: int, _col3: varchar(50), _col4: char(50), _col5: char(50), _col6: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 ASC NULLS LAST, _col2 ASC NULLS LAST
                        partition by: _col5, _col4, _col3
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_1
                              arguments: _col1, _col2
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 5288976 Data size: 2750267520 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((_col0 &gt; 0) and rank_window_1 is not null and (_col1 = 1999)) (type: boolean)
                    Statistics: Num rows: 881496 Data size: 458377920 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: rank_window_1 (type: int), _col0 (type: decimal(21,6)), _col1 (type: int), _col2 (type: int), _col3 (type: varchar(50)), _col4 (type: char(50)), _col5 (type: char(50)), _col6 (type: decimal(17,2))
                      outputColumnNames: rank_window_1, _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 881496 Data size: 458377920 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: CASE WHEN ((_col0 &gt; 0)) THEN (((abs((_col6 - _col0)) / _col0) &gt; 0.1)) ELSE (false) END (type: boolean)
                        Statistics: Num rows: 440748 Data size: 230951952 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col5 (type: char(50)), _col4 (type: char(50)), _col3 (type: varchar(50)), _col1 (type: int), _col2 (type: int), _col6 (type: decimal(17,2)), _col0 (type: decimal(21,6)), rank_window_1 (type: int)
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                          Statistics: Num rows: 440748 Data size: 230951952 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: char(50)), _col1 (type: char(50)), _col4 (type: int), _col2 (type: varchar(50))
                              1 _col0 (type: char(50)), _col1 (type: char(50)), _col7 (type: int), _col2 (type: varchar(50))
                            outputColumnNames: _col3, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                            input vertices:
                              0 Reducer 4
                            Statistics: Num rows: 440748 Data size: 280315728 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col5 (type: char(50)), _col6 (type: char(50)), _col12 (type: int), _col7 (type: varchar(50))
                                1 _col0 (type: char(50)), _col1 (type: char(50)), _col4 (type: int), _col2 (type: varchar(50))
                              outputColumnNames: _col3, _col5, _col6, _col8, _col9, _col10, _col11, _col16
                              input vertices:
                                1 Reducer 3
                              Statistics: Num rows: 440748 Data size: 284723208 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: ++
                                keys: (_col10 - _col11) (type: decimal(22,6)), _col11 (type: decimal(21,6))
                                null sort order: zz
                                Statistics: Num rows: 440748 Data size: 284723208 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 100
                                Select Operator
                                  expressions: _col5 (type: char(50)), _col6 (type: char(50)), _col8 (type: int), _col9 (type: int), _col11 (type: decimal(21,6)), _col10 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col16 (type: decimal(17,2)), (_col10 - _col11) (type: decimal(22,6))
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                                  Statistics: Num rows: 440748 Data size: 334086984 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col8 (type: decimal(22,6)), _col4 (type: decimal(21,6))
                                    null sort order: zz
                                    sort order: ++
                                    Statistics: Num rows: 440748 Data size: 334086984 Basic stats: COMPLETE Column stats: COMPLETE
                                    TopN Hash Memory Usage: 0.04
                                    value expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: int), _col3 (type: int), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: char(50)), VALUE._col1 (type: char(50)), VALUE._col2 (type: int), VALUE._col3 (type: int), KEY.reducesinkkey1 (type: decimal(21,6)), VALUE._col4 (type: decimal(17,2)), VALUE._col5 (type: decimal(17,2)), VALUE._col6 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 440748 Data size: 334086984 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 75800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 75800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query57
explain with v1 as( select i_category, i_brand, cc_name, d_year, d_moy, sum(cs_sales_price) sum_sales, avg(sum(cs_sales_price)) over (partition by i_category, i_brand, cc_name, d_year) avg_monthly_sales, rank() over (partition by i_category, i_brand, cc_name order by d_year, d_moy) rn from item, catalog_sales, date_dim, call_center where cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and cc_call_center_sk= cs_call_center_sk and ( d_year = 1999 or ( d_year = 1999-1 and d_moy =12) or ( d_year = 1999+1 and d_moy =1) ) group by i_category, i_brand, cc_name , d_year, d_moy), v2 as( select v1.i_category, v1.i_brand ,v1.d_year, v1.d_moy ,v1.avg_monthly_sales ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum from v1, v1 v1_lag, v1 v1_lead where v1.i_category = v1_lag.i_category and v1.i_category = v1_lead.i_category and v1.i_brand = v1_lag.i_brand and v1.i_brand = v1_lead.i_brand and v1. cc_name = v1_lag. cc_name and v1. cc_name = v1_lead. cc_name and v1.rn = v1_lag.rn + 1 and v1.rn = v1_lead.rn - 1) select  * from v2 where  d_year = 1999 and avg_monthly_sales &gt; 0 and case when avg_monthly_sales &gt; 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end &gt; 0.1 order by sum_sales - avg_monthly_sales, avg_monthly_sales limit 100

</samplerData>
</sample>
<sample t="5976" lt="5968" ts="1600984865266" s="true" lb="query58" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="32120" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220059_fc1a7e60-3f25-4e02-9d26-987b62b0dda9:266
      Edges:
        Map 3 &lt;- Map 1 (BROADCAST_EDGE), Reducer 2 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 8 (BROADCAST_EDGE), Map 9 (CUSTOM_SIMPLE_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 11 &lt;- Reducer 10 (SIMPLE_EDGE), Reducer 15 (BROADCAST_EDGE), Reducer 7 (BROADCAST_EDGE)
        Reducer 12 &lt;- Reducer 11 (SIMPLE_EDGE)
        Reducer 14 &lt;- Map 13 (CUSTOM_SIMPLE_EDGE), Map 8 (BROADCAST_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 15 &lt;- Reducer 14 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Map 1 (BROADCAST_EDGE), Map 3 (SIMPLE_EDGE)
        Reducer 6 &lt;- Map 5 (CUSTOM_SIMPLE_EDGE), Map 8 (BROADCAST_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
      DagName: zabetak_20200924220059_fc1a7e60-3f25-4e02-9d26-987b62b0dda9:266
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_date is not null or (d_date = DATE&apos;1998-02-21&apos;) or ((d_date = DATE&apos;1998-02-21&apos;) and d_week_seq is not null)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_date is not null (type: boolean)
                    Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_date (type: date)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: date)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: date)
                        Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: (d_date = DATE&apos;1998-02-21&apos;) (type: boolean)
                    Statistics: Num rows: 36524 Data size: 2045344 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 36524 Data size: 2045344 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: ((d_date = DATE&apos;1998-02-21&apos;) and d_week_seq is not null) (type: boolean)
                    Statistics: Num rows: 36524 Data size: 2191440 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_week_seq (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 36524 Data size: 146096 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  Statistics: Num rows: 7198162681 Data size: 921263967280 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_item_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7198162681 Data size: 921263967280 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col2 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col2 (type: bigint)
                      Statistics: Num rows: 7198162681 Data size: 921263967280 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint), _col1 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_week_seq is not null and d_date is not null) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4382940 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 4382940 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date (type: date), d_week_seq (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 4382940 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 
                          1 
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Reducer 2
                        Statistics: Num rows: 73049 Data size: 4382940 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: int)
                            1 _col0 (type: int)
                          outputColumnNames: _col0
                          input vertices:
                            1 Map 1
                          Statistics: Num rows: 236172 Data size: 13225632 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col0 (type: date)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 73049 Data size: 4090744 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: date)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: date)
                              Statistics: Num rows: 73049 Data size: 4090744 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  Statistics: Num rows: 14327953968 Data size: 1829948611216 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_item_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 14327953968 Data size: 1829948611216 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col2 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col2 (type: bigint)
                      Statistics: Num rows: 14327953968 Data size: 1829948611216 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint), _col1 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_item_id is not null (type: boolean)
                  Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: i_item_id is not null (type: boolean)
                    Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col2 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col2 (type: bigint)
                      Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint), _col1 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col3, _col4
                input vertices:
                  0 Reducer 4
                Statistics: Num rows: 2126708895 Data size: 182612710696 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col4, _col7
                  input vertices:
                    1 Map 8
                  Statistics: Num rows: 2126708895 Data size: 378269929036 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col4)
                    keys: _col7 (type: char(16))
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 312765492 Data size: 66306284304 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 312765492 Data size: 66306284304 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: decimal(17,2))
        Reducer 11 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 211614 Data size: 44862168 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: decimal(17,2)), (0.9 * _col1) (type: decimal(19,3)), (1.1 * _col1) (type: decimal(20,3))
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 211614 Data size: 92263704 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: char(16))
                      1 _col0 (type: char(16))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7
                    input vertices:
                      0 Reducer 7
                    Statistics: Num rows: 211614 Data size: 163366008 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col1 BETWEEN _col6 AND _col7 and _col5 BETWEEN _col2 AND _col3) (type: boolean)
                      Statistics: Num rows: 2612 Data size: 2016464 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: char(16))
                          1 _col0 (type: char(16))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col5, _col6, _col7, _col9, _col10, _col11
                        input vertices:
                          1 Reducer 15
                        Statistics: Num rows: 2612 Data size: 2894096 Basic stats: COMPLETE Column stats: COMPLETE
                        Filter Operator
                          predicate: (_col9 BETWEEN _col2 AND _col3 and _col9 BETWEEN _col6 AND _col7 and _col1 BETWEEN _col10 AND _col11 and _col5 BETWEEN _col10 AND _col11) (type: boolean)
                          Statistics: Num rows: 1 Data size: 1108 Basic stats: COMPLETE Column stats: COMPLETE
                          Top N Key Operator
                            sort order: ++
                            keys: _col0 (type: char(16)), _col5 (type: decimal(17,2))
                            null sort order: zz
                            Statistics: Num rows: 1 Data size: 1108 Basic stats: COMPLETE Column stats: COMPLETE
                            top n: 100
                            Select Operator
                              expressions: _col0 (type: char(16)), _col5 (type: decimal(17,2)), ((_col5 / (((_col5 + _col1) + _col9) / 3)) * 100) (type: decimal(38,13)), _col1 (type: decimal(17,2)), ((_col1 / (((_col5 + _col1) + _col9) / 3)) * 100) (type: decimal(38,13)), _col9 (type: decimal(17,2)), ((_col9 / (((_col5 + _col1) + _col9) / 3)) * 100) (type: decimal(38,13)), (((_col5 + _col1) + _col9) / 3) (type: decimal(23,6))
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                              Statistics: Num rows: 1 Data size: 884 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(16)), _col1 (type: decimal(17,2))
                                null sort order: zz
                                sort order: ++
                                Statistics: Num rows: 1 Data size: 884 Basic stats: COMPLETE Column stats: COMPLETE
                                TopN Hash Memory Usage: 0.04
                                value expressions: _col2 (type: decimal(38,13)), _col3 (type: decimal(17,2)), _col4 (type: decimal(38,13)), _col5 (type: decimal(17,2)), _col6 (type: decimal(38,13)), _col7 (type: decimal(23,6))
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), KEY.reducesinkkey1 (type: decimal(17,2)), VALUE._col0 (type: decimal(38,13)), VALUE._col1 (type: decimal(17,2)), VALUE._col2 (type: decimal(38,13)), VALUE._col3 (type: decimal(17,2)), VALUE._col4 (type: decimal(38,13)), VALUE._col5 (type: decimal(23,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 1 Data size: 884 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 884 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 884 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col3, _col4
                input vertices:
                  0 Reducer 4
                Statistics: Num rows: 556590324 Data size: 66689982992 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col4, _col7
                  input vertices:
                    1 Map 8
                  Statistics: Num rows: 556590324 Data size: 117896292800 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col4)
                    keys: _col7 (type: char(16))
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 97554054 Data size: 20681459448 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 97554054 Data size: 20681459448 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: decimal(17,2))
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 211614 Data size: 44862168 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: decimal(17,2)), (0.9 * _col1) (type: decimal(19,3)), (1.1 * _col1) (type: decimal(20,3))
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 211614 Data size: 92263704 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(16))
                    Statistics: Num rows: 211614 Data size: 92263704 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(19,3)), _col3 (type: decimal(20,3))
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (sq_count_check(_col0) &lt;= 1) (type: boolean)
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: date)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 36524 Data size: 2045344 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: date)
                    1 _col0 (type: date)
                  outputColumnNames: _col0
                  input vertices:
                    0 Map 1
                  Statistics: Num rows: 2668041676 Data size: 21344333408 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 2668041676 Data size: 21344333408 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 2668041676 Data size: 21344333408 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: _col0 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 5699400 Data size: 45595200 Basic stats: COMPLETE Column stats: COMPLETE
                      Dynamic Partitioning Event Operator
                        Target column: cs_sold_date_sk (bigint)
                        Target Input: catalog_sales
                        Partition key expr: cs_sold_date_sk
                        Statistics: Num rows: 5699400 Data size: 45595200 Basic stats: COMPLETE Column stats: COMPLETE
                        Target Vertex: Map 5
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 2668041676 Data size: 21344333408 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 2668041676 Data size: 21344333408 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: _col0 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 5699400 Data size: 45595200 Basic stats: COMPLETE Column stats: COMPLETE
                      Dynamic Partitioning Event Operator
                        Target column: ss_sold_date_sk (bigint)
                        Target Input: store_sales
                        Partition key expr: ss_sold_date_sk
                        Statistics: Num rows: 5699400 Data size: 45595200 Basic stats: COMPLETE Column stats: COMPLETE
                        Target Vertex: Map 9
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 2668041676 Data size: 21344333408 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 2668041676 Data size: 21344333408 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: _col0 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 5699400 Data size: 45595200 Basic stats: COMPLETE Column stats: COMPLETE
                      Dynamic Partitioning Event Operator
                        Target column: ws_sold_date_sk (bigint)
                        Target Input: web_sales
                        Partition key expr: ws_sold_date_sk
                        Statistics: Num rows: 5699400 Data size: 45595200 Basic stats: COMPLETE Column stats: COMPLETE
                        Target Vertex: Map 13
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col3, _col4
                input vertices:
                  0 Reducer 4
                Statistics: Num rows: 1107893902 Data size: 128917771552 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col4, _col7
                  input vertices:
                    1 Map 8
                  Statistics: Num rows: 1107893902 Data size: 230844010536 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col4)
                    keys: _col7 (type: char(16))
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 190875828 Data size: 40465675536 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 190875828 Data size: 40465675536 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: decimal(17,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 211614 Data size: 44862168 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: decimal(17,2)), (0.9 * _col1) (type: decimal(19,3)), (1.1 * _col1) (type: decimal(20,3))
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 211614 Data size: 92263704 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(16))
                    Statistics: Num rows: 211614 Data size: 92263704 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(19,3)), _col3 (type: decimal(20,3))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query58
explain with ss_items as (select i_item_id item_id ,sum(ss_ext_sales_price) ss_item_rev from store_sales ,item ,date_dim where ss_item_sk = i_item_sk and d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = &apos;1998-02-21&apos;)) and ss_sold_date_sk   = d_date_sk group by i_item_id), cs_items as (select i_item_id item_id ,sum(cs_ext_sales_price) cs_item_rev from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and  d_date in (select d_date from date_dim where d_week_seq = (select d_week_seq from date_dim where d_date = &apos;1998-02-21&apos;)) and  cs_sold_date_sk = d_date_sk group by i_item_id), ws_items as (select i_item_id item_id ,sum(ws_ext_sales_price) ws_item_rev from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and  d_date in (select d_date from date_dim where d_week_seq =(select d_week_seq from date_dim where d_date = &apos;1998-02-21&apos;)) and ws_sold_date_sk   = d_date_sk group by i_item_id) select  ss_items.item_id ,ss_item_rev ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev ,cs_item_rev ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev ,ws_item_rev ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average from ss_items,cs_items,ws_items where ss_items.item_id=cs_items.item_id and ss_items.item_id=ws_items.item_id and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev order by item_id ,ss_item_rev limit 100

</samplerData>
</sample>
<sample t="2406" lt="2398" ts="1600984867673" s="true" lb="query59" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="31789" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220105_84fa9ead-1d28-4af8-aef9-b97bf7171523:267
      Edges:
        Map 1 &lt;- Map 2 (BROADCAST_EDGE)
        Map 10 &lt;- Map 12 (BROADCAST_EDGE)
        Map 12 &lt;- Reducer 8 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Map 3 &lt;- Map 6 (BROADCAST_EDGE)
        Map 6 &lt;- Reducer 8 (BROADCAST_EDGE)
        Reducer 11 &lt;- Map 10 (SIMPLE_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 4 &lt;- Map 1 (BROADCAST_EDGE), Map 3 (SIMPLE_EDGE), Map 7 (BROADCAST_EDGE), Reducer 11 (BROADCAST_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Map 7 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220105_84fa9ead-1d28-4af8-aef9-b97bf7171523:267
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: s_store_id is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_164_container, bigKeyColName:s_store_id, smallTablePos:1, keyRatio:0.5146666666666667
                  Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: s_store_id is not null (type: boolean)
                    Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_store_id (type: char(16)), s_store_name (type: varchar(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1500 Data size: 294000 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: char(16))
                          1 _col1 (type: char(16))
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 2914 Data size: 594456 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 2914 Data size: 594456 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(16)), _col2 (type: varchar(50)), _col3 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3442744499344 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3361669960752 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_store_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26856185846 Data size: 3361669960752 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                        input vertices:
                          1 Map 12
                        Statistics: Num rows: 26856185846 Data size: 4006218421056 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col4 (type: int), _col0 (type: bigint), CASE WHEN (_col5) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col6) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col7) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col8) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col9) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col10) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col11) THEN (_col1) ELSE (null) END (type: decimal(7,2))
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                          Statistics: Num rows: 26856185846 Data size: 4006218421056 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8)
                            keys: _col0 (type: int), _col1 (type: bigint)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                            Statistics: Num rows: 26856185846 Data size: 21372464358712 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: int), _col1 (type: bigint)
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                              Statistics: Num rows: 26856185846 Data size: 21372464358712 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2)), _col8 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_47_d_d_week_seq_min) AND DynamicValue(RS_47_d_d_week_seq_max) and (d_week_seq - 52) BETWEEN DynamicValue(RS_25_d_d_week_seq_min) AND DynamicValue(RS_25_d_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_47_d_d_week_seq_bloom_filter)) and in_bloom_filter((d_week_seq - 52), DynamicValue(RS_25_d_d_week_seq_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_47_d_d_week_seq_min) AND DynamicValue(RS_47_d_d_week_seq_max) and (d_week_seq - 52) BETWEEN DynamicValue(RS_25_d_d_week_seq_min) AND DynamicValue(RS_25_d_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_47_d_d_week_seq_bloom_filter)) and in_bloom_filter((d_week_seq - 52), DynamicValue(RS_25_d_d_week_seq_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_week_seq (type: int), (d_day_name = &apos;Sunday   &apos;) (type: boolean), (d_day_name = &apos;Monday   &apos;) (type: boolean), (d_day_name = &apos;Tuesday  &apos;) (type: boolean), (d_day_name = &apos;Wednesday&apos;) (type: boolean), (d_day_name = &apos;Thursday &apos;) (type: boolean), (d_day_name = &apos;Friday   &apos;) (type: boolean), (d_day_name = &apos;Saturday &apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.50000685
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 10
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: s_store_id is not null (type: boolean)
                  Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: s_store_id is not null (type: boolean)
                    Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_store_id (type: char(16))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: char(16))
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: char(16))
                        Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3442744499344 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3361669960752 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_store_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26856185846 Data size: 3361669960752 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 26856185846 Data size: 4006218421056 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col4 (type: int), _col0 (type: bigint), CASE WHEN (_col5) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col6) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col7) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col8) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col9) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col10) THEN (_col1) ELSE (null) END (type: decimal(7,2)), CASE WHEN (_col11) THEN (_col1) ELSE (null) END (type: decimal(7,2))
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                          Statistics: Num rows: 26856185846 Data size: 4006218421056 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2), sum(_col3), sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8)
                            keys: _col0 (type: int), _col1 (type: bigint)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                            Statistics: Num rows: 26856185846 Data size: 21372464358712 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: int), _col1 (type: bigint)
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: int), _col1 (type: bigint)
                              Statistics: Num rows: 26856185846 Data size: 21372464358712 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2)), _col8 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_25_d_d_week_seq_min) AND DynamicValue(RS_25_d_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_25_d_d_week_seq_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_week_seq is not null and d_week_seq BETWEEN DynamicValue(RS_25_d_d_week_seq_min) AND DynamicValue(RS_25_d_d_week_seq_max) and in_bloom_filter(d_week_seq, DynamicValue(RS_25_d_d_week_seq_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 7524047 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_week_seq (type: int), (d_day_name = &apos;Sunday   &apos;) (type: boolean), (d_day_name = &apos;Monday   &apos;) (type: boolean), (d_day_name = &apos;Tuesday  &apos;) (type: boolean), (d_day_name = &apos;Wednesday&apos;) (type: boolean), (d_day_name = &apos;Thursday &apos;) (type: boolean), (d_day_name = &apos;Friday   &apos;) (type: boolean), (d_day_name = &apos;Saturday &apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 73049 Data size: 2921960 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.50000685
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 3
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: d
                  filterExpr: ((d_month_seq BETWEEN 1205 AND 1216 and d_week_seq is not null) or (d_month_seq BETWEEN 1217 AND 1228 and d_week_seq is not null)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_month_seq BETWEEN 1205 AND 1216 and d_week_seq is not null) (type: boolean)
                    Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_week_seq (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 359 Data size: 1436 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 359 Data size: 1436 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: int)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 1436 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
                  Filter Operator
                    predicate: (d_month_seq BETWEEN 1217 AND 1228 and d_week_seq is not null) (type: boolean)
                    Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_week_seq (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 359 Data size: 1436 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: int)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: int)
                        Statistics: Num rows: 359 Data size: 1436 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: int)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 1436 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
                keys: KEY._col0 (type: int), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 8585720 Data size: 6832615624 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  input vertices:
                    1 Map 7
                  Statistics: Num rows: 272840 Data size: 215563144 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint), (_col0 - 52) (type: int)
                    null sort order: aa
                    sort order: ++
                    Map-reduce partition columns: _col1 (type: bigint), (_col0 - 52) (type: int)
                    Statistics: Num rows: 272840 Data size: 215563144 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2)), _col8 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6)
                keys: KEY._col0 (type: int), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 8585720 Data size: 6832615624 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: int)
                    1 _col0 (type: int)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  input vertices:
                    1 Map 7
                  Statistics: Num rows: 272840 Data size: 215563144 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col1 (type: bigint)
                    outputColumnNames: _col1, _col2, _col3, _col5, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                    input vertices:
                      0 Map 1
                    Statistics: Num rows: 272840 Data size: 268474560 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint), _col5 (type: int)
                        1 _col1 (type: bigint), (_col0 - 52) (type: int)
                      outputColumnNames: _col1, _col2, _col5, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col17, _col18, _col19, _col20, _col21, _col22, _col23
                      input vertices:
                        1 Reducer 11
                      Statistics: Num rows: 49627777 Data size: 87344887520 Basic stats: COMPLETE Column stats: COMPLETE
                      Top N Key Operator
                        sort order: +++
                        keys: _col2 (type: varchar(50)), _col1 (type: char(16)), _col5 (type: int)
                        null sort order: zzz
                        Statistics: Num rows: 49627777 Data size: 87344887520 Basic stats: COMPLETE Column stats: COMPLETE
                        top n: 100
                        Select Operator
                          expressions: _col2 (type: varchar(50)), _col1 (type: char(16)), _col5 (type: int), (_col7 / _col17) (type: decimal(37,20)), (_col8 / _col18) (type: decimal(37,20)), (_col9 / _col19) (type: decimal(37,20)), (_col10 / _col20) (type: decimal(37,20)), (_col11 / _col21) (type: decimal(37,20)), (_col12 / _col22) (type: decimal(37,20)), (_col13 / _col23) (type: decimal(37,20))
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                          Statistics: Num rows: 49627777 Data size: 48436710352 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: varchar(50)), _col1 (type: char(16)), _col2 (type: int)
                            null sort order: zzz
                            sort order: +++
                            Statistics: Num rows: 49627777 Data size: 48436710352 Basic stats: COMPLETE Column stats: COMPLETE
                            TopN Hash Memory Usage: 0.04
                            value expressions: _col3 (type: decimal(37,20)), _col4 (type: decimal(37,20)), _col5 (type: decimal(37,20)), _col6 (type: decimal(37,20)), _col7 (type: decimal(37,20)), _col8 (type: decimal(37,20)), _col9 (type: decimal(37,20))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: varchar(50)), KEY.reducesinkkey1 (type: char(16)), KEY.reducesinkkey2 (type: int), VALUE._col0 (type: decimal(37,20)), VALUE._col1 (type: decimal(37,20)), VALUE._col2 (type: decimal(37,20)), VALUE._col3 (type: decimal(37,20)), VALUE._col4 (type: decimal(37,20)), VALUE._col5 (type: decimal(37,20)), VALUE._col6 (type: decimal(37,20))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 49627777 Data size: 48436710352 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 97600 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 97600 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 12 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: binary)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query59
explain with wss as (select d_week_seq, ss_store_sk, sum(case when (d_day_name=&apos;Sunday&apos;) then ss_sales_price else null end) sun_sales, sum(case when (d_day_name=&apos;Monday&apos;) then ss_sales_price else null end) mon_sales, sum(case when (d_day_name=&apos;Tuesday&apos;) then ss_sales_price else  null end) tue_sales, sum(case when (d_day_name=&apos;Wednesday&apos;) then ss_sales_price else null end) wed_sales, sum(case when (d_day_name=&apos;Thursday&apos;) then ss_sales_price else null end) thu_sales, sum(case when (d_day_name=&apos;Friday&apos;) then ss_sales_price else null end) fri_sales, sum(case when (d_day_name=&apos;Saturday&apos;) then ss_sales_price else null end) sat_sales from store_sales,date_dim where d_date_sk = ss_sold_date_sk group by d_week_seq,ss_store_sk ) select  s_store_name1,s_store_id1,d_week_seq1 ,sun_sales1/sun_sales2,mon_sales1/mon_sales2 ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2 ,fri_sales1/fri_sales2,sat_sales1/sat_sales2 from (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1 ,s_store_id s_store_id1,sun_sales sun_sales1 ,mon_sales mon_sales1,tue_sales tue_sales1 ,wed_sales wed_sales1,thu_sales thu_sales1 ,fri_sales fri_sales1,sat_sales sat_sales1 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1205 and 1205 + 11) y, (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2 ,s_store_id s_store_id2,sun_sales sun_sales2 ,mon_sales mon_sales2,tue_sales tue_sales2 ,wed_sales wed_sales2,thu_sales thu_sales2 ,fri_sales fri_sales2,sat_sales sat_sales2 from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1205+ 12 and 1205 + 23) x where s_store_id1=s_store_id2 and d_week_seq1=d_week_seq2-52 order by s_store_name1,s_store_id1,d_week_seq1 limit 100

</samplerData>
</sample>
<sample t="7118" lt="7097" ts="1600984874792" s="true" lb="query60" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="31298" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220107_084e98d7-4b9c-4cd1-9397-06b1c2a97793:268
      Edges:
        Map 1 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 11 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 13 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 8 &lt;- Reducer 10 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 12 &lt;- Map 11 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 14 &lt;- Map 13 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924220107_084e98d7-4b9c-4cd1-9397-06b1c2a97793:268
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_279_container, bigKeyColName:ss_addr_sk, smallTablePos:1, keyRatio:2.2069608940510507E-8
                  Statistics: Num rows: 27503885621 Data size: 3662750247000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 26855655526 Data size: 3576424082968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_addr_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26855655526 Data size: 3576424082968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 455922163 Data size: 3647377424 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 75987030 Data size: 607896352 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 3453819 Data size: 345382012 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: char(16))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 3156 Data size: 669072 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(16))
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: char(16))
                                Statistics: Num rows: 3156 Data size: 669072 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_288_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:1.2737673530191789E-4
                  Statistics: Num rows: 14327953968 Data size: 1944284201568 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 14291948793 Data size: 1939398347408 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_addr_sk (type: bigint), cs_item_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291948793 Data size: 1939398347408 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 240915901 Data size: 26530546888 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 40152652 Data size: 798947360 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 1825048 Data size: 182504912 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: char(16))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(16))
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: char(16))
                                Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_285_container, bigKeyColName:ws_bill_addr_sk, smallTablePos:1, keyRatio:8.432707440778109E-8
                  Statistics: Num rows: 7198162681 Data size: 978842066440 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 7197262394 Data size: 978719640968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_bill_addr_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 7197262394 Data size: 978719640968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 122186235 Data size: 15531793464 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 20364374 Data size: 2342881648 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col7
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 925617 Data size: 95387572 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col7 (type: char(16))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1
                              Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(16))
                                null sort order: a
                                sort order: +
                                Map-reduce partition columns: _col0 (type: char(16))
                                Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 1998) and (d_moy = 10)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 1998) and (d_moy = 10)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 11
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_gmt_offset = -5) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 3790780736 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_gmt_offset = -5) (type: boolean)
                    Statistics: Num rows: 5416667 Data size: 631796904 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5416667 Data size: 43333336 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_item_id is not null (type: boolean)
                  Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: i_item_id is not null (type: boolean)
                    Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: char(16))
                          1 _col0 (type: char(16))
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Reducer 10
                        Statistics: Num rows: 34711 Data size: 3748788 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 34711 Data size: 3748788 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(16))
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 34711 Data size: 3748788 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(16))
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 34711 Data size: 3748788 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_category = &apos;Children                                          &apos;) and i_item_id is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 76380000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_category = &apos;Children                                          &apos;) and i_item_id is not null) (type: boolean)
                    Statistics: Num rows: 36545 Data size: 6943550 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_id (type: char(16))
                      outputColumnNames: i_item_id
                      Statistics: Num rows: 36545 Data size: 6943550 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: i_item_id (type: char(16))
                        minReductionHashAggr: 0.5000137
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 18272 Data size: 1827200 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(16))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: char(16))
                          Statistics: Num rows: 18272 Data size: 1827200 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 18272 Data size: 1827200 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: char(16))
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: char(16))
                  Statistics: Num rows: 18272 Data size: 1827200 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col0 (type: char(16))
                  null sort order: z
                  Statistics: Num rows: 4734 Data size: 1003608 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Group By Operator
                    aggregations: sum(_col1)
                    keys: _col0 (type: char(16))
                    minReductionHashAggr: 0.6666666
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: z
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col1 (type: decimal(27,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col0 (type: char(16))
                  null sort order: z
                  Statistics: Num rows: 4734 Data size: 1003608 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Group By Operator
                    aggregations: sum(_col1)
                    keys: _col0 (type: char(16))
                    minReductionHashAggr: 0.6666666
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: z
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col1 (type: decimal(27,2))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col0 (type: char(16))
                  null sort order: z
                  Statistics: Num rows: 4734 Data size: 1003608 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Group By Operator
                    aggregations: sum(_col1)
                    keys: _col0 (type: char(16))
                    minReductionHashAggr: 0.6666666
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: z
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col1 (type: decimal(27,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: ++
                  keys: _col0 (type: char(16)), _col1 (type: decimal(27,2))
                  null sort order: zz
                  Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16)), _col1 (type: decimal(27,2))
                    null sort order: zz
                    sort order: ++
                    Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), KEY.reducesinkkey1 (type: decimal(27,2))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 1578 Data size: 334536 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 21200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 21200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 3 
            Vertex: Union 3

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query60
explain with ss as ( select i_item_id,sum(ss_ext_sales_price) total_sales from store_sales, date_dim, customer_address, item where i_item_id in (select i_item_id from item where i_category in (&apos;Children&apos;)) and     ss_item_sk              = i_item_sk and     ss_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     ss_addr_sk              = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id), cs as ( select i_item_id,sum(cs_ext_sales_price) total_sales from catalog_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_category in (&apos;Children&apos;)) and     cs_item_sk              = i_item_sk and     cs_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     cs_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id), ws as ( select i_item_id,sum(ws_ext_sales_price) total_sales from web_sales, date_dim, customer_address, item where i_item_id               in (select i_item_id from item where i_category in (&apos;Children&apos;)) and     ws_item_sk              = i_item_sk and     ws_sold_date_sk         = d_date_sk and     d_year                  = 1998 and     d_moy                   = 10 and     ws_bill_addr_sk         = ca_address_sk and     ca_gmt_offset           = -5 group by i_item_id) select i_item_id ,sum(total_sales) total_sales from  (select * from ss union all select * from cs union all select * from ws) tmp1 group by i_item_id order by i_item_id ,total_sales limit 100

</samplerData>
</sample>
<sample t="4327" lt="4320" ts="1600984879121" s="true" lb="query61" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="23997" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220114_d47107de-8dd6-4814-ab67-2768d7bca967:269
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Map 8 &lt;- Map 3 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 10 &lt;- Reducer 9 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
        Reducer 9 &lt;- Map 8 (CUSTOM_SIMPLE_EDGE), Reducer 2 (BROADCAST_EDGE)
      DagName: zabetak_20200924220114_d47107de-8dd6-4814-ab67-2768d7bca967:269
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_customer_sk is not null and ss_store_sk is not null and ss_promo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_204_container, bigKeyColName:ss_customer_sk, smallTablePos:1, keyRatio:5.9947602412260626E-5
                  Statistics: Num rows: 27503885621 Data size: 4092451202512 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_customer_sk is not null and ss_store_sk is not null and ss_promo_sk is not null) (type: boolean)
                    Statistics: Num rows: 25605916481 Data size: 3810042156848 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_promo_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 25605916481 Data size: 3810042156848 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col5 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 434705636 Data size: 3477645224 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col3, _col4
                          input vertices:
                            1 Map 4
                          Statistics: Num rows: 39518204 Data size: 136 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col3, _col4
                            input vertices:
                              1 Map 5
                            Statistics: Num rows: 9892750 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col3 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col1, _col4
                              input vertices:
                                1 Map 6
                              Statistics: Num rows: 9892750 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col1 (type: bigint)
                                  1 _col0 (type: bigint)
                                outputColumnNames: _col4
                                input vertices:
                                  1 Map 7
                                Statistics: Num rows: 1648792 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                Group By Operator
                                  aggregations: sum(_col4)
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0
                                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    null sort order: 
                                    sort order: 
                                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions: _col0 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2001) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2001) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 8
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_category = &apos;Sports                                            &apos;) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_category = &apos;Sports                                            &apos;) (type: boolean)
                    Statistics: Num rows: 36545 Data size: 3581410 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 36545 Data size: 292360 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 36545 Data size: 292360 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 36545 Data size: 292360 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_gmt_offset = -6) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 179440 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_gmt_offset = -6) (type: boolean)
                    Statistics: Num rows: 375 Data size: 44888 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 375 Data size: 3000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 375 Data size: 3000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 375 Data size: 3000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  filterExpr: ((p_channel_tv = &apos;Y&apos;) or (p_channel_email = &apos;Y&apos;) or (p_channel_dmail = &apos;Y&apos;)) (type: boolean)
                  Statistics: Num rows: 2000 Data size: 526000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((p_channel_tv = &apos;Y&apos;) or (p_channel_email = &apos;Y&apos;) or (p_channel_dmail = &apos;Y&apos;)) (type: boolean)
                    Statistics: Num rows: 2000 Data size: 526000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: p_promo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 2000 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2000 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: (ca_gmt_offset = -6) (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 7581731600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_gmt_offset = -6) (type: boolean)
                    Statistics: Num rows: 10833333 Data size: 1263622024 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 10833333 Data size: 86666664 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 10833333 Data size: 86666664 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 10833333 Data size: 86666664 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_208_container, bigKeyColName:ss_customer_sk, smallTablePos:1, keyRatio:6.13930345431173E-5
                  Statistics: Num rows: 27503885621 Data size: 3877600458528 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 26223309636 Data size: 3697060076208 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_store_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 26223309636 Data size: 3697060076208 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 445186975 Data size: 3561495928 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col3
                          input vertices:
                            1 Map 4
                          Statistics: Num rows: 40471041 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col3
                            input vertices:
                              1 Map 5
                            Statistics: Num rows: 10131278 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col1 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col3
                              input vertices:
                                1 Map 7
                              Statistics: Num rows: 1688547 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col3)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0
                                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  null sort order: 
                                  sort order: 
                                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col0 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: decimal(17,2)), KEY.reducesinkkey1 (type: decimal(17,2)), VALUE._col0 (type: decimal(38,19))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 336 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 336 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 336 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: decimal(17,2)), CAST( _col0 AS decimal(15,4)) (type: decimal(15,4))
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1 Data size: 224 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 224 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(17,2)), _col1 (type: decimal(15,4))
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: decimal(17,2)), CAST( _col0 AS decimal(15,4)) (type: decimal(15,4))
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 1 Data size: 224 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 
                      1 
                    outputColumnNames: _col0, _col1, _col2, _col3
                    input vertices:
                      0 Reducer 2
                    Statistics: Num rows: 1 Data size: 448 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++
                      keys: _col0 (type: decimal(17,2)), _col2 (type: decimal(17,2))
                      null sort order: zz
                      Statistics: Num rows: 1 Data size: 448 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Select Operator
                        expressions: _col0 (type: decimal(17,2)), _col2 (type: decimal(17,2)), ((_col1 / _col3) * 100) (type: decimal(38,19))
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 1 Data size: 336 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: decimal(17,2)), _col1 (type: decimal(17,2))
                          null sort order: zz
                          sort order: ++
                          Statistics: Num rows: 1 Data size: 336 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
                          value expressions: _col2 (type: decimal(38,19))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query61
explain select  promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from (select sum(ss_ext_sales_price) promotions from  store_sales ,store ,promotion ,date_dim ,customer ,customer_address ,item where ss_sold_date_sk = d_date_sk and   ss_store_sk = s_store_sk and   ss_promo_sk = p_promo_sk and   ss_customer_sk= c_customer_sk and   ca_address_sk = c_current_addr_sk and   ss_item_sk = i_item_sk and   ca_gmt_offset = -6 and   i_category = &apos;Sports&apos; and   (p_channel_dmail = &apos;Y&apos; or p_channel_email = &apos;Y&apos; or p_channel_tv = &apos;Y&apos;) and   s_gmt_offset = -6 and   d_year = 2001 and   d_moy  = 12) promotional_sales, (select sum(ss_ext_sales_price) total from  store_sales ,store ,date_dim ,customer ,customer_address ,item where ss_sold_date_sk = d_date_sk and   ss_store_sk = s_store_sk and   ss_customer_sk= c_customer_sk and   ca_address_sk = c_current_addr_sk and   ss_item_sk = i_item_sk and   ca_gmt_offset = -6 and   i_category = &apos;Sports&apos; and   s_gmt_offset = -6 and   d_year = 2001 and   d_moy  = 12) all_sales order by promotions, total limit 100

</samplerData>
</sample>
<sample t="3050" lt="3045" ts="1600984882172" s="true" lb="query62" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="13889" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220119_e98e18a6-e25c-46f8-9000-81fe58097ca6:270
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924220119_e98e18a6-e25c-46f8-9000-81fe58097ca6:270
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: (ws_warehouse_sk is not null and ws_ship_mode_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_99_container, bigKeyColName:ws_ship_date_sk, smallTablePos:1, keyRatio:0.18438878356153138
                  Statistics: Num rows: 7199963324 Data size: 287940924896 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_warehouse_sk is not null and ws_ship_mode_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null) (type: boolean)
                    Statistics: Num rows: 7192765012 Data size: 287653050008 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_ship_date_sk (type: bigint), ws_web_site_sk (type: bigint), ws_ship_mode_sk (type: bigint), ws_warehouse_sk (type: bigint), CASE WHEN (((ws_ship_date_sk - ws_sold_date_sk) &lt;= 30L)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((ws_ship_date_sk - ws_sold_date_sk) &gt; 30L) and ((ws_ship_date_sk - ws_sold_date_sk) &lt;= 60L))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((ws_ship_date_sk - ws_sold_date_sk) &gt; 60L) and ((ws_ship_date_sk - ws_sold_date_sk) &lt;= 90L))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((ws_ship_date_sk - ws_sold_date_sk) &gt; 90L) and ((ws_ship_date_sk - ws_sold_date_sk) &lt;= 120L))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((ws_ship_date_sk - ws_sold_date_sk) &gt; 120L)) THEN (1) ELSE (0) END (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 7192765012 Data size: 373966230152 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 1327592479 Data size: 58370900524 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col11
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 1327592479 Data size: 169903058936 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col3 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8, _col11, _col13
                            input vertices:
                              1 Map 6
                            Statistics: Num rows: 1327592479 Data size: 290728366613 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col1 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col11, _col13, _col15
                              input vertices:
                                1 Map 7
                              Statistics: Num rows: 1327592479 Data size: 399605336179 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: +++
                                keys: _col13 (type: string), _col11 (type: char(30)), _col15 (type: varchar(50))
                                null sort order: zzz
                                Statistics: Num rows: 1327592479 Data size: 399605336179 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 100
                                Group By Operator
                                  aggregations: sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8)
                                  keys: _col13 (type: string), _col11 (type: char(30)), _col15 (type: varchar(50))
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                                  Statistics: Num rows: 3278100 Data size: 1052270100 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: string), _col1 (type: char(30)), _col2 (type: varchar(50))
                                    null sort order: zzz
                                    sort order: +++
                                    Map-reduce partition columns: _col0 (type: string), _col1 (type: char(30)), _col2 (type: varchar(50))
                                    Statistics: Num rows: 3278100 Data size: 1052270100 Basic stats: COMPLETE Column stats: COMPLETE
                                    TopN Hash Memory Usage: 0.04
                                    value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_month_seq BETWEEN 1215 AND 1226 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1215 AND 1226 (type: boolean)
                    Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: ship_mode
                  Statistics: Num rows: 20 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: sm_ship_mode_sk (type: bigint), sm_type (type: char(30))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 20 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 20 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: warehouse
                  Statistics: Num rows: 25 Data size: 2700 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: w_warehouse_sk (type: bigint), substr(w_warehouse_name, 1, 20) (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 25 Data size: 2675 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 25 Data size: 2675 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: web_site
                  Statistics: Num rows: 78 Data size: 7644 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: web_site_sk (type: bigint), web_name (type: varchar(50))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 78 Data size: 7644 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 78 Data size: 7644 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4)
                keys: KEY._col0 (type: string), KEY._col1 (type: char(30)), KEY._col2 (type: varchar(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 2100 Data size: 674100 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(30)), _col2 (type: varchar(50)), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col0 (type: string)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 2100 Data size: 882000 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col8 (type: string), _col1 (type: char(30)), _col2 (type: varchar(50))
                    null sort order: zzz
                    sort order: +++
                    Statistics: Num rows: 2100 Data size: 882000 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: char(30)), KEY.reducesinkkey2 (type: varchar(50)), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 2100 Data size: 882000 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 42000 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 42000 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query62
explain select substr(w_warehouse_name,1,20) ,sm_type ,web_name ,sum(case when (ws_ship_date_sk - ws_sold_date_sk &lt;= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk &gt; 30) and (ws_ship_date_sk - ws_sold_date_sk &lt;= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk &gt; 60) and (ws_ship_date_sk - ws_sold_date_sk &lt;= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk &gt; 90) and (ws_ship_date_sk - ws_sold_date_sk &lt;= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (ws_ship_date_sk - ws_sold_date_sk  &gt; 120) then 1 else 0 end)  as `&gt;120 days` from web_sales ,warehouse ,ship_mode ,web_site ,date_dim where d_month_seq between 1215 and 1215 + 11 and ws_ship_date_sk   = d_date_sk and ws_warehouse_sk   = w_warehouse_sk and ws_ship_mode_sk   = sm_ship_mode_sk and ws_web_site_sk    = web_site_sk group by substr(w_warehouse_name,1,20) ,sm_type ,web_name order by substr(w_warehouse_name,1,20) ,sm_type ,web_name limit 100

</samplerData>
</sample>
<sample t="2506" lt="2500" ts="1600984884679" s="true" lb="query63" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="17168" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220122_ebc80e5d-3fe8-462c-8baa-e055e405fa67:271
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924220122_ebc80e5d-3fe8-462c-8baa-e055e405fa67:271
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_60_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.0201725816724738E-4
                  Statistics: Num rows: 27503885621 Data size: 3662775584312 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3576519447520 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26856185846 Data size: 3366729535456 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col4
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 2805871 Data size: 33670564 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col4, _col6
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 551640 Data size: 4413232 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col4 (type: int), _col6 (type: int)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 108 Data size: 12960 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: int), _col1 (type: int)
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: int)
                              Statistics: Num rows: 108 Data size: 12960 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_brand) IN (&apos;scholaramalgamalg #14                             &apos;, &apos;scholaramalgamalg #7                              &apos;, &apos;exportiunivamalg #9                               &apos;, &apos;scholaramalgamalg #9                              &apos;, &apos;amalgimporto #1                                   &apos;, &apos;edu packscholar #1                                &apos;, &apos;exportiimporto #1                                 &apos;, &apos;importoamalg #1                                   &apos;) and (i_class) IN (&apos;personal                                          &apos;, &apos;portable                                          &apos;, &apos;reference                                         &apos;, &apos;self-help                                         &apos;, &apos;accessories                                       &apos;, &apos;classical                                         &apos;, &apos;fragrances                                        &apos;, &apos;pants                                             &apos;) and (i_category) IN (&apos;Books                                             &apos;, &apos;Children                                          &apos;, &apos;Electronics                                       &apos;, &apos;Women                                             &apos;, &apos;Music                                             &apos;, &apos;Men                                               &apos;) and (((i_category) IN (&apos;Books                                             &apos;, &apos;Children                                          &apos;, &apos;Electronics                                       &apos;) and (i_class) IN (&apos;personal                                          &apos;, &apos;portable                                          &apos;, &apos;reference                                         &apos;, &apos;self-help                                         &apos;) and (i_brand) IN (&apos;scholaramalgamalg #14                             &apos;, &apos;scholaramalgamalg #7                              &apos;, &apos;exportiunivamalg #9                               &apos;, &apos;scholaramalgamalg #9                              &apos;)) or ((i_category) IN (&apos;Women                                             &apos;, &apos;Music                                             &apos;, &apos;Men                                               &apos;) and (i_class) IN (&apos;accessories                                       &apos;, &apos;classical                                         &apos;, &apos;fragrances                                        &apos;, &apos;pants                                             &apos;) and (i_brand) IN (&apos;amalgimporto #1                                   &apos;, &apos;edu packscholar #1                                &apos;, &apos;exportiimporto #1                                 &apos;, &apos;importoamalg #1                                   &apos;)))) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 118184052 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_brand) IN (&apos;scholaramalgamalg #14                             &apos;, &apos;scholaramalgamalg #7                              &apos;, &apos;exportiunivamalg #9                               &apos;, &apos;scholaramalgamalg #9                              &apos;, &apos;amalgimporto #1                                   &apos;, &apos;edu packscholar #1                                &apos;, &apos;exportiimporto #1                                 &apos;, &apos;importoamalg #1                                   &apos;) and (i_class) IN (&apos;personal                                          &apos;, &apos;portable                                          &apos;, &apos;reference                                         &apos;, &apos;self-help                                         &apos;, &apos;accessories                                       &apos;, &apos;classical                                         &apos;, &apos;fragrances                                        &apos;, &apos;pants                                             &apos;) and (i_category) IN (&apos;Books                                             &apos;, &apos;Children                                          &apos;, &apos;Electronics                                       &apos;, &apos;Women                                             &apos;, &apos;Music                                             &apos;, &apos;Men                                               &apos;) and (((i_category) IN (&apos;Books                                             &apos;, &apos;Children                                          &apos;, &apos;Electronics                                       &apos;) and (i_class) IN (&apos;personal                                          &apos;, &apos;portable                                          &apos;, &apos;reference                                         &apos;, &apos;self-help                                         &apos;) and (i_brand) IN (&apos;scholaramalgamalg #14                             &apos;, &apos;scholaramalgamalg #7                              &apos;, &apos;exportiunivamalg #9                               &apos;, &apos;scholaramalgamalg #9                              &apos;)) or ((i_category) IN (&apos;Women                                             &apos;, &apos;Music                                             &apos;, &apos;Men                                               &apos;) and (i_class) IN (&apos;accessories                                       &apos;, &apos;classical                                         &apos;, &apos;fragrances                                        &apos;, &apos;pants                                             &apos;) and (i_brand) IN (&apos;amalgimporto #1                                   &apos;, &apos;edu packscholar #1                                &apos;, &apos;exportiimporto #1                                 &apos;, &apos;importoamalg #1                                   &apos;)))) (type: boolean)
                    Statistics: Num rows: 42 Data size: 12348 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_manager_id (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 42 Data size: 504 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 42 Data size: 504 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_month_seq) IN (1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_month_seq) IN (1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222) (type: boolean)
                    Statistics: Num rows: 359 Data size: 5744 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_moy (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 108 Data size: 12960 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: int), _col2 (type: decimal(17,2))
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 108 Data size: 12528 Basic stats: COMPLETE Column stats: COMPLETE
                  PTF Operator
                    Function definitions:
                        Input definition
                          input alias: ptf_0
                          output shape: _col0: int, _col2: decimal(17,2)
                          type: WINDOWING
                        Windowing table definition
                          input alias: ptf_1
                          name: windowingtablefunction
                          order by: _col0 ASC NULLS FIRST
                          partition by: _col0
                          raw input shape:
                          window functions:
                              window function definition
                                alias: avg_window_0
                                arguments: _col2
                                name: avg
                                window function: GenericUDAFAverageEvaluatorDecimal
                                window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                    Statistics: Num rows: 108 Data size: 12528 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: avg_window_0 (type: decimal(21,6)), _col0 (type: int), _col2 (type: decimal(17,2))
                      outputColumnNames: avg_window_0, _col0, _col2
                      Statistics: Num rows: 108 Data size: 12528 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: CASE WHEN ((avg_window_0 &gt; 0)) THEN (((abs((_col2 - avg_window_0)) / avg_window_0) &gt; 0.1)) ELSE (false) END (type: boolean)
                        Statistics: Num rows: 54 Data size: 12312 Basic stats: COMPLETE Column stats: COMPLETE
                        Top N Key Operator
                          sort order: +++
                          keys: _col0 (type: int), avg_window_0 (type: decimal(21,6)), _col2 (type: decimal(17,2))
                          null sort order: zzz
                          Statistics: Num rows: 54 Data size: 12312 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 100
                          Select Operator
                            expressions: _col0 (type: int), _col2 (type: decimal(17,2)), avg_window_0 (type: decimal(21,6))
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 54 Data size: 12312 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: int), _col2 (type: decimal(21,6)), _col1 (type: decimal(17,2))
                              null sort order: zzz
                              sort order: +++
                              Statistics: Num rows: 54 Data size: 12312 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: int), KEY.reducesinkkey2 (type: decimal(17,2)), KEY.reducesinkkey1 (type: decimal(21,6))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 54 Data size: 12312 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 54 Data size: 12312 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 54 Data size: 12312 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query63
explain select  * from (select i_manager_id ,sum(ss_sales_price) sum_sales ,avg(sum(ss_sales_price)) over (partition by i_manager_id) avg_monthly_sales from item ,store_sales ,date_dim ,store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_month_seq in (1211,1211+1,1211+2,1211+3,1211+4,1211+5,1211+6,1211+7,1211+8,1211+9,1211+10,1211+11) and ((    i_category in (&apos;Books&apos;,&apos;Children&apos;,&apos;Electronics&apos;) and i_class in (&apos;personal&apos;,&apos;portable&apos;,&apos;reference&apos;,&apos;self-help&apos;) and i_brand in (&apos;scholaramalgamalg #14&apos;,&apos;scholaramalgamalg #7&apos;, &apos;exportiunivamalg #9&apos;,&apos;scholaramalgamalg #9&apos;)) or(    i_category in (&apos;Women&apos;,&apos;Music&apos;,&apos;Men&apos;) and i_class in (&apos;accessories&apos;,&apos;classical&apos;,&apos;fragrances&apos;,&apos;pants&apos;) and i_brand in (&apos;amalgimporto #1&apos;,&apos;edu packscholar #1&apos;,&apos;exportiimporto #1&apos;, &apos;importoamalg #1&apos;))) group by i_manager_id, d_moy) tmp1 where case when avg_monthly_sales &gt; 0 then abs (sum_sales - avg_monthly_sales) / avg_monthly_sales else null end &gt; 0.1 order by i_manager_id ,avg_monthly_sales ,sum_sales limit 100

</samplerData>
</sample>
<sample t="15664" lt="15650" ts="1600984900345" s="true" lb="query64" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="90363" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220124_c2ac7fae-61dd-4f0a-859a-748a0d90b619:272
      Edges:
        Map 1 &lt;- Map 17 (BROADCAST_EDGE), Map 2 (BROADCAST_EDGE), Reducer 28 (BROADCAST_EDGE)
        Map 11 &lt;- Reducer 3 (BROADCAST_EDGE)
        Map 12 &lt;- Reducer 3 (BROADCAST_EDGE)
        Map 22 &lt;- Map 17 (BROADCAST_EDGE), Map 2 (BROADCAST_EDGE), Reducer 3 (BROADCAST_EDGE)
        Map 30 &lt;- Reducer 4 (BROADCAST_EDGE)
        Map 33 &lt;- Reducer 4 (BROADCAST_EDGE)
        Map 34 &lt;- Reducer 4 (BROADCAST_EDGE)
        Map 5 &lt;- Map 1 (BROADCAST_EDGE), Reducer 10 (BROADCAST_EDGE)
        Map 8 &lt;- Reducer 3 (BROADCAST_EDGE)
        Reducer 10 &lt;- Reducer 9 (SIMPLE_EDGE)
        Reducer 23 &lt;- Map 22 (CUSTOM_SIMPLE_EDGE), Map 29 (CUSTOM_SIMPLE_EDGE), Reducer 32 (BROADCAST_EDGE)
        Reducer 24 &lt;- Map 13 (BROADCAST_EDGE), Map 14 (BROADCAST_EDGE), Map 15 (BROADCAST_EDGE), Map 16 (BROADCAST_EDGE), Map 17 (BROADCAST_EDGE), Map 18 (BROADCAST_EDGE), Map 19 (BROADCAST_EDGE), Map 20 (BROADCAST_EDGE), Map 21 (BROADCAST_EDGE), Map 34 (CUSTOM_SIMPLE_EDGE), Reducer 23 (CUSTOM_SIMPLE_EDGE)
        Reducer 25 &lt;- Reducer 24 (SIMPLE_EDGE)
        Reducer 26 &lt;- Reducer 25 (CUSTOM_SIMPLE_EDGE), Reducer 7 (CUSTOM_SIMPLE_EDGE)
        Reducer 27 &lt;- Reducer 26 (SIMPLE_EDGE)
        Reducer 28 &lt;- Reducer 25 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 31 &lt;- Map 30 (CUSTOM_SIMPLE_EDGE), Map 33 (CUSTOM_SIMPLE_EDGE)
        Reducer 32 &lt;- Reducer 31 (SIMPLE_EDGE)
        Reducer 4 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Map 12 (CUSTOM_SIMPLE_EDGE), Map 13 (BROADCAST_EDGE), Map 14 (BROADCAST_EDGE), Map 15 (BROADCAST_EDGE), Map 16 (BROADCAST_EDGE), Map 17 (BROADCAST_EDGE), Map 18 (BROADCAST_EDGE), Map 19 (BROADCAST_EDGE), Map 20 (BROADCAST_EDGE), Map 21 (BROADCAST_EDGE), Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
        Reducer 9 &lt;- Map 11 (CUSTOM_SIMPLE_EDGE), Map 8 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220124_c2ac7fae-61dd-4f0a-859a-748a0d90b619:272
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_addr_sk is not null and ss_cdemo_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null and ss_promo_sk is not null and ss_item_sk BETWEEN DynamicValue(RS_197_item_i_item_sk_min) AND DynamicValue(RS_197_item_i_item_sk_max) and in_bloom_filter(ss_item_sk, DynamicValue(RS_197_item_i_item_sk_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_943_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.890641952070093E-9
                  Statistics: Num rows: 27503885621 Data size: 10972731325096 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_addr_sk is not null and ss_cdemo_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null and ss_promo_sk is not null and ss_item_sk BETWEEN DynamicValue(RS_197_item_i_item_sk_min) AND DynamicValue(RS_197_item_i_item_sk_max) and in_bloom_filter(ss_item_sk, DynamicValue(RS_197_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 23837836636 Data size: 9510153597392 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_cdemo_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_wholesale_cost (type: decimal(7,2)), ss_list_price (type: decimal(7,2)), ss_coupon_amt (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 23837836636 Data size: 9323940747080 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 270992322 Data size: 8671754680 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col10 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col11
                          input vertices:
                            1 Map 17
                          Statistics: Num rows: 54464848 Data size: 1307156728 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col1 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col1 (type: bigint)
                            Statistics: Num rows: 54464848 Data size: 1307156728 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: decimal(7,2)), _col8 (type: decimal(7,2)), _col9 (type: decimal(7,2)), _col11 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: (cr_item_sk BETWEEN DynamicValue(RS_49_item_i_item_sk_min) AND DynamicValue(RS_49_item_i_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_49_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 497213063872 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_item_sk BETWEEN DynamicValue(RS_49_item_i_item_sk_min) AND DynamicValue(RS_49_item_i_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_49_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 1440033112 Data size: 497213063872 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint), ((cr_refunded_cash + cr_reversed_charge) + cr_store_credit) (type: decimal(9,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1440033112 Data size: 184324238336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 1440033112 Data size: 184324238336 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: decimal(9,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: (sr_item_sk BETWEEN DynamicValue(RS_49_item_i_item_sk_min) AND DynamicValue(RS_49_item_i_item_sk_max) and in_bloom_filter(sr_item_sk, DynamicValue(RS_49_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (sr_item_sk BETWEEN DynamicValue(RS_49_item_i_item_sk_min) AND DynamicValue(RS_49_item_i_item_sk_max) and in_bloom_filter(sr_item_sk, DynamicValue(RS_49_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_store_name is not null and s_zip is not null) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 277500 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_store_name is not null and s_zip is not null) (type: boolean)
                    Statistics: Num rows: 1500 Data size: 277500 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_store_name (type: varchar(50)), s_zip (type: char(10))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1500 Data size: 277500 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1500 Data size: 277500 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(50)), _col2 (type: char(10))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1500 Data size: 277500 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(50)), _col2 (type: char(10))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: hd1
                  filterExpr: hd_income_band_sk is not null (type: boolean)
                  Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: hd_income_band_sk is not null (type: boolean)
                    Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: hd2
                  filterExpr: hd_income_band_sk is not null (type: boolean)
                  Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: hd_income_band_sk is not null (type: boolean)
                    Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: d2
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: d_date_sk (type: bigint), d_year (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: d3
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: d_date_sk (type: bigint), d_year (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int)
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Select Operator
                    expressions: d_date_sk (type: bigint), d_year (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int)
                  Filter Operator
                    predicate: (d_year = 1999) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 22
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 18 
            Map Operator Tree:
                TableScan
                  alias: cd1
                  Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cd_demo_sk (type: bigint), cd_marital_status (type: char(1))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(1))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(1))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: cd2
                  Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cd_demo_sk (type: bigint), cd_marital_status (type: char(1))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(1))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(1))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_current_price BETWEEN 81 AND 90 and (i_color) IN (&apos;azure               &apos;, &apos;gainsboro           &apos;, &apos;misty               &apos;, &apos;blush               &apos;, &apos;hot                 &apos;, &apos;lemon               &apos;)) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 83904432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_current_price BETWEEN 81 AND 90 and (i_color) IN (&apos;azure               &apos;, &apos;gainsboro           &apos;, &apos;misty               &apos;, &apos;blush               &apos;, &apos;hot                 &apos;, &apos;lemon               &apos;)) (type: boolean)
                    Statistics: Num rows: 4570 Data size: 953898 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 4570 Data size: 36560 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 4570 Data size: 36560 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 4570 Data size: 36560 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_product_name (type: char(50))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 4570 Data size: 525550 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 4570 Data size: 525550 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(50))
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 4570 Data size: 36560 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: ad1
                  Statistics: Num rows: 32500000 Data size: 11992500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ca_address_sk (type: bigint), ca_street_number (type: char(10)), ca_street_name (type: varchar(60)), ca_city (type: varchar(60)), ca_zip (type: char(10))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 32500000 Data size: 11992500000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 11992500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(10)), _col2 (type: varchar(60)), _col3 (type: varchar(60)), _col4 (type: char(10))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 11992500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(10)), _col2 (type: varchar(60)), _col3 (type: varchar(60)), _col4 (type: char(10))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: ad2
                  Statistics: Num rows: 32500000 Data size: 11992500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ca_address_sk (type: bigint), ca_street_number (type: char(10)), ca_street_name (type: varchar(60)), ca_city (type: varchar(60)), ca_zip (type: char(10))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 32500000 Data size: 11992500000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 11992500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(10)), _col2 (type: varchar(60)), _col3 (type: varchar(60)), _col4 (type: char(10))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 11992500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(10)), _col2 (type: varchar(60)), _col3 (type: varchar(60)), _col4 (type: char(10))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 22 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_addr_sk is not null and ss_cdemo_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null and ss_promo_sk is not null and ss_item_sk BETWEEN DynamicValue(RS_49_item_i_item_sk_min) AND DynamicValue(RS_49_item_i_item_sk_max) and in_bloom_filter(ss_item_sk, DynamicValue(RS_49_item_i_item_sk_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_958_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.890641952070093E-9
                  Statistics: Num rows: 27503885621 Data size: 10972731325096 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_addr_sk is not null and ss_cdemo_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null and ss_promo_sk is not null and ss_item_sk BETWEEN DynamicValue(RS_49_item_i_item_sk_min) AND DynamicValue(RS_49_item_i_item_sk_max) and in_bloom_filter(ss_item_sk, DynamicValue(RS_49_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 23837836636 Data size: 9510153597392 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_cdemo_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_wholesale_cost (type: decimal(7,2)), ss_list_price (type: decimal(7,2)), ss_coupon_amt (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 23837836636 Data size: 9323940747080 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 270992322 Data size: 37667933134 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col10 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col11, _col12
                          input vertices:
                            1 Map 17
                          Statistics: Num rows: 54464848 Data size: 7134895464 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col1 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col1 (type: bigint)
                            Statistics: Num rows: 54464848 Data size: 7134895464 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: decimal(7,2)), _col8 (type: decimal(7,2)), _col9 (type: decimal(7,2)), _col11 (type: bigint), _col12 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 29 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: (c_first_shipto_date_sk is not null and c_first_sales_date_sk is not null and c_current_hdemo_sk is not null and c_current_cdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 3047253904 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (c_first_shipto_date_sk is not null and c_first_sales_date_sk is not null and c_current_hdemo_sk is not null and c_current_cdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
                    Statistics: Num rows: 56372751 Data size: 2642801328 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_cdemo_sk (type: bigint), c_current_hdemo_sk (type: bigint), c_current_addr_sk (type: bigint), c_first_shipto_date_sk (type: bigint), c_first_sales_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 56372751 Data size: 2642801328 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 56372751 Data size: 2642801328 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 30 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_item_sk BETWEEN DynamicValue(RS_147_item_i_item_sk_min) AND DynamicValue(RS_147_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_147_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14399964710 Data size: 1835131175328 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_item_sk BETWEEN DynamicValue(RS_147_item_i_item_sk_min) AND DynamicValue(RS_147_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_147_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14399964710 Data size: 1835131175328 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_item_sk (type: bigint), cs_order_number (type: bigint), cs_ext_list_price (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 14399964710 Data size: 1835131175328 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 14399964710 Data size: 1835131175328 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 33 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: (cr_item_sk BETWEEN DynamicValue(RS_147_item_i_item_sk_min) AND DynamicValue(RS_147_item_i_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_147_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 497213063872 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_item_sk BETWEEN DynamicValue(RS_147_item_i_item_sk_min) AND DynamicValue(RS_147_item_i_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_147_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 1440033112 Data size: 497213063872 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint), ((cr_refunded_cash + cr_reversed_charge) + cr_store_credit) (type: decimal(9,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1440033112 Data size: 184324238336 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 1440033112 Data size: 184324238336 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: decimal(9,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 34 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: (sr_item_sk BETWEEN DynamicValue(RS_147_item_i_item_sk_min) AND DynamicValue(RS_147_item_i_item_sk_max) and in_bloom_filter(sr_item_sk, DynamicValue(RS_147_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (sr_item_sk BETWEEN DynamicValue(RS_147_item_i_item_sk_min) AND DynamicValue(RS_147_item_i_item_sk_max) and in_bloom_filter(sr_item_sk, DynamicValue(RS_147_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: (c_first_shipto_date_sk is not null and c_first_sales_date_sk is not null and c_current_hdemo_sk is not null and c_current_cdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_945_container, bigKeyColName:ss_item_sk, smallTablePos:0, keyRatio:0.7267061230769231
                  Statistics: Num rows: 65000000 Data size: 3047253904 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (c_first_shipto_date_sk is not null and c_first_sales_date_sk is not null and c_current_hdemo_sk is not null and c_current_cdemo_sk is not null and c_current_addr_sk is not null) (type: boolean)
                    Statistics: Num rows: 56372751 Data size: 2642801328 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_cdemo_sk (type: bigint), c_current_hdemo_sk (type: bigint), c_current_addr_sk (type: bigint), c_first_shipto_date_sk (type: bigint), c_first_sales_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 56372751 Data size: 2642801328 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col11, _col15, _col16, _col17, _col18, _col19
                        input vertices:
                          0 Map 1
                        Statistics: Num rows: 47235898 Data size: 2960007120 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col11, _col15, _col16, _col17, _col18, _col19
                          input vertices:
                            1 Reducer 10
                          Statistics: Num rows: 47235898 Data size: 2960007120 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint), _col6 (type: bigint)
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: bigint), _col6 (type: bigint)
                            Statistics: Num rows: 47235898 Data size: 2960007120 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col7 (type: decimal(7,2)), _col8 (type: decimal(7,2)), _col9 (type: decimal(7,2)), _col11 (type: bigint), _col15 (type: bigint), _col16 (type: bigint), _col17 (type: bigint), _col18 (type: bigint), _col19 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_item_sk BETWEEN DynamicValue(RS_49_item_i_item_sk_min) AND DynamicValue(RS_49_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_49_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14399964710 Data size: 1835131175328 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_item_sk BETWEEN DynamicValue(RS_49_item_i_item_sk_min) AND DynamicValue(RS_49_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_49_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14399964710 Data size: 1835131175328 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_item_sk (type: bigint), cs_order_number (type: bigint), cs_ext_list_price (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 14399964710 Data size: 1835131175328 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 14399964710 Data size: 1835131175328 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 257610 Data size: 59765520 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt; (2 * _col2)) (type: boolean)
                  Statistics: Num rows: 85870 Data size: 19921840 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 85870 Data size: 686960 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 85870 Data size: 686960 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 23 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col11, _col12, _col15, _col16, _col17, _col18, _col19
                input vertices:
                  1 Map 29
                Statistics: Num rows: 47235898 Data size: 8014248206 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col11, _col12, _col15, _col16, _col17, _col18, _col19
                  input vertices:
                    1 Reducer 32
                  Statistics: Num rows: 47235898 Data size: 8014248206 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col6 (type: bigint)
                    null sort order: aa
                    sort order: ++
                    Map-reduce partition columns: _col0 (type: bigint), _col6 (type: bigint)
                    Statistics: Num rows: 47235898 Data size: 8014248206 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col2 (type: bigint), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col7 (type: decimal(7,2)), _col8 (type: decimal(7,2)), _col9 (type: decimal(7,2)), _col11 (type: bigint), _col12 (type: char(50)), _col15 (type: bigint), _col16 (type: bigint), _col17 (type: bigint), _col18 (type: bigint), _col19 (type: bigint)
        Reducer 24 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col3, _col4, _col5, _col7, _col8, _col9, _col11, _col12, _col15, _col16, _col17, _col18, _col19
                input vertices:
                  1 Map 34
                Statistics: Num rows: 1407247370 Data size: 718544473694 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2, _col3, _col4, _col7, _col8, _col9, _col11, _col12, _col15, _col16, _col17, _col18, _col19, _col24, _col25
                  input vertices:
                    1 Map 13
                  Statistics: Num rows: 1407247370 Data size: 956747166400 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2, _col4, _col7, _col8, _col9, _col11, _col12, _col15, _col16, _col17, _col18, _col19, _col24, _col25
                    input vertices:
                      1 Map 14
                    Statistics: Num rows: 1407247370 Data size: 945867074616 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col16 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col2, _col4, _col7, _col8, _col9, _col11, _col12, _col15, _col17, _col18, _col19, _col24, _col25
                      input vertices:
                        1 Map 15
                      Statistics: Num rows: 1407247370 Data size: 934624866216 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col19 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col2, _col4, _col7, _col8, _col9, _col11, _col12, _col15, _col17, _col18, _col24, _col25, _col29
                        input vertices:
                          1 Map 17
                        Statistics: Num rows: 1407247370 Data size: 929011647736 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col18 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col4, _col7, _col8, _col9, _col11, _col12, _col15, _col17, _col24, _col25, _col29, _col31
                          input vertices:
                            1 Map 16
                          Statistics: Num rows: 1407247370 Data size: 923398437384 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col4, _col7, _col8, _col9, _col11, _col12, _col15, _col17, _col24, _col25, _col29, _col31, _col33
                            input vertices:
                              1 Map 18
                            Statistics: Num rows: 1407247370 Data size: 1032134372050 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col15 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col4, _col7, _col8, _col9, _col11, _col12, _col17, _col24, _col25, _col29, _col31, _col33, _col35
                              input vertices:
                                1 Map 19
                              Statistics: Num rows: 1407247370 Data size: 1140508189572 Basic stats: COMPLETE Column stats: COMPLETE
                              Filter Operator
                                predicate: (_col33 &lt;&gt; _col35) (type: boolean)
                                Statistics: Num rows: 1407247370 Data size: 1140508189572 Basic stats: COMPLETE Column stats: COMPLETE
                                Map Join Operator
                                  condition map:
                                       Inner Join 0 to 1
                                  keys:
                                    0 _col4 (type: bigint)
                                    1 _col0 (type: bigint)
                                  outputColumnNames: _col7, _col8, _col9, _col11, _col12, _col17, _col24, _col25, _col29, _col31, _col37, _col38, _col39, _col40
                                  input vertices:
                                    1 Map 20
                                  Statistics: Num rows: 1407247370 Data size: 1398412345458 Basic stats: COMPLETE Column stats: COMPLETE
                                  Map Join Operator
                                    condition map:
                                         Inner Join 0 to 1
                                    keys:
                                      0 _col17 (type: bigint)
                                      1 _col0 (type: bigint)
                                    outputColumnNames: _col7, _col8, _col9, _col11, _col12, _col24, _col25, _col29, _col31, _col37, _col38, _col39, _col40, _col42, _col43, _col44, _col45
                                    input vertices:
                                      1 Map 21
                                    Statistics: Num rows: 1407247370 Data size: 1895170667068 Basic stats: COMPLETE Column stats: COMPLETE
                                    Group By Operator
                                      aggregations: count(), sum(_col7), sum(_col8), sum(_col9)
                                      keys: _col24 (type: varchar(50)), _col11 (type: bigint), _col25 (type: char(10)), _col12 (type: char(50)), _col29 (type: int), _col31 (type: int), _col37 (type: char(10)), _col38 (type: varchar(60)), _col39 (type: varchar(60)), _col40 (type: char(10)), _col42 (type: char(10)), _col43 (type: varchar(60)), _col44 (type: varchar(60)), _col45 (type: char(10))
                                      minReductionHashAggr: 0.9537406
                                      mode: hash
                                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                                      Statistics: Num rows: 1407247370 Data size: 1922299907420 Basic stats: COMPLETE Column stats: COMPLETE
                                      Reduce Output Operator
                                        key expressions: _col0 (type: varchar(50)), _col1 (type: bigint), _col2 (type: char(10)), _col3 (type: char(50)), _col4 (type: int), _col5 (type: int), _col6 (type: char(10)), _col7 (type: varchar(60)), _col8 (type: varchar(60)), _col9 (type: char(10)), _col10 (type: char(10)), _col11 (type: varchar(60)), _col12 (type: varchar(60)), _col13 (type: char(10))
                                        null sort order: aaaaaaaaaaaaaa
                                        sort order: ++++++++++++++
                                        Map-reduce partition columns: _col0 (type: varchar(50)), _col1 (type: bigint), _col2 (type: char(10)), _col3 (type: char(50)), _col4 (type: int), _col5 (type: int), _col6 (type: char(10)), _col7 (type: varchar(60)), _col8 (type: varchar(60)), _col9 (type: char(10)), _col10 (type: char(10)), _col11 (type: varchar(60)), _col12 (type: varchar(60)), _col13 (type: char(10))
                                        Statistics: Num rows: 1407247370 Data size: 1922299907420 Basic stats: COMPLETE Column stats: COMPLETE
                                        value expressions: _col14 (type: bigint), _col15 (type: decimal(17,2)), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2))
        Reducer 25 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: varchar(50)), KEY._col1 (type: bigint), KEY._col2 (type: char(10)), KEY._col3 (type: char(50)), KEY._col4 (type: int), KEY._col5 (type: int), KEY._col6 (type: char(10)), KEY._col7 (type: varchar(60)), KEY._col8 (type: varchar(60)), KEY._col9 (type: char(10)), KEY._col10 (type: char(10)), KEY._col11 (type: varchar(60)), KEY._col12 (type: varchar(60)), KEY._col13 (type: char(10))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17
                Statistics: Num rows: 1407247370 Data size: 1922299907420 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col3 (type: char(50)), _col1 (type: bigint), _col0 (type: varchar(50)), _col2 (type: char(10)), _col6 (type: char(10)), _col7 (type: varchar(60)), _col8 (type: varchar(60)), _col9 (type: char(10)), _col10 (type: char(10)), _col11 (type: varchar(60)), _col12 (type: varchar(60)), _col13 (type: char(10)), _col14 (type: bigint), _col15 (type: decimal(17,2)), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col14, _col15, _col16, _col17
                  Statistics: Num rows: 1407247370 Data size: 1922299907420 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: _col14 is not null (type: boolean)
                    Statistics: Num rows: 1407247370 Data size: 1922299907420 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: char(50)), _col1 (type: bigint), _col2 (type: varchar(50)), _col3 (type: char(10)), _col4 (type: char(10)), _col5 (type: varchar(60)), _col6 (type: varchar(60)), _col7 (type: char(10)), _col8 (type: char(10)), _col9 (type: varchar(60)), _col10 (type: varchar(60)), _col11 (type: char(10)), _col14 (type: bigint), _col15 (type: decimal(17,2)), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
                      Statistics: Num rows: 1407247370 Data size: 1911041928460 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col2 (type: varchar(50)), _col1 (type: bigint), _col3 (type: char(10))
                        null sort order: aaa
                        sort order: +++
                        Map-reduce partition columns: _col2 (type: varchar(50)), _col1 (type: bigint), _col3 (type: char(10))
                        Statistics: Num rows: 1407247370 Data size: 1911041928460 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: char(50)), _col4 (type: char(10)), _col5 (type: varchar(60)), _col6 (type: varchar(60)), _col7 (type: char(10)), _col8 (type: char(10)), _col9 (type: varchar(60)), _col10 (type: varchar(60)), _col11 (type: char(10)), _col12 (type: bigint), _col13 (type: decimal(17,2)), _col14 (type: decimal(17,2)), _col15 (type: decimal(17,2))
                      Select Operator
                        expressions: _col1 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1407247370 Data size: 22515957920 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 26 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: varchar(50)), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: char(10))
                  1 KEY.reducesinkkey0 (type: varchar(50)), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: char(10))
                outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22
                input vertices:
                  0 Reducer 7
                Statistics: Num rows: 2481635539313179 Data size: 4203890603596525072 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: (_col3 &lt;= _col19) (type: boolean)
                  Statistics: Num rows: 827211846437726 Data size: 1401296867865507824 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col7 (type: char(50)), _col9 (type: varchar(50)), _col10 (type: char(10)), _col11 (type: char(10)), _col12 (type: varchar(60)), _col13 (type: varchar(60)), _col14 (type: char(10)), _col15 (type: char(10)), _col16 (type: varchar(60)), _col17 (type: varchar(60)), _col18 (type: char(10)), _col19 (type: bigint), _col21 (type: decimal(17,2)), _col22 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col3 (type: bigint), _col20 (type: decimal(17,2)), _col4 (type: decimal(17,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col13, _col14, _col16, _col17, _col18, _col19, _col20
                    Statistics: Num rows: 827211846437726 Data size: 1586592321467558448 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(50)), _col1 (type: varchar(50)), _col18 (type: bigint), _col19 (type: decimal(17,2)), _col20 (type: decimal(17,2))
                      null sort order: zzzzz
                      sort order: +++++
                      Statistics: Num rows: 827211846437726 Data size: 1586592321467558448 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col2 (type: char(10)), _col3 (type: char(10)), _col4 (type: varchar(60)), _col5 (type: varchar(60)), _col6 (type: char(10)), _col7 (type: char(10)), _col8 (type: varchar(60)), _col9 (type: varchar(60)), _col10 (type: char(10)), _col11 (type: bigint), _col13 (type: decimal(17,2)), _col14 (type: decimal(17,2)), _col16 (type: decimal(17,2)), _col17 (type: decimal(17,2))
        Reducer 27 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(50)), KEY.reducesinkkey1 (type: varchar(50)), VALUE._col0 (type: char(10)), VALUE._col1 (type: char(10)), VALUE._col2 (type: varchar(60)), VALUE._col3 (type: varchar(60)), VALUE._col4 (type: char(10)), VALUE._col5 (type: char(10)), VALUE._col6 (type: varchar(60)), VALUE._col7 (type: varchar(60)), VALUE._col8 (type: char(10)), 1999 (type: int), VALUE._col9 (type: bigint), KEY.reducesinkkey3 (type: decimal(17,2)), VALUE._col10 (type: decimal(17,2)), VALUE._col11 (type: decimal(17,2)), KEY.reducesinkkey4 (type: decimal(17,2)), VALUE._col12 (type: decimal(17,2)), VALUE._col13 (type: decimal(17,2)), 2000 (type: int), KEY.reducesinkkey2 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20
                Statistics: Num rows: 827211846437726 Data size: 1407914562637009632 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 827211846437726 Data size: 1407914562637009632 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 28 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 31 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col2, _col5
                input vertices:
                  1 Map 33
                Statistics: Num rows: 302717649592 Data size: 70222430397792 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2), sum(_col5)
                  keys: _col0 (type: bigint)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 70664226270 Data size: 16394100494640 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 70664226270 Data size: 16394100494640 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(19,2))
        Reducer 32 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 257610 Data size: 59765520 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: (_col1 &gt; (2 * _col2)) (type: boolean)
                  Statistics: Num rows: 85870 Data size: 19921840 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 85870 Data size: 686960 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 85870 Data size: 686960 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col3, _col4, _col5, _col7, _col8, _col9, _col11, _col15, _col16, _col17, _col18, _col19
                input vertices:
                  1 Map 12
                Statistics: Num rows: 1407247370 Data size: 567969005104 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col5 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col2, _col3, _col4, _col7, _col8, _col9, _col11, _col15, _col16, _col17, _col18, _col19, _col24, _col25
                  input vertices:
                    1 Map 13
                  Statistics: Num rows: 1407247370 Data size: 806171697810 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col3 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col2, _col4, _col7, _col8, _col9, _col11, _col15, _col16, _col17, _col18, _col19, _col24, _col25
                    input vertices:
                      1 Map 14
                    Statistics: Num rows: 1407247370 Data size: 795291606026 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col16 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col2, _col4, _col7, _col8, _col9, _col11, _col15, _col17, _col18, _col19, _col24, _col25
                      input vertices:
                        1 Map 15
                      Statistics: Num rows: 1407247370 Data size: 784049397626 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col19 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col2, _col4, _col7, _col8, _col9, _col11, _col15, _col17, _col18, _col24, _col25, _col29
                        input vertices:
                          1 Map 16
                        Statistics: Num rows: 1407247370 Data size: 778436179146 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col18 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col4, _col7, _col8, _col9, _col11, _col15, _col17, _col24, _col25, _col29, _col31
                          input vertices:
                            1 Map 17
                          Statistics: Num rows: 1407247370 Data size: 772822968794 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col4, _col7, _col8, _col9, _col11, _col15, _col17, _col24, _col25, _col29, _col31, _col33
                            input vertices:
                              1 Map 18
                            Statistics: Num rows: 1407247370 Data size: 881558903460 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col15 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col4, _col7, _col8, _col9, _col11, _col17, _col24, _col25, _col29, _col31, _col33, _col35
                              input vertices:
                                1 Map 19
                              Statistics: Num rows: 1407247370 Data size: 989932720982 Basic stats: COMPLETE Column stats: COMPLETE
                              Filter Operator
                                predicate: (_col33 &lt;&gt; _col35) (type: boolean)
                                Statistics: Num rows: 1407247370 Data size: 989932720982 Basic stats: COMPLETE Column stats: COMPLETE
                                Map Join Operator
                                  condition map:
                                       Inner Join 0 to 1
                                  keys:
                                    0 _col4 (type: bigint)
                                    1 _col0 (type: bigint)
                                  outputColumnNames: _col7, _col8, _col9, _col11, _col17, _col24, _col25, _col29, _col31, _col37, _col38, _col39, _col40
                                  input vertices:
                                    1 Map 20
                                  Statistics: Num rows: 1407247370 Data size: 1247836876868 Basic stats: COMPLETE Column stats: COMPLETE
                                  Map Join Operator
                                    condition map:
                                         Inner Join 0 to 1
                                    keys:
                                      0 _col17 (type: bigint)
                                      1 _col0 (type: bigint)
                                    outputColumnNames: _col7, _col8, _col9, _col11, _col24, _col25, _col29, _col31, _col37, _col38, _col39, _col40, _col42, _col43, _col44, _col45
                                    input vertices:
                                      1 Map 21
                                    Statistics: Num rows: 1407247370 Data size: 1744595198478 Basic stats: COMPLETE Column stats: COMPLETE
                                    Group By Operator
                                      aggregations: count(), sum(_col7), sum(_col8), sum(_col9)
                                      keys: _col24 (type: varchar(50)), _col11 (type: bigint), _col25 (type: char(10)), _col29 (type: int), _col31 (type: int), _col37 (type: char(10)), _col38 (type: varchar(60)), _col39 (type: varchar(60)), _col40 (type: char(10)), _col42 (type: char(10)), _col43 (type: varchar(60)), _col44 (type: varchar(60)), _col45 (type: char(10))
                                      minReductionHashAggr: 0.9538523
                                      mode: hash
                                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16
                                      Statistics: Num rows: 1407247370 Data size: 1771724438830 Basic stats: COMPLETE Column stats: COMPLETE
                                      Reduce Output Operator
                                        key expressions: _col0 (type: varchar(50)), _col1 (type: bigint), _col2 (type: char(10)), _col3 (type: int), _col4 (type: int), _col5 (type: char(10)), _col6 (type: varchar(60)), _col7 (type: varchar(60)), _col8 (type: char(10)), _col9 (type: char(10)), _col10 (type: varchar(60)), _col11 (type: varchar(60)), _col12 (type: char(10))
                                        null sort order: aaaaaaaaaaaaa
                                        sort order: +++++++++++++
                                        Map-reduce partition columns: _col0 (type: varchar(50)), _col1 (type: bigint), _col2 (type: char(10)), _col3 (type: int), _col4 (type: int), _col5 (type: char(10)), _col6 (type: varchar(60)), _col7 (type: varchar(60)), _col8 (type: char(10)), _col9 (type: char(10)), _col10 (type: varchar(60)), _col11 (type: varchar(60)), _col12 (type: char(10))
                                        Statistics: Num rows: 1407247370 Data size: 1771724438830 Basic stats: COMPLETE Column stats: COMPLETE
                                        value expressions: _col13 (type: bigint), _col14 (type: decimal(17,2)), _col15 (type: decimal(17,2)), _col16 (type: decimal(17,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3)
                keys: KEY._col0 (type: varchar(50)), KEY._col1 (type: bigint), KEY._col2 (type: char(10)), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: char(10)), KEY._col6 (type: varchar(60)), KEY._col7 (type: varchar(60)), KEY._col8 (type: char(10)), KEY._col9 (type: char(10)), KEY._col10 (type: varchar(60)), KEY._col11 (type: varchar(60)), KEY._col12 (type: char(10))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16
                Statistics: Num rows: 1407247370 Data size: 1771724438830 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: bigint), _col0 (type: varchar(50)), _col2 (type: char(10)), _col13 (type: bigint), _col14 (type: decimal(17,2)), _col15 (type: decimal(17,2)), _col16 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col13, _col14, _col15, _col16
                  Statistics: Num rows: 1407247370 Data size: 1771724438830 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: _col13 is not null (type: boolean)
                    Statistics: Num rows: 1407247370 Data size: 1771724438830 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: bigint), _col1 (type: varchar(50)), _col2 (type: char(10)), _col13 (type: bigint), _col14 (type: decimal(17,2)), _col15 (type: decimal(17,2)), _col16 (type: decimal(17,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 1407247370 Data size: 744433858730 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: varchar(50)), _col0 (type: bigint), _col2 (type: char(10))
                        null sort order: aaa
                        sort order: +++
                        Map-reduce partition columns: _col1 (type: varchar(50)), _col0 (type: bigint), _col2 (type: char(10))
                        Statistics: Num rows: 1407247370 Data size: 744433858730 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: bigint), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2))
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col2, _col5
                input vertices:
                  1 Map 11
                Statistics: Num rows: 302717649592 Data size: 70222430397792 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col2), sum(_col5)
                  keys: _col0 (type: bigint)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 70664226270 Data size: 16394100494640 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 70664226270 Data size: 16394100494640 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(19,2))

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query64
explain with cs_ui as (select cs_item_sk ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund from catalog_sales ,catalog_returns where cs_item_sk = cr_item_sk and cs_order_number = cr_order_number group by cs_item_sk having sum(cs_ext_list_price)&gt;2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as (select i_product_name product_name ,i_item_sk item_sk ,s_store_name store_name ,s_zip store_zip ,ad1.ca_street_number b_street_number ,ad1.ca_street_name b_street_name ,ad1.ca_city b_city ,ad1.ca_zip b_zip ,ad2.ca_street_number c_street_number ,ad2.ca_street_name c_street_name ,ad2.ca_city c_city ,ad2.ca_zip c_zip ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year s2year ,count(*) cnt ,sum(ss_wholesale_cost) s1 ,sum(ss_list_price) s2 ,sum(ss_coupon_amt) s3 FROM   store_sales ,store_returns ,cs_ui ,date_dim d1 ,date_dim d2 ,date_dim d3 ,store ,customer ,customer_demographics cd1 ,customer_demographics cd2 ,promotion ,household_demographics hd1 ,household_demographics hd2 ,customer_address ad1 ,customer_address ad2 ,income_band ib1 ,income_band ib2 ,item WHERE  ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk= cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk and ss_item_sk = i_item_sk and ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number and ss_item_sk = cs_ui.cs_item_sk and c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk and c_first_sales_date_sk = d2.d_date_sk and c_first_shipto_date_sk = d3.d_date_sk and ss_promo_sk = p_promo_sk and hd1.hd_income_band_sk = ib1.ib_income_band_sk and hd2.hd_income_band_sk = ib2.ib_income_band_sk and cd1.cd_marital_status &lt;&gt; cd2.cd_marital_status and i_color in (&apos;azure&apos;,&apos;gainsboro&apos;,&apos;misty&apos;,&apos;blush&apos;,&apos;hot&apos;,&apos;lemon&apos;) and i_current_price between 80 and 80 + 10 and i_current_price between 80 + 1 and 80 + 15 group by i_product_name ,i_item_sk ,s_store_name ,s_zip ,ad1.ca_street_number ,ad1.ca_street_name ,ad1.ca_city ,ad1.ca_zip ,ad2.ca_street_number ,ad2.ca_street_name ,ad2.ca_city ,ad2.ca_zip ,d1.d_year ,d2.d_year ,d3.d_year ) select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_street_name ,cs1.b_city ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt ,cs1.s1 as s11 ,cs1.s2 as s21 ,cs1.s3 as s31 ,cs2.s1 as s12 ,cs2.s2 as s22 ,cs2.s3 as s32 ,cs2.syear ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and cs1.syear = 1999 and cs2.syear = 1999 + 1 and cs2.cnt &lt;= cs1.cnt and cs1.store_name = cs2.store_name and cs1.store_zip = cs2.store_zip order by cs1.product_name ,cs1.store_name ,cs2.cnt ,cs1.s1 ,cs2.s1

</samplerData>
</sample>
<sample t="2544" lt="2538" ts="1600984902893" s="true" lb="query65" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="15372" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220140_b55dfc6b-33ee-4a11-9762-5245f2514bbe:273
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Reducer 4 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Map 1 (SIMPLE_EDGE)
      DagName: zabetak_20200924220140_b55dfc6b-33ee-4a11-9762-5245f2514bbe:273
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3662775584312 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3576519447520 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_store_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26856185846 Data size: 3576519447520 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5279977323 Data size: 599915269808 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col2)
                          keys: _col1 (type: bigint), _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 2639988661 Data size: 335388761264 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint), _col1 (type: bigint)
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                            Statistics: Num rows: 2639988661 Data size: 335388761264 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: decimal(17,2))
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint), _col1 (type: bigint)
                            null sort order: aa
                            sort order: ++
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 2639988661 Data size: 335388761264 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_month_seq BETWEEN 1186 AND 1197 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1186 AND 1197 (type: boolean)
                    Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 144000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_store_name (type: varchar(50))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1500 Data size: 144000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 144000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 207209680 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_desc (type: varchar(200)), i_current_price (type: decimal(7,2)), i_wholesale_cost (type: decimal(7,2)), i_brand (type: char(50))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 402000 Data size: 207209680 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 207209680 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(200)), _col2 (type: decimal(7,2)), _col3 (type: decimal(7,2)), _col4 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6364801 Data size: 808595424 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col2 is not null (type: boolean)
                  Statistics: Num rows: 6364801 Data size: 808595424 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col4
                    input vertices:
                      1 Reducer 4
                    Statistics: Num rows: 6407233 Data size: 1531636816 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col2 &lt;= _col4) (type: boolean)
                      Statistics: Num rows: 2135744 Data size: 510545528 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col6
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 2135744 Data size: 444234752 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col2, _col6, _col8, _col9, _col10, _col11
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 2135744 Data size: 1511884432 Basic stats: COMPLETE Column stats: COMPLETE
                          Top N Key Operator
                            sort order: ++
                            keys: _col6 (type: varchar(50)), _col8 (type: varchar(200))
                            null sort order: zz
                            Statistics: Num rows: 2135744 Data size: 1511884432 Basic stats: COMPLETE Column stats: COMPLETE
                            top n: 100
                            Select Operator
                              expressions: _col6 (type: varchar(50)), _col8 (type: varchar(200)), _col2 (type: decimal(17,2)), _col9 (type: decimal(7,2)), _col10 (type: decimal(7,2)), _col11 (type: char(50))
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                              Statistics: Num rows: 2135744 Data size: 1511661888 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: varchar(50)), _col1 (type: varchar(200))
                                null sort order: zz
                                sort order: ++
                                Statistics: Num rows: 2135744 Data size: 1511661888 Basic stats: COMPLETE Column stats: COMPLETE
                                TopN Hash Memory Usage: 0.04
                                value expressions: _col2 (type: decimal(17,2)), _col3 (type: decimal(7,2)), _col4 (type: decimal(7,2)), _col5 (type: char(50))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: varchar(50)), KEY.reducesinkkey1 (type: varchar(200)), VALUE._col0 (type: decimal(17,2)), VALUE._col1 (type: decimal(7,2)), VALUE._col2 (type: decimal(7,2)), VALUE._col3 (type: char(50))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 2135744 Data size: 1511661888 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 70800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 70800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6364801 Data size: 808595424 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: bigint), _col2 (type: decimal(17,2))
                  outputColumnNames: _col1, _col2
                  Statistics: Num rows: 6364801 Data size: 808595424 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col2), count(_col2)
                    keys: _col1 (type: bigint)
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 151 Data size: 19192 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col1 is not null and _col2 is not null) (type: boolean)
                      Statistics: Num rows: 151 Data size: 19192 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint), (0.1 * (_col1 / _col2)) (type: decimal(38,12))
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 151 Data size: 17984 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 151 Data size: 17984 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(38,12))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query65
explain select s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand from store, item, (select ss_store_sk, avg(revenue) as ave from (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1186 and 1186+11 group by ss_store_sk, ss_item_sk) sa group by ss_store_sk) sb, (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue from store_sales, date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1186 and 1186+11 group by ss_store_sk, ss_item_sk) sc where sb.ss_store_sk = sc.ss_store_sk and sc.revenue &lt;= 0.1 * sb.ave and s_store_sk = sc.ss_store_sk and i_item_sk = sc.ss_item_sk order by s_store_name, i_item_desc limit 100

</samplerData>
</sample>
<sample t="6993" lt="6985" ts="1600984909887" s="true" lb="query66" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="50211" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220142_c2e957ce-4652-4e2f-9ff0-cf01eedadf9e:274
      Edges:
        Map 1 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Map 10 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 11 &lt;- Map 10 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924220142_c2e957ce-4652-4e2f-9ff0-cf01eedadf9e:274
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: (ws_sold_time_sk is not null and ws_ship_mode_sk is not null and ws_warehouse_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_198_container, bigKeyColName:ws_ship_mode_sk, smallTablePos:1, keyRatio:0.007921897924107225
                  Statistics: Num rows: 7198162681 Data size: 1871396308580 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_sold_time_sk is not null and ws_ship_mode_sk is not null and ws_warehouse_sk is not null) (type: boolean)
                    Statistics: Num rows: 7195462033 Data size: 1870694187408 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_sold_time_sk (type: bigint), ws_ship_mode_sk (type: bigint), ws_warehouse_sk (type: bigint), ws_sold_date_sk (type: bigint), (ws_sales_price * CAST( ws_quantity AS decimal(10,0))) (type: decimal(18,2)), (ws_net_paid_inc_ship_tax * CAST( ws_quantity AS decimal(10,0))) (type: decimal(18,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 7195462033 Data size: 1842016680688 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 2837210665 Data size: 703613852184 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 570231088 Data size: 164212160608 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 57023110 Data size: 15959277528 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col22, _col23, _col24, _col25, _col26, _col27
                              input vertices:
                                1 Map 9
                              Statistics: Num rows: 57023110 Data size: 42653286280 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator
                                expressions: _col22 (type: varchar(20)), _col23 (type: int), _col24 (type: varchar(60)), _col25 (type: varchar(30)), _col26 (type: char(2)), _col27 (type: varchar(20)), CASE WHEN (_col8) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col9) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col10) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col11) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col12) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col13) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col14) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col15) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col16) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col17) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col18) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col19) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col8) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col9) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col10) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col11) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col12) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col13) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col14) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col15) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col16) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col17) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col18) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col19) THEN (_col5) ELSE (0) END (type: decimal(18,2))
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                                Statistics: Num rows: 57023110 Data size: 42653286280 Basic stats: COMPLETE Column stats: COMPLETE
                                Group By Operator
                                  aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29)
                                  keys: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                                  Statistics: Num rows: 57023110 Data size: 180421120040 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                                    null sort order: aaaaaa
                                    sort order: ++++++
                                    Map-reduce partition columns: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                                    Statistics: Num rows: 57023110 Data size: 180421120040 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions: _col6 (type: decimal(28,2)), _col7 (type: decimal(28,2)), _col8 (type: decimal(28,2)), _col9 (type: decimal(28,2)), _col10 (type: decimal(28,2)), _col11 (type: decimal(28,2)), _col12 (type: decimal(28,2)), _col13 (type: decimal(28,2)), _col14 (type: decimal(28,2)), _col15 (type: decimal(28,2)), _col16 (type: decimal(28,2)), _col17 (type: decimal(28,2)), _col18 (type: decimal(28,2)), _col19 (type: decimal(28,2)), _col20 (type: decimal(28,2)), _col21 (type: decimal(28,2)), _col22 (type: decimal(28,2)), _col23 (type: decimal(28,2)), _col24 (type: decimal(28,2)), _col25 (type: decimal(28,2)), _col26 (type: decimal(28,2)), _col27 (type: decimal(28,2)), _col28 (type: decimal(28,2)), _col29 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_warehouse_sk is not null and cs_sold_time_sk is not null and cs_ship_mode_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_202_container, bigKeyColName:cs_ship_mode_sk, smallTablePos:1, keyRatio:0.007809694339464673
                  Statistics: Num rows: 14327953968 Data size: 3720227895776 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_warehouse_sk is not null and cs_sold_time_sk is not null and cs_ship_mode_sk is not null) (type: boolean)
                    Statistics: Num rows: 14220240245 Data size: 3692260218160 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_sold_time_sk (type: bigint), cs_ship_mode_sk (type: bigint), cs_warehouse_sk (type: bigint), cs_sold_date_sk (type: bigint), (cs_ext_list_price * CAST( cs_quantity AS decimal(10,0))) (type: decimal(18,2)), (cs_net_paid_inc_ship * CAST( cs_quantity AS decimal(10,0))) (type: decimal(18,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 14220240245 Data size: 3639524118928 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 5607119751 Data size: 1389994116696 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 1118969389 Data size: 321691602480 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 111896941 Data size: 31045301536 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col4, _col5, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col22, _col23, _col24, _col25, _col26, _col27
                              input vertices:
                                1 Map 9
                              Statistics: Num rows: 111896941 Data size: 83698911868 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator
                                expressions: _col22 (type: varchar(20)), _col23 (type: int), _col24 (type: varchar(60)), _col25 (type: varchar(30)), _col26 (type: char(2)), _col27 (type: varchar(20)), CASE WHEN (_col8) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col9) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col10) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col11) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col12) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col13) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col14) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col15) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col16) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col17) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col18) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col19) THEN (_col4) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col8) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col9) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col10) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col11) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col12) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col13) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col14) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col15) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col16) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col17) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col18) THEN (_col5) ELSE (0) END (type: decimal(18,2)), CASE WHEN (_col19) THEN (_col5) ELSE (0) END (type: decimal(18,2))
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                                Statistics: Num rows: 111896941 Data size: 83698911868 Basic stats: COMPLETE Column stats: COMPLETE
                                Group By Operator
                                  aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29)
                                  keys: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                                  Statistics: Num rows: 111896941 Data size: 354041921324 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                                    null sort order: aaaaaa
                                    sort order: ++++++
                                    Map-reduce partition columns: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                                    Statistics: Num rows: 111896941 Data size: 354041921324 Basic stats: COMPLETE Column stats: COMPLETE
                                    value expressions: _col6 (type: decimal(28,2)), _col7 (type: decimal(28,2)), _col8 (type: decimal(28,2)), _col9 (type: decimal(28,2)), _col10 (type: decimal(28,2)), _col11 (type: decimal(28,2)), _col12 (type: decimal(28,2)), _col13 (type: decimal(28,2)), _col14 (type: decimal(28,2)), _col15 (type: decimal(28,2)), _col16 (type: decimal(28,2)), _col17 (type: decimal(28,2)), _col18 (type: decimal(28,2)), _col19 (type: decimal(28,2)), _col20 (type: decimal(28,2)), _col21 (type: decimal(28,2)), _col22 (type: decimal(28,2)), _col23 (type: decimal(28,2)), _col24 (type: decimal(28,2)), _col25 (type: decimal(28,2)), _col26 (type: decimal(28,2)), _col27 (type: decimal(28,2)), _col28 (type: decimal(28,2)), _col29 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: time_dim
                  filterExpr: t_time BETWEEN 9453 AND 38253 (type: boolean)
                  Statistics: Num rows: 86400 Data size: 1036800 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: t_time BETWEEN 9453 AND 38253 (type: boolean)
                    Statistics: Num rows: 34068 Data size: 408816 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: t_time_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 34068 Data size: 272544 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 34068 Data size: 272544 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 34068 Data size: 272544 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2001) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), (d_moy = 1) (type: boolean), (d_moy = 2) (type: boolean), (d_moy = 3) (type: boolean), (d_moy = 4) (type: boolean), (d_moy = 5) (type: boolean), (d_moy = 6) (type: boolean), (d_moy = 7) (type: boolean), (d_moy = 8) (type: boolean), (d_moy = 9) (type: boolean), (d_moy = 10) (type: boolean), (d_moy = 11) (type: boolean), (d_moy = 12) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12
                      Statistics: Num rows: 367 Data size: 20552 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 20552 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean), _col9 (type: boolean), _col10 (type: boolean), _col11 (type: boolean), _col12 (type: boolean)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 20552 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean), _col9 (type: boolean), _col10 (type: boolean), _col11 (type: boolean), _col12 (type: boolean)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 10
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: ship_mode
                  filterExpr: (sm_carrier) IN (&apos;MSC                 &apos;, &apos;GERMA               &apos;) (type: boolean)
                  Statistics: Num rows: 20 Data size: 1980 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (sm_carrier) IN (&apos;MSC                 &apos;, &apos;GERMA               &apos;) (type: boolean)
                    Statistics: Num rows: 2 Data size: 198 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sm_ship_mode_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 2 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: warehouse
                  Statistics: Num rows: 25 Data size: 12100 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: w_warehouse_sk (type: bigint), w_warehouse_name (type: varchar(20)), w_warehouse_sq_ft (type: int), w_city (type: varchar(60)), w_county (type: varchar(30)), w_state (type: char(2)), w_country (type: varchar(20))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 25 Data size: 12100 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 25 Data size: 12100 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(20)), _col2 (type: int), _col3 (type: varchar(60)), _col4 (type: varchar(30)), _col5 (type: char(2)), _col6 (type: varchar(20))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 25 Data size: 12100 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(20)), _col2 (type: int), _col3 (type: varchar(60)), _col4 (type: varchar(30)), _col5 (type: char(2)), _col6 (type: varchar(20))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23)
                keys: KEY._col0 (type: varchar(20)), KEY._col1 (type: int), KEY._col2 (type: varchar(60)), KEY._col3 (type: varchar(30)), KEY._col4 (type: char(2)), KEY._col5 (type: varchar(20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                Statistics: Num rows: 1960000 Data size: 6201440000 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: ++++++
                  keys: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                  null sort order: zaaaaa
                  Statistics: Num rows: 3920000 Data size: 12402880000 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20)), _col6 (type: decimal(28,2)), _col7 (type: decimal(28,2)), _col8 (type: decimal(28,2)), _col9 (type: decimal(28,2)), _col10 (type: decimal(28,2)), _col11 (type: decimal(28,2)), _col12 (type: decimal(28,2)), _col13 (type: decimal(28,2)), _col14 (type: decimal(28,2)), _col15 (type: decimal(28,2)), _col16 (type: decimal(28,2)), _col17 (type: decimal(28,2)), (_col6 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col7 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col8 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col9 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col10 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col11 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col12 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col13 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col14 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col15 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col16 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col17 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), _col18 (type: decimal(28,2)), _col19 (type: decimal(28,2)), _col20 (type: decimal(28,2)), _col21 (type: decimal(28,2)), _col22 (type: decimal(28,2)), _col23 (type: decimal(28,2)), _col24 (type: decimal(28,2)), _col25 (type: decimal(28,2)), _col26 (type: decimal(28,2)), _col27 (type: decimal(28,2)), _col28 (type: decimal(28,2)), _col29 (type: decimal(28,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                    Statistics: Num rows: 3920000 Data size: 12402880000 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29), sum(_col30), sum(_col31), sum(_col32), sum(_col33), sum(_col34), sum(_col35), sum(_col36), sum(_col37), sum(_col38), sum(_col39), sum(_col40), sum(_col41)
                      keys: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                      Statistics: Num rows: 3920000 Data size: 17671360000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                        null sort order: zaaaaa
                        sort order: ++++++
                        Map-reduce partition columns: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                        Statistics: Num rows: 3920000 Data size: 17671360000 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col6 (type: decimal(38,2)), _col7 (type: decimal(38,2)), _col8 (type: decimal(38,2)), _col9 (type: decimal(38,2)), _col10 (type: decimal(38,2)), _col11 (type: decimal(38,2)), _col12 (type: decimal(38,2)), _col13 (type: decimal(38,2)), _col14 (type: decimal(38,2)), _col15 (type: decimal(38,2)), _col16 (type: decimal(38,2)), _col17 (type: decimal(38,2)), _col18 (type: decimal(38,12)), _col19 (type: decimal(38,12)), _col20 (type: decimal(38,12)), _col21 (type: decimal(38,12)), _col22 (type: decimal(38,12)), _col23 (type: decimal(38,12)), _col24 (type: decimal(38,12)), _col25 (type: decimal(38,12)), _col26 (type: decimal(38,12)), _col27 (type: decimal(38,12)), _col28 (type: decimal(38,12)), _col29 (type: decimal(38,12)), _col30 (type: decimal(38,2)), _col31 (type: decimal(38,2)), _col32 (type: decimal(38,2)), _col33 (type: decimal(38,2)), _col34 (type: decimal(38,2)), _col35 (type: decimal(38,2)), _col36 (type: decimal(38,2)), _col37 (type: decimal(38,2)), _col38 (type: decimal(38,2)), _col39 (type: decimal(38,2)), _col40 (type: decimal(38,2)), _col41 (type: decimal(38,2))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23)
                keys: KEY._col0 (type: varchar(20)), KEY._col1 (type: int), KEY._col2 (type: varchar(60)), KEY._col3 (type: varchar(30)), KEY._col4 (type: char(2)), KEY._col5 (type: varchar(20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29
                Statistics: Num rows: 1960000 Data size: 6201440000 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: ++++++
                  keys: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                  null sort order: zaaaaa
                  Statistics: Num rows: 3920000 Data size: 12402880000 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20)), _col6 (type: decimal(28,2)), _col7 (type: decimal(28,2)), _col8 (type: decimal(28,2)), _col9 (type: decimal(28,2)), _col10 (type: decimal(28,2)), _col11 (type: decimal(28,2)), _col12 (type: decimal(28,2)), _col13 (type: decimal(28,2)), _col14 (type: decimal(28,2)), _col15 (type: decimal(28,2)), _col16 (type: decimal(28,2)), _col17 (type: decimal(28,2)), (_col6 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col7 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col8 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col9 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col10 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col11 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col12 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col13 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col14 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col15 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col16 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), (_col17 / CAST( _col1 AS decimal(10,0))) (type: decimal(38,12)), _col18 (type: decimal(28,2)), _col19 (type: decimal(28,2)), _col20 (type: decimal(28,2)), _col21 (type: decimal(28,2)), _col22 (type: decimal(28,2)), _col23 (type: decimal(28,2)), _col24 (type: decimal(28,2)), _col25 (type: decimal(28,2)), _col26 (type: decimal(28,2)), _col27 (type: decimal(28,2)), _col28 (type: decimal(28,2)), _col29 (type: decimal(28,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                    Statistics: Num rows: 3920000 Data size: 12402880000 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: sum(_col6), sum(_col7), sum(_col8), sum(_col9), sum(_col10), sum(_col11), sum(_col12), sum(_col13), sum(_col14), sum(_col15), sum(_col16), sum(_col17), sum(_col18), sum(_col19), sum(_col20), sum(_col21), sum(_col22), sum(_col23), sum(_col24), sum(_col25), sum(_col26), sum(_col27), sum(_col28), sum(_col29), sum(_col30), sum(_col31), sum(_col32), sum(_col33), sum(_col34), sum(_col35), sum(_col36), sum(_col37), sum(_col38), sum(_col39), sum(_col40), sum(_col41)
                      keys: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                      Statistics: Num rows: 3920000 Data size: 17671360000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                        null sort order: zaaaaa
                        sort order: ++++++
                        Map-reduce partition columns: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20))
                        Statistics: Num rows: 3920000 Data size: 17671360000 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col6 (type: decimal(38,2)), _col7 (type: decimal(38,2)), _col8 (type: decimal(38,2)), _col9 (type: decimal(38,2)), _col10 (type: decimal(38,2)), _col11 (type: decimal(38,2)), _col12 (type: decimal(38,2)), _col13 (type: decimal(38,2)), _col14 (type: decimal(38,2)), _col15 (type: decimal(38,2)), _col16 (type: decimal(38,2)), _col17 (type: decimal(38,2)), _col18 (type: decimal(38,12)), _col19 (type: decimal(38,12)), _col20 (type: decimal(38,12)), _col21 (type: decimal(38,12)), _col22 (type: decimal(38,12)), _col23 (type: decimal(38,12)), _col24 (type: decimal(38,12)), _col25 (type: decimal(38,12)), _col26 (type: decimal(38,12)), _col27 (type: decimal(38,12)), _col28 (type: decimal(38,12)), _col29 (type: decimal(38,12)), _col30 (type: decimal(38,2)), _col31 (type: decimal(38,2)), _col32 (type: decimal(38,2)), _col33 (type: decimal(38,2)), _col34 (type: decimal(38,2)), _col35 (type: decimal(38,2)), _col36 (type: decimal(38,2)), _col37 (type: decimal(38,2)), _col38 (type: decimal(38,2)), _col39 (type: decimal(38,2)), _col40 (type: decimal(38,2)), _col41 (type: decimal(38,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4), sum(VALUE._col5), sum(VALUE._col6), sum(VALUE._col7), sum(VALUE._col8), sum(VALUE._col9), sum(VALUE._col10), sum(VALUE._col11), sum(VALUE._col12), sum(VALUE._col13), sum(VALUE._col14), sum(VALUE._col15), sum(VALUE._col16), sum(VALUE._col17), sum(VALUE._col18), sum(VALUE._col19), sum(VALUE._col20), sum(VALUE._col21), sum(VALUE._col22), sum(VALUE._col23), sum(VALUE._col24), sum(VALUE._col25), sum(VALUE._col26), sum(VALUE._col27), sum(VALUE._col28), sum(VALUE._col29), sum(VALUE._col30), sum(VALUE._col31), sum(VALUE._col32), sum(VALUE._col33), sum(VALUE._col34), sum(VALUE._col35)
                keys: KEY._col0 (type: varchar(20)), KEY._col1 (type: int), KEY._col2 (type: varchar(60)), KEY._col3 (type: varchar(30)), KEY._col4 (type: char(2)), KEY._col5 (type: varchar(20))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                Statistics: Num rows: 1881600 Data size: 8482252800 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: varchar(20))
                  null sort order: z
                  sort order: +
                  Statistics: Num rows: 1881600 Data size: 8482252800 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20)), _col6 (type: decimal(38,2)), _col7 (type: decimal(38,2)), _col8 (type: decimal(38,2)), _col9 (type: decimal(38,2)), _col10 (type: decimal(38,2)), _col11 (type: decimal(38,2)), _col12 (type: decimal(38,2)), _col13 (type: decimal(38,2)), _col14 (type: decimal(38,2)), _col15 (type: decimal(38,2)), _col16 (type: decimal(38,2)), _col17 (type: decimal(38,2)), _col18 (type: decimal(38,12)), _col19 (type: decimal(38,12)), _col20 (type: decimal(38,12)), _col21 (type: decimal(38,12)), _col22 (type: decimal(38,12)), _col23 (type: decimal(38,12)), _col24 (type: decimal(38,12)), _col25 (type: decimal(38,12)), _col26 (type: decimal(38,12)), _col27 (type: decimal(38,12)), _col28 (type: decimal(38,12)), _col29 (type: decimal(38,12)), _col30 (type: decimal(38,2)), _col31 (type: decimal(38,2)), _col32 (type: decimal(38,2)), _col33 (type: decimal(38,2)), _col34 (type: decimal(38,2)), _col35 (type: decimal(38,2)), _col36 (type: decimal(38,2)), _col37 (type: decimal(38,2)), _col38 (type: decimal(38,2)), _col39 (type: decimal(38,2)), _col40 (type: decimal(38,2)), _col41 (type: decimal(38,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: varchar(20)), VALUE._col0 (type: int), VALUE._col1 (type: varchar(60)), VALUE._col2 (type: varchar(30)), VALUE._col3 (type: char(2)), VALUE._col4 (type: varchar(20)), VALUE._col5 (type: decimal(38,2)), VALUE._col6 (type: decimal(38,2)), VALUE._col7 (type: decimal(38,2)), VALUE._col8 (type: decimal(38,2)), VALUE._col9 (type: decimal(38,2)), VALUE._col10 (type: decimal(38,2)), VALUE._col11 (type: decimal(38,2)), VALUE._col12 (type: decimal(38,2)), VALUE._col13 (type: decimal(38,2)), VALUE._col14 (type: decimal(38,2)), VALUE._col15 (type: decimal(38,2)), VALUE._col16 (type: decimal(38,2)), VALUE._col17 (type: decimal(38,12)), VALUE._col18 (type: decimal(38,12)), VALUE._col19 (type: decimal(38,12)), VALUE._col20 (type: decimal(38,12)), VALUE._col21 (type: decimal(38,12)), VALUE._col22 (type: decimal(38,12)), VALUE._col23 (type: decimal(38,12)), VALUE._col24 (type: decimal(38,12)), VALUE._col25 (type: decimal(38,12)), VALUE._col26 (type: decimal(38,12)), VALUE._col27 (type: decimal(38,12)), VALUE._col28 (type: decimal(38,12)), VALUE._col29 (type: decimal(38,2)), VALUE._col30 (type: decimal(38,2)), VALUE._col31 (type: decimal(38,2)), VALUE._col32 (type: decimal(38,2)), VALUE._col33 (type: decimal(38,2)), VALUE._col34 (type: decimal(38,2)), VALUE._col35 (type: decimal(38,2)), VALUE._col36 (type: decimal(38,2)), VALUE._col37 (type: decimal(38,2)), VALUE._col38 (type: decimal(38,2)), VALUE._col39 (type: decimal(38,2)), VALUE._col40 (type: decimal(38,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41
                Statistics: Num rows: 1881600 Data size: 8482252800 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 450800 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: varchar(20)), _col1 (type: int), _col2 (type: varchar(60)), _col3 (type: varchar(30)), _col4 (type: char(2)), _col5 (type: varchar(20)), &apos;MSC,GERMA&apos; (type: string), 2001 (type: int), _col6 (type: decimal(38,2)), _col7 (type: decimal(38,2)), _col8 (type: decimal(38,2)), _col9 (type: decimal(38,2)), _col10 (type: decimal(38,2)), _col11 (type: decimal(38,2)), _col12 (type: decimal(38,2)), _col13 (type: decimal(38,2)), _col14 (type: decimal(38,2)), _col15 (type: decimal(38,2)), _col16 (type: decimal(38,2)), _col17 (type: decimal(38,2)), _col18 (type: decimal(38,12)), _col19 (type: decimal(38,12)), _col20 (type: decimal(38,12)), _col21 (type: decimal(38,12)), _col22 (type: decimal(38,12)), _col23 (type: decimal(38,12)), _col24 (type: decimal(38,12)), _col25 (type: decimal(38,12)), _col26 (type: decimal(38,12)), _col27 (type: decimal(38,12)), _col28 (type: decimal(38,12)), _col29 (type: decimal(38,12)), _col30 (type: decimal(38,2)), _col31 (type: decimal(38,2)), _col32 (type: decimal(38,2)), _col33 (type: decimal(38,2)), _col34 (type: decimal(38,2)), _col35 (type: decimal(38,2)), _col36 (type: decimal(38,2)), _col37 (type: decimal(38,2)), _col38 (type: decimal(38,2)), _col39 (type: decimal(38,2)), _col40 (type: decimal(38,2)), _col41 (type: decimal(38,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col17, _col18, _col19, _col20, _col21, _col22, _col23, _col24, _col25, _col26, _col27, _col28, _col29, _col30, _col31, _col32, _col33, _col34, _col35, _col36, _col37, _col38, _col39, _col40, _col41, _col42, _col43
                    Statistics: Num rows: 100 Data size: 460500 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      Statistics: Num rows: 100 Data size: 460500 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 3 
            Vertex: Union 3

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query66
explain select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,ship_carriers ,year ,sum(jan_sales) as jan_sales ,sum(feb_sales) as feb_sales ,sum(mar_sales) as mar_sales ,sum(apr_sales) as apr_sales ,sum(may_sales) as may_sales ,sum(jun_sales) as jun_sales ,sum(jul_sales) as jul_sales ,sum(aug_sales) as aug_sales ,sum(sep_sales) as sep_sales ,sum(oct_sales) as oct_sales ,sum(nov_sales) as nov_sales ,sum(dec_sales) as dec_sales ,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot ,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot ,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot ,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot ,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot ,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot ,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot ,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot ,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot ,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot ,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot ,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot ,sum(jan_net) as jan_net ,sum(feb_net) as feb_net ,sum(mar_net) as mar_net ,sum(apr_net) as apr_net ,sum(may_net) as may_net ,sum(jun_net) as jun_net ,sum(jul_net) as jul_net ,sum(aug_net) as aug_net ,sum(sep_net) as sep_net ,sum(oct_net) as oct_net ,sum(nov_net) as nov_net ,sum(dec_net) as dec_net from ( select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,&apos;MSC&apos; || &apos;,&apos; || &apos;GERMA&apos; as ship_carriers ,d_year as year ,sum(case when d_moy = 1 then ws_sales_price* ws_quantity else 0 end) as jan_sales ,sum(case when d_moy = 2 then ws_sales_price* ws_quantity else 0 end) as feb_sales ,sum(case when d_moy = 3 then ws_sales_price* ws_quantity else 0 end) as mar_sales ,sum(case when d_moy = 4 then ws_sales_price* ws_quantity else 0 end) as apr_sales ,sum(case when d_moy = 5 then ws_sales_price* ws_quantity else 0 end) as may_sales ,sum(case when d_moy = 6 then ws_sales_price* ws_quantity else 0 end) as jun_sales ,sum(case when d_moy = 7 then ws_sales_price* ws_quantity else 0 end) as jul_sales ,sum(case when d_moy = 8 then ws_sales_price* ws_quantity else 0 end) as aug_sales ,sum(case when d_moy = 9 then ws_sales_price* ws_quantity else 0 end) as sep_sales ,sum(case when d_moy = 10 then ws_sales_price* ws_quantity else 0 end) as oct_sales ,sum(case when d_moy = 11 then ws_sales_price* ws_quantity else 0 end) as nov_sales ,sum(case when d_moy = 12 then ws_sales_price* ws_quantity else 0 end) as dec_sales ,sum(case when d_moy = 1 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jan_net ,sum(case when d_moy = 2 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as feb_net ,sum(case when d_moy = 3 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as mar_net ,sum(case when d_moy = 4 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as apr_net ,sum(case when d_moy = 5 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as may_net ,sum(case when d_moy = 6 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jun_net ,sum(case when d_moy = 7 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as jul_net ,sum(case when d_moy = 8 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as aug_net ,sum(case when d_moy = 9 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as sep_net ,sum(case when d_moy = 10 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as oct_net ,sum(case when d_moy = 11 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as nov_net ,sum(case when d_moy = 12 then ws_net_paid_inc_ship_tax * ws_quantity else 0 end) as dec_net from web_sales ,warehouse ,date_dim ,time_dim ,ship_mode where ws_warehouse_sk =  w_warehouse_sk and ws_sold_date_sk = d_date_sk and ws_sold_time_sk = t_time_sk and ws_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 9453 and 9453+28800 and sm_carrier in (&apos;MSC&apos;,&apos;GERMA&apos;) group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,d_year union all select w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,&apos;MSC&apos; || &apos;,&apos; || &apos;GERMA&apos; as ship_carriers ,d_year as year ,sum(case when d_moy = 1 then cs_ext_list_price* cs_quantity else 0 end) as jan_sales ,sum(case when d_moy = 2 then cs_ext_list_price* cs_quantity else 0 end) as feb_sales ,sum(case when d_moy = 3 then cs_ext_list_price* cs_quantity else 0 end) as mar_sales ,sum(case when d_moy = 4 then cs_ext_list_price* cs_quantity else 0 end) as apr_sales ,sum(case when d_moy = 5 then cs_ext_list_price* cs_quantity else 0 end) as may_sales ,sum(case when d_moy = 6 then cs_ext_list_price* cs_quantity else 0 end) as jun_sales ,sum(case when d_moy = 7 then cs_ext_list_price* cs_quantity else 0 end) as jul_sales ,sum(case when d_moy = 8 then cs_ext_list_price* cs_quantity else 0 end) as aug_sales ,sum(case when d_moy = 9 then cs_ext_list_price* cs_quantity else 0 end) as sep_sales ,sum(case when d_moy = 10 then cs_ext_list_price* cs_quantity else 0 end) as oct_sales ,sum(case when d_moy = 11 then cs_ext_list_price* cs_quantity else 0 end) as nov_sales ,sum(case when d_moy = 12 then cs_ext_list_price* cs_quantity else 0 end) as dec_sales ,sum(case when d_moy = 1 then cs_net_paid_inc_ship * cs_quantity else 0 end) as jan_net ,sum(case when d_moy = 2 then cs_net_paid_inc_ship * cs_quantity else 0 end) as feb_net ,sum(case when d_moy = 3 then cs_net_paid_inc_ship * cs_quantity else 0 end) as mar_net ,sum(case when d_moy = 4 then cs_net_paid_inc_ship * cs_quantity else 0 end) as apr_net ,sum(case when d_moy = 5 then cs_net_paid_inc_ship * cs_quantity else 0 end) as may_net ,sum(case when d_moy = 6 then cs_net_paid_inc_ship * cs_quantity else 0 end) as jun_net ,sum(case when d_moy = 7 then cs_net_paid_inc_ship * cs_quantity else 0 end) as jul_net ,sum(case when d_moy = 8 then cs_net_paid_inc_ship * cs_quantity else 0 end) as aug_net ,sum(case when d_moy = 9 then cs_net_paid_inc_ship * cs_quantity else 0 end) as sep_net ,sum(case when d_moy = 10 then cs_net_paid_inc_ship * cs_quantity else 0 end) as oct_net ,sum(case when d_moy = 11 then cs_net_paid_inc_ship * cs_quantity else 0 end) as nov_net ,sum(case when d_moy = 12 then cs_net_paid_inc_ship * cs_quantity else 0 end) as dec_net from catalog_sales ,warehouse ,date_dim ,time_dim ,ship_mode where cs_warehouse_sk =  w_warehouse_sk and cs_sold_date_sk = d_date_sk and cs_sold_time_sk = t_time_sk and cs_ship_mode_sk = sm_ship_mode_sk and d_year = 2001 and t_time between 9453 AND 9453+28800 and sm_carrier in (&apos;MSC&apos;,&apos;GERMA&apos;) group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,d_year ) x group by w_warehouse_name ,w_warehouse_sq_ft ,w_city ,w_county ,w_state ,w_country ,ship_carriers ,year order by w_warehouse_name limit 100

</samplerData>
</sample>
<sample t="2881" lt="2875" ts="1600984912769" s="true" lb="query67" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="17346" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220149_3f83b009-5080-4cf1-af65-840529af3fd0:275
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924220149_3f83b009-5080-4cf1-af65-840529af3fd0:275
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_75_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:1.5325470946482016E-6
                  Statistics: Num rows: 27503885621 Data size: 3770198711808 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3681412825712 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_store_sk (type: bigint), ss_sold_date_sk (type: bigint), CASE WHEN ((ss_sales_price is not null and CAST( ss_quantity AS decimal(10,0)) is not null)) THEN ((ss_sales_price * CAST( ss_quantity AS decimal(10,0)))) ELSE (0) END (type: decimal(18,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26856185846 Data size: 3647381700352 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col3, _col5, _col6, _col7
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5279977323 Data size: 734137250516 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col3, _col5, _col6, _col7, _col9
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 5279977323 Data size: 1224954738936 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col3, _col5, _col6, _col7, _col9, _col11, _col12, _col13, _col14
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 5279977323 Data size: 3236626098999 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col3)
                              keys: _col5 (type: int), _col6 (type: int), _col7 (type: int), _col9 (type: char(16)), _col11 (type: char(50)), _col12 (type: char(50)), _col13 (type: char(50)), _col14 (type: char(50)), 0L (type: bigint)
                              minReductionHashAggr: 0.9676565
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                              Statistics: Num rows: 47519795907 Data size: 29509793258247 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: char(16)), _col4 (type: char(50)), _col5 (type: char(50)), _col6 (type: char(50)), _col7 (type: char(50)), _col8 (type: bigint)
                                null sort order: aaaaaaaaa
                                sort order: +++++++++
                                Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: char(16)), _col4 (type: char(50)), _col5 (type: char(50)), _col6 (type: char(50)), _col7 (type: char(50)), _col8 (type: bigint)
                                Statistics: Num rows: 47519795907 Data size: 29509793258247 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col9 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_month_seq BETWEEN 1185 AND 1196 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1753176 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1185 AND 1196 (type: boolean)
                    Statistics: Num rows: 359 Data size: 8616 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_year (type: int), d_moy (type: int), d_qoy (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 359 Data size: 7180 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 7180 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_store_id (type: char(16))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 159594000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_brand (type: char(50)), i_class (type: char(50)), i_category (type: char(50)), i_product_name (type: char(50))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 402000 Data size: 159594000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 159594000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50)), _col4 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: char(16)), KEY._col4 (type: char(50)), KEY._col5 (type: char(50)), KEY._col6 (type: char(50)), KEY._col7 (type: char(50)), KEY._col8 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col9
                Statistics: Num rows: 47519795907 Data size: 29509793258247 Basic stats: COMPLETE Column stats: COMPLETE
                pruneGroupingSetId: true
                Top N Key Operator
                  sort order: +-
                  keys: _col6 (type: char(50)), _col9 (type: decimal(28,2))
                  null sort order: aa
                  Map-reduce partition columns: _col6 (type: char(50))
                  Statistics: Num rows: 47519795907 Data size: 29509793258247 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 101
                  Select Operator
                    expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: char(16)), _col4 (type: char(50)), _col5 (type: char(50)), _col6 (type: char(50)), _col7 (type: char(50)), _col9 (type: decimal(28,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                    Statistics: Num rows: 47519795907 Data size: 29129634890991 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col6 (type: char(50)), _col8 (type: decimal(28,2))
                      null sort order: aa
                      sort order: +-
                      Map-reduce partition columns: _col6 (type: char(50))
                      Statistics: Num rows: 47519795907 Data size: 29129634890991 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: char(16)), _col4 (type: char(50)), _col5 (type: char(50)), _col7 (type: char(50))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: char(16)), VALUE._col4 (type: char(50)), VALUE._col5 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col6 (type: char(50)), KEY.reducesinkkey1 (type: decimal(28,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                Statistics: Num rows: 47519795907 Data size: 29129634890991 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: int, _col1: int, _col2: int, _col3: char(16), _col4: char(50), _col5: char(50), _col6: char(50), _col7: char(50), _col8: decimal(28,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col8 DESC NULLS FIRST
                        partition by: _col6
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col8
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 47519795907 Data size: 29129634890991 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (rank_window_0 &lt;= 100) (type: boolean)
                    Statistics: Num rows: 15839931969 Data size: 9709878296997 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++++++++++
                      keys: _col6 (type: char(50)), _col5 (type: char(50)), _col4 (type: char(50)), _col7 (type: char(50)), _col0 (type: int), _col2 (type: int), _col1 (type: int), _col3 (type: char(16)), _col8 (type: decimal(28,2)), rank_window_0 (type: int)
                      null sort order: zzzzzzzzzz
                      Statistics: Num rows: 15839931969 Data size: 9709878296997 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Select Operator
                        expressions: _col6 (type: char(50)), _col5 (type: char(50)), _col4 (type: char(50)), _col7 (type: char(50)), _col0 (type: int), _col2 (type: int), _col1 (type: int), _col3 (type: char(16)), _col8 (type: decimal(28,2)), rank_window_0 (type: int)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                        Statistics: Num rows: 15839931969 Data size: 9773238024873 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50)), _col4 (type: int), _col5 (type: int), _col6 (type: int), _col7 (type: char(16)), _col8 (type: decimal(28,2)), _col9 (type: int)
                          null sort order: zzzzzzzzzz
                          sort order: ++++++++++
                          Statistics: Num rows: 15839931969 Data size: 9773238024873 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(50)), KEY.reducesinkkey1 (type: char(50)), KEY.reducesinkkey2 (type: char(50)), KEY.reducesinkkey3 (type: char(50)), KEY.reducesinkkey4 (type: int), KEY.reducesinkkey5 (type: int), KEY.reducesinkkey6 (type: int), KEY.reducesinkkey7 (type: char(16)), KEY.reducesinkkey8 (type: decimal(28,2)), KEY.reducesinkkey9 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                Statistics: Num rows: 15839931969 Data size: 9773238024873 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 61700 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 61700 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query67
explain select  * from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rank() over (partition by i_category order by sumsales desc) rk from (select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales from store_sales ,date_dim ,store ,item where  ss_sold_date_sk=d_date_sk and ss_item_sk=i_item_sk and ss_store_sk = s_store_sk and d_month_seq between 1185 and 1185+11 group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2 where rk &lt;= 100 order by i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id ,sumsales ,rk limit 100

</samplerData>
</sample>
<sample t="4400" lt="4393" ts="1600984917170" s="true" lb="query68" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="19734" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220152_1a93b4f0-9bae-4926-8add-8c5b0f218cb8:276
      Edges:
        Map 5 &lt;- Map 10 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 4 (CUSTOM_SIMPLE_EDGE), Reducer 7 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 6 &lt;- Map 4 (CUSTOM_SIMPLE_EDGE), Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
      DagName: zabetak_20200924220152_1a93b4f0-9bae-4926-8add-8c5b0f218cb8:276
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: c_current_addr_sk is not null (type: boolean)
                  Statistics: Num rows: 65000000 Data size: 12740000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: c_current_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 65000000 Data size: 12740000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_addr_sk (type: bigint), c_first_name (type: char(20)), c_last_name (type: char(30))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 65000000 Data size: 12740000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: bigint)
                        Statistics: Num rows: 65000000 Data size: 12740000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col2 (type: char(20)), _col3 (type: char(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: ((hd_vehicle_count = 0) or (hd_dep_count = 4)) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((hd_vehicle_count = 0) or (hd_dep_count = 4)) (type: boolean)
                    Statistics: Num rows: 1920 Data size: 30720 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1920 Data size: 15360 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1920 Data size: 15360 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: current_addr
                  Statistics: Num rows: 32500000 Data size: 3282500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ca_address_sk (type: bigint), ca_city (type: varchar(60))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 32500000 Data size: 3282500000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 3282500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(60))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 32500000 Data size: 3282500000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(60))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_addr_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_135_container, bigKeyColName:ss_hdemo_sk, smallTablePos:1, keyRatio:1.4579758130386678E-8
                  Statistics: Num rows: 27503885621 Data size: 10322953799888 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_addr_sk is not null and ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 25001837266 Data size: 9383867231192 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_ext_list_price (type: decimal(7,2)), ss_ext_tax (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 25001837266 Data size: 9383867231192 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col8 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 972128206 Data size: 148681926504 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 12330075 Data size: 98640960 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7
                            input vertices:
                              1 Map 10
                            Statistics: Num rows: 3288021 Data size: 26304520 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col2 (type: bigint)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col2 (type: bigint)
                              Statistics: Num rows: 3288021 Data size: 26304520 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col4 (type: bigint), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2)), _col7 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_dom BETWEEN 1 AND 2 and (d_year) IN (1999, 2000, 2001)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_dom BETWEEN 1 AND 2 and (d_year) IN (1999, 2000, 2001)) (type: boolean)
                    Statistics: Num rows: 71 Data size: 1136 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 71 Data size: 568 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 71 Data size: 568 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 71 Data size: 568 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5070423
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 35 Data size: 280 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 35 Data size: 280 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 5
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_city) IN (&apos;Pleasant Hill&apos;, &apos;Bethel&apos;) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 151500 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_city) IN (&apos;Pleasant Hill&apos;, &apos;Bethel&apos;) (type: boolean)
                    Statistics: Num rows: 19 Data size: 1919 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 19 Data size: 152 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 19 Data size: 152 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col3, _col5
                input vertices:
                  1 Map 4
                Statistics: Num rows: 65000000 Data size: 18265000000 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col1 (type: bigint)
                  outputColumnNames: _col2, _col3, _col5, _col6, _col8, _col9, _col10, _col11
                  input vertices:
                    1 Reducer 7
                  Statistics: Num rows: 3288021 Data size: 2334494910 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (_col5 &lt;&gt; _col8) (type: boolean)
                    Statistics: Num rows: 3288021 Data size: 2334494910 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++
                      keys: _col3 (type: char(30)), _col6 (type: bigint)
                      null sort order: zz
                      Statistics: Num rows: 3288021 Data size: 2334494910 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Select Operator
                        expressions: _col3 (type: char(30)), _col2 (type: char(20)), _col5 (type: varchar(60)), _col8 (type: varchar(60)), _col6 (type: bigint), _col9 (type: decimal(17,2)), _col11 (type: decimal(17,2)), _col10 (type: decimal(17,2))
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                        Statistics: Num rows: 3288021 Data size: 2334494910 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(30)), _col4 (type: bigint)
                          null sort order: zz
                          sort order: ++
                          Statistics: Num rows: 3288021 Data size: 2334494910 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
                          value expressions: _col1 (type: char(20)), _col2 (type: varchar(60)), _col3 (type: varchar(60)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(30)), VALUE._col0 (type: char(20)), VALUE._col1 (type: varchar(60)), VALUE._col2 (type: varchar(60)), KEY.reducesinkkey1 (type: bigint), VALUE._col3 (type: decimal(17,2)), VALUE._col4 (type: decimal(17,2)), VALUE._col5 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 3288021 Data size: 2334494910 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 71000 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 71000 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col7, _col13
                input vertices:
                  1 Map 4
                Statistics: Num rows: 3288021 Data size: 332090473 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col5), sum(_col6), sum(_col7)
                  keys: _col0 (type: bigint), _col13 (type: varchar(60)), _col2 (type: bigint), _col4 (type: bigint)
                  minReductionHashAggr: 0.97843444
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                  Statistics: Num rows: 3288021 Data size: 1436865193 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint), _col1 (type: varchar(60)), _col2 (type: bigint), _col3 (type: bigint)
                    null sort order: aaaa
                    sort order: ++++
                    Map-reduce partition columns: _col0 (type: bigint), _col1 (type: varchar(60)), _col2 (type: bigint), _col3 (type: bigint)
                    Statistics: Num rows: 3288021 Data size: 1436865193 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: varchar(60)), KEY._col2 (type: bigint), KEY._col3 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 3288021 Data size: 1436865193 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col3 (type: bigint), _col0 (type: bigint), _col1 (type: varchar(60)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), _col6 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 3288021 Data size: 1436865185 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 3288021 Data size: 1436865185 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: bigint), _col2 (type: varchar(60)), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query68
explain select  c_last_name ,c_first_name ,ca_city ,bought_city ,ss_ticket_number ,extended_price ,extended_tax ,list_price from (select ss_ticket_number ,ss_customer_sk ,ca_city bought_city ,sum(ss_ext_sales_price) extended_price ,sum(ss_ext_list_price) list_price ,sum(ss_ext_tax) extended_tax from store_sales ,date_dim ,store ,household_demographics ,customer_address where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and store_sales.ss_addr_sk = customer_address.ca_address_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_dep_count = 4 or household_demographics.hd_vehicle_count= 0) and date_dim.d_year in (1999,1999+1,1999+2) and store.s_city in (&apos;Pleasant Hill&apos;,&apos;Bethel&apos;) group by ss_ticket_number ,ss_customer_sk ,ss_addr_sk,ca_city) dn ,customer ,customer_address current_addr where ss_customer_sk = c_customer_sk and customer.c_current_addr_sk = current_addr.ca_address_sk and current_addr.ca_city &lt;&gt; bought_city order by c_last_name ,ss_ticket_number limit 100

</samplerData>
</sample>
<sample t="4416" lt="4409" ts="1600984921588" s="true" lb="query69" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="25325" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220157_2e6b205c-8101-4b44-ba9e-cbd5795e1aa3:277
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Reducer 10 (BROADCAST_EDGE), Reducer 8 (BROADCAST_EDGE)
        Map 5 &lt;- Map 6 (BROADCAST_EDGE)
        Map 7 &lt;- Map 6 (BROADCAST_EDGE)
        Map 9 &lt;- Map 6 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE)
      DagName: zabetak_20200924220157_2e6b205c-8101-4b44-ba9e-cbd5795e1aa3:277
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: ((ca_state) IN (&apos;MO&apos;, &apos;MN&apos;, &apos;AZ&apos;) and c_current_cdemo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_143_container, bigKeyColName:c_customer_sk, smallTablePos:1, keyRatio:1.277076923076923E-4
                  Statistics: Num rows: 65000000 Data size: 6611816528 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ca_state) IN (&apos;MO&apos;, &apos;MN&apos;, &apos;AZ&apos;) and c_current_cdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 3550588 Data size: 361166720 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_cdemo_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 3550588 Data size: 55816152 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col7
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 3550588 Data size: 1303065796 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Left Semi Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col7
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 192422 Data size: 70618874 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Left Outer Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col1 (type: bigint)
                            outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col7, _col8
                            input vertices:
                              1 Reducer 8
                            Statistics: Num rows: 46493 Data size: 17248903 Basic stats: COMPLETE Column stats: COMPLETE
                            Filter Operator
                              predicate: _col8 is null (type: boolean)
                              Statistics: Num rows: 1 Data size: 371 Basic stats: COMPLETE Column stats: COMPLETE
                              Select Operator
                                expressions: _col0 (type: bigint), _col3 (type: char(1)), _col4 (type: char(1)), _col5 (type: char(20)), _col6 (type: int), _col7 (type: char(10))
                                outputColumnNames: _col0, _col3, _col4, _col5, _col6, _col7
                                Statistics: Num rows: 1 Data size: 371 Basic stats: COMPLETE Column stats: COMPLETE
                                Map Join Operator
                                  condition map:
                                       Left Outer Join 0 to 1
                                  keys:
                                    0 _col0 (type: bigint)
                                    1 _col1 (type: bigint)
                                  outputColumnNames: _col3, _col4, _col5, _col6, _col7, _col10
                                  input vertices:
                                    1 Reducer 10
                                  Statistics: Num rows: 94836 Data size: 34425468 Basic stats: COMPLETE Column stats: COMPLETE
                                  Filter Operator
                                    predicate: _col10 is null (type: boolean)
                                    Statistics: Num rows: 1 Data size: 363 Basic stats: COMPLETE Column stats: COMPLETE
                                    Top N Key Operator
                                      sort order: +++++
                                      keys: _col3 (type: char(1)), _col4 (type: char(1)), _col5 (type: char(20)), _col6 (type: int), _col7 (type: char(10))
                                      null sort order: zzzzz
                                      Statistics: Num rows: 1 Data size: 363 Basic stats: COMPLETE Column stats: COMPLETE
                                      top n: 100
                                      Select Operator
                                        expressions: _col3 (type: char(1)), _col4 (type: char(1)), _col5 (type: char(20)), _col6 (type: int), _col7 (type: char(10))
                                        outputColumnNames: _col3, _col4, _col5, _col6, _col7
                                        Statistics: Num rows: 1 Data size: 363 Basic stats: COMPLETE Column stats: COMPLETE
                                        Group By Operator
                                          aggregations: count()
                                          keys: _col3 (type: char(1)), _col4 (type: char(1)), _col5 (type: char(20)), _col6 (type: int), _col7 (type: char(10))
                                          minReductionHashAggr: 0.0
                                          mode: hash
                                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                                          Statistics: Num rows: 1 Data size: 367 Basic stats: COMPLETE Column stats: COMPLETE
                                          Reduce Output Operator
                                            key expressions: _col0 (type: char(1)), _col1 (type: char(1)), _col2 (type: char(20)), _col3 (type: int), _col4 (type: char(10))
                                            null sort order: zzzzz
                                            sort order: +++++
                                            Map-reduce partition columns: _col0 (type: char(1)), _col1 (type: char(1)), _col2 (type: char(20)), _col3 (type: int), _col4 (type: char(10))
                                            Statistics: Num rows: 1 Data size: 367 Basic stats: COMPLETE Column stats: COMPLETE
                                            TopN Hash Memory Usage: 0.04
                                            value expressions: _col5 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  Statistics: Num rows: 1920800 Data size: 704933600 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cd_demo_sk (type: bigint), cd_gender (type: char(1)), cd_marital_status (type: char(1)), cd_education_status (type: char(20)), cd_purchase_estimate (type: int), cd_credit_rating (type: char(10))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 1920800 Data size: 704933600 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 704933600 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(1)), _col2 (type: char(1)), _col3 (type: char(20)), _col4 (type: int), _col5 (type: char(10))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 434877053936 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 1353063873 Data size: 5761584208 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 3522634 Data size: 15000000 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 3522634 Data size: 15000000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2003) and d_moy BETWEEN 2 AND 4) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2003) and d_moy BETWEEN 2 AND 4) (type: boolean)
                    Statistics: Num rows: 92 Data size: 1472 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 5
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 92 Data size: 736 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 46 Data size: 368 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 9
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 115163423680 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 362617356 Data size: 2893760528 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 557916 Data size: 4452288 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 557916 Data size: 4452288 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_ship_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 228959459440 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_ship_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291978461 Data size: 228384573968 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_ship_customer_sk (type: bigint), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 14291978461 Data size: 228384573968 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 714977700 Data size: 5432740192 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 2086392 Data size: 15853408 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 2086392 Data size: 15853408 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 94836 Data size: 720616 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: true (type: boolean), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 94836 Data size: 1099960 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 94836 Data size: 1099960 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: char(1)), KEY._col1 (type: char(1)), KEY._col2 (type: char(20)), KEY._col3 (type: int), KEY._col4 (type: char(10))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1 Data size: 367 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(1)), _col1 (type: char(1)), _col2 (type: char(20)), _col5 (type: bigint), _col3 (type: int), _col4 (type: char(10))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col6
                  Statistics: Num rows: 1 Data size: 383 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(1)), _col1 (type: char(1)), _col2 (type: char(20)), _col4 (type: int), _col6 (type: char(10))
                    null sort order: zzzzz
                    sort order: +++++
                    Statistics: Num rows: 1 Data size: 383 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col3 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(1)), KEY.reducesinkkey1 (type: char(1)), KEY.reducesinkkey2 (type: char(20)), VALUE._col0 (type: bigint), KEY.reducesinkkey3 (type: int), VALUE._col0 (type: bigint), KEY.reducesinkkey4 (type: char(10)), VALUE._col0 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 1 Data size: 383 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 383 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 383 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 46493 Data size: 371032 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: true (type: boolean), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 46493 Data size: 557004 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 46493 Data size: 557004 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query69
explain select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_state in (&apos;MO&apos;,&apos;MN&apos;,&apos;AZ&apos;) and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2003 and d_moy between 2 and 2+2) and (not exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 2003 and d_moy between 2 and 2+2) and not exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 2003 and d_moy between 2 and 2+2)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating limit 100

</samplerData>
</sample>
<sample t="2336" lt="2329" ts="1600984923926" s="true" lb="query70" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="23399" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220201_90b73237-4941-4dc4-9457-ca8d3923b1ad:278
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Reducer 9 (BROADCAST_EDGE)
        Map 7 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE)
        Reducer 9 &lt;- Map 6 (BROADCAST_EDGE), Reducer 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924220201_90b73237-4941-4dc4-9457-ca8d3923b1ad:278
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_123_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:0.19197205063158737
                  Statistics: Num rows: 27503885621 Data size: 3442730411872 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3361656205024 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_store_sk (type: bigint), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26856185846 Data size: 3361656205024 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5279977323 Data size: 557661695496 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col6, _col7
                          input vertices:
                            1 Reducer 9
                          Statistics: Num rows: 5279977323 Data size: 1491997279048 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: _col7 (type: char(2)), _col6 (type: varchar(30)), _col1 (type: decimal(7,2))
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 5279977323 Data size: 1491997279048 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col0 (type: char(2)), _col1 (type: varchar(30)), 0L (type: bigint)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3
                              Statistics: Num rows: 1888596 Data size: 574133184 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(2)), _col1 (type: varchar(30)), _col2 (type: bigint)
                                null sort order: aaa
                                sort order: +++
                                Map-reduce partition columns: _col0 (type: char(2)), _col1 (type: varchar(30)), _col2 (type: bigint)
                                Statistics: Num rows: 1888596 Data size: 574133184 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col3 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: d1
                  filterExpr: d_month_seq BETWEEN 1218 AND 1229 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1218 AND 1229 (type: boolean)
                    Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: s_state is not null (type: boolean)
                  Statistics: Num rows: 1500 Data size: 288000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: s_state is not null (type: boolean)
                    Statistics: Num rows: 1500 Data size: 288000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_county (type: varchar(30)), s_state (type: char(2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1500 Data size: 288000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col2 (type: char(2))
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col2 (type: char(2))
                        Statistics: Num rows: 1500 Data size: 288000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col1 (type: varchar(30))
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_state (type: char(2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1500 Data size: 141000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1500 Data size: 141000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_121_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:0.19197205063158737
                  Statistics: Num rows: 27503885621 Data size: 3442730411872 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3361656205024 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_store_sk (type: bigint), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 26856185846 Data size: 3361656205024 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 5279977323 Data size: 557661695496 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col5
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 5279977323 Data size: 974559501394 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            keys: _col5 (type: char(2))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1
                            Statistics: Num rows: 137052 Data size: 27136296 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(2))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: char(2))
                              Statistics: Num rows: 137052 Data size: 27136296 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(2)), KEY._col1 (type: varchar(30)), KEY._col2 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 324 Data size: 98496 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(2)), _col1 (type: varchar(30)), _col3 (type: decimal(17,2)), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 324 Data size: 98496 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: (grouping(_col3, 1L) + grouping(_col3, 0L)) (type: bigint), CASE WHEN ((grouping(_col3, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(2))) END (type: char(2)), _col2 (type: decimal(17,2))
                    null sort order: aaa
                    sort order: ++-
                    Map-reduce partition columns: (grouping(_col3, 1L) + grouping(_col3, 0L)) (type: bigint), CASE WHEN ((grouping(_col3, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(2))) END (type: char(2))
                    Statistics: Num rows: 324 Data size: 98496 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: char(2)), _col1 (type: varchar(30)), _col3 (type: bigint)
        Reducer 3 
            Execution mode: llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: char(2)), VALUE._col1 (type: varchar(30)), KEY.reducesinkkey2 (type: decimal(17,2)), VALUE._col2 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 324 Data size: 98496 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: char(2), _col1: varchar(30), _col2: decimal(17,2), _col3: bigint
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col2 DESC NULLS FIRST
                        partition by: (grouping(_col3, 1L) + grouping(_col3, 0L)), CASE WHEN ((grouping(_col3, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(2))) END
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col2
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 324 Data size: 98496 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: -++
                    keys: (grouping(_col3, 1L) + grouping(_col3, 0L)) (type: bigint), CASE WHEN (((grouping(_col3, 1L) + grouping(_col3, 0L)) = 0L)) THEN (_col0) ELSE (null) END (type: char(2)), rank_window_0 (type: int)
                    null sort order: azz
                    Statistics: Num rows: 324 Data size: 98496 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: _col2 (type: decimal(17,2)), _col0 (type: char(2)), _col1 (type: varchar(30)), (grouping(_col3, 1L) + grouping(_col3, 0L)) (type: bigint), rank_window_0 (type: int), CASE WHEN (((grouping(_col3, 1L) + grouping(_col3, 0L)) = 0L)) THEN (_col0) ELSE (null) END (type: char(2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 324 Data size: 127656 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col3 (type: bigint), _col5 (type: char(2)), _col4 (type: int)
                        null sort order: azz
                        sort order: -++
                        Statistics: Num rows: 324 Data size: 127656 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col0 (type: decimal(17,2)), _col1 (type: char(2)), _col2 (type: varchar(30))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: decimal(17,2)), VALUE._col1 (type: char(2)), VALUE._col2 (type: varchar(30)), KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey2 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 324 Data size: 127656 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 39400 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 39400 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(2))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 36 Data size: 7128 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +-
                  keys: _col0 (type: char(2)), _col1 (type: decimal(17,2))
                  null sort order: aa
                  Map-reduce partition columns: _col0 (type: char(2))
                  Statistics: Num rows: 36 Data size: 7128 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 6
                  Reduce Output Operator
                    key expressions: _col0 (type: char(2)), _col1 (type: decimal(17,2))
                    null sort order: aa
                    sort order: +-
                    Map-reduce partition columns: _col0 (type: char(2))
                    Statistics: Num rows: 36 Data size: 7128 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(2)), KEY.reducesinkkey1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 36 Data size: 7128 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: char(2), _col1: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 DESC NULLS FIRST
                        partition by: _col0
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col1
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 36 Data size: 7128 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (rank_window_0 &lt;= 5) (type: boolean)
                    Statistics: Num rows: 12 Data size: 2376 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: char(2))
                      outputColumnNames: _col0
                      Statistics: Num rows: 12 Data size: 1032 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: char(2))
                          1 _col0 (type: char(2))
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          0 Map 6
                        Statistics: Num rows: 500 Data size: 96000 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 500 Data size: 96000 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: varchar(30)), _col2 (type: char(2))

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query70
explain select sum(ss_net_profit) as total_sum ,s_state ,s_county ,grouping(s_state)+grouping(s_county) as lochierarchy ,rank() over ( partition by grouping(s_state)+grouping(s_county), case when grouping(s_county) = 0 then s_state end order by sum(ss_net_profit) desc) as rank_within_parent from store_sales ,date_dim       d1 ,store where d1.d_month_seq between 1218 and 1218+11 and d1.d_date_sk = ss_sold_date_sk and s_store_sk  = ss_store_sk and s_state in ( select s_state from  (select s_state as s_state, rank() over ( partition by s_state order by sum(ss_net_profit) desc) as ranking from   store_sales, store, date_dim where  d_month_seq between 1218 and 1218+11 and d_date_sk = ss_sold_date_sk and s_store_sk  = ss_store_sk group by s_state ) tmp1 where ranking &lt;= 5 ) group by rollup(s_state,s_county) order by lochierarchy desc ,case when lochierarchy = 0 then s_state end ,rank_within_parent limit 100

</samplerData>
</sample>
<sample t="6842" lt="6835" ts="1600984930769" s="true" lb="query71" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="30224" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220203_d6c45015-a5cf-425d-a42c-a4cb47e92898:279
      Edges:
        Map 1 &lt;- Map 10 (BROADCAST_EDGE), Map 12 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 6 &lt;- Map 10 (BROADCAST_EDGE), Map 12 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Reducer 11 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Map 8 &lt;- Map 10 (BROADCAST_EDGE), Map 12 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE), Reducer 11 (BROADCAST_EDGE), Union 2 (CONTAINS)
        Reducer 11 &lt;- Map 10 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Union 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924220203_d6c45015-a5cf-425d-a42c-a4cb47e92898:279
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_sold_time_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_119_container, bigKeyColName:time_sk, smallTablePos:1, keyRatio:9.446855123112214E-9
                  Statistics: Num rows: 7198162681 Data size: 978842059000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_sold_time_sk is not null (type: boolean)
                    Statistics: Num rows: 7197261464 Data size: 978719507048 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_sold_time_sk (type: bigint), ws_item_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 7197261464 Data size: 978719507048 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 122186220 Data size: 15531784104 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col2 (type: decimal(7,2)), _col1 (type: bigint), _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 122186220 Data size: 15531784104 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col2, _col4, _col5
                            input vertices:
                              1 Map 10
                            Statistics: Num rows: 7874501 Data size: 818948188 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col0, _col4, _col5, _col7, _col8
                              input vertices:
                                1 Map 12
                              Statistics: Num rows: 3937251 Data size: 440972188 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col0)
                                keys: _col4 (type: int), _col5 (type: char(50)), _col7 (type: int), _col8 (type: int)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                                Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: int), _col1 (type: char(50)), _col2 (type: int), _col3 (type: int)
                                  null sort order: aaaa
                                  sort order: ++++
                                  Map-reduce partition columns: _col0 (type: int), _col1 (type: char(50)), _col2 (type: int), _col3 (type: int)
                                  Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_manager_id = 1) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 46624044 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_manager_id = 1) (type: boolean)
                    Statistics: Num rows: 3865 Data size: 448272 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand_id (type: int), i_brand (type: char(50))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 3865 Data size: 432844 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 3865 Data size: 432844 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: char(50))
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 3865 Data size: 30920 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 3865 Data size: 432844 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: char(50))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 3865 Data size: 432844 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: time_dim
                  filterExpr: (t_meal_time) IN (&apos;breakfast           &apos;, &apos;dinner              &apos;) (type: boolean)
                  Statistics: Num rows: 86400 Data size: 8899200 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (t_meal_time) IN (&apos;breakfast           &apos;, &apos;dinner              &apos;) (type: boolean)
                    Statistics: Num rows: 43200 Data size: 4449600 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: t_time_sk (type: bigint), t_hour (type: int), t_minute (type: int)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 43200 Data size: 691200 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 43200 Data size: 691200 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 43200 Data size: 691200 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 43200 Data size: 691200 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_sold_time_sk is not null and cs_item_sk BETWEEN DynamicValue(RS_39_item_i_item_sk_min) AND DynamicValue(RS_39_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_39_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 1944284275864 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_sold_time_sk is not null and cs_item_sk BETWEEN DynamicValue(RS_39_item_i_item_sk_min) AND DynamicValue(RS_39_item_i_item_sk_max) and in_bloom_filter(cs_item_sk, DynamicValue(RS_39_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14291958080 Data size: 1939399681784 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_sold_time_sk (type: bigint), cs_item_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 14291958080 Data size: 1939399681784 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 240916058 Data size: 26530638328 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col2 (type: decimal(7,2)), _col1 (type: bigint), _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 240916058 Data size: 26530638328 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col2, _col4, _col5
                            input vertices:
                              1 Map 10
                            Statistics: Num rows: 7874501 Data size: 818948188 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col0, _col4, _col5, _col7, _col8
                              input vertices:
                                1 Map 12
                              Statistics: Num rows: 3937251 Data size: 440972188 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col0)
                                keys: _col4 (type: int), _col5 (type: char(50)), _col7 (type: int), _col8 (type: int)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                                Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: int), _col1 (type: char(50)), _col2 (type: int), _col3 (type: int)
                                  null sort order: aaaa
                                  sort order: ++++
                                  Map-reduce partition columns: _col0 (type: int), _col1 (type: char(50)), _col2 (type: int), _col3 (type: int)
                                  Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 6
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_sold_time_sk is not null and ss_item_sk BETWEEN DynamicValue(RS_39_item_i_item_sk_min) AND DynamicValue(RS_39_item_i_item_sk_max) and in_bloom_filter(ss_item_sk, DynamicValue(RS_39_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 3662752680008 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_sold_time_sk is not null and ss_item_sk BETWEEN DynamicValue(RS_39_item_i_item_sk_min) AND DynamicValue(RS_39_item_i_item_sk_max) and in_bloom_filter(ss_item_sk, DynamicValue(RS_39_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26855959652 Data size: 3576466959752 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_sold_time_sk (type: bigint), ss_item_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26855959652 Data size: 3576466959752 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 9
                        Statistics: Num rows: 455927326 Data size: 3647418728 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col2 (type: decimal(7,2)), _col1 (type: bigint), _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 455927326 Data size: 3647418728 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col2, _col4, _col5
                            input vertices:
                              1 Map 10
                            Statistics: Num rows: 7874501 Data size: 818948188 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col2 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col0, _col4, _col5, _col7, _col8
                              input vertices:
                                1 Map 12
                              Statistics: Num rows: 3937251 Data size: 440972188 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col0)
                                keys: _col4 (type: int), _col5 (type: char(50)), _col7 (type: int), _col8 (type: int)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                                Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: int), _col1 (type: char(50)), _col2 (type: int), _col3 (type: int)
                                  null sort order: aaaa
                                  sort order: ++++
                                  Map-reduce partition columns: _col0 (type: int), _col1 (type: char(50)), _col2 (type: int), _col3 (type: int)
                                  Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col4 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 8
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: int), KEY._col1 (type: char(50)), KEY._col2 (type: int), KEY._col3 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(50)), _col2 (type: int), _col3 (type: int), _col4 (type: decimal(17,2)), _col0 (type: int)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 3937251 Data size: 897693156 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col4 (type: decimal(17,2)), _col5 (type: int)
                    null sort order: az
                    sort order: -+
                    Statistics: Num rows: 3937251 Data size: 897693156 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: char(50)), _col2 (type: int), _col3 (type: int)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: int), VALUE._col0 (type: char(50)), VALUE._col1 (type: int), VALUE._col2 (type: int), KEY.reducesinkkey0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 3937251 Data size: 881944188 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 2 
            Vertex: Union 2

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query71
explain select i_brand_id brand_id, i_brand brand,t_hour,t_minute, sum(ext_price) ext_price from item, (select ws_ext_sales_price as ext_price, ws_sold_date_sk as sold_date_sk, ws_item_sk as sold_item_sk, ws_sold_time_sk as time_sk from web_sales,date_dim where d_date_sk = ws_sold_date_sk and d_moy=12 and d_year=2000 union all select cs_ext_sales_price as ext_price, cs_sold_date_sk as sold_date_sk, cs_item_sk as sold_item_sk, cs_sold_time_sk as time_sk from catalog_sales,date_dim where d_date_sk = cs_sold_date_sk and d_moy=12 and d_year=2000 union all select ss_ext_sales_price as ext_price, ss_sold_date_sk as sold_date_sk, ss_item_sk as sold_item_sk, ss_sold_time_sk as time_sk from store_sales,date_dim where d_date_sk = ss_sold_date_sk and d_moy=12 and d_year=2000 ) tmp,time_dim where sold_item_sk = i_item_sk and i_manager_id=1 and time_sk = t_time_sk and (t_meal_time = &apos;breakfast&apos; or t_meal_time = &apos;dinner&apos;) group by i_brand, i_brand_id,t_hour,t_minute order by ext_price desc, i_brand_id

</samplerData>
</sample>
<sample t="6798" lt="6792" ts="1600984937568" s="true" lb="query72" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="27684" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220210_3ec7e909-f2c9-4d0b-abb2-8ec9e070235e:280
      Edges:
        Map 1 &lt;- Map 2 (BROADCAST_EDGE)
        Map 3 &lt;- Map 1 (BROADCAST_EDGE), Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE), Map 12 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 4 &lt;- Map 13 (CUSTOM_SIMPLE_EDGE), Map 14 (BROADCAST_EDGE), Map 3 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
      DagName: zabetak_20200924220210_3ec7e909-f2c9-4d0b-abb2-8ec9e070235e:280
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.ware_inv_date_2
                  filterExpr: inv_quantity_on_hand is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_239_container, bigKeyColName:w_warehouse_sk, smallTablePos:1, keyRatio:1.0450000420449188
                  Statistics: Num rows: 25211132 Data size: 670616156 Basic stats: COMPLETE Column stats: NONE
                  Filter Operator
                    predicate: inv_quantity_on_hand is not null (type: boolean)
                    Statistics: Num rows: 23950576 Data size: 637085364 Basic stats: COMPLETE Column stats: NONE
                    Select Operator
                      expressions: d_date_sk (type: bigint), inv_item_sk (type: bigint), w_warehouse_sk (type: bigint), inv_quantity_on_hand (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 23950576 Data size: 637085364 Basic stats: COMPLETE Column stats: NONE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col3, _col5
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 26345634 Data size: 700793915 Basic stats: COMPLETE Column stats: NONE
                        Reduce Output Operator
                          key expressions: _col1 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col1 (type: bigint)
                          Statistics: Num rows: 26345634 Data size: 700793915 Basic stats: COMPLETE Column stats: NONE
                          value expressions: _col0 (type: bigint), _col3 (type: int), _col5 (type: varchar(20))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: d2
                  filterExpr: d_week_seq is not null (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_week_seq is not null (type: boolean)
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_week_seq (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: int)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: int)
                        Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  Statistics: Num rows: 2000 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: p_promo_sk (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 2000 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 2000 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: d3
                  filterExpr: CAST( d_date AS TIMESTAMP) is not null (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) is not null (type: boolean)
                    Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), CAST( d_date AS TIMESTAMP) (type: timestamp)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 3506352 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 73049 Data size: 3506352 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: timestamp)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  Statistics: Num rows: 1440033112 Data size: 23040529792 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1440033112 Data size: 23040529792 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 1440033112 Data size: 23040529792 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 77184000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_item_desc (type: varchar(200))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 77184000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 77184000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(200))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: warehouse
                  Statistics: Num rows: 25 Data size: 2700 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: w_warehouse_sk (type: bigint), w_warehouse_name (type: varchar(20))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 25 Data size: 2700 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 25 Data size: 2700 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(20))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_quantity is not null and cs_ship_date_sk is not null and cs_bill_hdemo_sk is not null and cs_bill_cdemo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_242_container, bigKeyColName:cs_bill_hdemo_sk, smallTablePos:1, keyRatio:0.43922590985811577
                  Statistics: Num rows: 14327953968 Data size: 858381637040 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_quantity is not null and cs_ship_date_sk is not null and cs_bill_hdemo_sk is not null and cs_bill_cdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 14184541420 Data size: 849789852196 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_ship_date_sk (type: bigint), cs_bill_cdemo_sk (type: bigint), cs_bill_hdemo_sk (type: bigint), cs_item_sk (type: bigint), cs_promo_sk (type: bigint), cs_order_number (type: bigint), cs_quantity (type: int), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 14184541420 Data size: 849789852196 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col3 (type: bigint)
                        outputColumnNames: _col0, _col3, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13
                        input vertices:
                          0 Map 1
                        Statistics: Num rows: 15602995900 Data size: 934768857676 Basic stats: COMPLETE Column stats: NONE
                        Filter Operator
                          predicate: (_col3 &lt; _col12) (type: boolean)
                          Statistics: Num rows: 5200998633 Data size: 311589619205 Basic stats: COMPLETE Column stats: NONE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col13 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col15, _col16
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 5721098620 Data size: 342748588554 Basic stats: COMPLETE Column stats: NONE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col8 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col0, _col5, _col6, _col7, _col9, _col10, _col11, _col15, _col16
                              input vertices:
                                1 Map 8
                              Statistics: Num rows: 6293208618 Data size: 377023455581 Basic stats: COMPLETE Column stats: NONE
                              Map Join Operator
                                condition map:
                                     Inner Join 0 to 1
                                keys:
                                  0 _col7 (type: bigint)
                                  1 _col0 (type: bigint)
                                outputColumnNames: _col0, _col5, _col6, _col9, _col10, _col11, _col15, _col16
                                input vertices:
                                  1 Map 9
                                Statistics: Num rows: 6922529629 Data size: 414725810128 Basic stats: COMPLETE Column stats: NONE
                                Map Join Operator
                                  condition map:
                                       Inner Join 0 to 1
                                  keys:
                                    0 _col0 (type: bigint), _col15 (type: int)
                                    1 _col0 (type: bigint), _col1 (type: int)
                                  outputColumnNames: _col5, _col6, _col9, _col10, _col11, _col15, _col16
                                  input vertices:
                                    1 Map 10
                                  Statistics: Num rows: 7614782756 Data size: 456198401028 Basic stats: COMPLETE Column stats: NONE
                                  Map Join Operator
                                    condition map:
                                         Left Outer Join 0 to 1
                                    keys:
                                      0 _col10 (type: bigint)
                                      1 _col0 (type: bigint)
                                    outputColumnNames: _col5, _col6, _col9, _col11, _col15, _col16, _col21
                                    input vertices:
                                      1 Map 11
                                    Statistics: Num rows: 8376261213 Data size: 501818252007 Basic stats: COMPLETE Column stats: NONE
                                    Map Join Operator
                                      condition map:
                                           Inner Join 0 to 1
                                      keys:
                                        0 _col6 (type: bigint)
                                        1 _col0 (type: bigint)
                                      outputColumnNames: _col5, _col9, _col11, _col15, _col16, _col21, _col23
                                      input vertices:
                                        1 Map 12
                                      Statistics: Num rows: 9213887534 Data size: 552000089171 Basic stats: COMPLETE Column stats: NONE
                                      Filter Operator
                                        predicate: (_col23 &gt; _col16) (type: boolean)
                                        Statistics: Num rows: 3071295844 Data size: 184000029683 Basic stats: COMPLETE Column stats: NONE
                                        Select Operator
                                          expressions: _col9 (type: bigint), _col11 (type: bigint), _col5 (type: varchar(20)), _col15 (type: int), _col21 (type: bigint)
                                          outputColumnNames: _col3, _col5, _col13, _col17, _col23
                                          Statistics: Num rows: 3071295844 Data size: 184000029683 Basic stats: COMPLETE Column stats: NONE
                                          Reduce Output Operator
                                            key expressions: _col3 (type: bigint), _col5 (type: bigint)
                                            null sort order: aa
                                            sort order: ++
                                            Map-reduce partition columns: _col3 (type: bigint), _col5 (type: bigint)
                                            Statistics: Num rows: 3071295844 Data size: 184000029683 Basic stats: COMPLETE Column stats: NONE
                                            value expressions: _col13 (type: varchar(20)), _col17 (type: int), _col23 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: d1
                  filterExpr: ((d_year = 2000) and d_week_seq is not null and d_date is not null) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 5259528 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and d_week_seq is not null and d_date is not null) (type: boolean)
                    Statistics: Num rows: 367 Data size: 26424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_week_seq (type: int), (d_date + INTERVAL&apos;5 00:00:00.000000000&apos;) (type: timestamp)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 367 Data size: 19084 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 19084 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: timestamp)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 3
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: (hd_buy_potential = &apos;1001-5000      &apos;) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 720000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (hd_buy_potential = &apos;1001-5000      &apos;) (type: boolean)
                    Statistics: Num rows: 1200 Data size: 120000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1200 Data size: 9600 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1200 Data size: 9600 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  filterExpr: (cd_marital_status = &apos;D&apos;) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 178634400 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cd_marital_status = &apos;D&apos;) (type: boolean)
                    Statistics: Num rows: 384160 Data size: 35726880 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 384160 Data size: 3073280 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 384160 Data size: 3073280 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col3, _col13, _col17, _col23
                input vertices:
                  1 Map 13
                Statistics: Num rows: 3378425501 Data size: 202400037038 Basic stats: COMPLETE Column stats: NONE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col13, _col17, _col23, _col27
                  input vertices:
                    1 Map 14
                  Statistics: Num rows: 3716268131 Data size: 222640045567 Basic stats: COMPLETE Column stats: NONE
                  Select Operator
                    expressions: _col27 (type: varchar(200)), _col13 (type: varchar(20)), _col17 (type: int), CASE WHEN (_col23 is null) THEN (1) ELSE (0) END (type: int), CASE WHEN (_col23 is not null) THEN (1) ELSE (0) END (type: int)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 3716268131 Data size: 222640045567 Basic stats: COMPLETE Column stats: NONE
                    Group By Operator
                      aggregations: sum(_col3), sum(_col4), count()
                      keys: _col0 (type: varchar(200)), _col1 (type: varchar(20)), _col2 (type: int)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 3716268131 Data size: 222640045567 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: varchar(200)), _col1 (type: varchar(20)), _col2 (type: int)
                        null sort order: aaa
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: varchar(200)), _col1 (type: varchar(20)), _col2 (type: int)
                        Statistics: Num rows: 3716268131 Data size: 222640045567 Basic stats: COMPLETE Column stats: NONE
                        value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), count(VALUE._col2)
                keys: KEY._col0 (type: varchar(200)), KEY._col1 (type: varchar(20)), KEY._col2 (type: int)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1858134065 Data size: 111320022753 Basic stats: COMPLETE Column stats: NONE
                Top N Key Operator
                  sort order: -+++
                  keys: _col5 (type: bigint), _col0 (type: varchar(200)), _col1 (type: varchar(20)), _col2 (type: int)
                  null sort order: azzz
                  Statistics: Num rows: 1858134065 Data size: 111320022753 Basic stats: COMPLETE Column stats: NONE
                  top n: 100
                  Reduce Output Operator
                    key expressions: _col5 (type: bigint), _col0 (type: varchar(200)), _col1 (type: varchar(20)), _col2 (type: int)
                    null sort order: azzz
                    sort order: -+++
                    Statistics: Num rows: 1858134065 Data size: 111320022753 Basic stats: COMPLETE Column stats: NONE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col3 (type: bigint), _col4 (type: bigint)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: varchar(200)), KEY.reducesinkkey2 (type: varchar(20)), KEY.reducesinkkey3 (type: int), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 1858134065 Data size: 111320022753 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 5900 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 5900 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query72
explain select  i_item_desc ,w_warehouse_name ,d1.d_week_seq ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo ,sum(case when p_promo_sk is not null then 1 else 0 end) promo ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq and inv_quantity_on_hand &lt; cs_quantity and d3.d_date &gt; d1.d_date + INTERVAL(5) DAY and hd_buy_potential = &apos;1001-5000&apos; and d1.d_year = 2000 and cd_marital_status = &apos;D&apos; group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq limit 100

</samplerData>
</sample>
<sample t="3009" lt="3005" ts="1600984940579" s="true" lb="query73" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="14452" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220217_260cbaee-6820-417f-9925-2ab4b9a85259:281
      Edges:
        Map 1 &lt;- Reducer 4 (BROADCAST_EDGE)
        Map 3 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 4 &lt;- Map 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924220217_260cbaee-6820-417f-9925-2ab4b9a85259:281
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_92_container, bigKeyColName:c_customer_sk, smallTablePos:1, keyRatio:1.5384615384615385E-8
                  Statistics: Num rows: 65000000 Data size: 23400000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_salutation (type: char(10)), c_first_name (type: char(20)), c_last_name (type: char(30)), c_preferred_cust_flag (type: char(1))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 65000000 Data size: 23400000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col1 (type: bigint)
                      outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col7
                      input vertices:
                        1 Reducer 4
                      Statistics: Num rows: 5 Data size: 1840 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col3 (type: char(30)), _col2 (type: char(20)), _col1 (type: char(10)), _col4 (type: char(1)), _col5 (type: bigint), _col7 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 5 Data size: 1840 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col5 (type: bigint), _col0 (type: char(30))
                          null sort order: az
                          sort order: -+
                          Statistics: Num rows: 5 Data size: 1840 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: char(20)), _col2 (type: char(10)), _col3 (type: char(1)), _col4 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_91_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:2.9086799262616815E-8
                  Statistics: Num rows: 27503885621 Data size: 1084603370712 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 25605320705 Data size: 1009734316368 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 25605320705 Data size: 1009734316368 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col4 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 995593013 Data size: 17380464584 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col3
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 132745742 Data size: 1061965952 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col2 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col3
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 6734770 Data size: 53878168 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: count()
                              keys: _col0 (type: bigint), _col3 (type: bigint)
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2
                              Statistics: Num rows: 717696 Data size: 11483144 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: bigint), _col1 (type: bigint)
                                null sort order: aa
                                sort order: ++
                                Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                                Statistics: Num rows: 717696 Data size: 11483144 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_dom BETWEEN 1 AND 2 and (d_year) IN (2000, 2001, 2002)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_dom BETWEEN 1 AND 2 and (d_year) IN (2000, 2001, 2002)) (type: boolean)
                    Statistics: Num rows: 71 Data size: 1136 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 71 Data size: 568 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 71 Data size: 568 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 71 Data size: 568 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5070423
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 35 Data size: 280 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 35 Data size: 280 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 3
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: ((hd_vehicle_count &gt; 0) and (hd_buy_potential) IN (&apos;&gt;10000         &apos;, &apos;5001-10000     &apos;) and CASE WHEN ((hd_vehicle_count &gt; 0)) THEN (((UDFToDouble(hd_dep_count) / UDFToDouble(hd_vehicle_count)) &gt; 1.0D)) ELSE (false) END) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 777600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((hd_vehicle_count &gt; 0) and (hd_buy_potential) IN (&apos;&gt;10000         &apos;, &apos;5001-10000     &apos;) and CASE WHEN ((hd_vehicle_count &gt; 0)) THEN (((UDFToDouble(hd_dep_count) / UDFToDouble(hd_vehicle_count)) &gt; 1.0D)) ELSE (false) END) (type: boolean)
                    Statistics: Num rows: 960 Data size: 103680 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 960 Data size: 7680 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 960 Data size: 7680 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_county) IN (&apos;Lea County&apos;, &apos;Furnas County&apos;, &apos;Pennington County&apos;, &apos;Bronx County&apos;) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 159000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_county) IN (&apos;Lea County&apos;, &apos;Furnas County&apos;, &apos;Pennington County&apos;, &apos;Bronx County&apos;) (type: boolean)
                    Statistics: Num rows: 76 Data size: 8056 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 76 Data size: 608 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 76 Data size: 608 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: char(30)), VALUE._col0 (type: char(20)), VALUE._col1 (type: char(10)), VALUE._col2 (type: char(1)), VALUE._col3 (type: bigint), KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 5 Data size: 1840 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 5 Data size: 1840 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 717696 Data size: 11483144 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 717696 Data size: 11483144 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: _col2 BETWEEN 1L AND 5L (type: boolean)
                    Statistics: Num rows: 5 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col1 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col1 (type: bigint)
                      Statistics: Num rows: 5 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint), _col2 (type: bigint)

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query73
explain select c_last_name ,c_first_name ,c_salutation ,c_preferred_cust_flag ,ss_ticket_number ,cnt from (select ss_ticket_number ,ss_customer_sk ,count(*) cnt from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and date_dim.d_dom between 1 and 2 and (household_demographics.hd_buy_potential = &apos;&gt;10000&apos; or household_demographics.hd_buy_potential = &apos;5001-10000&apos;) and household_demographics.hd_vehicle_count &gt; 0 and case when household_demographics.hd_vehicle_count &gt; 0 then household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end &gt; 1 and date_dim.d_year in (2000,2000+1,2000+2) and store.s_county in (&apos;Lea County&apos;,&apos;Furnas County&apos;,&apos;Pennington County&apos;,&apos;Bronx County&apos;) group by ss_ticket_number,ss_customer_sk) dj,customer where ss_customer_sk = c_customer_sk and cnt between 1 and 5 order by cnt desc, c_last_name asc

</samplerData>
</sample>
<sample t="8465" lt="8458" ts="1600984949044" s="true" lb="query74" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="34170" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220220_99710570-c594-4027-abce-96077e364661:282
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE)
        Map 12 &lt;- Map 4 (BROADCAST_EDGE)
        Map 15 &lt;- Reducer 3 (BROADCAST_EDGE)
        Map 6 &lt;- Map 4 (BROADCAST_EDGE)
        Map 9 &lt;- Map 4 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 5 (CUSTOM_SIMPLE_EDGE), Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 11 &lt;- Reducer 10 (SIMPLE_EDGE)
        Reducer 13 &lt;- Map 12 (CUSTOM_SIMPLE_EDGE), Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 14 &lt;- Reducer 13 (SIMPLE_EDGE)
        Reducer 16 &lt;- Map 15 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 11 (BROADCAST_EDGE), Reducer 14 (BROADCAST_EDGE), Reducer 2 (SIMPLE_EDGE), Reducer 8 (BROADCAST_EDGE)
        Reducer 7 &lt;- Map 5 (CUSTOM_SIMPLE_EDGE), Map 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Reducer 7 (SIMPLE_EDGE)
      DagName: zabetak_20200924220220_99710570-c594-4027-abce-96077e364661:282
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 28800426268 Data size: 3530954377600 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_customer_sk (type: bigint), ss_net_paid (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 28800426268 Data size: 3530954377600 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col2 is not null and _col0 is not null) (type: boolean)
                      Statistics: Num rows: 27504208767 Data size: 3372037116520 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 5527878160 Data size: 514843773544 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 5527878160 Data size: 514843773544 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  Statistics: Num rows: 7199963324 Data size: 921379302080 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_bill_customer_sk (type: bigint), ws_net_paid (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7199963324 Data size: 921379302080 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col2 is not null and _col0 is not null) (type: boolean)
                      Statistics: Num rows: 7198165559 Data size: 921149242040 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 1446708849 Data size: 173389112368 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 1446708849 Data size: 173389112368 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 65000000 Data size: 23062000184 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: c_customer_id (type: string), c_first_name (type: char(20)), c_last_name (type: char(30))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 65000000 Data size: 23062000184 Basic stats: COMPLETE Column stats: PARTIAL
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: string)
                        1 _col0 (type: string)
                      outputColumnNames: _col0, _col2, _col3
                      input vertices:
                        0 Reducer 3
                      Statistics: Num rows: 7222220 Data size: 2628419432 Basic stats: COMPLETE Column stats: PARTIAL
                      Top N Key Operator
                        sort order: +++
                        keys: _col3 (type: char(30)), _col0 (type: string), _col2 (type: char(20))
                        null sort order: zzz
                        Statistics: Num rows: 7222220 Data size: 2628419432 Basic stats: COMPLETE Column stats: PARTIAL
                        top n: 100
                        Select Operator
                          expressions: _col0 (type: string), _col2 (type: char(20)), _col3 (type: char(30))
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 7222220 Data size: 2627950600 Basic stats: COMPLETE Column stats: PARTIAL
                          Reduce Output Operator
                            key expressions: _col2 (type: char(30)), _col0 (type: string), _col1 (type: char(20))
                            null sort order: zzz
                            sort order: +++
                            Statistics: Num rows: 7222220 Data size: 2627950600 Basic stats: COMPLETE Column stats: PARTIAL
                            TopN Hash Memory Usage: 0.04
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: d_date_sk (type: bigint), d_year (type: int)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: ((_col1 = 1999) and (_col1) IN (1998, 1999)) (type: boolean)
                      Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col0 (type: bigint)
                            minReductionHashAggr: 0.5013624
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Dynamic Partitioning Event Operator
                              Target column: ss_sold_date_sk (bigint)
                              Target Input: store_sales
                              Partition key expr: ss_sold_date_sk
                              Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                              Target Vertex: Map 1
                    Filter Operator
                      predicate: ((_col1 = 1998) and (_col1) IN (1998, 1999)) (type: boolean)
                      Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col0 (type: bigint)
                            minReductionHashAggr: 0.5013624
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Dynamic Partitioning Event Operator
                              Target column: ss_sold_date_sk (bigint)
                              Target Input: store_sales
                              Partition key expr: ss_sold_date_sk
                              Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                              Target Vertex: Map 6
                    Filter Operator
                      predicate: ((_col1 = 1999) and (_col1) IN (1998, 1999)) (type: boolean)
                      Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col0 (type: bigint)
                            minReductionHashAggr: 0.5013624
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Dynamic Partitioning Event Operator
                              Target column: ws_sold_date_sk (bigint)
                              Target Input: web_sales
                              Partition key expr: ws_sold_date_sk
                              Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                              Target Vertex: Map 9
                    Filter Operator
                      predicate: ((_col1 = 1998) and (_col1) IN (1998, 1999)) (type: boolean)
                      Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col0 (type: bigint)
                            minReductionHashAggr: 0.5013624
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Dynamic Partitioning Event Operator
                              Target column: ws_sold_date_sk (bigint)
                              Target Input: web_sales
                              Partition key expr: ws_sold_date_sk
                              Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                              Target Vertex: Map 12
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_customer_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 11882000184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 28800426268 Data size: 3530954377600 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_customer_sk (type: bigint), ss_net_paid (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 28800426268 Data size: 3530954377600 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col2 is not null and _col0 is not null) (type: boolean)
                      Statistics: Num rows: 27504208767 Data size: 3372037116520 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 5527878160 Data size: 514843773544 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 5527878160 Data size: 514843773544 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  Statistics: Num rows: 7199963324 Data size: 921379302080 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_bill_customer_sk (type: bigint), ws_net_paid (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7199963324 Data size: 921379302080 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col2 is not null and _col0 is not null) (type: boolean)
                      Statistics: Num rows: 7198165559 Data size: 921149242040 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 1446708849 Data size: 173389112368 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 1446708849 Data size: 173389112368 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col1, _col5
                input vertices:
                  1 Map 5
                Statistics: Num rows: 1446708849 Data size: 427426248496 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19213132320 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19213132320 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(17,2))
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3842626944 Basic stats: COMPLETE Column stats: PARTIAL
                Reduce Output Operator
                  key expressions: _col0 (type: string)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: string)
                  Statistics: Num rows: 13000001 Data size: 3842626944 Basic stats: COMPLETE Column stats: PARTIAL
                  value expressions: _col1 (type: decimal(17,2))
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col1, _col5
                input vertices:
                  1 Map 5
                Statistics: Num rows: 1446708849 Data size: 427426248496 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19213132320 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19213132320 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(17,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3842626944 Basic stats: COMPLETE Column stats: PARTIAL
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 4333333 Data size: 1280875512 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 4333333 Data size: 1280875512 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(17,2))
        Reducer 16 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: char(20)), KEY.reducesinkkey0 (type: char(30))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 7222220 Data size: 2627950600 Basic stats: COMPLETE Column stats: PARTIAL
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 36400 Basic stats: COMPLETE Column stats: PARTIAL
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 36400 Basic stats: COMPLETE Column stats: PARTIAL
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col1, _col5
                input vertices:
                  1 Map 5
                Statistics: Num rows: 5527878160 Data size: 1497055360184 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19232968624 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19232968624 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3846594168 Basic stats: COMPLETE Column stats: PARTIAL
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: string)
                    1 _col0 (type: string)
                  outputColumnNames: _col0, _col1, _col3
                  input vertices:
                    1 Reducer 8
                  Statistics: Num rows: 4333333 Data size: 1766593736 Basic stats: COMPLETE Column stats: PARTIAL
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: string)
                      1 _col0 (type: string)
                    outputColumnNames: _col0, _col1, _col3, _col5
                    input vertices:
                      1 Reducer 11
                    Statistics: Num rows: 4333333 Data size: 2251927032 Basic stats: COMPLETE Column stats: PARTIAL
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: string)
                        1 _col0 (type: string)
                      outputColumnNames: _col0, _col1, _col3, _col5, _col7
                      input vertices:
                        1 Reducer 14
                      Statistics: Num rows: 4333333 Data size: 2737260328 Basic stats: COMPLETE Column stats: PARTIAL
                      Filter Operator
                        predicate: ((_col5 / _col7) &gt; (_col1 / _col3)) (type: boolean)
                        Statistics: Num rows: 1444444 Data size: 912419960 Basic stats: COMPLETE Column stats: PARTIAL
                        Select Operator
                          expressions: _col0 (type: string)
                          outputColumnNames: _col0
                          Statistics: Num rows: 1444444 Data size: 265309048 Basic stats: COMPLETE Column stats: PARTIAL
                          Reduce Output Operator
                            key expressions: _col0 (type: string)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: string)
                            Statistics: Num rows: 1444444 Data size: 265309048 Basic stats: COMPLETE Column stats: PARTIAL
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col1, _col5
                input vertices:
                  1 Map 5
                Statistics: Num rows: 5527878160 Data size: 1497055360184 Basic stats: COMPLETE Column stats: PARTIAL
                DynamicPartitionHashJoin: true
                Group By Operator
                  aggregations: sum(_col1)
                  keys: _col5 (type: string)
                  minReductionHashAggr: 0.99
                  mode: hash
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 65000000 Data size: 19232968624 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 65000000 Data size: 19232968624 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(17,2))
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 13000001 Data size: 3846594168 Basic stats: COMPLETE Column stats: PARTIAL
                Filter Operator
                  predicate: (_col1 &gt; 0) (type: boolean)
                  Statistics: Num rows: 4333333 Data size: 1282197920 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: string)
                    Statistics: Num rows: 4333333 Data size: 1282197920 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col1 (type: decimal(17,2))

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query74
explain with year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,d_year as year ,sum(ss_net_paid) year_total ,&apos;s&apos; sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (1998,1998+1) group by c_customer_id ,c_first_name ,c_last_name ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,d_year as year ,sum(ws_net_paid) year_total ,&apos;w&apos; sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year in (1998,1998+1) group by c_customer_id ,c_first_name ,c_last_name ,d_year ) select t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = &apos;s&apos; and t_w_firstyear.sale_type = &apos;w&apos; and t_s_secyear.sale_type = &apos;s&apos; and t_w_secyear.sale_type = &apos;w&apos; and t_s_firstyear.year = 1998 and t_s_secyear.year = 1998+1 and t_w_firstyear.year = 1998 and t_w_secyear.year = 1998+1 and t_s_firstyear.year_total &gt; 0 and t_w_firstyear.year_total &gt; 0 and case when t_w_firstyear.year_total &gt; 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end &gt; case when t_s_firstyear.year_total &gt; 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end order by 3,1,2 limit 100

</samplerData>
</sample>
<sample t="18405" lt="18394" ts="1600984967451" s="true" lb="query75" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="79362" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220229_d93f82b4-db5e-4c07-97dd-d12173e43931:283
      Edges:
        Map 1 &lt;- Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE)
        Map 12 &lt;- Reducer 9 (BROADCAST_EDGE)
        Map 13 &lt;- Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE)
        Map 16 &lt;- Reducer 15 (BROADCAST_EDGE)
        Map 17 &lt;- Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE)
        Map 20 &lt;- Reducer 19 (BROADCAST_EDGE)
        Map 21 &lt;- Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE)
        Map 28 &lt;- Reducer 27 (BROADCAST_EDGE)
        Map 29 &lt;- Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE)
        Map 32 &lt;- Reducer 31 (BROADCAST_EDGE)
        Map 33 &lt;- Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE)
        Map 36 &lt;- Reducer 35 (BROADCAST_EDGE)
        Reducer 14 &lt;- Map 13 (CUSTOM_SIMPLE_EDGE), Map 16 (CUSTOM_SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 15 &lt;- Map 13 (CUSTOM_SIMPLE_EDGE)
        Reducer 18 &lt;- Map 17 (CUSTOM_SIMPLE_EDGE), Map 20 (CUSTOM_SIMPLE_EDGE), Union 5 (CONTAINS)
        Reducer 19 &lt;- Map 17 (CUSTOM_SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 12 (CUSTOM_SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 22 &lt;- Map 21 (CUSTOM_SIMPLE_EDGE), Map 28 (CUSTOM_SIMPLE_EDGE), Union 23 (CONTAINS)
        Reducer 24 &lt;- Union 23 (SIMPLE_EDGE), Union 25 (CONTAINS)
        Reducer 26 &lt;- Union 25 (SIMPLE_EDGE)
        Reducer 27 &lt;- Map 21 (CUSTOM_SIMPLE_EDGE)
        Reducer 30 &lt;- Map 29 (CUSTOM_SIMPLE_EDGE), Map 32 (CUSTOM_SIMPLE_EDGE), Union 23 (CONTAINS)
        Reducer 31 &lt;- Map 29 (CUSTOM_SIMPLE_EDGE)
        Reducer 34 &lt;- Map 33 (CUSTOM_SIMPLE_EDGE), Map 36 (CUSTOM_SIMPLE_EDGE), Union 25 (CONTAINS)
        Reducer 35 &lt;- Map 33 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE), Union 5 (CONTAINS)
        Reducer 6 &lt;- Union 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 26 (CUSTOM_SIMPLE_EDGE), Reducer 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Reducer 7 (SIMPLE_EDGE)
        Reducer 9 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220229_d93f82b4-db5e-4c07-97dd-d12173e43931:283
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_454_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:2.2731787157288277E-7
                  Statistics: Num rows: 14327953968 Data size: 2001740096912 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_item_sk (type: bigint), cs_order_number (type: bigint), cs_quantity (type: int), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 14327953968 Data size: 2001740096912 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col4 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 2859318617 Data size: 373256598836 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col9, _col10
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 257352896 Data size: 33914768580 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 257352896 Data size: 33914768580 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 257352896 Data size: 2058823168 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) or (d_year = 2001)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 17
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 21
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 29
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 33
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_category = &apos;Sports                                            &apos;) and i_category_id is not null and i_brand_id is not null and i_manufact_id is not null and i_class_id is not null) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 45812048 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_category = &apos;Sports                                            &apos;) and i_category_id is not null and i_brand_id is not null and i_manufact_id is not null and i_class_id is not null) (type: boolean)
                    Statistics: Num rows: 36182 Data size: 4123328 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand_id (type: int), i_class_id (type: int), i_category_id (type: int), i_manufact_id (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 36182 Data size: 866948 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 36182 Data size: 866948 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 36182 Data size: 866948 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 36182 Data size: 866948 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 36182 Data size: 866948 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 36182 Data size: 866948 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 36182 Data size: 866948 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: (cr_item_sk BETWEEN DynamicValue(RS_17_catalog_sales_cs_item_sk_min) AND DynamicValue(RS_17_catalog_sales_cs_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_17_catalog_sales_cs_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_item_sk BETWEEN DynamicValue(RS_17_catalog_sales_cs_item_sk_min) AND DynamicValue(RS_17_catalog_sales_cs_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_17_catalog_sales_cs_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_457_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.1841963149792871E-7
                  Statistics: Num rows: 27503885621 Data size: 3775359215248 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 27503885621 Data size: 3775359215248 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col4 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 5527813214 Data size: 654486572556 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col9, _col10
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 497530680 Data size: 15920980456 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 497530680 Data size: 15920980456 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 497530680 Data size: 7960490880 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: (sr_ticket_number BETWEEN DynamicValue(RS_38_store_sales_ss_ticket_number_min) AND DynamicValue(RS_38_store_sales_ss_ticket_number_max) and in_bloom_filter(sr_ticket_number, DynamicValue(RS_38_store_sales_ss_ticket_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (sr_ticket_number BETWEEN DynamicValue(RS_38_store_sales_ss_ticket_number_min) AND DynamicValue(RS_38_store_sales_ss_ticket_number_max) and in_bloom_filter(sr_ticket_number, DynamicValue(RS_38_store_sales_ss_ticket_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 17 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_460_container, bigKeyColName:ws_item_sk, smallTablePos:1, keyRatio:4.524765755290659E-7
                  Statistics: Num rows: 7198162681 Data size: 1007638330100 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_item_sk (type: bigint), ws_order_number (type: bigint), ws_quantity (type: int), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 7198162681 Data size: 1007638330100 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col4 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 1446708270 Data size: 190861046400 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col9, _col10
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 130210939 Data size: 19166772312 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 130210939 Data size: 19166772312 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 130210939 Data size: 2083375024 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  filterExpr: (wr_order_number BETWEEN DynamicValue(RS_66_web_sales_ws_order_number_min) AND DynamicValue(RS_66_web_sales_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_66_web_sales_ws_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (wr_order_number BETWEEN DynamicValue(RS_66_web_sales_ws_order_number_min) AND DynamicValue(RS_66_web_sales_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_66_web_sales_ws_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_item_sk (type: bigint), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 21 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_463_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:2.2731787157288277E-7
                  Statistics: Num rows: 14327953968 Data size: 2001740096912 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_item_sk (type: bigint), cs_order_number (type: bigint), cs_quantity (type: int), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 14327953968 Data size: 2001740096912 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col4 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 2859318617 Data size: 373256598836 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col9, _col10
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 257352896 Data size: 33914768580 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 257352896 Data size: 33914768580 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 257352896 Data size: 2058823168 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 28 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: (cr_item_sk BETWEEN DynamicValue(RS_99_catalog_sales_cs_item_sk_min) AND DynamicValue(RS_99_catalog_sales_cs_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_99_catalog_sales_cs_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_item_sk BETWEEN DynamicValue(RS_99_catalog_sales_cs_item_sk_min) AND DynamicValue(RS_99_catalog_sales_cs_item_sk_max) and in_bloom_filter(cr_item_sk, DynamicValue(RS_99_catalog_sales_cs_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint), cr_return_quantity (type: int), cr_return_amount (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 1440033112 Data size: 186744701244 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 29 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_466_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:1.1841963149792871E-7
                  Statistics: Num rows: 27503885621 Data size: 3775359215248 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 27503885621 Data size: 3775359215248 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col4 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 5527813214 Data size: 654486572556 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col9, _col10
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 497530680 Data size: 15920980456 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 497530680 Data size: 15920980456 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 497530680 Data size: 7960490880 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 32 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: (sr_ticket_number BETWEEN DynamicValue(RS_120_store_sales_ss_ticket_number_min) AND DynamicValue(RS_120_store_sales_ss_ticket_number_max) and in_bloom_filter(sr_ticket_number, DynamicValue(RS_120_store_sales_ss_ticket_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (sr_ticket_number BETWEEN DynamicValue(RS_120_store_sales_ss_ticket_number_min) AND DynamicValue(RS_120_store_sales_ss_ticket_number_max) and in_bloom_filter(sr_ticket_number, DynamicValue(RS_120_store_sales_ss_ticket_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint), sr_return_quantity (type: int), sr_return_amt (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 2879513368 Data size: 368409547108 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 33 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_469_container, bigKeyColName:ws_item_sk, smallTablePos:1, keyRatio:4.524765755290659E-7
                  Statistics: Num rows: 7198162681 Data size: 1007638330100 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_item_sk (type: bigint), ws_order_number (type: bigint), ws_quantity (type: int), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 7198162681 Data size: 1007638330100 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col4 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      input vertices:
                        1 Map 10
                      Statistics: Num rows: 1446708270 Data size: 190861046400 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col7, _col8, _col9, _col10
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 130210939 Data size: 19166772312 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 130210939 Data size: 19166772312 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: int), _col3 (type: decimal(7,2)), _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int)
                        Select Operator
                          expressions: _col1 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 130210939 Data size: 2083375024 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 36 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  filterExpr: (wr_order_number BETWEEN DynamicValue(RS_148_web_sales_ws_order_number_min) AND DynamicValue(RS_148_web_sales_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_148_web_sales_ws_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (wr_order_number BETWEEN DynamicValue(RS_148_web_sales_ws_order_number_min) AND DynamicValue(RS_148_web_sales_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_148_web_sales_ws_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_item_sk (type: bigint), wr_order_number (type: bigint), wr_return_quantity (type: int), wr_return_amt (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col1 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                        Statistics: Num rows: 720020485 Data size: 91284724852 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: int), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10, _col13, _col14
                input vertices:
                  1 Map 16
                Statistics: Num rows: 15319917270 Data size: 3672226146428 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int), (_col2 - CASE WHEN (_col13 is not null) THEN (_col13) ELSE (0) END) (type: int), (_col3 - CASE WHEN (_col14 is not null) THEN (_col14) ELSE (0) END) (type: decimal(8,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 15319917270 Data size: 2022229078220 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                    minReductionHashAggr: 0.9326458
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      null sort order: aaaaaa
                      sort order: ++++++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 18 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10, _col13, _col14
                input vertices:
                  1 Map 20
                Statistics: Num rows: 3083986123 Data size: 745861663752 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int), (_col2 - CASE WHEN (_col13 is not null) THEN (_col13) ELSE (0) END) (type: int), (_col3 - CASE WHEN (_col14 is not null) THEN (_col14) ELSE (0) END) (type: decimal(8,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 3083986123 Data size: 407086166816 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                    minReductionHashAggr: 0.9074643
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      null sort order: aaaaaa
                      sort order: ++++++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 19 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10, _col13, _col14
                input vertices:
                  1 Map 12
                Statistics: Num rows: 313790933022 Data size: 77782785323952 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int), (_col2 - CASE WHEN (_col13 is not null) THEN (_col13) ELSE (0) END) (type: int), (_col3 - CASE WHEN (_col14 is not null) THEN (_col14) ELSE (0) END) (type: decimal(8,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 313790933022 Data size: 41420403157484 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                    minReductionHashAggr: 0.9326458
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      null sort order: aaaaaa
                      sort order: ++++++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 22 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10, _col13, _col14
                input vertices:
                  1 Map 28
                Statistics: Num rows: 313790933022 Data size: 77782785323952 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int), (_col2 - CASE WHEN (_col13 is not null) THEN (_col13) ELSE (0) END) (type: int), (_col3 - CASE WHEN (_col14 is not null) THEN (_col14) ELSE (0) END) (type: decimal(8,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 313790933022 Data size: 41420403157484 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                    minReductionHashAggr: 0.9326458
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      null sort order: aaaaaa
                      sort order: ++++++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 24 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: decimal(8,2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                  minReductionHashAggr: 0.9074643
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                    null sort order: aaaaaa
                    sort order: ++++++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 26 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: decimal(8,2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col4), sum(_col5)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  mode: complete
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 177920028 Data size: 24197123808 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    null sort order: aaaa
                    sort order: ++++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    Statistics: Num rows: 177920028 Data size: 24197123808 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col4 (type: bigint), _col5 (type: decimal(18,2))
        Reducer 27 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 30 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10, _col13, _col14
                input vertices:
                  1 Map 32
                Statistics: Num rows: 15319917270 Data size: 3672226146428 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int), (_col2 - CASE WHEN (_col13 is not null) THEN (_col13) ELSE (0) END) (type: int), (_col3 - CASE WHEN (_col14 is not null) THEN (_col14) ELSE (0) END) (type: decimal(8,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 15319917270 Data size: 2022229078220 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                    minReductionHashAggr: 0.9326458
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      null sort order: aaaaaa
                      sort order: ++++++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 31 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 34 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col2, _col3, _col7, _col8, _col9, _col10, _col13, _col14
                input vertices:
                  1 Map 36
                Statistics: Num rows: 3083986123 Data size: 745861663752 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col7 (type: int), _col8 (type: int), _col9 (type: int), _col10 (type: int), (_col2 - CASE WHEN (_col13 is not null) THEN (_col13) ELSE (0) END) (type: int), (_col3 - CASE WHEN (_col14 is not null) THEN (_col14) ELSE (0) END) (type: decimal(8,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 3083986123 Data size: 407086166816 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                    minReductionHashAggr: 0.9074643
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                      null sort order: aaaaaa
                      sort order: ++++++
                      Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                      Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 35 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: decimal(8,2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 329110850292 Data size: 43442632234252 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                  minReductionHashAggr: 0.9074643
                  mode: hash
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: int), _col5 (type: decimal(8,2))
                    null sort order: aaaaaa
                    sort order: ++++++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: int), KEY._col1 (type: int), KEY._col2 (type: int), KEY._col3 (type: int), KEY._col4 (type: int), KEY._col5 (type: decimal(8,2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 332194836415 Data size: 43849718396744 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: sum(_col4), sum(_col5)
                  keys: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                  mode: complete
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 177920028 Data size: 24197123808 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    null sort order: aaaa
                    sort order: ++++
                    Map-reduce partition columns: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int)
                    Statistics: Num rows: 177920028 Data size: 24197123808 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col4 (type: bigint), _col5 (type: decimal(18,2))
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: int), KEY.reducesinkkey3 (type: int)
                  1 KEY.reducesinkkey0 (type: int), KEY.reducesinkkey1 (type: int), KEY.reducesinkkey2 (type: int), KEY.reducesinkkey3 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col10, _col11
                input vertices:
                  1 Reducer 26
                Statistics: Num rows: 32072478585127 Data size: 8210554517792512 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: ((CAST( _col10 AS decimal(17,2)) / CAST( _col4 AS decimal(17,2))) &lt; 0.9) (type: boolean)
                  Statistics: Num rows: 10690826195042 Data size: 2736851505930752 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: ++
                    keys: (_col10 - _col4) (type: bigint), (_col11 - _col5) (type: decimal(19,2))
                    null sort order: zz
                    Statistics: Num rows: 10690826195042 Data size: 2736851505930752 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint), _col10 (type: bigint), (_col10 - _col4) (type: bigint), (_col11 - _col5) (type: decimal(19,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 10690826195042 Data size: 1625005581646384 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col6 (type: bigint), _col7 (type: decimal(19,2))
                        null sort order: zz
                        sort order: ++
                        Statistics: Num rows: 10690826195042 Data size: 1625005581646384 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint), _col5 (type: bigint)
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: int), VALUE._col1 (type: int), VALUE._col2 (type: int), VALUE._col3 (type: int), VALUE._col4 (type: bigint), VALUE._col5 (type: bigint), KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: decimal(19,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 10690826195042 Data size: 1625005581646384 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 15200 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: 2000 (type: int), 2001 (type: int), _col0 (type: int), _col1 (type: int), _col2 (type: int), _col3 (type: int), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: decimal(19,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                    Statistics: Num rows: 100 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
                    File Output Operator
                      compressed: false
                      Statistics: Num rows: 100 Data size: 16000 Basic stats: COMPLETE Column stats: COMPLETE
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Union 23 
            Vertex: Union 23
        Union 25 
            Vertex: Union 25
        Union 3 
            Vertex: Union 3
        Union 5 
            Vertex: Union 5

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query75
explain WITH all_sales AS ( SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,SUM(sales_cnt) AS sales_cnt ,SUM(sales_amt) AS sales_amt FROM (SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk JOIN date_dim ON d_date_sk=cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number AND cs_item_sk=cr_item_sk) WHERE i_category=&apos;Sports&apos; UNION SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk=ss_item_sk JOIN date_dim ON d_date_sk=ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number AND ss_item_sk=sr_item_sk) WHERE i_category=&apos;Sports&apos; UNION SELECT d_year ,i_brand_id ,i_class_id ,i_category_id ,i_manufact_id ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk=ws_item_sk JOIN date_dim ON d_date_sk=ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number=wr_order_number AND ws_item_sk=wr_item_sk) WHERE i_category=&apos;Sports&apos;) sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id) SELECT  prev_yr.d_year AS prev_year ,curr_yr.d_year AS year ,curr_yr.i_brand_id ,curr_yr.i_class_id ,curr_yr.i_category_id ,curr_yr.i_manufact_id ,prev_yr.sales_cnt AS prev_yr_cnt ,curr_yr.sales_cnt AS curr_yr_cnt ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff FROM all_sales curr_yr, all_sales prev_yr WHERE curr_yr.i_brand_id=prev_yr.i_brand_id AND curr_yr.i_class_id=prev_yr.i_class_id AND curr_yr.i_category_id=prev_yr.i_category_id AND curr_yr.i_manufact_id=prev_yr.i_manufact_id AND curr_yr.d_year=2001 AND prev_yr.d_year=2001-1 AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))&lt;0.9 ORDER BY sales_cnt_diff,sales_amt_diff limit 100

</samplerData>
</sample>
<sample t="6856" lt="6849" ts="1600984974310" s="true" lb="query76" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="25701" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220247_b712e9bf-6024-450d-8074-21eadc81191a:284
      Edges:
        Map 10 &lt;- Map 11 (BROADCAST_EDGE), Map 12 (BROADCAST_EDGE), Union 3 (CONTAINS)
        Map 2 &lt;- Map 1 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Union 3 (CONTAINS)
        Map 8 &lt;- Map 7 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE), Union 3 (CONTAINS)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924220247_b712e9bf-6024-450d-8074-21eadc81191a:284
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: d_date_sk (type: bigint), d_year (type: int), d_qoy (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int), _col2 (type: int)
                    Select Operator
                      expressions: _col0 (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.50000685
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                        Dynamic Partitioning Event Operator
                          Target column: ss_sold_date_sk (bigint)
                          Target Input: store_sales
                          Partition key expr: ss_sold_date_sk
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Target Vertex: Map 2
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_ship_mode_sk is null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_127_container, bigKeyColName:cs_item_sk, smallTablePos:1, keyRatio:0.002511733362654254
                  Statistics: Num rows: 14327953968 Data size: 1944284338968 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_ship_mode_sk is null (type: boolean)
                    Statistics: Num rows: 35988000 Data size: 4883523992 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_item_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 35988000 Data size: 4596343120 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col4, _col5
                        input vertices:
                          1 Map 11
                        Statistics: Num rows: 35988000 Data size: 4596343120 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col4, _col5, _col7
                          input vertices:
                            1 Map 12
                          Statistics: Num rows: 35988000 Data size: 7547359120 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: &apos;catalog&apos; (type: string), &apos;cs_ship_mode_sk&apos; (type: string), _col4 (type: int), _col5 (type: int), _col7 (type: char(50)), _col1 (type: decimal(7,2))
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                            Statistics: Num rows: 35988000 Data size: 14385079120 Basic stats: COMPLETE Column stats: COMPLETE
                            Top N Key Operator
                              sort order: +++++
                              keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                              null sort order: zzzzz
                              Statistics: Num rows: 685026422 Data size: 270341755029 Basic stats: COMPLETE Column stats: COMPLETE
                              top n: 100
                              Group By Operator
                                aggregations: count(), sum(_col5)
                                keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                                Statistics: Num rows: 9255092 Data size: 3776077536 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                  null sort order: zzzzz
                                  sort order: +++++
                                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                  Statistics: Num rows: 9255092 Data size: 3776077536 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col5 (type: bigint), _col6 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: d_date_sk (type: bigint), d_year (type: int), d_qoy (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int), _col2 (type: int)
                    Select Operator
                      expressions: _col0 (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.50000685
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                        Dynamic Partitioning Event Operator
                          Target column: cs_sold_date_sk (bigint)
                          Target Input: catalog_sales
                          Partition key expr: cs_sold_date_sk
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Target Vertex: Map 10
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_category (type: char(50))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_125_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:0.02356537944969954
                  Statistics: Num rows: 27503885621 Data size: 3662750971752 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is null (type: boolean)
                    Statistics: Num rows: 648139501 Data size: 86314116648 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 648139501 Data size: 81251189856 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col2 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col4
                        input vertices:
                          0 Map 1
                        Statistics: Num rows: 648139501 Data size: 81251189856 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col4, _col7
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 648139501 Data size: 134398628938 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: &apos;store&apos; (type: string), &apos;ss_customer_sk&apos; (type: string), _col1 (type: int), _col2 (type: int), _col7 (type: char(50)), _col4 (type: decimal(7,2))
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                            Statistics: Num rows: 648139501 Data size: 255600715625 Basic stats: COMPLETE Column stats: COMPLETE
                            Top N Key Operator
                              sort order: +++++
                              keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                              null sort order: zzzzz
                              Statistics: Num rows: 685026422 Data size: 270341755029 Basic stats: COMPLETE Column stats: COMPLETE
                              top n: 100
                              Group By Operator
                                aggregations: count(), sum(_col5)
                                keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                                Statistics: Num rows: 9255092 Data size: 3776077536 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                  null sort order: zzzzz
                                  sort order: +++++
                                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                  Statistics: Num rows: 9255092 Data size: 3776077536 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col5 (type: bigint), _col6 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_category (type: char(50))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: d_date_sk (type: bigint), d_year (type: int), d_qoy (type: int)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: int), _col2 (type: int)
                    Select Operator
                      expressions: _col0 (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 73049 Data size: 584392 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.50000685
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                        Dynamic Partitioning Event Operator
                          Target column: ws_sold_date_sk (bigint)
                          Target Input: web_sales
                          Partition key expr: ws_sold_date_sk
                          Statistics: Num rows: 36524 Data size: 292192 Basic stats: COMPLETE Column stats: COMPLETE
                          Target Vertex: Map 8
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_ship_addr_sk is null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_126_container, bigKeyColName:ws_item_sk, smallTablePos:1, keyRatio:1.248820066782817E-4
                  Statistics: Num rows: 7198162681 Data size: 978842077368 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_ship_addr_sk is null (type: boolean)
                    Statistics: Num rows: 898921 Data size: 122239936 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 898921 Data size: 115049456 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col2 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col4
                        input vertices:
                          0 Map 7
                        Statistics: Num rows: 898921 Data size: 115049456 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col4, _col7
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 898921 Data size: 188760978 Basic stats: COMPLETE Column stats: COMPLETE
                          Select Operator
                            expressions: &apos;web&apos; (type: string), &apos;ws_ship_addr_sk&apos; (type: string), _col1 (type: int), _col2 (type: int), _col7 (type: char(50)), _col4 (type: decimal(7,2))
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                            Statistics: Num rows: 898921 Data size: 355960284 Basic stats: COMPLETE Column stats: COMPLETE
                            Top N Key Operator
                              sort order: +++++
                              keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                              null sort order: zzzzz
                              Statistics: Num rows: 685026422 Data size: 270341755029 Basic stats: COMPLETE Column stats: COMPLETE
                              top n: 100
                              Group By Operator
                                aggregations: count(), sum(_col5)
                                keys: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                                Statistics: Num rows: 9255092 Data size: 3776077536 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                  null sort order: zzzzz
                                  sort order: +++++
                                  Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                                  Statistics: Num rows: 9255092 Data size: 3776077536 Basic stats: COMPLETE Column stats: COMPLETE
                                  TopN Hash Memory Usage: 0.04
                                  value expressions: _col5 (type: bigint), _col6 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_category (type: char(50))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 39396000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: int), KEY._col3 (type: int), KEY._col4 (type: char(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 8756 Data size: 3572448 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: int), _col3 (type: int), _col4 (type: char(50))
                  null sort order: zzzzz
                  sort order: +++++
                  Statistics: Num rows: 8756 Data size: 3572448 Basic stats: COMPLETE Column stats: COMPLETE
                  TopN Hash Memory Usage: 0.04
                  value expressions: _col5 (type: bigint), _col6 (type: decimal(17,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), KEY.reducesinkkey2 (type: int), KEY.reducesinkkey3 (type: int), KEY.reducesinkkey4 (type: char(50)), VALUE._col0 (type: bigint), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 8756 Data size: 3572448 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 40800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 40800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 3 
            Vertex: Union 3

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query76
explain select  channel, col_name, d_year, d_qoy, i_category, COUNT(*) sales_cnt, SUM(ext_sales_price) sales_amt FROM ( SELECT &apos;store&apos; as channel, &apos;ss_customer_sk&apos; col_name, d_year, d_qoy, i_category, ss_ext_sales_price ext_sales_price FROM store_sales, item, date_dim WHERE ss_customer_sk IS NULL AND ss_sold_date_sk=d_date_sk AND ss_item_sk=i_item_sk UNION ALL SELECT &apos;web&apos; as channel, &apos;ws_ship_addr_sk&apos; col_name, d_year, d_qoy, i_category, ws_ext_sales_price ext_sales_price FROM web_sales, item, date_dim WHERE ws_ship_addr_sk IS NULL AND ws_sold_date_sk=d_date_sk AND ws_item_sk=i_item_sk UNION ALL SELECT &apos;catalog&apos; as channel, &apos;cs_ship_mode_sk&apos; col_name, d_year, d_qoy, i_category, cs_ext_sales_price ext_sales_price FROM catalog_sales, item, date_dim WHERE cs_ship_mode_sk IS NULL AND cs_sold_date_sk=d_date_sk AND cs_item_sk=i_item_sk) foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category limit 100

</samplerData>
</sample>
<sample t="14498" lt="14486" ts="1600984988811" s="true" lb="query77" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="39081" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220254_afc8c8c9-5337-49c9-b8c1-50af682745ec:285
      Edges:
        Map 1 &lt;- Map 6 (BROADCAST_EDGE)
        Map 12 &lt;- Map 6 (BROADCAST_EDGE)
        Map 14 &lt;- Map 6 (BROADCAST_EDGE)
        Map 16 &lt;- Map 6 (BROADCAST_EDGE)
        Map 7 &lt;- Map 6 (BROADCAST_EDGE)
        Map 9 &lt;- Map 6 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (SIMPLE_EDGE)
        Reducer 11 &lt;- Reducer 10 (XPROD_EDGE), Reducer 13 (XPROD_EDGE), Union 3 (CONTAINS)
        Reducer 13 &lt;- Map 12 (SIMPLE_EDGE)
        Reducer 15 &lt;- Map 14 (SIMPLE_EDGE)
        Reducer 17 &lt;- Map 16 (SIMPLE_EDGE), Reducer 15 (BROADCAST_EDGE), Union 3 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Reducer 8 (BROADCAST_EDGE), Union 3 (CONTAINS)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
        Reducer 8 &lt;- Map 7 (SIMPLE_EDGE)
      DagName: zabetak_20200924220254_afc8c8c9-5337-49c9-b8c1-50af682745ec:285
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 6450573244720 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 6298666168912 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_store_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26856185846 Data size: 6298666168912 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 2983816376 Data size: 545426965104 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), sum(_col2)
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 183266 Data size: 42206960 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 183266 Data size: 42206960 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 3434391571752 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_call_center_sk (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_net_profit (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 14327953968 Data size: 3434391571752 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 1591885904 Data size: 365000149160 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col1), sum(_col2)
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 5704 Data size: 1322304 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 5704 Data size: 1322304 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  filterExpr: wr_web_page_sk is not null (type: boolean)
                  Statistics: Num rows: 687618864 Data size: 161271339144 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: wr_web_page_sk is not null (type: boolean)
                    Statistics: Num rows: 671424162 Data size: 157473099504 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_web_page_sk (type: bigint), wr_return_amt (type: decimal(7,2)), wr_net_loss (type: decimal(7,2)), wr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 671424162 Data size: 157473099504 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 74597578 Data size: 13637938720 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), sum(_col2)
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 16200 Data size: 3730936 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 16200 Data size: 3730936 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_web_page_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 1727450989656 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_web_page_sk is not null (type: boolean)
                    Statistics: Num rows: 7197262943 Data size: 1727235066088 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_web_page_sk (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_net_profit (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 7197262943 Data size: 1727235066088 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 799641139 Data size: 185408704016 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), sum(_col2)
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 166750 Data size: 38684504 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 166750 Data size: 38684504 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2000-08-16 00:00:00&apos; AND TIMESTAMP&apos;2000-09-15 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2000-08-16 00:00:00&apos; AND TIMESTAMP&apos;2000-09-15 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: sr_returned_date_sk (bigint)
                            Target Input: store_returns
                            Partition key expr: sr_returned_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 7
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cr_returned_date_sk (bigint)
                            Target Input: catalog_returns
                            Partition key expr: cr_returned_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 9
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 12
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: wr_returned_date_sk (bigint)
                            Target Input: web_returns
                            Partition key expr: wr_returned_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 14
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 16
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: sr_store_sk is not null (type: boolean)
                  Statistics: Num rows: 2778787720 Data size: 655225947872 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: sr_store_sk is not null (type: boolean)
                    Statistics: Num rows: 2728337839 Data size: 643330087408 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_store_sk (type: bigint), sr_return_amt (type: decimal(7,2)), sr_net_loss (type: decimal(7,2)), sr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2728337839 Data size: 643330087408 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 303127897 Data size: 58854678152 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), sum(_col2)
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 19780 Data size: 4563112 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 19780 Data size: 4563112 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: cr_returned_date_sk is not null (type: boolean)
                  Statistics: Num rows: 1440033112 Data size: 338925516264 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cr_call_center_sk (type: bigint), cr_return_amount (type: decimal(7,2)), cr_net_loss (type: decimal(7,2)), cr_returned_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1440033112 Data size: 338925516264 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      input vertices:
                        1 Map 6
                      Statistics: Num rows: 159992726 Data size: 30435881816 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col1), sum(_col2)
                        keys: _col0 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2
                        Statistics: Num rows: 714 Data size: 164624 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 714 Data size: 164624 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 6 Data size: 1392 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 6 Data size: 1344 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 6 Data size: 1344 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: decimal(17,2)), _col1 (type: decimal(17,2))
        Reducer 11 
            Execution mode: llap
            Reduce Operator Tree:
              Merge Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 
                  1 
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 24 Data size: 10944 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: &apos;catalog channel&apos; (type: string), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col0 (type: decimal(17,2)), (_col4 - _col1) (type: decimal(18,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 24 Data size: 10632 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: string), _col1 (type: bigint)
                    null sort order: zz
                    Statistics: Num rows: 571 Data size: 250803 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: string), _col1 (type: bigint), 0L (type: bigint)
                      minReductionHashAggr: 0.5971979
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 690 Data size: 310502 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: bigint), _col2 (type: bigint)
                        null sort order: zza
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: bigint), _col2 (type: bigint)
                        Statistics: Num rows: 690 Data size: 310502 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 4 Data size: 928 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 4 Data size: 928 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 300 Data size: 69096 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 300 Data size: 69096 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
        Reducer 17 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 230 Data size: 53360 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Right Outer Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5
                  input vertices:
                    0 Reducer 15
                  Statistics: Num rows: 460 Data size: 158464 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: &apos;web channel&apos; (type: string), _col3 (type: bigint), _col4 (type: decimal(17,2)), CASE WHEN (_col1 is not null) THEN (_col1) ELSE (0) END (type: decimal(17,2)), (_col5 - CASE WHEN (_col2 is not null) THEN (_col2) ELSE (0) END) (type: decimal(18,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 460 Data size: 201940 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++
                      keys: _col0 (type: string), _col1 (type: bigint)
                      null sort order: zz
                      Statistics: Num rows: 571 Data size: 250803 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Group By Operator
                        aggregations: sum(_col2), sum(_col3), sum(_col4)
                        keys: _col0 (type: string), _col1 (type: bigint), 0L (type: bigint)
                        minReductionHashAggr: 0.5971979
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 690 Data size: 310502 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: bigint), _col2 (type: bigint)
                          null sort order: zza
                          sort order: +++
                          Map-reduce partition columns: _col0 (type: string), _col1 (type: bigint), _col2 (type: bigint)
                          Statistics: Num rows: 690 Data size: 310502 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
                          value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 86 Data size: 19816 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Left Outer Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col4, _col5
                  input vertices:
                    1 Reducer 8
                  Statistics: Num rows: 87 Data size: 39536 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: &apos;store channel&apos; (type: string), _col0 (type: bigint), _col1 (type: decimal(17,2)), CASE WHEN (_col4 is not null) THEN (_col4) ELSE (0) END (type: decimal(17,2)), (_col2 - CASE WHEN (_col5 is not null) THEN (_col5) ELSE (0) END) (type: decimal(18,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 87 Data size: 38231 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++
                      keys: _col0 (type: string), _col1 (type: bigint)
                      null sort order: zz
                      Statistics: Num rows: 571 Data size: 250803 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Group By Operator
                        aggregations: sum(_col2), sum(_col3), sum(_col4)
                        keys: _col0 (type: string), _col1 (type: bigint), 0L (type: bigint)
                        minReductionHashAggr: 0.5971979
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                        Statistics: Num rows: 690 Data size: 310502 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: string), _col1 (type: bigint), _col2 (type: bigint)
                          null sort order: zza
                          sort order: +++
                          Map-reduce partition columns: _col0 (type: string), _col1 (type: bigint), _col2 (type: bigint)
                          Statistics: Num rows: 690 Data size: 310502 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
                          value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string), KEY._col1 (type: bigint), KEY._col2 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col3, _col4, _col5
                Statistics: Num rows: 690 Data size: 310502 Basic stats: COMPLETE Column stats: COMPLETE
                pruneGroupingSetId: true
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: bigint), _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 690 Data size: 304982 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: bigint)
                    null sort order: zz
                    sort order: ++
                    Statistics: Num rows: 690 Data size: 304982 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col2 (type: decimal(27,2)), _col3 (type: decimal(27,2)), _col4 (type: decimal(28,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: bigint), VALUE._col0 (type: decimal(27,2)), VALUE._col1 (type: decimal(27,2)), VALUE._col2 (type: decimal(28,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 690 Data size: 304982 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 44204 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 44204 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 86 Data size: 19848 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col0 (type: bigint)
                  Statistics: Num rows: 86 Data size: 19848 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
        Union 3 
            Vertex: Union 3

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query77
explain with ss as (select s_store_sk, sum(ss_ext_sales_price) as sales, sum(ss_net_profit) as profit from store_sales, date_dim, store where ss_sold_date_sk = d_date_sk and d_date between cast(&apos;2000-08-16&apos; as date) and (cast(&apos;2000-08-16&apos; as date) +  30 days) and ss_store_sk = s_store_sk group by s_store_sk) , sr as (select s_store_sk, sum(sr_return_amt) as returns, sum(sr_net_loss) as profit_loss from store_returns, date_dim, store where sr_returned_date_sk = d_date_sk and d_date between cast(&apos;2000-08-16&apos; as date) and (cast(&apos;2000-08-16&apos; as date) +  30 days) and sr_store_sk = s_store_sk group by s_store_sk), cs as (select cs_call_center_sk, sum(cs_ext_sales_price) as sales, sum(cs_net_profit) as profit from catalog_sales, date_dim where cs_sold_date_sk = d_date_sk and d_date between cast(&apos;2000-08-16&apos; as date) and (cast(&apos;2000-08-16&apos; as date) +  30 days) group by cs_call_center_sk ), cr as (select cr_call_center_sk, sum(cr_return_amount) as returns, sum(cr_net_loss) as profit_loss from catalog_returns, date_dim where cr_returned_date_sk = d_date_sk and d_date between cast(&apos;2000-08-16&apos; as date) and (cast(&apos;2000-08-16&apos; as date) +  30 days) group by cr_call_center_sk ), ws as ( select wp_web_page_sk, sum(ws_ext_sales_price) as sales, sum(ws_net_profit) as profit from web_sales, date_dim, web_page where ws_sold_date_sk = d_date_sk and d_date between cast(&apos;2000-08-16&apos; as date) and (cast(&apos;2000-08-16&apos; as date) +  30 days) and ws_web_page_sk = wp_web_page_sk group by wp_web_page_sk), wr as (select wp_web_page_sk, sum(wr_return_amt) as returns, sum(wr_net_loss) as profit_loss from web_returns, date_dim, web_page where wr_returned_date_sk = d_date_sk and d_date between cast(&apos;2000-08-16&apos; as date) and (cast(&apos;2000-08-16&apos; as date) +  30 days) and wr_web_page_sk = wp_web_page_sk group by wp_web_page_sk) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select &apos;store channel&apos; as channel , ss.s_store_sk as id , sales , coalesce(returns, 0) as returns , (profit - coalesce(profit_loss,0)) as profit from   ss left join sr on  ss.s_store_sk = sr.s_store_sk union all select &apos;catalog channel&apos; as channel , cs_call_center_sk as id , sales , returns , (profit - profit_loss) as profit from  cs , cr union all select &apos;web channel&apos; as channel , ws.wp_web_page_sk as id , sales , coalesce(returns, 0) returns , (profit - coalesce(profit_loss,0)) as profit from   ws left join wr on  ws.wp_web_page_sk = wr.wp_web_page_sk ) x group by rollup (channel, id) order by channel ,id limit 100

</samplerData>
</sample>
<sample t="16383" lt="16363" ts="1600985005195" s="true" lb="query78" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="33405" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220308_a1243ea4-0b9f-4d82-bd8b-4b375155d7d6:286
      Edges:
        Reducer 10 &lt;- Map 12 (CUSTOM_SIMPLE_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 11 &lt;- Reducer 10 (SIMPLE_EDGE)
        Reducer 14 &lt;- Map 13 (CUSTOM_SIMPLE_EDGE), Map 16 (CUSTOM_SIMPLE_EDGE), Map 8 (BROADCAST_EDGE)
        Reducer 15 &lt;- Reducer 14 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 7 (CUSTOM_SIMPLE_EDGE), Map 8 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 11 (CUSTOM_SIMPLE_EDGE), Reducer 3 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 15 (CUSTOM_SIMPLE_EDGE), Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
      DagName: zabetak_20200924220308_a1243ea4-0b9f-4d82-bd8b-4b375155d7d6:286
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 6998081785848 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_wholesale_cost (type: decimal(7,2)), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 27503885621 Data size: 6998081785848 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col2 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col2 (type: bigint)
                      Statistics: Num rows: 27503885621 Data size: 6998081785848 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: bigint), _col3 (type: int), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  Statistics: Num rows: 720020485 Data size: 11520327760 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: wr_item_sk (type: bigint), wr_order_number (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 720020485 Data size: 11520327760 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 720020485 Data size: 11520327760 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 3716773439824 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 3707433071224 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_item_sk (type: bigint), cs_order_number (type: bigint), cs_quantity (type: int), cs_wholesale_cost (type: decimal(7,2)), cs_sales_price (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 14291947369 Data size: 3707433071224 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint), _col2 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col1 (type: bigint), _col2 (type: bigint)
                        Statistics: Num rows: 14291947369 Data size: 3707433071224 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col3 (type: int), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  Statistics: Num rows: 1440033112 Data size: 23040529792 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1440033112 Data size: 23040529792 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 1440033112 Data size: 23040529792 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 2879513368 Data size: 46072213888 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2001) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 9
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 13
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 1871309795772 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 1871076497424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_bill_customer_sk (type: bigint), ws_order_number (type: bigint), ws_quantity (type: int), ws_wholesale_cost (type: decimal(7,2)), ws_sales_price (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 7197265278 Data size: 1871076497424 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col2 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col2 (type: bigint)
                        Statistics: Num rows: 7197265278 Data size: 1871076497424 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint), _col3 (type: int), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8
                input vertices:
                  1 Map 12
                Statistics: Num rows: 170463913512 Data size: 44262826916048 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: _col8 is null (type: boolean)
                  Statistics: Num rows: 7197265278 Data size: 1868848959036 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: bigint), _col3 (type: int), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 7197265278 Data size: 1813701879316 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col5 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      input vertices:
                        1 Map 8
                      Statistics: Num rows: 1446527908 Data size: 352943838812 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col2), sum(_col3), sum(_col4)
                        keys: _col1 (type: bigint), _col0 (type: bigint)
                        minReductionHashAggr: 0.97338593
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 1446527908 Data size: 358738618112 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 1446527908 Data size: 358738618112 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1446527908 Data size: 358738618112 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 1446527908 Data size: 358738618112 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint), _col0 (type: bigint)
                    null sort order: aa
                    sort order: ++
                    Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint)
                    Statistics: Num rows: 1446527908 Data size: 358738618112 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8
                input vertices:
                  1 Map 16
                Statistics: Num rows: 10846117953152 Data size: 2819912835568956 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: _col8 is null (type: boolean)
                  Statistics: Num rows: 8669875732 Data size: 2254105475088 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: bigint), _col3 (type: int), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 8669875732 Data size: 2184801911544 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col5 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      input vertices:
                        1 Map 8
                      Statistics: Num rows: 1730179839 Data size: 422157107796 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col2), sum(_col3), sum(_col4)
                        keys: _col0 (type: bigint), _col1 (type: bigint)
                        minReductionHashAggr: 0.95482963
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 1730179839 Data size: 429084370400 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 1730179839 Data size: 429084370400 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 1730179839 Data size: 429084370400 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 1730179839 Data size: 429084370400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint), _col0 (type: bigint)
                    null sort order: aa
                    sort order: ++
                    Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint)
                    Statistics: Num rows: 1730179839 Data size: 429084370400 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col8
                input vertices:
                  1 Map 7
                Statistics: Num rows: 846897024159 Data size: 219820266720768 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: _col8 is null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 7138898001584 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint), _col1 (type: bigint), _col3 (type: int), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                    Statistics: Num rows: 27503885621 Data size: 6926012661160 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col5 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      input vertices:
                        1 Map 8
                      Statistics: Num rows: 5527813214 Data size: 1343819908884 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: sum(_col2), sum(_col3), sum(_col4)
                        keys: _col1 (type: bigint), _col0 (type: bigint)
                        minReductionHashAggr: 0.97705704
                        mode: hash
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 5527813214 Data size: 1370729284896 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 5527813214 Data size: 1370729284896 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 5527813214 Data size: 1370729284896 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: bigint), _col0 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 5527813214 Data size: 1370729284896 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint), _col0 (type: bigint)
                    null sort order: aa
                    sort order: ++
                    Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint)
                    Statistics: Num rows: 5527813214 Data size: 1370729284896 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col7, _col8, _col9
                input vertices:
                  1 Reducer 11
                Statistics: Num rows: 13093307551171 Data size: 6283505003504488 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Reduce Output Operator
                  key expressions: _col1 (type: bigint), _col0 (type: bigint)
                  null sort order: aa
                  sort order: ++
                  Map-reduce partition columns: _col1 (type: bigint), _col0 (type: bigint)
                  Statistics: Num rows: 13093307551171 Data size: 6283505003504488 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), _col7 (type: bigint), _col8 (type: decimal(17,2)), _col9 (type: decimal(17,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col1, _col2, _col3, _col4, _col7, _col8, _col9, _col12, _col13, _col14
                input vertices:
                  1 Reducer 15
                Statistics: Num rows: 59971160758692899 Data size: 9223372036854775807 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: ((_col7 &gt; 0L) or (_col12 &gt; 0L)) (type: boolean)
                  Statistics: Num rows: 39980773839128598 Data size: 9223372036854775807 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: +---++++
                    keys: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2)), (CASE WHEN (_col7 is not null) THEN (_col7) ELSE (0L) END + CASE WHEN (_col12 is not null) THEN (_col12) ELSE (0L) END) (type: bigint), (CASE WHEN (_col8 is not null) THEN (_col8) ELSE (0) END + CASE WHEN (_col13 is not null) THEN (_col13) ELSE (0) END) (type: decimal(18,2)), (CASE WHEN (_col9 is not null) THEN (_col9) ELSE (0) END + CASE WHEN (_col14 is not null) THEN (_col14) ELSE (0) END) (type: decimal(18,2)), round((UDFToDouble(_col2) / UDFToDouble((CASE WHEN (_col7 is not null) THEN (_col7) ELSE (0L) END + CASE WHEN (_col12 is not null) THEN (_col12) ELSE (0L) END))), 2) (type: double)
                    null sort order: zaaazzzz
                    Statistics: Num rows: 39980773839128598 Data size: 9223372036854775807 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: _col1 (type: bigint), round((UDFToDouble(_col2) / UDFToDouble((CASE WHEN (_col7 is not null) THEN (_col7) ELSE (0L) END + CASE WHEN (_col12 is not null) THEN (_col12) ELSE (0L) END))), 2) (type: double), (CASE WHEN (_col7 is not null) THEN (_col7) ELSE (0L) END + CASE WHEN (_col12 is not null) THEN (_col12) ELSE (0L) END) (type: bigint), (CASE WHEN (_col8 is not null) THEN (_col8) ELSE (0) END + CASE WHEN (_col13 is not null) THEN (_col13) ELSE (0) END) (type: decimal(18,2)), (CASE WHEN (_col9 is not null) THEN (_col9) ELSE (0) END + CASE WHEN (_col14 is not null) THEN (_col14) ELSE (0) END) (type: decimal(18,2)), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: decimal(17,2))
                      outputColumnNames: _col0, _col1, _col5, _col6, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 39980773839128598 Data size: 9223372036854775807 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col8 (type: bigint), _col9 (type: decimal(17,2)), _col10 (type: decimal(17,2)), _col5 (type: bigint), _col6 (type: decimal(18,2)), _col7 (type: decimal(18,2)), _col1 (type: double)
                        null sort order: zaaazzzz
                        sort order: +---++++
                        Statistics: Num rows: 39980773839128598 Data size: 9223372036854775807 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey7 (type: double), KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey2 (type: decimal(17,2)), KEY.reducesinkkey3 (type: decimal(17,2)), KEY.reducesinkkey4 (type: bigint), KEY.reducesinkkey5 (type: decimal(18,2)), KEY.reducesinkkey6 (type: decimal(18,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 39980773839128598 Data size: 9223372036854775807 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 71200 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 71200 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query78
explain with ws as (select d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk ws_customer_sk, sum(ws_quantity) ws_qty, sum(ws_wholesale_cost) ws_wc, sum(ws_sales_price) ws_sp from web_sales left join web_returns on wr_order_number=ws_order_number and ws_item_sk=wr_item_sk join date_dim on ws_sold_date_sk = d_date_sk where wr_order_number is null group by d_year, ws_item_sk, ws_bill_customer_sk ), cs as (select d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk cs_customer_sk, sum(cs_quantity) cs_qty, sum(cs_wholesale_cost) cs_wc, sum(cs_sales_price) cs_sp from catalog_sales left join catalog_returns on cr_order_number=cs_order_number and cs_item_sk=cr_item_sk join date_dim on cs_sold_date_sk = d_date_sk where cr_order_number is null group by d_year, cs_item_sk, cs_bill_customer_sk ), ss as (select d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, sum(ss_quantity) ss_qty, sum(ss_wholesale_cost) ss_wc, sum(ss_sales_price) ss_sp from store_sales left join store_returns on sr_ticket_number=ss_ticket_number and ss_item_sk=sr_item_sk join date_dim on ss_sold_date_sk = d_date_sk where sr_ticket_number is null group by d_year, ss_item_sk, ss_customer_sk ) select ss_customer_sk, round(ss_qty/(coalesce(ws_qty,0)+coalesce(cs_qty,0)),2) ratio, ss_qty store_qty, ss_wc store_wholesale_cost, ss_sp store_sales_price, coalesce(ws_qty,0)+coalesce(cs_qty,0) other_chan_qty, coalesce(ws_wc,0)+coalesce(cs_wc,0) other_chan_wholesale_cost, coalesce(ws_sp,0)+coalesce(cs_sp,0) other_chan_sales_price from ss left join ws on (ws_sold_year=ss_sold_year and ws_item_sk=ss_item_sk and ws_customer_sk=ss_customer_sk) left join cs on (cs_sold_year=ss_sold_year and cs_item_sk=ss_item_sk and cs_customer_sk=ss_customer_sk) where (coalesce(ws_qty,0)&gt;0 or coalesce(cs_qty, 0)&gt;0) and ss_sold_year=2001 order by ss_customer_sk, ss_qty desc, ss_wc desc, ss_sp desc, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio limit 100

</samplerData>
</sample>
<sample t="4078" lt="4071" ts="1600985009275" s="true" lb="query79" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="15176" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220325_abb0754e-a7f0-463a-ad39-966d38370f91:287
      Edges:
        Map 2 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 3 &lt;- Map 1 (BROADCAST_EDGE), Map 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924220325_abb0754e-a7f0-463a-ad39-966d38370f91:287
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_first_name (type: char(20)), c_last_name (type: char(30))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_92_container, bigKeyColName:ss_hdemo_sk, smallTablePos:1, keyRatio:2.740521868024678E-6
                  Statistics: Num rows: 27503885621 Data size: 7315150431472 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_hdemo_sk is not null and ss_customer_sk is not null and ss_store_sk is not null) (type: boolean)
                    Statistics: Num rows: 25605320705 Data size: 6810193126312 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_addr_sk (type: bigint), ss_store_sk (type: bigint), ss_ticket_number (type: bigint), ss_coupon_amt (type: decimal(7,2)), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 25605320705 Data size: 6810193126312 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col7 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 2201522442 Data size: 426747819240 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col10
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 2116285037 Data size: 588953290265 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col10
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 634885537 Data size: 71693181725 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col5), sum(_col6)
                              keys: _col0 (type: bigint), _col2 (type: bigint), _col4 (type: bigint), _col10 (type: varchar(60))
                              minReductionHashAggr: 0.026077569
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                              Statistics: Num rows: 634885537 Data size: 206840907837 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: varchar(60))
                                null sort order: aaaa
                                sort order: ++++
                                Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint), _col3 (type: varchar(60))
                                Statistics: Num rows: 634885537 Data size: 206840907837 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_dow = 1) and (d_year) IN (1998, 1999, 2000)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_dow = 1) and (d_year) IN (1998, 1999, 2000)) (type: boolean)
                    Statistics: Num rows: 157 Data size: 2512 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 157 Data size: 1256 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 157 Data size: 1256 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 157 Data size: 1256 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5031847
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 78 Data size: 624 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 78 Data size: 624 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 2
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: s_number_employees BETWEEN 200 AND 295 (type: boolean)
                  Statistics: Num rows: 1500 Data size: 157460 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: s_number_employees BETWEEN 200 AND 295 (type: boolean)
                    Statistics: Num rows: 1440 Data size: 151160 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint), s_city (type: varchar(60))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 1440 Data size: 145440 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1440 Data size: 145440 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: varchar(60))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: ((hd_vehicle_count &gt; 3) or (hd_dep_count = 0)) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((hd_vehicle_count &gt; 3) or (hd_dep_count = 0)) (type: boolean)
                    Statistics: Num rows: 2160 Data size: 34560 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 2160 Data size: 17280 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2160 Data size: 17280 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint), KEY._col2 (type: bigint), KEY._col3 (type: varchar(60))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 634885537 Data size: 206840907837 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col2 (type: bigint), _col0 (type: bigint), _col3 (type: varchar(60)), _col4 (type: decimal(17,2)), _col5 (type: decimal(17,2)), substr(_col3, 1, 30) (type: string)
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                  Statistics: Num rows: 634885537 Data size: 264999160449 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col1 (type: bigint)
                    outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col7, _col8
                    input vertices:
                      0 Map 1
                    Statistics: Num rows: 634885537 Data size: 379026665589 Basic stats: COMPLETE Column stats: COMPLETE
                    Top N Key Operator
                      sort order: ++++
                      keys: _col2 (type: char(30)), _col1 (type: char(20)), substr(_col5, 1, 30) (type: string), _col7 (type: decimal(17,2))
                      null sort order: zzzz
                      Statistics: Num rows: 634885537 Data size: 379026665589 Basic stats: COMPLETE Column stats: COMPLETE
                      top n: 100
                      Select Operator
                        expressions: _col2 (type: char(30)), _col1 (type: char(20)), _col8 (type: string), _col3 (type: bigint), _col6 (type: decimal(17,2)), _col7 (type: decimal(17,2)), substr(_col5, 1, 30) (type: string)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                        Statistics: Num rows: 634885537 Data size: 378391780052 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col6 (type: string), _col5 (type: decimal(17,2))
                          null sort order: zzzz
                          sort order: ++++
                          Statistics: Num rows: 634885537 Data size: 378391780052 Basic stats: COMPLETE Column stats: COMPLETE
                          TopN Hash Memory Usage: 0.04
                          value expressions: _col2 (type: string), _col3 (type: bigint), _col4 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(30)), KEY.reducesinkkey1 (type: char(20)), VALUE._col0 (type: string), VALUE._col1 (type: bigint), VALUE._col2 (type: decimal(17,2)), KEY.reducesinkkey3 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 634885537 Data size: 378391780052 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 59600 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 59600 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query79
explain select c_last_name,c_first_name,substr(s_city,1,30),ss_ticket_number,amt,profit from (select ss_ticket_number ,ss_customer_sk ,store.s_city ,sum(ss_coupon_amt) amt ,sum(ss_net_profit) profit from store_sales,date_dim,store,household_demographics where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_store_sk = store.s_store_sk and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count &gt; 3) and date_dim.d_dow = 1 and date_dim.d_year in (1998,1998+1,1998+2) and store.s_number_employees between 200 and 295 group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer where ss_customer_sk = c_customer_sk order by c_last_name,c_first_name,substr(s_city,1,30), profit limit 100

</samplerData>
</sample>
<sample t="19547" lt="19538" ts="1600985028823" s="true" lb="query80" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="51788" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220329_5a44593b-35f9-447a-88ce-20eccd6c8a26:288
      Edges:
        Map 1 &lt;- Reducer 10 (BROADCAST_EDGE)
        Map 15 &lt;- Reducer 11 (BROADCAST_EDGE)
        Map 20 &lt;- Reducer 12 (BROADCAST_EDGE)
        Reducer 10 &lt;- Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 11 &lt;- Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 12 &lt;- Map 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 16 &lt;- Map 13 (BROADCAST_EDGE), Map 15 (CUSTOM_SIMPLE_EDGE), Map 18 (CUSTOM_SIMPLE_EDGE), Map 19 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 17 &lt;- Reducer 16 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 13 (BROADCAST_EDGE), Map 14 (BROADCAST_EDGE), Map 7 (CUSTOM_SIMPLE_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 21 &lt;- Map 13 (BROADCAST_EDGE), Map 20 (CUSTOM_SIMPLE_EDGE), Map 23 (CUSTOM_SIMPLE_EDGE), Map 24 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 22 &lt;- Reducer 21 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE), Union 4 (CONTAINS)
        Reducer 5 &lt;- Union 4 (SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
      DagName: zabetak_20200924220329_5a44593b-35f9-447a-88ce-20eccd6c8a26:288
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_store_sk is not null and ss_promo_sk is not null and ss_promo_sk BETWEEN DynamicValue(RS_23_promotion_p_promo_sk_min) AND DynamicValue(RS_23_promotion_p_promo_sk_max) and in_bloom_filter(ss_promo_sk, DynamicValue(RS_23_promotion_p_promo_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 7105486158640 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_store_sk is not null and ss_promo_sk is not null and ss_promo_sk BETWEEN DynamicValue(RS_23_promotion_p_promo_sk_min) AND DynamicValue(RS_23_promotion_p_promo_sk_max) and in_bloom_filter(ss_promo_sk, DynamicValue(RS_23_promotion_p_promo_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 26223892457 Data size: 6774806565352 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_store_sk (type: bigint), ss_promo_sk (type: bigint), ss_ticket_number (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_net_profit (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 26223892457 Data size: 6774806565352 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col3 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col3 (type: bigint)
                        Statistics: Num rows: 26223892457 Data size: 6774806565352 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint), _col2 (type: bigint), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-08-06 00:00:00&apos; AND TIMESTAMP&apos;2002-09-05 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-08-06 00:00:00&apos; AND TIMESTAMP&apos;2002-09-05 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 15
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 20
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 14 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_store_id (type: char(16))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 162000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 15 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_promo_sk is not null and cs_catalog_page_sk is not null and cs_promo_sk BETWEEN DynamicValue(RS_60_promotion_p_promo_sk_min) AND DynamicValue(RS_60_promotion_p_promo_sk_max) and in_bloom_filter(cs_promo_sk, DynamicValue(RS_60_promotion_p_promo_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 3777974651336 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_promo_sk is not null and cs_catalog_page_sk is not null and cs_promo_sk BETWEEN DynamicValue(RS_60_promotion_p_promo_sk_min) AND DynamicValue(RS_60_promotion_p_promo_sk_max) and in_bloom_filter(cs_promo_sk, DynamicValue(RS_60_promotion_p_promo_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 14256081883 Data size: 3759023521592 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_catalog_page_sk (type: bigint), cs_item_sk (type: bigint), cs_promo_sk (type: bigint), cs_order_number (type: bigint), cs_ext_sales_price (type: decimal(7,2)), cs_net_profit (type: decimal(7,2)), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 14256081883 Data size: 3759023521592 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint), _col3 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col1 (type: bigint), _col3 (type: bigint)
                        Statistics: Num rows: 14256081883 Data size: 3759023521592 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col2 (type: bigint), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 18 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  Statistics: Num rows: 1440033112 Data size: 339155998496 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cr_item_sk (type: bigint), cr_order_number (type: bigint), cr_return_amount (type: decimal(7,2)), cr_net_loss (type: decimal(7,2))
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 1440033112 Data size: 339155998496 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 1440033112 Data size: 339155998496 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col2 (type: decimal(7,2)), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 19 
            Map Operator Tree:
                TableScan
                  alias: catalog_page
                  Statistics: Num rows: 40000 Data size: 7312184 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: cp_catalog_page_sk (type: bigint), cp_catalog_page_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 40000 Data size: 7312184 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 40000 Data size: 7312184 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 20 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: (ws_web_site_sk is not null and ws_promo_sk is not null and ws_promo_sk BETWEEN DynamicValue(RS_98_promotion_p_promo_sk_min) AND DynamicValue(RS_98_promotion_p_promo_sk_max) and in_bloom_filter(ws_promo_sk, DynamicValue(RS_98_promotion_p_promo_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 1900199678872 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_web_site_sk is not null and ws_promo_sk is not null and ws_promo_sk BETWEEN DynamicValue(RS_98_promotion_p_promo_sk_min) AND DynamicValue(RS_98_promotion_p_promo_sk_max) and in_bloom_filter(ws_promo_sk, DynamicValue(RS_98_promotion_p_promo_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 7196361164 Data size: 1899724107192 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_web_site_sk (type: bigint), ws_promo_sk (type: bigint), ws_order_number (type: bigint), ws_ext_sales_price (type: decimal(7,2)), ws_net_profit (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 7196361164 Data size: 1899724107192 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint), _col3 (type: bigint)
                        null sort order: aa
                        sort order: ++
                        Map-reduce partition columns: _col0 (type: bigint), _col3 (type: bigint)
                        Statistics: Num rows: 7196361164 Data size: 1899724107192 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: bigint), _col2 (type: bigint), _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2)), _col6 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 23 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  Statistics: Num rows: 720020485 Data size: 165548342320 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: wr_item_sk (type: bigint), wr_order_number (type: bigint), wr_return_amt (type: decimal(7,2)), wr_net_loss (type: decimal(7,2))
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 720020485 Data size: 165548342320 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 720020485 Data size: 165548342320 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col2 (type: decimal(7,2)), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 24 
            Map Operator Tree:
                TableScan
                  alias: web_site
                  Statistics: Num rows: 78 Data size: 14608 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: web_site_sk (type: bigint), web_site_id (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 78 Data size: 14608 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 78 Data size: 14608 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  Statistics: Num rows: 2879513368 Data size: 668523212512 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: sr_item_sk (type: bigint), sr_ticket_number (type: bigint), sr_return_amt (type: decimal(7,2)), sr_net_loss (type: decimal(7,2))
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 2879513368 Data size: 668523212512 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint), _col1 (type: bigint)
                      null sort order: aa
                      sort order: ++
                      Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                      Statistics: Num rows: 2879513368 Data size: 668523212512 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col2 (type: decimal(7,2)), _col3 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_current_price &gt; 50) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 48126432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_current_price &gt; 50) (type: boolean)
                    Statistics: Num rows: 205020 Data size: 24544496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 205020 Data size: 1640160 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 205020 Data size: 1640160 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 205020 Data size: 1640160 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 205020 Data size: 1640160 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: promotion
                  filterExpr: (p_channel_tv = &apos;N&apos;) (type: boolean)
                  Statistics: Num rows: 2000 Data size: 186000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (p_channel_tv = &apos;N&apos;) (type: boolean)
                    Statistics: Num rows: 1000 Data size: 93000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: p_promo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1000 Data size: 8000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1000 Data size: 8000 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1000 Data size: 8000 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1000 Data size: 8000 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1000 Data size: 8000 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1000 Data size: 8000 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 1000 Data size: 8000 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 16 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
                input vertices:
                  1 Map 18
                Statistics: Num rows: 10818899266824 Data size: 5191123541076736 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col0, _col2, _col4, _col5, _col6, _col9, _col10
                  input vertices:
                    1 Map 8
                  Statistics: Num rows: 5517638522904 Data size: 2602377275811904 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col0, _col4, _col5, _col6, _col9, _col10
                    input vertices:
                      1 Map 9
                    Statistics: Num rows: 2758819261452 Data size: 1278144316801544 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col6 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col4, _col5, _col9, _col10
                      input vertices:
                        1 Map 13
                      Statistics: Num rows: 306514489323 Data size: 137822786619104 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col9, _col10, _col15
                        input vertices:
                          1 Map 19
                        Statistics: Num rows: 306514489323 Data size: 191769622697232 Basic stats: COMPLETE Column stats: PARTIAL
                        Select Operator
                          expressions: _col15 (type: string), _col4 (type: decimal(7,2)), CASE WHEN (_col9 is not null) THEN (_col9) ELSE (0) END (type: decimal(7,2)), (_col5 - CASE WHEN (_col10 is not null) THEN (_col10) ELSE (0) END) (type: decimal(8,2))
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 306514489323 Data size: 191769622697232 Basic stats: COMPLETE Column stats: PARTIAL
                          Group By Operator
                            aggregations: sum(_col1), sum(_col2), sum(_col3)
                            keys: _col0 (type: string)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 5993557101 Data size: 3116649685528 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 5993557101 Data size: 3116649685528 Basic stats: COMPLETE Column stats: PARTIAL
                              value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(18,2))
        Reducer 17 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 8001 Data size: 4160520 Basic stats: COMPLETE Column stats: PARTIAL
                Select Operator
                  expressions: &apos;catalog channel&apos; (type: string), concat(&apos;catalog_page&apos;, _col0) (type: string), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(18,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 8001 Data size: 4952619 Basic stats: COMPLETE Column stats: PARTIAL
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: string), _col1 (type: string)
                    null sort order: zz
                    Statistics: Num rows: 8788 Data size: 5438168 Basic stats: COMPLETE Column stats: PARTIAL
                    top n: 100
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        null sort order: zza
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
                input vertices:
                  1 Map 7
                Statistics: Num rows: 807483596672 Data size: 381547113453088 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col9, _col10
                  input vertices:
                    1 Map 8
                  Statistics: Num rows: 411816626602 Data size: 188332434806672 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col1, _col4, _col5, _col6, _col9, _col10
                    input vertices:
                      1 Map 9
                    Statistics: Num rows: 205908313301 Data size: 89501383677200 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col6 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col4, _col5, _col9, _col10
                      input vertices:
                        1 Map 13
                      Statistics: Num rows: 22877135295 Data size: 5164133600376 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col9, _col10, _col15
                        input vertices:
                          1 Map 14
                        Statistics: Num rows: 22877135295 Data size: 7273770501228 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col15 (type: char(16)), _col4 (type: decimal(7,2)), CASE WHEN (_col9 is not null) THEN (_col9) ELSE (0) END (type: decimal(7,2)), (_col5 - CASE WHEN (_col10 is not null) THEN (_col10) ELSE (0) END) (type: decimal(8,2))
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 22877135295 Data size: 7273770501228 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1), sum(_col2), sum(_col3)
                            keys: _col0 (type: char(16))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 21935608 Data size: 9563925088 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(16))
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: char(16))
                              Statistics: Num rows: 21935608 Data size: 9563925088 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(18,2))
        Reducer 21 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col9, _col10
                input vertices:
                  1 Map 23
                Statistics: Num rows: 170442499988 Data size: 80193043279320 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col0 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col9, _col10
                  input vertices:
                    1 Map 8
                  Statistics: Num rows: 86925673369 Data size: 39409561115248 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col2 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col1, _col4, _col5, _col6, _col9, _col10
                    input vertices:
                      1 Map 9
                    Statistics: Num rows: 43462836685 Data size: 18547406708712 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col6 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col4, _col5, _col9, _col10
                      input vertices:
                        1 Map 13
                      Statistics: Num rows: 4828873489 Data size: 1120190611360 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col4, _col5, _col9, _col10, _col15
                        input vertices:
                          1 Map 24
                        Statistics: Num rows: 4828873489 Data size: 1970079552680 Basic stats: COMPLETE Column stats: PARTIAL
                        Select Operator
                          expressions: _col15 (type: string), _col4 (type: decimal(7,2)), CASE WHEN (_col9 is not null) THEN (_col9) ELSE (0) END (type: decimal(7,2)), (_col5 - CASE WHEN (_col10 is not null) THEN (_col10) ELSE (0) END) (type: decimal(8,2))
                          outputColumnNames: _col0, _col1, _col2, _col3
                          Statistics: Num rows: 4828873489 Data size: 1970079552680 Basic stats: COMPLETE Column stats: PARTIAL
                          Group By Operator
                            aggregations: sum(_col1), sum(_col2), sum(_col3)
                            keys: _col0 (type: string)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 123136 Data size: 64030720 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              key expressions: _col0 (type: string)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col0 (type: string)
                              Statistics: Num rows: 123136 Data size: 64030720 Basic stats: COMPLETE Column stats: PARTIAL
                              value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(18,2))
        Reducer 22 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 15 Data size: 7800 Basic stats: COMPLETE Column stats: PARTIAL
                Select Operator
                  expressions: &apos;web channel&apos; (type: string), concat(&apos;web_site&apos;, _col0) (type: string), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(18,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 15 Data size: 9225 Basic stats: COMPLETE Column stats: PARTIAL
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: string), _col1 (type: string)
                    null sort order: zz
                    Statistics: Num rows: 8788 Data size: 5438168 Basic stats: COMPLETE Column stats: PARTIAL
                    top n: 100
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        null sort order: zza
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 772 Data size: 336592 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: &apos;store channel&apos; (type: string), concat(&apos;store&apos;, _col0) (type: string), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col3 (type: decimal(18,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 772 Data size: 476324 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: ++
                    keys: _col0 (type: string), _col1 (type: string)
                    null sort order: zz
                    Statistics: Num rows: 8788 Data size: 5438168 Basic stats: COMPLETE Column stats: PARTIAL
                    top n: 100
                    Group By Operator
                      aggregations: sum(_col2), sum(_col3), sum(_col4)
                      keys: _col0 (type: string), _col1 (type: string), 0L (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                      Reduce Output Operator
                        key expressions: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        null sort order: zza
                        sort order: +++
                        Map-reduce partition columns: _col0 (type: string), _col1 (type: string), _col2 (type: bigint)
                        Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                keys: KEY._col0 (type: string), KEY._col1 (type: string), KEY._col2 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col3, _col4, _col5
                Statistics: Num rows: 13182 Data size: 8265114 Basic stats: COMPLETE Column stats: PARTIAL
                pruneGroupingSetId: true
                Select Operator
                  expressions: _col0 (type: string), _col1 (type: string), _col3 (type: decimal(27,2)), _col4 (type: decimal(27,2)), _col5 (type: decimal(28,2))
                  outputColumnNames: _col0, _col1, _col2, _col3, _col4
                  Statistics: Num rows: 13182 Data size: 8159658 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col0 (type: string), _col1 (type: string)
                    null sort order: zz
                    sort order: ++
                    Statistics: Num rows: 13182 Data size: 8159658 Basic stats: COMPLETE Column stats: PARTIAL
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col2 (type: decimal(27,2)), _col3 (type: decimal(27,2)), _col4 (type: decimal(28,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: string), VALUE._col0 (type: decimal(27,2)), VALUE._col1 (type: decimal(27,2)), VALUE._col2 (type: decimal(28,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 13182 Data size: 8159658 Basic stats: COMPLETE Column stats: PARTIAL
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 61900 Basic stats: COMPLETE Column stats: PARTIAL
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 61900 Basic stats: COMPLETE Column stats: PARTIAL
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 4 
            Vertex: Union 4

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query80
explain with ssr as (select  s_store_id as store_id, sum(ss_ext_sales_price) as sales, sum(coalesce(sr_return_amt, 0)) as returns, sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit from store_sales left outer join store_returns on (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion where ss_sold_date_sk = d_date_sk and d_date between cast(&apos;2002-08-06&apos; as date) and (cast(&apos;2002-08-06&apos; as date) +  30 days) and ss_store_sk = s_store_sk and ss_item_sk = i_item_sk and i_current_price &gt; 50 and ss_promo_sk = p_promo_sk and p_channel_tv = &apos;N&apos; group by s_store_id) , csr as (select  cp_catalog_page_id as catalog_page_id, sum(cs_ext_sales_price) as sales, sum(coalesce(cr_return_amount, 0)) as returns, sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit from catalog_sales left outer join catalog_returns on (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion where cs_sold_date_sk = d_date_sk and d_date between cast(&apos;2002-08-06&apos; as date) and (cast(&apos;2002-08-06&apos; as date) +  30 days) and cs_catalog_page_sk = cp_catalog_page_sk and cs_item_sk = i_item_sk and i_current_price &gt; 50 and cs_promo_sk = p_promo_sk and p_channel_tv = &apos;N&apos; group by cp_catalog_page_id) , wsr as (select  web_site_id, sum(ws_ext_sales_price) as sales, sum(coalesce(wr_return_amt, 0)) as returns, sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit from web_sales left outer join web_returns on (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number), date_dim, web_site, item, promotion where ws_sold_date_sk = d_date_sk and d_date between cast(&apos;2002-08-06&apos; as date) and (cast(&apos;2002-08-06&apos; as date) +  30 days) and ws_web_site_sk = web_site_sk and ws_item_sk = i_item_sk and i_current_price &gt; 50 and ws_promo_sk = p_promo_sk and p_channel_tv = &apos;N&apos; group by web_site_id) select  channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select &apos;store channel&apos; as channel , &apos;store&apos; || store_id as id , sales , returns , profit from   ssr union all select &apos;catalog channel&apos; as channel , &apos;catalog_page&apos; || catalog_page_id as id , sales , returns , profit from  csr union all select &apos;web channel&apos; as channel , &apos;web_site&apos; || web_site_id as id , sales , returns , profit from   wsr ) x group by rollup (channel, id) order by channel ,id limit 100

</samplerData>
</sample>
<sample t="3312" lt="3306" ts="1600985032138" s="true" lb="query81" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="28206" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220348_40b6db43-e17c-47b4-ad81-abc0fdeac97c:289
      Edges:
        Map 1 &lt;- Map 3 (BROADCAST_EDGE)
        Map 4 &lt;- Map 3 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Reducer 2 (BROADCAST_EDGE)
        Map 8 &lt;- Map 3 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 1 (BROADCAST_EDGE), Map 4 (SIMPLE_EDGE), Reducer 9 (BROADCAST_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 9 &lt;- Map 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924220348_40b6db43-e17c-47b4-ad81-abc0fdeac97c:289
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer
                  filterExpr: c_current_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_160_container, bigKeyColName:c_current_addr_sk, smallTablePos:1, keyRatio:0.01886793846153846
                  Statistics: Num rows: 65000000 Data size: 29757000184 Basic stats: COMPLETE Column stats: PARTIAL
                  Filter Operator
                    predicate: c_current_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 65000000 Data size: 29757000184 Basic stats: COMPLETE Column stats: PARTIAL
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_customer_id (type: string), c_current_addr_sk (type: bigint), c_salutation (type: char(10)), c_first_name (type: char(20)), c_last_name (type: char(30))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 65000000 Data size: 29757000184 Basic stats: COMPLETE Column stats: PARTIAL
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16
                        input vertices:
                          1 Map 3
                        Statistics: Num rows: 1226416 Data size: 1489261352 Basic stats: COMPLETE Column stats: PARTIAL
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 1226416 Data size: 1489261352 Basic stats: COMPLETE Column stats: PARTIAL
                          value expressions: _col1 (type: string), _col3 (type: char(10)), _col4 (type: char(20)), _col5 (type: char(30)), _col7 (type: char(10)), _col8 (type: varchar(60)), _col9 (type: char(15)), _col10 (type: char(10)), _col11 (type: varchar(60)), _col12 (type: varchar(30)), _col13 (type: char(10)), _col14 (type: varchar(20)), _col15 (type: decimal(5,2)), _col16 (type: char(20))
                        Select Operator
                          expressions: _col0 (type: bigint)
                          outputColumnNames: _col0
                          Statistics: Num rows: 1226416 Data size: 9811328 Basic stats: COMPLETE Column stats: PARTIAL
                          Group By Operator
                            aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1226416)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: PARTIAL
                              value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: ((ca_state = &apos;TX&apos;) or ca_state is not null) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 33528280736 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_state = &apos;TX&apos;) (type: boolean)
                    Statistics: Num rows: 613208 Data size: 632609592 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), ca_street_number (type: char(10)), ca_street_name (type: varchar(60)), ca_street_type (type: char(15)), ca_suite_number (type: char(10)), ca_city (type: varchar(60)), ca_county (type: varchar(30)), ca_zip (type: char(10)), ca_country (type: varchar(20)), ca_gmt_offset (type: decimal(5,2)), ca_location_type (type: char(20))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10
                      Statistics: Num rows: 613208 Data size: 579873704 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 613208 Data size: 579873704 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(10)), _col2 (type: varchar(60)), _col3 (type: char(15)), _col4 (type: char(10)), _col5 (type: varchar(60)), _col6 (type: varchar(30)), _col7 (type: char(10)), _col8 (type: varchar(20)), _col9 (type: decimal(5,2)), _col10 (type: char(20))
                  Filter Operator
                    predicate: ca_state is not null (type: boolean)
                    Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), ca_state (type: char(2))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(2))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: (cr_returning_addr_sk is not null and cr_returning_customer_sk is not null and cr_returning_customer_sk BETWEEN DynamicValue(RS_57_customer_c_customer_sk_min) AND DynamicValue(RS_57_customer_c_customer_sk_max) and in_bloom_filter(cr_returning_customer_sk, DynamicValue(RS_57_customer_c_customer_sk_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_162_container, bigKeyColName:cr_returning_addr_sk, smallTablePos:1, keyRatio:1.367079675873453E-4
                  Statistics: Num rows: 1440033112 Data size: 192155704752 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_returning_addr_sk is not null and cr_returning_customer_sk is not null and cr_returning_customer_sk BETWEEN DynamicValue(RS_57_customer_c_customer_sk_min) AND DynamicValue(RS_57_customer_c_customer_sk_max) and in_bloom_filter(cr_returning_customer_sk, DynamicValue(RS_57_customer_c_customer_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 1382988681 Data size: 184543787560 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_returning_customer_sk (type: bigint), cr_returning_addr_sk (type: bigint), cr_return_amt_inc_tax (type: decimal(7,2)), cr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 1382988681 Data size: 184543787560 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 241345648 Data size: 27349569888 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col6
                          input vertices:
                            1 Map 3
                          Statistics: Num rows: 241345648 Data size: 46396021440 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2)
                            keys: _col0 (type: bigint), _col6 (type: char(2))
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 120672824 Data size: 24747994120 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: bigint), _col1 (type: char(2))
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: bigint), _col1 (type: char(2))
                              Statistics: Num rows: 120672824 Data size: 24747994120 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 1998) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 1998) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cr_returned_date_sk (bigint)
                            Target Input: catalog_returns
                            Partition key expr: cr_returned_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 4
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cr_returned_date_sk (bigint)
                            Target Input: catalog_returns
                            Partition key expr: cr_returned_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 8
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: cr_returning_addr_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_164_container, bigKeyColName:cr_returning_addr_sk, smallTablePos:1, keyRatio:1.367079675873453E-4
                  Statistics: Num rows: 1440033112 Data size: 192155704752 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cr_returning_addr_sk is not null (type: boolean)
                    Statistics: Num rows: 1411204749 Data size: 188308894320 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_returning_customer_sk (type: bigint), cr_returning_addr_sk (type: bigint), cr_return_amt_inc_tax (type: decimal(7,2)), cr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 1411204749 Data size: 188308894320 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 7
                        Statistics: Num rows: 246269640 Data size: 27907562376 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col1 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col2, _col6
                          input vertices:
                            1 Map 3
                          Statistics: Num rows: 246269640 Data size: 47342604216 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2)
                            keys: _col6 (type: char(2)), _col0 (type: bigint)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 123134820 Data size: 25252908656 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(2)), _col1 (type: bigint)
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: char(2))
                              Statistics: Num rows: 123134820 Data size: 25252908656 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col2 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1226416)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: PARTIAL
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: PARTIAL
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint), KEY._col1 (type: char(2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 10433845 Data size: 2139808510 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: _col2 is not null (type: boolean)
                  Statistics: Num rows: 10433845 Data size: 2139808510 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: bigint)
                      1 _col0 (type: bigint)
                    outputColumnNames: _col1, _col3, _col4, _col5, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col18, _col19
                    input vertices:
                      0 Map 1
                    Statistics: Num rows: 10433845 Data size: 16362092502 Basic stats: COMPLETE Column stats: PARTIAL
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col18 (type: char(2))
                        1 _col1 (type: char(2))
                      outputColumnNames: _col1, _col3, _col4, _col5, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15, _col16, _col19, _col20
                      input vertices:
                        1 Reducer 9
                      Statistics: Num rows: 10433845 Data size: 16633372472 Basic stats: COMPLETE Column stats: PARTIAL
                      Filter Operator
                        predicate: (_col19 &gt; _col20) (type: boolean)
                        Statistics: Num rows: 3477948 Data size: 5544457248 Basic stats: COMPLETE Column stats: PARTIAL
                        Top N Key Operator
                          sort order: +++++++++++++++
                          keys: _col1 (type: string), _col3 (type: char(10)), _col4 (type: char(20)), _col5 (type: char(30)), _col7 (type: char(10)), _col8 (type: varchar(60)), _col9 (type: char(15)), _col10 (type: char(10)), _col11 (type: varchar(60)), _col12 (type: varchar(30)), _col13 (type: char(10)), _col14 (type: varchar(20)), _col15 (type: decimal(5,2)), _col16 (type: char(20)), _col19 (type: decimal(17,2))
                          null sort order: zzzzzzzzzzzzzzz
                          Statistics: Num rows: 3477948 Data size: 5544457248 Basic stats: COMPLETE Column stats: PARTIAL
                          top n: 100
                          Select Operator
                            expressions: _col1 (type: string), _col3 (type: char(10)), _col4 (type: char(20)), _col5 (type: char(30)), _col7 (type: char(10)), _col8 (type: varchar(60)), _col9 (type: char(15)), _col10 (type: char(10)), _col11 (type: varchar(60)), _col12 (type: varchar(30)), _col13 (type: char(10)), _col14 (type: varchar(20)), _col15 (type: decimal(5,2)), _col16 (type: char(20)), _col19 (type: decimal(17,2))
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                            Statistics: Num rows: 3477948 Data size: 5079020056 Basic stats: COMPLETE Column stats: PARTIAL
                            Reduce Output Operator
                              key expressions: _col0 (type: string), _col1 (type: char(10)), _col2 (type: char(20)), _col3 (type: char(30)), _col4 (type: char(10)), _col5 (type: varchar(60)), _col6 (type: char(15)), _col7 (type: char(10)), _col8 (type: varchar(60)), _col9 (type: varchar(30)), _col10 (type: char(10)), _col11 (type: varchar(20)), _col12 (type: decimal(5,2)), _col13 (type: char(20)), _col14 (type: decimal(17,2))
                              null sort order: zzzzzzzzzzzzzzz
                              sort order: +++++++++++++++
                              Statistics: Num rows: 3477948 Data size: 5079020056 Basic stats: COMPLETE Column stats: PARTIAL
                              TopN Hash Memory Usage: 0.04
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: char(10)), KEY.reducesinkkey2 (type: char(20)), KEY.reducesinkkey3 (type: char(30)), KEY.reducesinkkey4 (type: char(10)), KEY.reducesinkkey5 (type: varchar(60)), KEY.reducesinkkey6 (type: char(15)), KEY.reducesinkkey7 (type: char(10)), KEY.reducesinkkey8 (type: varchar(60)), KEY.reducesinkkey9 (type: varchar(30)), KEY.reducesinkkey10 (type: char(10)), KEY.reducesinkkey11 (type: varchar(20)), KEY.reducesinkkey12 (type: decimal(5,2)), KEY.reducesinkkey13 (type: char(20)), KEY.reducesinkkey14 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14
                Statistics: Num rows: 3477948 Data size: 5079020056 Basic stats: COMPLETE Column stats: PARTIAL
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 146168 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: _col0 (type: string), _col1 (type: char(10)), _col2 (type: char(20)), _col3 (type: char(30)), _col4 (type: char(10)), _col5 (type: varchar(60)), _col6 (type: char(15)), _col7 (type: char(10)), _col8 (type: varchar(60)), _col9 (type: varchar(30)), &apos;TX&apos; (type: char(2)), _col10 (type: char(10)), _col11 (type: varchar(20)), _col12 (type: decimal(5,2)), _col13 (type: char(20)), _col14 (type: decimal(17,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9, _col10, _col11, _col12, _col13, _col14, _col15
                    Statistics: Num rows: 100 Data size: 154768 Basic stats: COMPLETE Column stats: PARTIAL
                    File Output Operator
                      compressed: false
                      Statistics: Num rows: 100 Data size: 154768 Basic stats: COMPLETE Column stats: PARTIAL
                      table:
                          input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                          output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                          serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(2)), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 10433845 Data size: 2139808510 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(2)), _col2 (type: decimal(17,2))
                  outputColumnNames: _col0, _col2
                  Statistics: Num rows: 10433845 Data size: 2139808510 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col2), count(_col2)
                    keys: _col0 (type: char(2))
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 53 Data size: 10918 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: (_col1 is not null and _col2 is not null) (type: boolean)
                      Statistics: Num rows: 53 Data size: 10918 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: ((_col1 / _col2) * 1.2) (type: decimal(38,11)), _col0 (type: char(2))
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 53 Data size: 10494 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col1 (type: char(2))
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col1 (type: char(2))
                          Statistics: Num rows: 53 Data size: 10494 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: decimal(38,11))

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query81
explain with customer_total_return as (select cr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(cr_return_amt_inc_tax) as ctr_total_return from catalog_returns ,date_dim ,customer_address where cr_returned_date_sk = d_date_sk and d_year =1998 and cr_returning_addr_sk = ca_address_sk group by cr_returning_customer_sk ,ca_state ) select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return &gt; (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = &apos;TX&apos; and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset ,ca_location_type,ctr_total_return limit 100

</samplerData>
</sample>
<sample t="1675" lt="1670" ts="1600985033815" s="true" lb="query82" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="2891" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220352_18748576-b3a6-4dd7-a2d0-442e37d5e2eb:290
      Edges:
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
      DagName: zabetak_20200924220352_18748576-b3a6-4dd7-a2d0-442e37d5e2eb:290
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.q82
                  Statistics: Num rows: 77 Data size: 37200 Basic stats: COMPLETE Column stats: NONE
                  Top N Key Operator
                    sort order: +
                    keys: i_item_id (type: char(16))
                    null sort order: z
                    Statistics: Num rows: 77 Data size: 37200 Basic stats: COMPLETE Column stats: NONE
                    top n: 100
                    Select Operator
                      expressions: i_item_id (type: char(16)), i_item_desc (type: varchar(200)), i_current_price (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 77 Data size: 37200 Basic stats: COMPLETE Column stats: NONE
                      Reduce Output Operator
                        key expressions: _col0 (type: char(16))
                        null sort order: z
                        sort order: +
                        Statistics: Num rows: 77 Data size: 37200 Basic stats: COMPLETE Column stats: NONE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col1 (type: varchar(200)), _col2 (type: decimal(7,2))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), VALUE._col0 (type: varchar(200)), VALUE._col1 (type: decimal(7,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 77 Data size: 37200 Basic stats: COMPLETE Column stats: NONE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 77 Data size: 37200 Basic stats: COMPLETE Column stats: NONE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 77 Data size: 37200 Basic stats: COMPLETE Column stats: NONE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query82
explain select  i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, store_sales where i_current_price between 49 and 49+30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast(&apos;2001-01-28&apos; as date) and (cast(&apos;2001-01-28&apos; as date) +  60 days) and i_manufact_id in (80,675,292,17) and inv_quantity_on_hand between 100 and 500 and ss_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id limit 100

</samplerData>
</sample>
<sample t="6964" lt="6957" ts="1600985040780" s="true" lb="query83" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="28959" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220353_4ac37a12-58d2-41f7-97bc-88210c189f81:291
      Edges:
        Map 2 &lt;- Map 1 (BROADCAST_EDGE)
        Reducer 10 &lt;- Reducer 14 (BROADCAST_EDGE), Reducer 6 (BROADCAST_EDGE), Reducer 9 (SIMPLE_EDGE)
        Reducer 11 &lt;- Reducer 10 (SIMPLE_EDGE)
        Reducer 13 &lt;- Map 12 (CUSTOM_SIMPLE_EDGE), Map 7 (BROADCAST_EDGE), Reducer 3 (CUSTOM_SIMPLE_EDGE)
        Reducer 14 &lt;- Reducer 13 (SIMPLE_EDGE)
        Reducer 3 &lt;- Map 1 (BROADCAST_EDGE), Map 2 (SIMPLE_EDGE)
        Reducer 5 &lt;- Map 4 (CUSTOM_SIMPLE_EDGE), Map 7 (BROADCAST_EDGE), Reducer 3 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 9 &lt;- Map 7 (BROADCAST_EDGE), Map 8 (CUSTOM_SIMPLE_EDGE), Reducer 3 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220353_4ac37a12-58d2-41f7-97bc-88210c189f81:291
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_date is not null or ((d_date) IN (DATE&apos;2000-06-17&apos;, DATE&apos;2000-08-22&apos;, DATE&apos;2000-11-17&apos;) and d_week_seq is not null)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_date is not null (type: boolean)
                    Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_date (type: date)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: date)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: date)
                        Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: ((d_date) IN (DATE&apos;2000-06-17&apos;, DATE&apos;2000-08-22&apos;, DATE&apos;2000-11-17&apos;) and d_week_seq is not null) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 4382940 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_week_seq (type: int)
                      outputColumnNames: _col0
                      Statistics: Num rows: 73049 Data size: 292196 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: int)
                        minReductionHashAggr: 0.8453504
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 11297 Data size: 45188 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: int)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: int)
                          Statistics: Num rows: 11297 Data size: 45188 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  Statistics: Num rows: 687618864 Data size: 13687586272 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: wr_item_sk (type: bigint), wr_return_quantity (type: int), wr_returned_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 687618864 Data size: 13687586272 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col2 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col2 (type: bigint)
                      Statistics: Num rows: 687618864 Data size: 13687586272 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint), _col1 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_week_seq is not null and d_date is not null) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4382940 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_week_seq is not null and d_date is not null) (type: boolean)
                    Statistics: Num rows: 73049 Data size: 4382940 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date (type: date), d_week_seq (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 73049 Data size: 4382940 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Left Semi Join 0 to 1
                        keys:
                          0 _col1 (type: int)
                          1 _col0 (type: int)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 1
                        Statistics: Num rows: 73049 Data size: 4090744 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: date)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 36524 Data size: 2045344 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: date)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: date)
                            Statistics: Num rows: 36524 Data size: 2045344 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  Statistics: Num rows: 1440033112 Data size: 28685498460 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cr_item_sk (type: bigint), cr_return_quantity (type: int), cr_returned_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1440033112 Data size: 28685498460 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col2 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col2 (type: bigint)
                      Statistics: Num rows: 1440033112 Data size: 28685498460 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint), _col1 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: i_item_id is not null (type: boolean)
                  Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: i_item_id is not null (type: boolean)
                    Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16))
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16))
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 402000 Data size: 43416000 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  Statistics: Num rows: 2778787720 Data size: 55373913972 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: sr_item_sk (type: bigint), sr_return_quantity (type: int), sr_returned_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 2778787720 Data size: 55373913972 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col2 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col2 (type: bigint)
                      Statistics: Num rows: 2778787720 Data size: 55373913972 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint), _col1 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 211614 Data size: 22854312 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: bigint), UDFToDouble(_col1) (type: double)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 211614 Data size: 24547224 Basic stats: COMPLETE Column stats: COMPLETE
                  Map Join Operator
                    condition map:
                         Inner Join 0 to 1
                    keys:
                      0 _col0 (type: char(16))
                      1 _col0 (type: char(16))
                    outputColumnNames: _col0, _col1, _col2, _col4, _col5
                    input vertices:
                      0 Reducer 6
                    Statistics: Num rows: 211614 Data size: 27933048 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: char(16))
                        1 _col0 (type: char(16))
                      outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col7, _col8
                      input vertices:
                        1 Reducer 14
                      Statistics: Num rows: 211614 Data size: 31318872 Basic stats: COMPLETE Column stats: COMPLETE
                      Top N Key Operator
                        sort order: ++
                        keys: _col0 (type: char(16)), _col4 (type: bigint)
                        null sort order: zz
                        Statistics: Num rows: 211614 Data size: 31318872 Basic stats: COMPLETE Column stats: COMPLETE
                        top n: 100
                        Select Operator
                          expressions: _col0 (type: char(16)), _col4 (type: bigint), (((_col5 / UDFToDouble(((_col4 + _col1) + _col7))) / 3.0D) * 100.0D) (type: double), _col1 (type: bigint), (((_col2 / UDFToDouble(((_col4 + _col1) + _col7))) / 3.0D) * 100.0D) (type: double), _col7 (type: bigint), (((_col8 / UDFToDouble(((_col4 + _col1) + _col7))) / 3.0D) * 100.0D) (type: double), (CAST( ((_col4 + _col1) + _col7) AS decimal(19,0)) / 3) (type: decimal(25,6))
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                          Statistics: Num rows: 211614 Data size: 55019640 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(16)), _col1 (type: bigint)
                            null sort order: zz
                            sort order: ++
                            Statistics: Num rows: 211614 Data size: 55019640 Basic stats: COMPLETE Column stats: COMPLETE
                            TopN Hash Memory Usage: 0.04
                            value expressions: _col2 (type: double), _col3 (type: bigint), _col4 (type: double), _col5 (type: bigint), _col6 (type: double), _col7 (type: decimal(25,6))
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: char(16)), KEY.reducesinkkey1 (type: bigint), VALUE._col0 (type: double), VALUE._col1 (type: bigint), VALUE._col2 (type: double), VALUE._col3 (type: bigint), VALUE._col4 (type: double), VALUE._col5 (type: decimal(25,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 211614 Data size: 55019640 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 26000 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 26000 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col3, _col4
                input vertices:
                  0 Reducer 3
                Statistics: Num rows: 26584635 Data size: 254224612 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col4, _col7
                  input vertices:
                    1 Map 7
                  Statistics: Num rows: 26584635 Data size: 2700011032 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col4)
                    keys: _col7 (type: char(16))
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 2327754 Data size: 251397432 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 2327754 Data size: 251397432 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: bigint)
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 211614 Data size: 22854312 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: bigint), UDFToDouble(_col1) (type: double)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 211614 Data size: 24547224 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(16))
                    Statistics: Num rows: 211614 Data size: 24547224 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: bigint), _col2 (type: double)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: date)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 18262 Data size: 1022672 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col1 (type: date)
                    1 _col0 (type: date)
                  outputColumnNames: _col0
                  input vertices:
                    0 Map 1
                  Statistics: Num rows: 1334020838 Data size: 10672166704 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 1334020838 Data size: 10672166704 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1334020838 Data size: 10672166704 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: _col0 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 2849700 Data size: 22797600 Basic stats: COMPLETE Column stats: COMPLETE
                      Dynamic Partitioning Event Operator
                        Target column: cr_returned_date_sk (bigint)
                        Target Input: catalog_returns
                        Partition key expr: cr_returned_date_sk
                        Statistics: Num rows: 2849700 Data size: 22797600 Basic stats: COMPLETE Column stats: COMPLETE
                        Target Vertex: Map 4
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 1334020838 Data size: 10672166704 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1334020838 Data size: 10672166704 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: _col0 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 2849700 Data size: 22797600 Basic stats: COMPLETE Column stats: COMPLETE
                      Dynamic Partitioning Event Operator
                        Target column: sr_returned_date_sk (bigint)
                        Target Input: store_returns
                        Partition key expr: sr_returned_date_sk
                        Statistics: Num rows: 2849700 Data size: 22797600 Basic stats: COMPLETE Column stats: COMPLETE
                        Target Vertex: Map 8
                  Reduce Output Operator
                    key expressions: _col0 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: bigint)
                    Statistics: Num rows: 1334020838 Data size: 10672166704 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1334020838 Data size: 10672166704 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: _col0 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 2849700 Data size: 22797600 Basic stats: COMPLETE Column stats: COMPLETE
                      Dynamic Partitioning Event Operator
                        Target column: wr_returned_date_sk (bigint)
                        Target Input: web_returns
                        Partition key expr: wr_returned_date_sk
                        Statistics: Num rows: 2849700 Data size: 22797600 Basic stats: COMPLETE Column stats: COMPLETE
                        Target Vertex: Map 12
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col3, _col4
                input vertices:
                  0 Reducer 3
                Statistics: Num rows: 55674380 Data size: 552928780 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col4, _col7
                  input vertices:
                    1 Map 7
                  Statistics: Num rows: 55674380 Data size: 5674971740 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col4)
                    keys: _col7 (type: char(16))
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 4867122 Data size: 525649176 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 4867122 Data size: 525649176 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: bigint)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(16))
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 211614 Data size: 22854312 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(16)), _col1 (type: bigint), UDFToDouble(_col1) (type: double)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 211614 Data size: 24547224 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col0 (type: char(16))
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col0 (type: char(16))
                    Statistics: Num rows: 211614 Data size: 24547224 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col1 (type: bigint), _col2 (type: double)
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col3, _col4
                input vertices:
                  0 Reducer 3
                Statistics: Num rows: 107433144 Data size: 1087357300 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col4, _col7
                  input vertices:
                    1 Map 7
                  Statistics: Num rows: 107433144 Data size: 10971206548 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col4)
                    keys: _col7 (type: char(16))
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 9099402 Data size: 982735416 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: char(16))
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: char(16))
                      Statistics: Num rows: 9099402 Data size: 982735416 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: bigint)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query83
explain with sr_items as (select i_item_id item_id, sum(sr_return_quantity) sr_item_qty from store_returns, item, date_dim where sr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in (&apos;2000-06-17&apos;,&apos;2000-08-22&apos;,&apos;2000-11-17&apos;))) and   sr_returned_date_sk   = d_date_sk group by i_item_id), cr_items as (select i_item_id item_id, sum(cr_return_quantity) cr_item_qty from catalog_returns, item, date_dim where cr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in (&apos;2000-06-17&apos;,&apos;2000-08-22&apos;,&apos;2000-11-17&apos;))) and   cr_returned_date_sk   = d_date_sk group by i_item_id), wr_items as (select i_item_id item_id, sum(wr_return_quantity) wr_item_qty from web_returns, item, date_dim where wr_item_sk = i_item_sk and   d_date    in (select d_date from date_dim where d_week_seq in (select d_week_seq from date_dim where d_date in (&apos;2000-06-17&apos;,&apos;2000-08-22&apos;,&apos;2000-11-17&apos;))) and   wr_returned_date_sk   = d_date_sk group by i_item_id) select  sr_items.item_id ,sr_item_qty ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev ,cr_item_qty ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev ,wr_item_qty ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average from sr_items ,cr_items ,wr_items where sr_items.item_id=cr_items.item_id and sr_items.item_id=wr_items.item_id order by sr_items.item_id ,sr_item_qty limit 100

</samplerData>
</sample>
<sample t="1600" lt="1596" ts="1600985042382" s="true" lb="query84" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="14072" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220400_fca734f8-04d4-4ee1-8aed-0cad4286957b:292
      Edges:
        Map 2 &lt;- Map 1 (BROADCAST_EDGE), Map 4 (BROADCAST_EDGE)
        Map 4 &lt;- Map 5 (BROADCAST_EDGE)
        Map 6 &lt;- Map 2 (BROADCAST_EDGE), Reducer 3 (BROADCAST_EDGE)
        Reducer 3 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Map 6 (SIMPLE_EDGE)
      DagName: zabetak_20200924220400_fca734f8-04d4-4ee1-8aed-0cad4286957b:292
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  Statistics: Num rows: 1920800 Data size: 15366400 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cd_demo_sk (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 1920800 Data size: 15366400 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1920800 Data size: 15366400 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: ((ca_city = &apos;Hopewell&apos;) and c_current_hdemo_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_97_container, bigKeyColName:c_current_hdemo_sk, smallTablePos:1, keyRatio:1.06E-5
                  Statistics: Num rows: 65000000 Data size: 25248632448 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ca_city = &apos;Hopewell&apos;) and c_current_hdemo_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 61455 Data size: 23871627 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_id (type: string), c_current_cdemo_sk (type: bigint), c_current_hdemo_sk (type: bigint), concat(concat(CASE WHEN (c_last_name is not null) THEN (CAST( c_last_name AS STRING)) ELSE (&apos;&apos;) END, &apos;, &apos;), CASE WHEN (c_first_name is not null) THEN (CAST( c_first_name AS STRING)) ELSE (&apos;&apos;) END) (type: string)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 61455 Data size: 18402132 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col1 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 61455 Data size: 948912 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col1 (type: bigint)
                        outputColumnNames: _col0, _col1, _col3, _col4
                        input vertices:
                          0 Map 1
                        Statistics: Num rows: 61455 Data size: 18419316 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col4
                          input vertices:
                            1 Map 4
                          Statistics: Num rows: 21510 Data size: 6280920 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 21510 Data size: 6280920 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: string), _col4 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: hd_income_band_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_96_container, bigKeyColName:hd_income_band_sk, smallTablePos:1, keyRatio:0.35
                  Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: hd_income_band_sk is not null (type: boolean)
                    Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint), hd_income_band_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 7200 Data size: 115200 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 2520 Data size: 20160 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 2520 Data size: 20160 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: income_band
                  filterExpr: ((ib_lower_bound &gt;= 37855) and (ib_upper_bound &lt;= 87855)) (type: boolean)
                  Statistics: Num rows: 20 Data size: 320 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ib_lower_bound &gt;= 37855) and (ib_upper_bound &lt;= 87855)) (type: boolean)
                    Statistics: Num rows: 7 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ib_income_band_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 7 Data size: 56 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 7 Data size: 56 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: (sr_cdemo_sk is not null and sr_cdemo_sk BETWEEN DynamicValue(RS_19_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_current_cdemo_sk_min) AND DynamicValue(RS_19_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_current_cdemo_sk_max) and in_bloom_filter(sr_cdemo_sk, DynamicValue(RS_19_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_current_cdemo_sk_bloom_filter))) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_98_container, bigKeyColName:sr_cdemo_sk, smallTablePos:0, keyRatio:9.124361182684393E-4
                  Statistics: Num rows: 2879513368 Data size: 22231437072 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (sr_cdemo_sk is not null and sr_cdemo_sk BETWEEN DynamicValue(RS_19_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_current_cdemo_sk_min) AND DynamicValue(RS_19_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_current_cdemo_sk_max) and in_bloom_filter(sr_cdemo_sk, DynamicValue(RS_19_tpcds_bin_partitioned_orc_10000.customer_customer_address_1_c_current_cdemo_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 2778929633 Data size: 21454874960 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_cdemo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 2778929633 Data size: 21454874960 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col4
                        input vertices:
                          0 Map 2
                        Statistics: Num rows: 2627372 Data size: 746173648 Basic stats: COMPLETE Column stats: COMPLETE
                        Top N Key Operator
                          sort order: +
                          keys: _col1 (type: string)
                          null sort order: z
                          Statistics: Num rows: 2627372 Data size: 746173648 Basic stats: COMPLETE Column stats: COMPLETE
                          top n: 100
                          Select Operator
                            expressions: _col4 (type: string), _col1 (type: string)
                            outputColumnNames: _col1, _col2
                            Statistics: Num rows: 2627372 Data size: 1008910848 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col2 (type: string)
                              null sort order: z
                              sort order: +
                              Statistics: Num rows: 2627372 Data size: 1008910848 Basic stats: COMPLETE Column stats: COMPLETE
                              TopN Hash Memory Usage: 0.04
                              value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), VALUE._col0 (type: string)
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2627372 Data size: 1008910848 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 38400 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 38400 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query84
explain select  c_customer_id as customer_id , coalesce(c_last_name,&apos;&apos;) || &apos;, &apos; || coalesce(c_first_name,&apos;&apos;) as customername from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,store_returns where ca_city	        =  &apos;Hopewell&apos; and c_current_addr_sk = ca_address_sk and ib_lower_bound   &gt;=  37855 and ib_upper_bound   &lt;=  37855 + 50000 and ib_income_band_sk = hd_income_band_sk and cd_demo_sk = c_current_cdemo_sk and hd_demo_sk = c_current_hdemo_sk and sr_cdemo_sk = cd_demo_sk order by c_customer_id limit 100

</samplerData>
</sample>
<sample t="8837" lt="8830" ts="1600985051220" s="true" lb="query85" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="22098" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220402_13b54e8e-21a5-4ec4-b74d-c21f58a3a0e8:293
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Map 5 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924220402_13b54e8e-21a5-4ec4-b74d-c21f58a3a0e8:293
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: (((ws_sales_price &gt;= 100) or (ws_sales_price &lt;= 150) or (ws_sales_price &gt;= 50) or (ws_sales_price &lt;= 100) or (ws_sales_price &gt;= 150) or (ws_sales_price &lt;= 200)) and ((ws_net_profit &gt;= 100) or (ws_net_profit &lt;= 200) or (ws_net_profit &gt;= 150) or (ws_net_profit &lt;= 300) or (ws_net_profit &gt;= 50) or (ws_net_profit &lt;= 250)) and ws_web_page_sk is not null) (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 1871410718548 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (((ws_sales_price &gt;= 100) or (ws_sales_price &lt;= 150) or (ws_sales_price &gt;= 50) or (ws_sales_price &lt;= 100) or (ws_sales_price &gt;= 150) or (ws_sales_price &lt;= 200)) and ((ws_net_profit &gt;= 100) or (ws_net_profit &lt;= 200) or (ws_net_profit &gt;= 150) or (ws_net_profit &lt;= 300) or (ws_net_profit &gt;= 50) or (ws_net_profit &lt;= 250)) and ws_web_page_sk is not null) (type: boolean)
                    Statistics: Num rows: 7197262943 Data size: 1871176800556 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_order_number (type: bigint), ws_quantity (type: int), ws_sold_date_sk (type: bigint), ws_net_profit BETWEEN 100 AND 200 (type: boolean), ws_net_profit BETWEEN 150 AND 300 (type: boolean), ws_net_profit BETWEEN 50 AND 250 (type: boolean), ws_sales_price BETWEEN 100 AND 150 (type: boolean), ws_sales_price BETWEEN 50 AND 100 (type: boolean), ws_sales_price BETWEEN 150 AND 200 (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8, _col9
                      Statistics: Num rows: 7197262943 Data size: 374254084132 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col4, _col5, _col6, _col7, _col8, _col9
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 1446527438 Data size: 63643618368 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint), _col1 (type: bigint)
                            1 _col0 (type: bigint), _col5 (type: bigint)
                          outputColumnNames: _col2, _col4, _col5, _col6, _col7, _col8, _col9, _col15, _col17, _col18, _col20, _col21, _col22, _col29, _col30, _col31, _col32, _col33, _col34
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 27293809337 Data size: 8075930420568 Basic stats: COMPLETE Column stats: COMPLETE
                          Filter Operator
                            predicate: (((_col20 and _col4) or (_col21 and _col5) or (_col22 and _col6)) and ((_col29 and _col30 and _col7) or (_col31 and _col32 and _col8) or (_col33 and _col34 and _col9))) (type: boolean)
                            Statistics: Num rows: 7676383875 Data size: 2271355430664 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col15 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col2, _col17, _col18, _col36
                              input vertices:
                                1 Map 9
                              Statistics: Num rows: 7676383875 Data size: 2493999983279 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: sum(_col2), count(_col2), sum(_col18), count(_col18), sum(_col17), count(_col17)
                                keys: _col36 (type: char(100))
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                                Statistics: Num rows: 672267 Data size: 237310251 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  key expressions: _col0 (type: char(100))
                                  null sort order: a
                                  sort order: +
                                  Map-reduce partition columns: _col0 (type: char(100))
                                  Statistics: Num rows: 672267 Data size: 237310251 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col1 (type: bigint), _col2 (type: bigint), _col3 (type: decimal(17,2)), _col4 (type: bigint), _col5 (type: decimal(17,2)), _col6 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2001) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2001) (type: boolean)
                    Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  filterExpr: (wr_refunded_cdemo_sk is not null and wr_reason_sk is not null and wr_returning_cdemo_sk is not null and wr_refunded_addr_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_168_container, bigKeyColName:wr_returning_cdemo_sk, smallTablePos:1, keyRatio:1.2159376271079288E-5
                  Statistics: Num rows: 720020485 Data size: 187551383168 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (wr_refunded_cdemo_sk is not null and wr_reason_sk is not null and wr_returning_cdemo_sk is not null and wr_refunded_addr_sk is not null) (type: boolean)
                    Statistics: Num rows: 598897702 Data size: 156001245376 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_item_sk (type: bigint), wr_refunded_cdemo_sk (type: bigint), wr_refunded_addr_sk (type: bigint), wr_returning_cdemo_sk (type: bigint), wr_reason_sk (type: bigint), wr_order_number (type: bigint), wr_fee (type: decimal(7,2)), wr_refunded_cash (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                      Statistics: Num rows: 598897702 Data size: 156001245376 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col3, _col4, _col5, _col6, _col7, _col9, _col10, _col11
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 50849806 Data size: 7351214920 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col1, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col13, _col14
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 13075666 Data size: 2706663102 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col13 (type: char(1)), _col14 (type: char(20)), _col1 (type: bigint)
                              1 _col1 (type: char(1)), _col2 (type: char(20)), _col0 (type: bigint)
                            outputColumnNames: _col0, _col4, _col5, _col6, _col7, _col9, _col10, _col11, _col18, _col19, _col20, _col21, _col22, _col23
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 13075666 Data size: 679934864 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: bigint), _col5 (type: bigint)
                              null sort order: aa
                              sort order: ++
                              Map-reduce partition columns: _col0 (type: bigint), _col5 (type: bigint)
                              Statistics: Num rows: 13075666 Data size: 679934864 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col4 (type: bigint), _col6 (type: decimal(7,2)), _col7 (type: decimal(7,2)), _col9 (type: boolean), _col10 (type: boolean), _col11 (type: boolean), _col18 (type: boolean), _col19 (type: boolean), _col20 (type: boolean), _col21 (type: boolean), _col22 (type: boolean), _col23 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: ((ca_state) IN (&apos;TX&apos;, &apos;VA&apos;, &apos;CA&apos;, &apos;AR&apos;, &apos;NE&apos;, &apos;MO&apos;, &apos;IA&apos;, &apos;MS&apos;, &apos;WA&apos;) and (ca_country = &apos;United States&apos;)) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 6207500000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ca_state) IN (&apos;TX&apos;, &apos;VA&apos;, &apos;CA&apos;, &apos;AR&apos;, &apos;NE&apos;, &apos;MO&apos;, &apos;IA&apos;, &apos;MS&apos;, &apos;WA&apos;) and (ca_country = &apos;United States&apos;)) (type: boolean)
                    Statistics: Num rows: 2759434 Data size: 527051894 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint), (ca_state) IN (&apos;TX&apos;, &apos;VA&apos;, &apos;CA&apos;) (type: boolean), (ca_state) IN (&apos;AR&apos;, &apos;NE&apos;, &apos;MO&apos;) (type: boolean), (ca_state) IN (&apos;IA&apos;, &apos;MS&apos;, &apos;WA&apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2759434 Data size: 55188680 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 2759434 Data size: 55188680 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: boolean), _col2 (type: boolean), _col3 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: cd2
                  filterExpr: ((cd_marital_status) IN (&apos;M&apos;, &apos;S&apos;, &apos;D&apos;) and (cd_education_status) IN (&apos;4 yr Degree         &apos;, &apos;College             &apos;, &apos;Secondary           &apos;)) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 359189600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_marital_status) IN (&apos;M&apos;, &apos;S&apos;, &apos;D&apos;) and (cd_education_status) IN (&apos;4 yr Degree         &apos;, &apos;College             &apos;, &apos;Secondary           &apos;)) (type: boolean)
                    Statistics: Num rows: 493920 Data size: 92363040 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint), cd_marital_status (type: char(1)), cd_education_status (type: char(20))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 493920 Data size: 92363040 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 493920 Data size: 92363040 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(1)), _col2 (type: char(20))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: cd1
                  filterExpr: ((cd_marital_status) IN (&apos;M&apos;, &apos;S&apos;, &apos;D&apos;) and (cd_education_status) IN (&apos;4 yr Degree         &apos;, &apos;College             &apos;, &apos;Secondary           &apos;)) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 359189600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_marital_status) IN (&apos;M&apos;, &apos;S&apos;, &apos;D&apos;) and (cd_education_status) IN (&apos;4 yr Degree         &apos;, &apos;College             &apos;, &apos;Secondary           &apos;)) (type: boolean)
                    Statistics: Num rows: 493920 Data size: 92363040 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint), cd_marital_status (type: char(1)), cd_education_status (type: char(20)), (cd_marital_status = &apos;M&apos;) (type: boolean), (cd_education_status = &apos;4 yr Degree         &apos;) (type: boolean), (cd_marital_status = &apos;S&apos;) (type: boolean), (cd_education_status = &apos;College             &apos;) (type: boolean), (cd_marital_status = &apos;D&apos;) (type: boolean), (cd_education_status = &apos;Secondary           &apos;) (type: boolean)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 493920 Data size: 104217120 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: char(1)), _col2 (type: char(20)), _col0 (type: bigint)
                        null sort order: aaa
                        sort order: +++
                        Map-reduce partition columns: _col1 (type: char(1)), _col2 (type: char(20)), _col0 (type: bigint)
                        Statistics: Num rows: 493920 Data size: 104217120 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col3 (type: boolean), _col4 (type: boolean), _col5 (type: boolean), _col6 (type: boolean), _col7 (type: boolean), _col8 (type: boolean)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: reason
                  Statistics: Num rows: 70 Data size: 7350 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: r_reason_sk (type: bigint), r_reason_desc (type: char(100))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 70 Data size: 7350 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 70 Data size: 7350 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(100))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1), sum(VALUE._col2), count(VALUE._col3), sum(VALUE._col4), count(VALUE._col5)
                keys: KEY._col0 (type: char(100))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 69 Data size: 24357 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: ++++
                  keys: substr(_col0, 1, 20) (type: string), (UDFToDouble(_col1) / _col2) (type: double), (_col3 / _col4) (type: decimal(37,22)), (_col5 / _col6) (type: decimal(37,22))
                  null sort order: zzzz
                  Statistics: Num rows: 69 Data size: 24357 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: (UDFToDouble(_col1) / _col2) (type: double), (_col3 / _col4) (type: decimal(37,22)), (_col5 / _col6) (type: decimal(37,22)), substr(_col0, 1, 20) (type: string)
                    outputColumnNames: _col4, _col5, _col6, _col7
                    Statistics: Num rows: 69 Data size: 45264 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col7 (type: string), _col4 (type: double), _col5 (type: decimal(37,22)), _col6 (type: decimal(37,22))
                      null sort order: zzzz
                      sort order: ++++
                      Statistics: Num rows: 69 Data size: 45264 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: double), KEY.reducesinkkey2 (type: decimal(37,22)), KEY.reducesinkkey3 (type: decimal(37,22))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 69 Data size: 45264 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 69 Data size: 45264 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 69 Data size: 45264 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query85
explain select  substr(r_reason_desc,1,20) ,avg(ws_quantity) ,avg(wr_refunded_cash) ,avg(wr_fee) from web_sales, web_returns, web_page, customer_demographics cd1, customer_demographics cd2, customer_address, date_dim, reason where ws_web_page_sk = wp_web_page_sk and ws_item_sk = wr_item_sk and ws_order_number = wr_order_number and ws_sold_date_sk = d_date_sk and d_year = 2001 and cd1.cd_demo_sk = wr_refunded_cdemo_sk and cd2.cd_demo_sk = wr_returning_cdemo_sk and ca_address_sk = wr_refunded_addr_sk and r_reason_sk = wr_reason_sk and ( ( cd1.cd_marital_status = &apos;M&apos; and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = &apos;4 yr Degree&apos; and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 100.00 and 150.00 ) or ( cd1.cd_marital_status = &apos;S&apos; and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = &apos;College&apos; and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 50.00 and 100.00 ) or ( cd1.cd_marital_status = &apos;D&apos; and cd1.cd_marital_status = cd2.cd_marital_status and cd1.cd_education_status = &apos;Secondary&apos; and cd1.cd_education_status = cd2.cd_education_status and ws_sales_price between 150.00 and 200.00 ) ) and ( ( ca_country = &apos;United States&apos; and ca_state in (&apos;TX&apos;, &apos;VA&apos;, &apos;CA&apos;) and ws_net_profit between 100 and 200 ) or ( ca_country = &apos;United States&apos; and ca_state in (&apos;AR&apos;, &apos;NE&apos;, &apos;MO&apos;) and ws_net_profit between 150 and 300 ) or ( ca_country = &apos;United States&apos; and ca_state in (&apos;IA&apos;, &apos;MS&apos;, &apos;WA&apos;) and ws_net_profit between 50 and 250 ) ) group by r_reason_desc order by substr(r_reason_desc,1,20) ,avg(ws_quantity) ,avg(wr_refunded_cash) ,avg(wr_fee) limit 100

</samplerData>
</sample>
<sample t="2280" lt="2273" ts="1600985053501" s="true" lb="query86" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="13171" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220411_7900e9ff-c295-4086-81b4-294979069617:294
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924220411_7900e9ff-c295-4086-81b4-294979069617:294
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_53_container, bigKeyColName:ws_item_sk, smallTablePos:1, keyRatio:0.19660190603019242
                  Statistics: Num rows: 7198162681 Data size: 921264182880 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_item_sk (type: bigint), ws_net_paid (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 7198162681 Data size: 921264182880 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 5
                      Statistics: Num rows: 1415172503 Data size: 169720060072 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col5, _col6
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 1415172503 Data size: 415960075594 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col6 (type: char(50)), _col5 (type: char(50)), _col1 (type: decimal(7,2))
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1415172503 Data size: 415960075594 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col2)
                            keys: _col0 (type: char(50)), _col1 (type: char(50)), 0L (type: bigint)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3
                            Statistics: Num rows: 5308875 Data size: 1603280250 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: bigint)
                              null sort order: aaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: bigint)
                              Statistics: Num rows: 5308875 Data size: 1603280250 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col3 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: d1
                  filterExpr: d_month_seq BETWEEN 1215 AND 1226 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1215 AND 1226 (type: boolean)
                    Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: item
                  Statistics: Num rows: 402000 Data size: 76380000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: i_item_sk (type: bigint), i_class (type: char(50)), i_category (type: char(50))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 402000 Data size: 76380000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 402000 Data size: 76380000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(50)), _col2 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(50)), KEY._col1 (type: char(50)), KEY._col2 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 3267 Data size: 986634 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col3 (type: decimal(17,2)), _col2 (type: bigint)
                  outputColumnNames: _col0, _col1, _col2, _col3
                  Statistics: Num rows: 3267 Data size: 986634 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: (grouping(_col3, 1L) + grouping(_col3, 0L)) (type: bigint), CASE WHEN ((grouping(_col3, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(50))) END (type: char(50)), _col2 (type: decimal(17,2))
                    null sort order: aaa
                    sort order: ++-
                    Map-reduce partition columns: (grouping(_col3, 1L) + grouping(_col3, 0L)) (type: bigint), CASE WHEN ((grouping(_col3, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(50))) END (type: char(50))
                    Statistics: Num rows: 3267 Data size: 986634 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col3 (type: bigint)
        Reducer 3 
            Execution mode: llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: char(50)), VALUE._col1 (type: char(50)), KEY.reducesinkkey2 (type: decimal(17,2)), VALUE._col2 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 3267 Data size: 986634 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: char(50), _col1: char(50), _col2: decimal(17,2), _col3: bigint
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col2 DESC NULLS FIRST
                        partition by: (grouping(_col3, 1L) + grouping(_col3, 0L)), CASE WHEN ((grouping(_col3, 0L) = UDFToLong(0))) THEN (_col0) ELSE (CAST( null AS CHAR(50))) END
                        raw input shape:
                        window functions:
                            window function definition
                              alias: rank_window_0
                              arguments: _col2
                              name: rank
                              window function: GenericUDAFRankEvaluator
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                              isPivotResult: true
                  Statistics: Num rows: 3267 Data size: 986634 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: -++
                    keys: (grouping(_col3, 1L) + grouping(_col3, 0L)) (type: bigint), CASE WHEN (((grouping(_col3, 1L) + grouping(_col3, 0L)) = 0L)) THEN (_col0) ELSE (null) END (type: char(50)), rank_window_0 (type: int)
                    null sort order: azz
                    Statistics: Num rows: 3267 Data size: 986634 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: _col2 (type: decimal(17,2)), _col0 (type: char(50)), _col1 (type: char(50)), (grouping(_col3, 1L) + grouping(_col3, 0L)) (type: bigint), rank_window_0 (type: int), CASE WHEN (((grouping(_col3, 1L) + grouping(_col3, 0L)) = 0L)) THEN (_col0) ELSE (null) END (type: char(50))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 3267 Data size: 1437480 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col3 (type: bigint), _col5 (type: char(50)), _col4 (type: int)
                        null sort order: azz
                        sort order: -++
                        Statistics: Num rows: 3267 Data size: 1437480 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
                        value expressions: _col0 (type: decimal(17,2)), _col1 (type: char(50)), _col2 (type: char(50))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: decimal(17,2)), VALUE._col1 (type: char(50)), VALUE._col2 (type: char(50)), KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey2 (type: int)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 3267 Data size: 1437480 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 44000 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 44000 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query86
explain select sum(ws_net_paid) as total_sum ,i_category ,i_class ,grouping(i_category)+grouping(i_class) as lochierarchy ,rank() over ( partition by grouping(i_category)+grouping(i_class), case when grouping(i_class) = 0 then i_category end order by sum(ws_net_paid) desc) as rank_within_parent from web_sales ,date_dim       d1 ,item where d1.d_month_seq between 1215 and 1215+11 and d1.d_date_sk = ws_sold_date_sk and i_item_sk  = ws_item_sk group by rollup(i_category,i_class) order by lochierarchy desc, case when lochierarchy = 0 then i_category end, rank_within_parent limit 100

</samplerData>
</sample>
<sample t="4185" lt="4178" ts="1600985057687" s="true" lb="query87" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="32688" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220413_73e9d2c2-d1b8-4f1e-b467-d08c0ad09b43:295
      Edges:
        Map 1 &lt;- Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Map 10 &lt;- Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Map 12 &lt;- Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 11 &lt;- Map 10 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 13 &lt;- Map 12 (SIMPLE_EDGE), Union 5 (CONTAINS)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE), Union 3 (CONTAINS)
        Reducer 4 &lt;- Union 3 (SIMPLE_EDGE), Union 5 (CONTAINS)
        Reducer 6 &lt;- Union 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220413_73e9d2c2-d1b8-4f1e-b467-d08c0ad09b43:295
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_164_container, bigKeyColName:ss_customer_sk, smallTablePos:1, keyRatio:0.19196890740298356
                  Statistics: Num rows: 27503885621 Data size: 434877053936 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 26855746120 Data size: 424629011144 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 5279890872 Data size: 332850089032 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col3, _col5, _col6
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 5279890872 Data size: 1246054245792 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col6 (type: char(30)), _col5 (type: char(20)), _col3 (type: date)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 2639945436 Data size: 623027122896 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              null sort order: aaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              Statistics: Num rows: 2639945436 Data size: 623027122896 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_166_container, bigKeyColName:cs_bill_customer_sk, smallTablePos:1, keyRatio:0.19472155195578444
                  Statistics: Num rows: 14327953968 Data size: 228959210704 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: cs_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 14291947369 Data size: 228383829008 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_bill_customer_sk (type: bigint), cs_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 14291947369 Data size: 228383829008 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 2789961433 Data size: 178270202816 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col3, _col5, _col6
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 2789961433 Data size: 658430898188 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col6 (type: char(30)), _col5 (type: char(20)), _col3 (type: date)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 1394980716 Data size: 329215448976 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              null sort order: aaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              Statistics: Num rows: 1394980716 Data size: 329215448976 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_bill_customer_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_168_container, bigKeyColName:ws_bill_customer_sk, smallTablePos:1, keyRatio:0.19657739533102947
                  Statistics: Num rows: 7198162681 Data size: 115163423680 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_bill_customer_sk is not null (type: boolean)
                    Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_bill_customer_sk (type: bigint), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 7197265278 Data size: 115149066128 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col3
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 1414996071 Data size: 90552570224 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col3, _col5, _col6
                          input vertices:
                            1 Map 9
                          Statistics: Num rows: 1414996071 Data size: 333939072756 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            keys: _col6 (type: char(30)), _col5 (type: char(20)), _col3 (type: date)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2
                            Statistics: Num rows: 707498035 Data size: 166969536260 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              null sort order: aaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              Statistics: Num rows: 707498035 Data size: 166969536260 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_month_seq BETWEEN 1221 AND 1232 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4967332 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1221 AND 1232 (type: boolean)
                    Statistics: Num rows: 359 Data size: 24412 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_date (type: date)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 10
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 22976 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: date)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 12
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: customer
                  Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: c_customer_sk (type: bigint), c_first_name (type: char(20)), c_last_name (type: char(30))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 65000000 Data size: 12220000000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(20)), _col2 (type: char(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 697490358 Data size: 164607724488 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(20)), _col0 (type: char(30)), _col2 (type: date)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 697490358 Data size: 164607724488 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    keys: _col1 (type: char(30)), _col0 (type: char(20)), _col2 (type: date)
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 348745179 Data size: 85093823676 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date), 1L (type: bigint), _col3 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 348745179 Data size: 87883785108 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date), _col4 (type: bigint), (_col3 * _col4) (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 1008731538 Data size: 254200347576 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col3), sum(_col4)
                          keys: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4
                          Statistics: Num rows: 504365769 Data size: 127100173788 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                            Statistics: Num rows: 504365769 Data size: 127100173788 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint), _col4 (type: bigint)
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 353749017 Data size: 83484768012 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(20)), _col0 (type: char(30)), _col2 (type: date)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 353749017 Data size: 83484768012 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    keys: _col1 (type: char(30)), _col0 (type: char(20)), _col2 (type: date)
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 176874508 Data size: 43157379952 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date), 1L (type: bigint), _col3 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 176874508 Data size: 44572376016 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date), _col4 (type: bigint), (_col3 * _col4) (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 197889748 Data size: 49868216496 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col3), sum(_col4)
                          keys: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4
                          Statistics: Num rows: 98944874 Data size: 24934108248 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                            Statistics: Num rows: 98944874 Data size: 24934108248 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint), _col4 (type: bigint)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1319972718 Data size: 311513561448 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(20)), _col0 (type: char(30)), _col2 (type: date)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1319972718 Data size: 311513561448 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: count()
                    keys: _col1 (type: char(30)), _col0 (type: char(20)), _col2 (type: date)
                    mode: complete
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 659986359 Data size: 161036671596 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date), 2L (type: bigint), _col3 (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4
                      Statistics: Num rows: 659986359 Data size: 166316562468 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date), _col4 (type: bigint), (_col3 * _col4) (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 1008731538 Data size: 254200347576 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col3), sum(_col4)
                          keys: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4
                          Statistics: Num rows: 504365769 Data size: 127100173788 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                            null sort order: aaa
                            sort order: +++
                            Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                            Statistics: Num rows: 504365769 Data size: 127100173788 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col3 (type: bigint), _col4 (type: bigint)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 252182884 Data size: 63550086768 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: ((_col3 &gt; 0L) and ((_col3 * 2L) = _col4)) (type: boolean)
                  Statistics: Num rows: 42030480 Data size: 10591680960 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 42030480 Data size: 10591680960 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: count()
                      keys: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                      mode: complete
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 21015240 Data size: 5127718560 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date), 2L (type: bigint), _col3 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2, _col3, _col4
                        Statistics: Num rows: 21015240 Data size: 5295840480 Basic stats: COMPLETE Column stats: COMPLETE
                        Select Operator
                          expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date), _col4 (type: bigint), (_col3 * _col4) (type: bigint)
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4
                          Statistics: Num rows: 197889748 Data size: 49868216496 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col3), sum(_col4)
                            keys: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0, _col1, _col2, _col3, _col4
                            Statistics: Num rows: 98944874 Data size: 24934108248 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              null sort order: aaa
                              sort order: +++
                              Map-reduce partition columns: _col0 (type: char(30)), _col1 (type: char(20)), _col2 (type: date)
                              Statistics: Num rows: 98944874 Data size: 24934108248 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col3 (type: bigint), _col4 (type: bigint)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: char(30)), KEY._col1 (type: char(20)), KEY._col2 (type: date)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4
                Statistics: Num rows: 49472437 Data size: 12467054124 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col3 (type: bigint), _col4 (type: bigint)
                  outputColumnNames: _col3, _col4
                  Statistics: Num rows: 49472437 Data size: 791558992 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((_col3 &gt; 0L) and ((_col3 * 2L) = _col4)) (type: boolean)
                    Statistics: Num rows: 8245406 Data size: 131926496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      Statistics: Num rows: 8245406 Data size: 131926496 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        aggregations: count()
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          null sort order: 
                          sort order: 
                          Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col0 (type: bigint)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Union 3 
            Vertex: Union 3
        Union 5 
            Vertex: Union 5

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query87
explain select count(*) from ((select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) except (select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) except (select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) ) cool_cust

</samplerData>
</sample>
<sample t="2583" lt="2577" ts="1600985060273" s="true" lb="query89" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="19137" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220417_391503ab-0bfc-497c-ade4-c20ae5a3abb5:296
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924220417_391503ab-0bfc-497c-ade4-c20ae5a3abb5:296
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_store_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_82_container, bigKeyColName:ss_store_sk, smallTablePos:1, keyRatio:0.0027806961188642154
                  Statistics: Num rows: 27503885621 Data size: 3662775584312 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ss_store_sk is not null (type: boolean)
                    Statistics: Num rows: 26856185846 Data size: 3576519447520 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_item_sk (type: bigint), ss_store_sk (type: bigint), ss_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 26856185846 Data size: 3576519447520 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col5, _col6, _col7
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 380529452 Data size: 110353541200 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col3 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col5, _col6, _col7, _col9
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 76479948 Data size: 21873265248 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col5, _col6, _col7, _col9, _col11, _col12
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 76479948 Data size: 35563175932 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col5 (type: char(50)), _col6 (type: char(50)), _col7 (type: char(50)), _col9 (type: int), _col11 (type: varchar(50)), _col12 (type: varchar(50))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                              Statistics: Num rows: 5504400 Data size: 3176038800 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: int), _col4 (type: varchar(50)), _col5 (type: varchar(50))
                                null sort order: aaaaaa
                                sort order: ++++++
                                Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: int), _col4 (type: varchar(50)), _col5 (type: varchar(50))
                                Statistics: Num rows: 5504400 Data size: 3176038800 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col6 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: ((i_class) IN (&apos;glassware                                         &apos;, &apos;classical                                         &apos;, &apos;fiction                                           &apos;, &apos;semi-precious                                     &apos;, &apos;baseball                                          &apos;, &apos;dresses                                           &apos;) and (i_category) IN (&apos;Home                                              &apos;, &apos;Music                                             &apos;, &apos;Books                                             &apos;, &apos;Jewelry                                           &apos;, &apos;Sports                                            &apos;, &apos;Women                                             &apos;) and (((i_category) IN (&apos;Home                                              &apos;, &apos;Music                                             &apos;, &apos;Books                                             &apos;) and (i_class) IN (&apos;glassware                                         &apos;, &apos;classical                                         &apos;, &apos;fiction                                           &apos;)) or ((i_category) IN (&apos;Jewelry                                           &apos;, &apos;Sports                                            &apos;, &apos;Women                                             &apos;) and (i_class) IN (&apos;semi-precious                                     &apos;, &apos;baseball                                          &apos;, &apos;dresses                                           &apos;)))) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 116580000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((i_class) IN (&apos;glassware                                         &apos;, &apos;classical                                         &apos;, &apos;fiction                                           &apos;, &apos;semi-precious                                     &apos;, &apos;baseball                                          &apos;, &apos;dresses                                           &apos;) and (i_category) IN (&apos;Home                                              &apos;, &apos;Music                                             &apos;, &apos;Books                                             &apos;, &apos;Jewelry                                           &apos;, &apos;Sports                                            &apos;, &apos;Women                                             &apos;) and (((i_category) IN (&apos;Home                                              &apos;, &apos;Music                                             &apos;, &apos;Books                                             &apos;) and (i_class) IN (&apos;glassware                                         &apos;, &apos;classical                                         &apos;, &apos;fiction                                           &apos;)) or ((i_category) IN (&apos;Jewelry                                           &apos;, &apos;Sports                                            &apos;, &apos;Women                                             &apos;) and (i_class) IN (&apos;semi-precious                                     &apos;, &apos;baseball                                          &apos;, &apos;dresses                                           &apos;)))) (type: boolean)
                    Statistics: Num rows: 5696 Data size: 1651840 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_brand (type: char(50)), i_class (type: char(50)), i_category (type: char(50))
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 5696 Data size: 1651840 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 5696 Data size: 1651840 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (d_year = 2000) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (d_year = 2000) (type: boolean)
                    Statistics: Num rows: 367 Data size: 5872 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint), d_moy (type: int)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 367 Data size: 4404 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: int)
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 367 Data size: 2936 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013624
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 183 Data size: 1464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: store
                  Statistics: Num rows: 1500 Data size: 280500 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: s_store_sk (type: bigint), s_store_name (type: varchar(50)), s_company_name (type: varchar(50))
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1500 Data size: 280500 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1500 Data size: 280500 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(50)), _col2 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(50)), KEY._col1 (type: char(50)), KEY._col2 (type: char(50)), KEY._col3 (type: int), KEY._col4 (type: varchar(50)), KEY._col5 (type: varchar(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 39600 Data size: 22849200 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col2 (type: char(50)), _col0 (type: char(50)), _col4 (type: varchar(50)), _col5 (type: varchar(50))
                  null sort order: aaaa
                  sort order: ++++
                  Map-reduce partition columns: _col2 (type: char(50)), _col0 (type: char(50)), _col4 (type: varchar(50)), _col5 (type: varchar(50))
                  Statistics: Num rows: 39600 Data size: 22849200 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col1 (type: char(50)), _col3 (type: int), _col6 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: char(50)), VALUE._col0 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col1 (type: int), KEY.reducesinkkey2 (type: varchar(50)), KEY.reducesinkkey3 (type: varchar(50)), VALUE._col2 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 39600 Data size: 22849200 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: char(50), _col1: char(50), _col2: char(50), _col3: int, _col4: varchar(50), _col5: varchar(50), _col6: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col2 ASC NULLS FIRST, _col0 ASC NULLS FIRST, _col4 ASC NULLS FIRST, _col5 ASC NULLS FIRST
                        partition by: _col2, _col0, _col4, _col5
                        raw input shape:
                        window functions:
                            window function definition
                              alias: avg_window_0
                              arguments: _col6
                              name: avg
                              window function: GenericUDAFAverageEvaluatorDecimal
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  Statistics: Num rows: 39600 Data size: 22849200 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: avg_window_0 (type: decimal(21,6)), _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col3 (type: int), _col4 (type: varchar(50)), _col5 (type: varchar(50)), _col6 (type: decimal(17,2))
                    outputColumnNames: avg_window_0, _col0, _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 39600 Data size: 22849200 Basic stats: COMPLETE Column stats: COMPLETE
                    Filter Operator
                      predicate: CASE WHEN ((avg_window_0 &lt;&gt; 0)) THEN (((abs((_col6 - avg_window_0)) / avg_window_0) &gt; 0.1)) ELSE (false) END (type: boolean)
                      Statistics: Num rows: 19800 Data size: 13642200 Basic stats: COMPLETE Column stats: COMPLETE
                      Top N Key Operator
                        sort order: ++
                        keys: (_col6 - avg_window_0) (type: decimal(22,6)), _col4 (type: varchar(50))
                        null sort order: zz
                        Statistics: Num rows: 19800 Data size: 13642200 Basic stats: COMPLETE Column stats: COMPLETE
                        top n: 100
                        Select Operator
                          expressions: _col2 (type: char(50)), _col1 (type: char(50)), _col0 (type: char(50)), _col4 (type: varchar(50)), _col5 (type: varchar(50)), _col3 (type: int), _col6 (type: decimal(17,2)), avg_window_0 (type: decimal(21,6)), (_col6 - avg_window_0) (type: decimal(22,6))
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                          Statistics: Num rows: 19800 Data size: 15859800 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col8 (type: decimal(22,6)), _col3 (type: varchar(50))
                            null sort order: zz
                            sort order: ++
                            Statistics: Num rows: 19800 Data size: 15859800 Basic stats: COMPLETE Column stats: COMPLETE
                            TopN Hash Memory Usage: 0.04
                            value expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(50)), _col4 (type: varchar(50)), _col5 (type: int), _col6 (type: decimal(17,2)), _col7 (type: decimal(21,6))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: char(50)), VALUE._col1 (type: char(50)), VALUE._col2 (type: char(50)), KEY.reducesinkkey1 (type: varchar(50)), VALUE._col3 (type: varchar(50)), VALUE._col4 (type: int), VALUE._col5 (type: decimal(17,2)), VALUE._col6 (type: decimal(21,6))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 19800 Data size: 15859800 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 80100 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 80100 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query89
explain select  * from( select i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum(ss_sales_price) sum_sales, avg(sum(ss_sales_price)) over (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales from item, store_sales, date_dim, store where ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and ss_store_sk = s_store_sk and d_year in (2000) and ((i_category in (&apos;Home&apos;,&apos;Music&apos;,&apos;Books&apos;) and i_class in (&apos;glassware&apos;,&apos;classical&apos;,&apos;fiction&apos;) ) or (i_category in (&apos;Jewelry&apos;,&apos;Sports&apos;,&apos;Women&apos;) and i_class in (&apos;semi-precious&apos;,&apos;baseball&apos;,&apos;dresses&apos;) )) group by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) tmp1 where case when (avg_monthly_sales &lt;&gt; 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end &gt; 0.1 order by sum_sales - avg_monthly_sales, s_store_name limit 100

</samplerData>
</sample>
<sample t="2946" lt="2940" ts="1600985063220" s="true" lb="query90" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="15222" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220420_78f99a5c-d0b9-453a-b9e1-75e963c0ed74:297
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Reducer 4 (BROADCAST_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220420_78f99a5c-d0b9-453a-b9e1-75e963c0ed74:297
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: (ws_sold_time_sk is not null and ws_web_page_sk is not null and ws_ship_hdemo_sk is not null) (type: boolean)
                  Statistics: Num rows: 7199963324 Data size: 172755927248 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_sold_time_sk is not null and ws_web_page_sk is not null and ws_ship_hdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 7194565605 Data size: 172626414368 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_sold_time_sk (type: bigint), ws_ship_hdemo_sk (type: bigint), ws_web_page_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7194565605 Data size: 172626414368 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 5
                        Statistics: Num rows: 1837292879 Data size: 29367915168 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1
                          input vertices:
                            1 Map 6
                          Statistics: Num rows: 153107745 Data size: 1210485280 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            input vertices:
                              1 Map 7
                            Statistics: Num rows: 15310775 Data size: 122486200 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: count()
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0
                              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                null sort order: 
                                sort order: 
                                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col0 (type: bigint)
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 153107745 Data size: 1210485280 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            input vertices:
                              1 Map 9
                            Statistics: Num rows: 15310775 Data size: 122486200 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: count()
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0
                              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                null sort order: 
                                sort order: 
                                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: web_page
                  filterExpr: wp_char_count BETWEEN 5000 AND 5200 (type: boolean)
                  Statistics: Num rows: 4002 Data size: 47796 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: wp_char_count BETWEEN 5000 AND 5200 (type: boolean)
                    Statistics: Num rows: 1022 Data size: 12208 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wp_web_page_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1022 Data size: 8176 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1022 Data size: 8176 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: time_dim
                  filterExpr: t_hour BETWEEN 9 AND 10 (type: boolean)
                  Statistics: Num rows: 86400 Data size: 1036800 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: t_hour BETWEEN 9 AND 10 (type: boolean)
                    Statistics: Num rows: 7200 Data size: 86400 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: t_time_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: (hd_dep_count = 3) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 86400 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (hd_dep_count = 3) (type: boolean)
                    Statistics: Num rows: 720 Data size: 8640 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 720 Data size: 5760 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 720 Data size: 5760 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: time_dim
                  filterExpr: t_hour BETWEEN 16 AND 17 (type: boolean)
                  Statistics: Num rows: 86400 Data size: 1036800 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: t_hour BETWEEN 16 AND 17 (type: boolean)
                    Statistics: Num rows: 7200 Data size: 86400 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: t_time_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 7200 Data size: 57600 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: (hd_dep_count = 3) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 86400 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (hd_dep_count = 3) (type: boolean)
                    Statistics: Num rows: 720 Data size: 8640 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 720 Data size: 5760 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 720 Data size: 5760 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 
                    1 
                  outputColumnNames: _col0, _col1
                  input vertices:
                    1 Reducer 4
                  Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                  Top N Key Operator
                    sort order: +
                    keys: (CAST( _col0 AS decimal(15,4)) / CAST( _col1 AS decimal(15,4))) (type: decimal(35,20))
                    null sort order: z
                    Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                    top n: 100
                    Select Operator
                      expressions: (CAST( _col0 AS decimal(15,4)) / CAST( _col1 AS decimal(15,4))) (type: decimal(35,20))
                      outputColumnNames: _col0
                      Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: decimal(35,20))
                        null sort order: z
                        sort order: +
                        Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                        TopN Hash Memory Usage: 0.04
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: decimal(35,20))
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint)

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query90
explain select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio from ( select count(*) amc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 9 and 9+1 and household_demographics.hd_dep_count = 3 and web_page.wp_char_count between 5000 and 5200) at, ( select count(*) pmc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 16 and 16+1 and household_demographics.hd_dep_count = 3 and web_page.wp_char_count between 5000 and 5200) pt order by am_pm_ratio limit 100

</samplerData>
</sample>
<sample t="3927" lt="3921" ts="1600985067148" s="true" lb="query91" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="16453" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220423_2e8ad934-1d01-40fa-baaa-b570d0832ce0:298
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 8 (BROADCAST_EDGE)
        Map 5 &lt;- Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924220423_2e8ad934-1d01-40fa-baaa-b570d0832ce0:298
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_returns
                  filterExpr: (cr_call_center_sk is not null and cr_returning_customer_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_112_container, bigKeyColName:cr_returning_customer_sk, smallTablePos:1, keyRatio:8.08966120495707E-4
                  Statistics: Num rows: 1440033112 Data size: 192156238616 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cr_call_center_sk is not null and cr_returning_customer_sk is not null) (type: boolean)
                    Statistics: Num rows: 1383006403 Data size: 184546665112 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cr_returning_customer_sk (type: bigint), cr_call_center_sk (type: bigint), cr_net_loss (type: decimal(7,2)), cr_returned_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 1383006403 Data size: 184546665112 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col3 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1, _col2
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 20386407 Data size: 128 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col0 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col2, _col9, _col10
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 1164938 Data size: 208524022 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col2, _col9, _col10, _col13, _col14, _col15
                            input vertices:
                              1 Map 8
                            Statistics: Num rows: 1164938 Data size: 648870394 Basic stats: COMPLETE Column stats: PARTIAL
                            Group By Operator
                              aggregations: sum(_col2)
                              keys: _col9 (type: char(1)), _col10 (type: char(20)), _col13 (type: string), _col14 (type: varchar(50)), _col15 (type: varchar(40))
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                              Statistics: Num rows: 33858 Data size: 22651002 Basic stats: COMPLETE Column stats: PARTIAL
                              Reduce Output Operator
                                key expressions: _col0 (type: char(1)), _col1 (type: char(20)), _col2 (type: string), _col3 (type: varchar(50)), _col4 (type: varchar(40))
                                null sort order: aaaaa
                                sort order: +++++
                                Map-reduce partition columns: _col0 (type: char(1)), _col1 (type: char(20)), _col2 (type: string), _col3 (type: varchar(50)), _col4 (type: varchar(40))
                                Statistics: Num rows: 33858 Data size: 22651002 Basic stats: COMPLETE Column stats: PARTIAL
                                value expressions: _col5 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 1168784 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((d_year = 2000) and (d_moy = 12)) (type: boolean)
                    Statistics: Num rows: 31 Data size: 496 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 31 Data size: 248 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.516129
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cr_returned_date_sk (bigint)
                            Target Input: catalog_returns
                            Partition key expr: cr_returned_date_sk
                            Statistics: Num rows: 15 Data size: 120 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: tpcds_bin_partitioned_orc_10000.customer_customer_address_1
                  filterExpr: ((ca_gmt_offset = -7) and c_current_hdemo_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_111_container, bigKeyColName:c_current_hdemo_sk, smallTablePos:1, keyRatio:0.004434692307692308
                  Statistics: Num rows: 65000000 Data size: 8585364048 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((ca_gmt_offset = -7) and c_current_hdemo_sk is not null and c_current_cdemo_sk is not null) (type: boolean)
                    Statistics: Num rows: 10088923 Data size: 1332570568 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: c_customer_sk (type: bigint), c_current_cdemo_sk (type: bigint), c_current_hdemo_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 10088923 Data size: 236489400 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col4, _col5
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 576510 Data size: 109597026 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col4, _col5
                          input vertices:
                            1 Map 7
                          Statistics: Num rows: 288255 Data size: 53903685 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 288255 Data size: 53903685 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col4 (type: char(1)), _col5 (type: char(20))
            Execution mode: vectorized, llap
            LLAP IO: all inputs
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: customer_demographics
                  filterExpr: ((cd_marital_status) IN (&apos;M&apos;, &apos;W&apos;) and (cd_education_status) IN (&apos;Unknown             &apos;, &apos;Advanced Degree     &apos;) and (struct(cd_marital_status,cd_education_status)) IN (const struct(&apos;M&apos;,&apos;Unknown             &apos;), const struct(&apos;W&apos;,&apos;Advanced Degree     &apos;))) (type: boolean)
                  Statistics: Num rows: 1920800 Data size: 359189600 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((cd_marital_status) IN (&apos;M&apos;, &apos;W&apos;) and (cd_education_status) IN (&apos;Unknown             &apos;, &apos;Advanced Degree     &apos;) and (struct(cd_marital_status,cd_education_status)) IN (const struct(&apos;M&apos;,&apos;Unknown             &apos;), const struct(&apos;W&apos;,&apos;Advanced Degree     &apos;))) (type: boolean)
                    Statistics: Num rows: 109760 Data size: 20525120 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cd_demo_sk (type: bigint), cd_marital_status (type: char(1)), cd_education_status (type: char(20))
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 109760 Data size: 20525120 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 109760 Data size: 20525120 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(1)), _col2 (type: char(20))
            Execution mode: llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: (hd_buy_potential like &apos;Unknown%&apos;) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 720000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (hd_buy_potential like &apos;Unknown%&apos;) (type: boolean)
                    Statistics: Num rows: 3600 Data size: 360000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 3600 Data size: 28800 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 3600 Data size: 28800 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: call_center
                  Statistics: Num rows: 54 Data size: 20660 Basic stats: COMPLETE Column stats: PARTIAL
                  Select Operator
                    expressions: cc_call_center_sk (type: bigint), cc_call_center_id (type: string), cc_name (type: varchar(50)), cc_manager (type: varchar(40))
                    outputColumnNames: _col0, _col1, _col2, _col3
                    Statistics: Num rows: 54 Data size: 20660 Basic stats: COMPLETE Column stats: PARTIAL
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 54 Data size: 20660 Basic stats: COMPLETE Column stats: PARTIAL
                      value expressions: _col1 (type: string), _col2 (type: varchar(50)), _col3 (type: varchar(40))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(1)), KEY._col1 (type: char(20)), KEY._col2 (type: string), KEY._col3 (type: varchar(50)), KEY._col4 (type: varchar(40))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 10260 Data size: 6863940 Basic stats: COMPLETE Column stats: PARTIAL
                Select Operator
                  expressions: _col2 (type: string), _col3 (type: varchar(50)), _col4 (type: varchar(40)), _col5 (type: decimal(17,2))
                  outputColumnNames: _col0, _col1, _col2, _col4
                  Statistics: Num rows: 10260 Data size: 6176520 Basic stats: COMPLETE Column stats: PARTIAL
                  Reduce Output Operator
                    key expressions: _col4 (type: decimal(17,2))
                    null sort order: a
                    sort order: -
                    Statistics: Num rows: 10260 Data size: 6176520 Basic stats: COMPLETE Column stats: PARTIAL
                    value expressions: _col0 (type: string), _col1 (type: varchar(50)), _col2 (type: varchar(40))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: string), VALUE._col1 (type: varchar(50)), VALUE._col2 (type: varchar(40)), KEY.reducesinkkey0 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3
                Statistics: Num rows: 10260 Data size: 5027400 Basic stats: COMPLETE Column stats: PARTIAL
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 10260 Data size: 5027400 Basic stats: COMPLETE Column stats: PARTIAL
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query91
explain select cc_call_center_id Call_Center, cc_name Call_Center_Name, cc_manager Manager, sum(cr_net_loss) Returns_Loss from call_center, catalog_returns, date_dim, customer, customer_address, customer_demographics, household_demographics where cr_call_center_sk       = cc_call_center_sk and     cr_returned_date_sk     = d_date_sk and     cr_returning_customer_sk= c_customer_sk and     cd_demo_sk              = c_current_cdemo_sk and     hd_demo_sk              = c_current_hdemo_sk and     ca_address_sk           = c_current_addr_sk and     d_year                  = 2000 and     d_moy                   = 12 and     ( (cd_marital_status       = &apos;M&apos; and cd_education_status     = &apos;Unknown&apos;) or(cd_marital_status       = &apos;W&apos; and cd_education_status     = &apos;Advanced Degree&apos;)) and     hd_buy_potential like &apos;Unknown%&apos; and     ca_gmt_offset           = -7 group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status order by sum(cr_net_loss) desc

</samplerData>
</sample>
<sample t="2561" lt="2555" ts="1600985069709" s="true" lb="query92" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="18157" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220427_3cb661c4-0233-4b6b-b0e5-bbd2a6f828ad:299
      Edges:
        Map 1 &lt;- Map 2 (BROADCAST_EDGE)
        Map 4 &lt;- Map 8 (BROADCAST_EDGE), Reducer 3 (BROADCAST_EDGE)
        Reducer 3 &lt;- Map 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 5 &lt;- Map 1 (BROADCAST_EDGE), Map 4 (SIMPLE_EDGE), Map 8 (BROADCAST_EDGE)
        Reducer 6 &lt;- Reducer 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 6 (SIMPLE_EDGE)
      DagName: zabetak_20200924220427_3cb661c4-0233-4b6b-b0e5-bbd2a6f828ad:299
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: ws_ext_discount_amt is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_97_container, bigKeyColName:ws_item_sk, smallTablePos:1, keyRatio:0.0010123112414830403
                  Statistics: Num rows: 7198162681 Data size: 921263901536 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ws_ext_discount_amt is not null (type: boolean)
                    Statistics: Num rows: 7197261594 Data size: 921148575056 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_ext_discount_amt (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7197261594 Data size: 921148575056 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 7286781 Data size: 831798992 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col3 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col3 (type: bigint)
                          Statistics: Num rows: 7286781 Data size: 831798992 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: decimal(7,2)), _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_manufact_id = 356) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 4820000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_manufact_id = 356) (type: boolean)
                    Statistics: Num rows: 407 Data size: 4884 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 407 Data size: 3256 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 407 Data size: 3256 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 407 Data size: 3256 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            null sort order: 
                            sort order: 
                            Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: web_sales
                  filterExpr: (ws_item_sk BETWEEN DynamicValue(RS_25_item_i_item_sk_min) AND DynamicValue(RS_25_item_i_item_sk_max) and in_bloom_filter(ws_item_sk, DynamicValue(RS_25_item_i_item_sk_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 7198162681 Data size: 921263901536 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_item_sk BETWEEN DynamicValue(RS_25_item_i_item_sk_min) AND DynamicValue(RS_25_item_i_item_sk_max) and in_bloom_filter(ws_item_sk, DynamicValue(RS_25_item_i_item_sk_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 7198162681 Data size: 921263901536 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_item_sk (type: bigint), ws_ext_discount_amt (type: decimal(7,2)), ws_sold_date_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 7198162681 Data size: 921263901536 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col1
                        input vertices:
                          1 Map 8
                        Statistics: Num rows: 799741103 Data size: 95868010728 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1), count(_col1)
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2
                          Statistics: Num rows: 8932875 Data size: 1143408000 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 8932875 Data size: 1143408000 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(17,2)), _col2 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 8 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: (CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2001-03-12 00:00:00&apos; AND TIMESTAMP&apos;2001-06-10 00:00:00&apos; or CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2001-03-12 00:00:00&apos; AND TIMESTAMP&apos;2001-06-10 00:00:00&apos;) (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2001-03-12 00:00:00&apos; AND TIMESTAMP&apos;2001-06-10 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2001-03-12 00:00:00&apos; AND TIMESTAMP&apos;2001-06-10 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ws_sold_date_sk (bigint)
                            Target Input: web_sales
                            Partition key expr: ws_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 4
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 5 
            Execution mode: llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), count(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 23821 Data size: 3049088 Basic stats: COMPLETE Column stats: COMPLETE
                Filter Operator
                  predicate: CAST( (1.3 * (_col1 / _col2)) AS decimal(14,7)) is not null (type: boolean)
                  Statistics: Num rows: 23821 Data size: 3049088 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col0 (type: bigint), CAST( (1.3 * (_col1 / _col2)) AS decimal(14,7)) (type: decimal(14,7))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 23821 Data size: 2858520 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col3 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col2, _col5
                      input vertices:
                        0 Map 1
                      Statistics: Num rows: 23821 Data size: 2858632 Basic stats: COMPLETE Column stats: COMPLETE
                      Filter Operator
                        predicate: (_col1 &gt; _col5) (type: boolean)
                        Statistics: Num rows: 7940 Data size: 952912 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1
                          input vertices:
                            1 Map 8
                          Statistics: Num rows: 7940 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                          Group By Operator
                            aggregations: sum(_col1)
                            minReductionHashAggr: 0.99
                            mode: hash
                            outputColumnNames: _col0
                            Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              null sort order: 
                              sort order: 
                              Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col0 (type: decimal(17,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col0 (type: decimal(17,2))
                  null sort order: z
                  Statistics: Num rows: 1 Data size: 112 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col0 (type: decimal(17,2))
                    outputColumnNames: _col1
                    Statistics: Num rows: 1 Data size: 224 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col1 (type: decimal(17,2))
                      null sort order: z
                      sort order: +
                      Statistics: Num rows: 1 Data size: 224 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: decimal(17,2))
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 224 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 224 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 224 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query92
explain select sum(ws_ext_discount_amt)  as `Excess Discount Amount` from web_sales ,item ,date_dim where i_manufact_id = 356 and i_item_sk = ws_item_sk and d_date between &apos;2001-03-12&apos; and (cast(&apos;2001-03-12&apos; as date) + 90 days) and d_date_sk = ws_sold_date_sk and ws_ext_discount_amt &gt; ( SELECT 1.3 * avg(ws_ext_discount_amt) FROM web_sales ,date_dim WHERE ws_item_sk = i_item_sk and d_date between &apos;2001-03-12&apos; and (cast(&apos;2001-03-12&apos; as date) + 90 days) and d_date_sk = ws_sold_date_sk ) order by sum(ws_ext_discount_amt) limit 100

</samplerData>
</sample>
<sample t="6349" lt="6344" ts="1600985076059" s="true" lb="query93" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="8907" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220429_877a3f90-575f-42af-b9fd-fb1a4a2c8600:300
      Edges:
        Map 1 &lt;- Map 2 (BROADCAST_EDGE)
        Map 3 &lt;- Map 1 (BROADCAST_EDGE)
        Reducer 4 &lt;- Map 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (SIMPLE_EDGE)
      DagName: zabetak_20200924220429_877a3f90-575f-42af-b9fd-fb1a4a2c8600:300
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_returns
                  filterExpr: sr_reason_sk is not null (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_63_container, bigKeyColName:sr_reason_sk, smallTablePos:1, keyRatio:1.9895722880353025E-6
                  Statistics: Num rows: 2879513368 Data size: 79417621500 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: sr_reason_sk is not null (type: boolean)
                    Statistics: Num rows: 2778808464 Data size: 76640157772 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: sr_item_sk (type: bigint), sr_reason_sk (type: bigint), sr_ticket_number (type: bigint), sr_return_quantity (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3
                      Statistics: Num rows: 2778808464 Data size: 76640157772 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3
                        input vertices:
                          1 Map 2
                        Statistics: Num rows: 39697264 Data size: 635156228 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col2 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col2 (type: bigint)
                          Statistics: Num rows: 39697264 Data size: 635156228 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col3 (type: int)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: reason
                  filterExpr: (r_reason_desc = &apos;reason 66                                                                                           &apos;) (type: boolean)
                  Statistics: Num rows: 70 Data size: 7350 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (r_reason_desc = &apos;reason 66                                                                                           &apos;) (type: boolean)
                    Statistics: Num rows: 1 Data size: 105 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: r_reason_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  Statistics: Num rows: 28800426268 Data size: 3871338091136 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_ticket_number (type: bigint), ss_quantity (type: int), ss_sales_price (type: decimal(7,2))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4
                    Statistics: Num rows: 28800426268 Data size: 3871338091136 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint), _col2 (type: bigint)
                        1 _col0 (type: bigint), _col2 (type: bigint)
                      outputColumnNames: _col3, _col6, _col8, _col9
                      input vertices:
                        0 Map 1
                      Statistics: Num rows: 1097227257 Data size: 4230120100 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col6 (type: bigint), CASE WHEN (_col3 is not null) THEN ((CAST( (_col8 - _col3) AS decimal(10,0)) * _col9)) ELSE ((CAST( _col8 AS decimal(10,0)) * _col9)) END (type: decimal(18,2))
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 1097227257 Data size: 4230120100 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1)
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.99
                          mode: hash
                          outputColumnNames: _col0, _col1
                          Statistics: Num rows: 42097882 Data size: 4714962792 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: bigint)
                            null sort order: a
                            sort order: +
                            Map-reduce partition columns: _col0 (type: bigint)
                            Statistics: Num rows: 42097882 Data size: 4714962792 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col1 (type: decimal(28,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2476346 Data size: 277350760 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: ++
                  keys: _col1 (type: decimal(28,2)), _col0 (type: bigint)
                  null sort order: zz
                  Statistics: Num rows: 2476346 Data size: 277350760 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Reduce Output Operator
                    key expressions: _col1 (type: decimal(28,2)), _col0 (type: bigint)
                    null sort order: zz
                    sort order: ++
                    Statistics: Num rows: 2476346 Data size: 277350760 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey1 (type: bigint), KEY.reducesinkkey0 (type: decimal(28,2))
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2476346 Data size: 257539992 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 11208 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 11208 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query93
explain select  ss_customer_sk ,sum(act_sales) sumsales from (select ss_item_sk ,ss_ticket_number ,ss_customer_sk ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price else (ss_quantity*ss_sales_price) end act_sales from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk and sr_ticket_number = ss_ticket_number) ,reason where sr_reason_sk = r_reason_sk and r_reason_desc = &apos;reason 66&apos;) t group by ss_customer_sk order by sumsales, ss_customer_sk limit 100

</samplerData>
</sample>
<sample t="6021" lt="6015" ts="1600985082081" s="true" lb="query94" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="24139" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220436_2cd70bad-9d2e-4b42-8f77-ba5ffbd9b6ad:301
      Edges:
        Map 1 &lt;- Map 10 (BROADCAST_EDGE), Map 11 (BROADCAST_EDGE), Map 9 (BROADCAST_EDGE)
        Map 12 &lt;- Reducer 8 (BROADCAST_EDGE)
        Map 13 &lt;- Reducer 7 (BROADCAST_EDGE)
        Reducer 14 &lt;- Map 13 (SIMPLE_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE), Map 12 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 14 (CUSTOM_SIMPLE_EDGE), Reducer 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
        Reducer 5 &lt;- Reducer 4 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Reducer 5 (SIMPLE_EDGE)
        Reducer 7 &lt;- Reducer 2 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
      DagName: zabetak_20200924220436_2cd70bad-9d2e-4b42-8f77-ba5ffbd9b6ad:301
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: ws1
                  filterExpr: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_127_container, bigKeyColName:ws_web_site_sk, smallTablePos:1, keyRatio:8.333375782623639E-10
                  Statistics: Num rows: 7199963324 Data size: 1900531149288 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null) (type: boolean)
                    Statistics: Num rows: 7194564635 Data size: 1899106089672 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_ship_date_sk (type: bigint), ws_ship_addr_sk (type: bigint), ws_web_site_sk (type: bigint), ws_warehouse_sk (type: bigint), ws_order_number (type: bigint), ws_ext_ship_cost (type: decimal(7,2)), ws_net_profit (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                      Statistics: Num rows: 7194564635 Data size: 1899106089672 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5, _col6
                        input vertices:
                          1 Map 9
                        Statistics: Num rows: 135746599 Data size: 34506547864 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col3, _col4, _col5, _col6
                          input vertices:
                            1 Map 10
                          Statistics: Num rows: 19143753 Data size: 4517459152 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col3, _col4, _col5, _col6
                            input vertices:
                              1 Map 11
                            Statistics: Num rows: 2126939 Data size: 294659288 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col4 (type: bigint)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col4 (type: bigint)
                              Statistics: Num rows: 2126939 Data size: 294659288 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col3 (type: bigint), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
                            Select Operator
                              expressions: _col4 (type: bigint)
                              outputColumnNames: _col0
                              Statistics: Num rows: 2126939 Data size: 34031024 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2
                                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  null sort order: 
                                  sort order: 
                                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 10 
            Map Operator Tree:
                TableScan
                  alias: web_site
                  filterExpr: (web_company_name = &apos;pri                                               &apos;) (type: boolean)
                  Statistics: Num rows: 78 Data size: 7488 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (web_company_name = &apos;pri                                               &apos;) (type: boolean)
                    Statistics: Num rows: 11 Data size: 1056 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: web_site_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 11 Data size: 1562 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 11 Data size: 1562 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 11 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;1999-04-01 00:00:00&apos; AND TIMESTAMP&apos;1999-05-31 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;1999-04-01 00:00:00&apos; AND TIMESTAMP&apos;1999-05-31 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 12 
            Map Operator Tree:
                TableScan
                  alias: ws2
                  filterExpr: (ws_warehouse_sk is not null and ws_order_number BETWEEN DynamicValue(RS_33_ws1_ws_order_number_min) AND DynamicValue(RS_33_ws1_ws_order_number_max) and in_bloom_filter(ws_order_number, DynamicValue(RS_33_ws1_ws_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_warehouse_sk is not null and ws_order_number BETWEEN DynamicValue(RS_33_ws1_ws_order_number_min) AND DynamicValue(RS_33_ws1_ws_order_number_max) and in_bloom_filter(ws_order_number, DynamicValue(RS_33_ws1_ws_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 7198162512 Data size: 115156197304 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_order_number (type: bigint), ws_warehouse_sk (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 7198162512 Data size: 115156197304 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint), _col1 (type: bigint)
                        minReductionHashAggr: 0.99
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 7198162512 Data size: 115156197304 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint)
                          null sort order: a
                          sort order: +
                          Map-reduce partition columns: _col0 (type: bigint)
                          Statistics: Num rows: 7198162512 Data size: 115156197304 Basic stats: COMPLETE Column stats: COMPLETE
                          value expressions: _col1 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 13 
            Map Operator Tree:
                TableScan
                  alias: wr1
                  filterExpr: (wr_order_number BETWEEN DynamicValue(RS_37_ws1_ws_order_number_min) AND DynamicValue(RS_37_ws1_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_37_ws1_ws_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 720020485 Data size: 5760163880 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (wr_order_number BETWEEN DynamicValue(RS_37_ws1_ws_order_number_min) AND DynamicValue(RS_37_ws1_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_37_ws1_ws_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 720020485 Data size: 5760163880 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: wr_order_number (type: bigint)
                      minReductionHashAggr: 0.9559171
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 720020485 Data size: 5760163880 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 720020485 Data size: 5760163880 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 9 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_state = &apos;NE&apos;) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_state = &apos;NE&apos;) (type: boolean)
                    Statistics: Num rows: 613208 Data size: 57641552 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 613208 Data size: 57641552 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 613208 Data size: 57641552 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 31740582 Data size: 253924656 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: true (type: boolean), _col0 (type: bigint)
                  outputColumnNames: _col0, _col1
                  Statistics: Num rows: 31740582 Data size: 380886984 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col1 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col1 (type: bigint)
                    Statistics: Num rows: 31740582 Data size: 380886984 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: boolean)
        Reducer 2 
            Execution mode: llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Semi Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col3, _col4, _col5, _col6, _col14
                input vertices:
                  1 Map 12
                residual filter predicates: {(_col3 &lt;&gt; _col14)}
                Statistics: Num rows: 2126939 Data size: 297271912 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: _col4 (type: bigint), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
                  outputColumnNames: _col4, _col5, _col6
                  Statistics: Num rows: 2126939 Data size: 294659288 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col4 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col4 (type: bigint)
                    Statistics: Num rows: 2126939 Data size: 294659288 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
                  Select Operator
                    expressions: _col4 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 2126939 Data size: 34031024 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        null sort order: 
                        sort order: 
                        Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Left Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col4, _col5, _col6, _col13
                input vertices:
                  1 Reducer 14
                Statistics: Num rows: 4253878 Data size: 793997072 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: _col13 is null (type: boolean)
                  Statistics: Num rows: 2126939 Data size: 396998592 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col4 (type: bigint), _col5 (type: decimal(7,2)), _col6 (type: decimal(7,2))
                    outputColumnNames: _col4, _col5, _col6
                    Statistics: Num rows: 2126939 Data size: 396998592 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: sum(_col5), sum(_col6)
                      keys: _col4 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col2, _col3
                      Statistics: Num rows: 1126 Data size: 261232 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1126 Data size: 261232 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1126 Data size: 261232 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col0), sum(_col1), sum(_col2)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: bigint), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
        Reducer 5 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col0 (type: bigint)
                  null sort order: z
                  Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col0 (type: bigint)
                    outputColumnNames: _col1, _col2, _col3
                    Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col3 (type: bigint)
                      null sort order: z
                      sort order: +
                      Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: decimal(17,2)), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query94
explain select count(distinct ws_order_number) as `order count` ,sum(ws_ext_ship_cost) as `total shipping cost` ,sum(ws_net_profit) as `total net profit` from web_sales ws1 ,date_dim ,customer_address ,web_site where d_date between &apos;1999-4-01&apos; and (cast(&apos;1999-4-01&apos; as date) + 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = &apos;NE&apos; and ws1.ws_web_site_sk = web_site_sk and web_company_name = &apos;pri&apos; and exists (select * from web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk &lt;&gt; ws2.ws_warehouse_sk) and not exists(select * from web_returns wr1 where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number) limit 100

</samplerData>
</sample>
<sample t="5654" lt="5647" ts="1600985087737" s="true" lb="query95" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="28177" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220442_241ea838-2851-4f80-8415-fe5c15f90858:302
      Edges:
        Map 16 &lt;- Reducer 14 (BROADCAST_EDGE)
        Map 4 &lt;- Reducer 15 (BROADCAST_EDGE)
        Map 5 &lt;- Map 1 (BROADCAST_EDGE), Map 2 (BROADCAST_EDGE), Map 3 (BROADCAST_EDGE)
        Reducer 10 &lt;- Reducer 9 (CUSTOM_SIMPLE_EDGE)
        Reducer 11 &lt;- Reducer 10 (SIMPLE_EDGE)
        Reducer 12 &lt;- Map 4 (CUSTOM_SIMPLE_EDGE), Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 13 &lt;- Map 5 (BROADCAST_EDGE), Reducer 12 (SIMPLE_EDGE)
        Reducer 14 &lt;- Reducer 13 (CUSTOM_SIMPLE_EDGE)
        Reducer 15 &lt;- Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 6 &lt;- Map 16 (CUSTOM_SIMPLE_EDGE), Map 5 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Map 5 (CUSTOM_SIMPLE_EDGE), Reducer 6 (CUSTOM_SIMPLE_EDGE)
        Reducer 8 &lt;- Reducer 13 (BROADCAST_EDGE), Reducer 7 (SIMPLE_EDGE)
        Reducer 9 &lt;- Reducer 8 (SIMPLE_EDGE)
      DagName: zabetak_20200924220442_241ea838-2851-4f80-8415-fe5c15f90858:302
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: customer_address
                  filterExpr: (ca_state = &apos;AL&apos;) (type: boolean)
                  Statistics: Num rows: 32500000 Data size: 3055000000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ca_state = &apos;AL&apos;) (type: boolean)
                    Statistics: Num rows: 613208 Data size: 57641552 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ca_address_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 613208 Data size: 4905664 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 613208 Data size: 4905664 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 16 
            Map Operator Tree:
                TableScan
                  alias: web_returns
                  filterExpr: (wr_order_number BETWEEN DynamicValue(RS_55_ws1_ws_order_number_min) AND DynamicValue(RS_55_ws1_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_55_ws1_ws_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 720020485 Data size: 5760163880 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (wr_order_number BETWEEN DynamicValue(RS_55_ws1_ws_order_number_min) AND DynamicValue(RS_55_ws1_ws_order_number_max) and in_bloom_filter(wr_order_number, DynamicValue(RS_55_ws1_ws_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 720020485 Data size: 5760163880 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: wr_order_number (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 720020485 Data size: 5760163880 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 720020485 Data size: 5760163880 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 2 
            Map Operator Tree:
                TableScan
                  alias: web_site
                  filterExpr: (web_company_name = &apos;pri                                               &apos;) (type: boolean)
                  Statistics: Num rows: 78 Data size: 7488 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (web_company_name = &apos;pri                                               &apos;) (type: boolean)
                    Statistics: Num rows: 11 Data size: 1056 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: web_site_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 11 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 11 Data size: 88 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 3 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-04-01 00:00:00&apos; AND TIMESTAMP&apos;2002-05-31 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-04-01 00:00:00&apos; AND TIMESTAMP&apos;2002-05-31 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: ws2
                  filterExpr: (ws_order_number BETWEEN DynamicValue(RS_52_ws1_ws_order_number_min) AND DynamicValue(RS_52_ws1_ws_order_number_max) and in_bloom_filter(ws_order_number, DynamicValue(RS_52_ws1_ws_order_number_bloom_filter))) (type: boolean)
                  Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ws_order_number BETWEEN DynamicValue(RS_52_ws1_ws_order_number_min) AND DynamicValue(RS_52_ws1_ws_order_number_max) and in_bloom_filter(ws_order_number, DynamicValue(RS_52_ws1_ws_order_number_bloom_filter))) (type: boolean)
                    Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_warehouse_sk (type: bigint), ws_order_number (type: bigint)
                      outputColumnNames: _col0, _col1
                      Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col1 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col1 (type: bigint)
                        Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: ws1
                  Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ws_warehouse_sk (type: bigint), ws_order_number (type: bigint)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col1 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col1 (type: bigint)
                      Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint)
                    Reduce Output Operator
                      key expressions: _col1 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col1 (type: bigint)
                      Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint)
                    Reduce Output Operator
                      key expressions: _col1 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col1 (type: bigint)
                      Statistics: Num rows: 7199963324 Data size: 115185006696 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col0 (type: bigint)
                  Filter Operator
                    predicate: (ws_ship_addr_sk is not null and ws_web_site_sk is not null and ws_ship_date_sk is not null) (type: boolean)
                    Statistics: Num rows: 7194564635 Data size: 1841563968280 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ws_ship_date_sk (type: bigint), ws_ship_addr_sk (type: bigint), ws_web_site_sk (type: bigint), ws_order_number (type: bigint), ws_ext_ship_cost (type: decimal(7,2)), ws_net_profit (type: decimal(7,2))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 7194564635 Data size: 1841563968280 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col1 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col0, _col2, _col3, _col4, _col5
                        input vertices:
                          1 Map 1
                        Statistics: Num rows: 135746599 Data size: 33434970760 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col0, _col3, _col4, _col5
                          input vertices:
                            1 Map 2
                          Statistics: Num rows: 19143753 Data size: 4378704816 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col0 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col3, _col4, _col5
                            input vertices:
                              1 Map 3
                            Statistics: Num rows: 2126939 Data size: 292039464 Basic stats: COMPLETE Column stats: COMPLETE
                            Reduce Output Operator
                              key expressions: _col3 (type: bigint)
                              null sort order: a
                              sort order: +
                              Map-reduce partition columns: _col3 (type: bigint)
                              Statistics: Num rows: 2126939 Data size: 292039464 Basic stats: COMPLETE Column stats: COMPLETE
                              value expressions: _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2))
                            Select Operator
                              expressions: _col3 (type: bigint)
                              outputColumnNames: _col0
                              Statistics: Num rows: 2126939 Data size: 34031024 Basic stats: COMPLETE Column stats: COMPLETE
                              Group By Operator
                                aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                                minReductionHashAggr: 0.99
                                mode: hash
                                outputColumnNames: _col0, _col1, _col2
                                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                Reduce Output Operator
                                  null sort order: 
                                  sort order: 
                                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 10 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col0 (type: bigint)
                  null sort order: z
                  Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2)), _col0 (type: bigint)
                    outputColumnNames: _col1, _col2, _col3
                    Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col3 (type: bigint)
                      null sort order: z
                      sort order: +
                      Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))
        Reducer 11 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint), VALUE._col0 (type: decimal(17,2)), VALUE._col1 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 240 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 12 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col1, _col2
                input vertices:
                  1 Map 4
                Statistics: Num rows: 27261836125953 Data size: 654284038209896 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: (_col0 &lt;&gt; _col2) (type: boolean)
                  Statistics: Num rows: 27261836125953 Data size: 654284038209896 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col1 (type: bigint)
                    outputColumnNames: _col1
                    Statistics: Num rows: 27261836125953 Data size: 654284038209896 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: _col1 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 4859952128920 Data size: 38879617031360 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 4859952128920 Data size: 38879617031360 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 13 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1901540 Data size: 15212320 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col3, _col4, _col5
                  input vertices:
                    0 Map 5
                  Statistics: Num rows: 2126939 Data size: 292039464 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col3 (type: bigint)
                    null sort order: a
                    sort order: +
                    Map-reduce partition columns: _col3 (type: bigint)
                    Statistics: Num rows: 2126939 Data size: 292039464 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col4 (type: decimal(7,2)), _col5 (type: decimal(7,2))
                  Select Operator
                    expressions: _col3 (type: bigint)
                    outputColumnNames: _col0
                    Statistics: Num rows: 2126939 Data size: 34031024 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      aggregations: min(_col0), max(_col0), bloom_filter(_col0, expectedEntries=1000000)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        null sort order: 
                        sort order: 
                        Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 14 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 15 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: min(VALUE._col0), max(VALUE._col1), bloom_filter(VALUE._col2, expectedEntries=1000000)
                mode: final
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  null sort order: 
                  sort order: 
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: binary)
        Reducer 6 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col1, _col2
                input vertices:
                  1 Map 16
                Statistics: Num rows: 163327852165 Data size: 3919854045472 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Reduce Output Operator
                  key expressions: _col1 (type: bigint)
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col1 (type: bigint)
                  Statistics: Num rows: 163327852165 Data size: 3919854045472 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: bigint), _col2 (type: bigint)
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Inner Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0, _col2, _col3
                input vertices:
                  1 Map 5
                Statistics: Num rows: 618422197469258 Data size: 14842132710449216 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Filter Operator
                  predicate: (_col0 &lt;&gt; _col3) (type: boolean)
                  Statistics: Num rows: 618422197469258 Data size: 14842132710449216 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col2 (type: bigint)
                    outputColumnNames: _col2
                    Statistics: Num rows: 618422197469258 Data size: 14842132710449216 Basic stats: COMPLETE Column stats: COMPLETE
                    Group By Operator
                      keys: _col2 (type: bigint)
                      minReductionHashAggr: 0.99
                      mode: hash
                      outputColumnNames: _col0
                      Statistics: Num rows: 110245738604740 Data size: 881965908837920 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 110245738604740 Data size: 881965908837920 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 8 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1901540 Data size: 15212320 Basic stats: COMPLETE Column stats: COMPLETE
                Map Join Operator
                  condition map:
                       Inner Join 0 to 1
                  keys:
                    0 _col3 (type: bigint)
                    1 _col0 (type: bigint)
                  outputColumnNames: _col3, _col4, _col5
                  input vertices:
                    0 Reducer 13
                  Statistics: Num rows: 2126939 Data size: 292039464 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col4), sum(_col5)
                    keys: _col3 (type: bigint)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col2, _col3
                    Statistics: Num rows: 1126 Data size: 261232 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 1126 Data size: 261232 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col2 (type: decimal(17,2)), _col3 (type: decimal(17,2))
        Reducer 9 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1)
                keys: KEY._col0 (type: bigint)
                mode: partial2
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1126 Data size: 261232 Basic stats: COMPLETE Column stats: COMPLETE
                Group By Operator
                  aggregations: count(_col0), sum(_col1), sum(_col2)
                  mode: partial2
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    null sort order: 
                    sort order: 
                    Statistics: Num rows: 1 Data size: 232 Basic stats: COMPLETE Column stats: COMPLETE
                    value expressions: _col0 (type: bigint), _col1 (type: decimal(17,2)), _col2 (type: decimal(17,2))

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query95
explain with ws_wh as (select ws1.ws_order_number,ws1.ws_warehouse_sk wh1,ws2.ws_warehouse_sk wh2 from web_sales ws1,web_sales ws2 where ws1.ws_order_number = ws2.ws_order_number and ws1.ws_warehouse_sk &lt;&gt; ws2.ws_warehouse_sk) select count(distinct ws_order_number) as `order count` ,sum(ws_ext_ship_cost) as `total shipping cost` ,sum(ws_net_profit) as `total net profit` from web_sales ws1 ,date_dim ,customer_address ,web_site where d_date between &apos;2002-4-01&apos; and (cast(&apos;2002-4-01&apos; as date) + 60 days) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = &apos;AL&apos; and ws1.ws_web_site_sk = web_site_sk and web_company_name = &apos;pri&apos; and ws1.ws_order_number in (select ws_order_number from ws_wh) and ws1.ws_order_number in (select wr_order_number from web_returns,ws_wh where wr_order_number = ws_wh.ws_order_number) order by count(distinct ws_order_number) limit 100

</samplerData>
</sample>
<sample t="2744" lt="2739" ts="1600985090482" s="true" lb="query96" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="9860" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220447_2e8fc4c3-3b54-43c6-a9de-8602ae9057bf:303
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (CUSTOM_SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924220447_2e8fc4c3-3b54-43c6-a9de-8602ae9057bf:303
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: (ss_store_sk is not null and ss_hdemo_sk is not null and ss_sold_time_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_77_container, bigKeyColName:ss_hdemo_sk, smallTablePos:1, keyRatio:2.9889314553529996E-4
                  Statistics: Num rows: 28800426268 Data size: 660101764952 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (ss_store_sk is not null and ss_hdemo_sk is not null and ss_sold_time_sk is not null) (type: boolean)
                    Statistics: Num rows: 25084250276 Data size: 574927528000 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: ss_sold_time_sk (type: bigint), ss_hdemo_sk (type: bigint), ss_store_sk (type: bigint)
                      outputColumnNames: _col0, _col1, _col2
                      Statistics: Num rows: 25084250276 Data size: 574927528000 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 948172500 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 86082491 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col1 (type: bigint)
                              1 _col0 (type: bigint)
                            input vertices:
                              1 Map 6
                            Statistics: Num rows: 8608250 Data size: 68866000 Basic stats: COMPLETE Column stats: COMPLETE
                            Group By Operator
                              aggregations: count()
                              minReductionHashAggr: 0.99
                              mode: hash
                              outputColumnNames: _col0
                              Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                              Reduce Output Operator
                                null sort order: 
                                sort order: 
                                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                                value expressions: _col0 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: time_dim
                  filterExpr: ((t_hour = 16) and (t_minute &gt;= 30)) (type: boolean)
                  Statistics: Num rows: 86400 Data size: 1382400 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: ((t_hour = 16) and (t_minute &gt;= 30)) (type: boolean)
                    Statistics: Num rows: 1769 Data size: 28304 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: t_time_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 1769 Data size: 14152 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 1769 Data size: 14152 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: store
                  filterExpr: (s_store_name = &apos;ese&apos;) (type: boolean)
                  Statistics: Num rows: 1500 Data size: 144000 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (s_store_name = &apos;ese&apos;) (type: boolean)
                    Statistics: Num rows: 136 Data size: 13056 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: s_store_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 136 Data size: 1088 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 136 Data size: 1088 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: household_demographics
                  filterExpr: (hd_dep_count = 6) (type: boolean)
                  Statistics: Num rows: 7200 Data size: 86400 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (hd_dep_count = 6) (type: boolean)
                    Statistics: Num rows: 720 Data size: 8640 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: hd_demo_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 720 Data size: 5760 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 720 Data size: 5760 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: count(VALUE._col0)
                mode: mergepartial
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                Top N Key Operator
                  sort order: +
                  keys: _col0 (type: bigint)
                  null sort order: z
                  Statistics: Num rows: 1 Data size: 8 Basic stats: COMPLETE Column stats: COMPLETE
                  top n: 100
                  Select Operator
                    expressions: _col0 (type: bigint)
                    outputColumnNames: _col1
                    Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col1 (type: bigint)
                      null sort order: z
                      sort order: +
                      Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: bigint)
                outputColumnNames: _col0
                Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 16 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query96
explain select  count(*) from store_sales ,household_demographics ,time_dim, store where ss_sold_time_sk = time_dim.t_time_sk and ss_hdemo_sk = household_demographics.hd_demo_sk and ss_store_sk = s_store_sk and time_dim.t_hour = 16 and time_dim.t_minute &gt;= 30 and household_demographics.hd_dep_count = 6 and store.s_store_name = &apos;ese&apos; order by count(*) limit 100

</samplerData>
</sample>
<sample t="4313" lt="4308" ts="1600985094797" s="true" lb="query97" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="13030" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220450_a1febd09-8b18-4e63-a9c4-c2b21f94fc7d:304
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE)
        Map 6 &lt;- Map 5 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (CUSTOM_SIMPLE_EDGE), Reducer 7 (CUSTOM_SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (CUSTOM_SIMPLE_EDGE)
        Reducer 7 &lt;- Map 6 (SIMPLE_EDGE)
      DagName: zabetak_20200924220450_a1febd09-8b18-4e63-a9c4-c2b21f94fc7d:304
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  filterExpr: ss_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 27503885621 Data size: 654908138904 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_customer_sk (type: bigint), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 654908138904 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 5
                      Statistics: Num rows: 5407316333 Data size: 81331945328 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col1 (type: bigint), _col0 (type: bigint)
                        minReductionHashAggr: 0.9773084
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 5407316333 Data size: 81331945328 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 5407316333 Data size: 81331945328 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_month_seq BETWEEN 1190 AND 1201 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1190 AND 1201 (type: boolean)
                    Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5013927
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: cs_sold_date_sk (bigint)
                            Target Input: catalog_sales
                            Partition key expr: cs_sold_date_sk
                            Statistics: Num rows: 179 Data size: 1432 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 6
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: cs_sold_date_sk is not null (type: boolean)
                  Statistics: Num rows: 14327953968 Data size: 343582842448 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cs_bill_customer_sk (type: bigint), cs_item_sk (type: bigint), cs_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 14327953968 Data size: 343582842448 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col2 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col0, _col1
                      input vertices:
                        1 Map 5
                      Statistics: Num rows: 2796990358 Data size: 44463792944 Basic stats: COMPLETE Column stats: COMPLETE
                      Group By Operator
                        keys: _col0 (type: bigint), _col1 (type: bigint)
                        minReductionHashAggr: 0.97296697
                        mode: hash
                        outputColumnNames: _col0, _col1
                        Statistics: Num rows: 2796990358 Data size: 44463792944 Basic stats: COMPLETE Column stats: COMPLETE
                        Reduce Output Operator
                          key expressions: _col0 (type: bigint), _col1 (type: bigint)
                          null sort order: aa
                          sort order: ++
                          Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                          Statistics: Num rows: 2796990358 Data size: 44463792944 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 5407316333 Data size: 81331945328 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint), _col1 (type: bigint)
                  null sort order: aa
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                  Statistics: Num rows: 5407316333 Data size: 81331945328 Basic stats: COMPLETE Column stats: COMPLETE
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Map Join Operator
                condition map:
                     Full Outer Join 0 to 1
                keys:
                  0 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                  1 KEY.reducesinkkey0 (type: bigint), KEY.reducesinkkey1 (type: bigint)
                outputColumnNames: _col0, _col2
                input vertices:
                  1 Reducer 7
                Statistics: Num rows: 25314593471573 Data size: 404901938585336 Basic stats: COMPLETE Column stats: COMPLETE
                DynamicPartitionHashJoin: true
                Select Operator
                  expressions: CASE WHEN ((_col2 is null and _col0 is not null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is null and _col2 is not null)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((_col0 is not null and _col2 is not null)) THEN (1) ELSE (0) END (type: int)
                  outputColumnNames: _col0, _col1, _col2
                  Statistics: Num rows: 25314593471573 Data size: 404901938585336 Basic stats: COMPLETE Column stats: COMPLETE
                  Group By Operator
                    aggregations: sum(_col0), sum(_col1), sum(_col2)
                    minReductionHashAggr: 0.99
                    mode: hash
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      null sort order: 
                      sort order: 
                      Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                      TopN Hash Memory Usage: 0.04
                      value expressions: _col0 (type: bigint), _col1 (type: bigint), _col2 (type: bigint)
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2)
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2
                Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 1 Data size: 24 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe
        Reducer 7 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                keys: KEY._col0 (type: bigint), KEY._col1 (type: bigint)
                mode: mergepartial
                outputColumnNames: _col0, _col1
                Statistics: Num rows: 2796990358 Data size: 44463792944 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col0 (type: bigint), _col1 (type: bigint)
                  null sort order: aa
                  sort order: ++
                  Map-reduce partition columns: _col0 (type: bigint), _col1 (type: bigint)
                  Statistics: Num rows: 2796990358 Data size: 44463792944 Basic stats: COMPLETE Column stats: COMPLETE

  Stage: Stage-0
    Fetch Operator
      limit: 100
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query97
explain with ssci as ( select ss_customer_sk customer_sk ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk and d_month_seq between 1190 and 1190 + 11 group by ss_customer_sk ,ss_item_sk), csci as( select cs_bill_customer_sk customer_sk ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk and d_month_seq between 1190 and 1190 + 11 group by cs_bill_customer_sk ,cs_item_sk) select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk and ssci.item_sk = csci.item_sk) limit 100

</samplerData>
</sample>
<sample t="2364" lt="2359" ts="1600985097161" s="true" lb="query98" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="12869" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220454_812220da-11d9-4673-be94-ff1d29da1f66:305
      Edges:
        Map 1 &lt;- Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
        Reducer 4 &lt;- Reducer 3 (SIMPLE_EDGE)
      DagName: zabetak_20200924220454_812220da-11d9-4673-be94-ff1d29da1f66:305
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: store_sales
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_53_container, bigKeyColName:ss_item_sk, smallTablePos:1, keyRatio:0.27272635700872555
                  Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: ss_item_sk (type: bigint), ss_ext_sales_price (type: decimal(7,2)), ss_sold_date_sk (type: bigint)
                    outputColumnNames: _col0, _col1, _col2
                    Statistics: Num rows: 27503885621 Data size: 3447905002784 Basic stats: COMPLETE Column stats: COMPLETE
                    Map Join Operator
                      condition map:
                           Inner Join 0 to 1
                      keys:
                        0 _col0 (type: bigint)
                        1 _col0 (type: bigint)
                      outputColumnNames: _col1, _col2, _col4, _col5, _col6, _col7, _col8
                      input vertices:
                        1 Map 5
                      Statistics: Num rows: 7501034529 Data size: 5163129713626 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col2 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8
                        input vertices:
                          1 Map 6
                        Statistics: Num rows: 833391227 Data size: 502447559014 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          aggregations: sum(_col1)
                          keys: _col8 (type: char(50)), _col7 (type: char(50)), _col4 (type: char(16)), _col5 (type: varchar(200)), _col6 (type: decimal(7,2))
                          minReductionHashAggr: 0.98764044
                          mode: hash
                          outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                          Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                          Reduce Output Operator
                            key expressions: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(16)), _col3 (type: varchar(200)), _col4 (type: decimal(7,2))
                            null sort order: aaaaa
                            sort order: +++++
                            Map-reduce partition columns: _col0 (type: char(50)), _col1 (type: char(50)), _col2 (type: char(16)), _col3 (type: varchar(200)), _col4 (type: decimal(7,2))
                            Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                            value expressions: _col5 (type: decimal(17,2))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: item
                  filterExpr: (i_category) IN (&apos;Home                                              &apos;, &apos;Sports                                            &apos;, &apos;Men                                               &apos;) (type: boolean)
                  Statistics: Num rows: 402000 Data size: 235458432 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (i_category) IN (&apos;Home                                              &apos;, &apos;Sports                                            &apos;, &apos;Men                                               &apos;) (type: boolean)
                    Statistics: Num rows: 109636 Data size: 64215784 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: i_item_sk (type: bigint), i_item_id (type: char(16)), i_item_desc (type: varchar(200)), i_current_price (type: decimal(7,2)), i_class (type: char(50)), i_category (type: char(50))
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                      Statistics: Num rows: 109636 Data size: 64215784 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 109636 Data size: 64215784 Basic stats: COMPLETE Column stats: COMPLETE
                        value expressions: _col1 (type: char(16)), _col2 (type: varchar(200)), _col3 (type: decimal(7,2)), _col4 (type: char(50)), _col5 (type: char(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-01-05 00:00:00&apos; AND TIMESTAMP&apos;2002-02-04 00:00:00&apos; (type: boolean)
                  Statistics: Num rows: 73049 Data size: 4675136 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: CAST( d_date AS TIMESTAMP) BETWEEN TIMESTAMP&apos;2002-01-05 00:00:00&apos; AND TIMESTAMP&apos;2002-02-04 00:00:00&apos; (type: boolean)
                    Statistics: Num rows: 8116 Data size: 519424 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                      Select Operator
                        expressions: _col0 (type: bigint)
                        outputColumnNames: _col0
                        Statistics: Num rows: 8116 Data size: 64928 Basic stats: COMPLETE Column stats: COMPLETE
                        Group By Operator
                          keys: _col0 (type: bigint)
                          minReductionHashAggr: 0.5
                          mode: hash
                          outputColumnNames: _col0
                          Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                          Dynamic Partitioning Event Operator
                            Target column: ss_sold_date_sk (bigint)
                            Target Input: store_sales
                            Partition key expr: ss_sold_date_sk
                            Statistics: Num rows: 4058 Data size: 32464 Basic stats: COMPLETE Column stats: COMPLETE
                            Target Vertex: Map 1
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0)
                keys: KEY._col0 (type: char(50)), KEY._col1 (type: char(50)), KEY._col2 (type: char(16)), KEY._col3 (type: varchar(200)), KEY._col4 (type: decimal(7,2))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                Reduce Output Operator
                  key expressions: _col1 (type: char(50))
                  null sort order: a
                  sort order: +
                  Map-reduce partition columns: _col1 (type: char(50))
                  Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                  value expressions: _col0 (type: char(50)), _col2 (type: char(16)), _col3 (type: varchar(200)), _col4 (type: decimal(7,2)), _col5 (type: decimal(17,2))
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: VALUE._col0 (type: char(50)), KEY.reducesinkkey0 (type: char(50)), VALUE._col1 (type: char(16)), VALUE._col2 (type: varchar(200)), VALUE._col3 (type: decimal(7,2)), VALUE._col4 (type: decimal(17,2))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5
                Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                PTF Operator
                  Function definitions:
                      Input definition
                        input alias: ptf_0
                        output shape: _col0: char(50), _col1: char(50), _col2: char(16), _col3: varchar(200), _col4: decimal(7,2), _col5: decimal(17,2)
                        type: WINDOWING
                      Windowing table definition
                        input alias: ptf_1
                        name: windowingtablefunction
                        order by: _col1 ASC NULLS FIRST
                        partition by: _col1
                        raw input shape:
                        window functions:
                            window function definition
                              alias: sum_window_0
                              arguments: _col5
                              name: sum
                              window function: GenericUDAFSumHiveDecimal
                              window frame: ROWS PRECEDING(MAX)~FOLLOWING(MAX)
                  Statistics: Num rows: 109636 Data size: 75648840 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: _col2 (type: char(16)), _col3 (type: varchar(200)), _col0 (type: char(50)), _col1 (type: char(50)), _col4 (type: decimal(7,2)), _col5 (type: decimal(17,2)), ((_col5 * 100) / sum_window_0) (type: decimal(38,17))
                    outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                    Statistics: Num rows: 109636 Data size: 87928072 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col2 (type: char(50)), _col3 (type: char(50)), _col0 (type: char(16)), _col1 (type: varchar(200)), _col6 (type: decimal(38,17))
                      null sort order: zzzzz
                      sort order: +++++
                      Statistics: Num rows: 109636 Data size: 87928072 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col4 (type: decimal(7,2)), _col5 (type: decimal(17,2))
        Reducer 4 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey2 (type: char(16)), KEY.reducesinkkey3 (type: varchar(200)), KEY.reducesinkkey0 (type: char(50)), KEY.reducesinkkey1 (type: char(50)), VALUE._col0 (type: decimal(7,2)), VALUE._col1 (type: decimal(17,2)), KEY.reducesinkkey4 (type: decimal(38,17))
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6
                Statistics: Num rows: 109636 Data size: 87928072 Basic stats: COMPLETE Column stats: COMPLETE
                File Output Operator
                  compressed: false
                  Statistics: Num rows: 109636 Data size: 87928072 Basic stats: COMPLETE Column stats: COMPLETE
                  table:
                      input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                      output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                      serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query98
explain select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ss_ext_sales_price) as itemrevenue ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over (partition by i_class) as revenueratio from store_sales ,item ,date_dim where ss_item_sk = i_item_sk and i_category in (&apos;Home&apos;, &apos;Sports&apos;, &apos;Men&apos;) and ss_sold_date_sk = d_date_sk and d_date between cast(&apos;2002-01-05&apos; as date) and (cast(&apos;2002-01-05&apos; as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio

</samplerData>
</sample>
<sample t="3234" lt="3227" ts="1600985100397" s="true" lb="query99" rc="200" rm="OK" tn="Runs 1-1" dt="text" by="13920" ng="1" na="1">
  <responseData class="java.lang.String">Explain
STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 depends on stages: Stage-1

STAGE PLANS:
  Stage: Stage-1
    Tez
      DagId: zabetak_20200924220457_88856b7c-f0aa-4dc6-8f85-c1e4e958fb5d:306
      Edges:
        Map 1 &lt;- Map 4 (BROADCAST_EDGE), Map 5 (BROADCAST_EDGE), Map 6 (BROADCAST_EDGE), Map 7 (BROADCAST_EDGE)
        Reducer 2 &lt;- Map 1 (SIMPLE_EDGE)
        Reducer 3 &lt;- Reducer 2 (SIMPLE_EDGE)
      DagName: zabetak_20200924220457_88856b7c-f0aa-4dc6-8f85-c1e4e958fb5d:306
      Vertices:
        Map 1 
            Map Operator Tree:
                TableScan
                  alias: catalog_sales
                  filterExpr: (cs_warehouse_sk is not null and cs_ship_date_sk is not null and cs_ship_mode_sk is not null and cs_call_center_sk is not null) (type: boolean)
                  probeDecodeDetails: cacheKey:HASH_MAP_MAPJOIN_99_container, bigKeyColName:cs_ship_date_sk, smallTablePos:1, keyRatio:0.18259954103734743
                  Statistics: Num rows: 14399964710 Data size: 573694744792 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: (cs_warehouse_sk is not null and cs_ship_date_sk is not null and cs_ship_mode_sk is not null and cs_call_center_sk is not null) (type: boolean)
                    Statistics: Num rows: 14114136778 Data size: 562307356992 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: cs_ship_date_sk (type: bigint), cs_call_center_sk (type: bigint), cs_ship_mode_sk (type: bigint), cs_warehouse_sk (type: bigint), CASE WHEN (((cs_ship_date_sk - cs_sold_date_sk) &lt;= 30L)) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((cs_ship_date_sk - cs_sold_date_sk) &gt; 30L) and ((cs_ship_date_sk - cs_sold_date_sk) &lt;= 60L))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((cs_ship_date_sk - cs_sold_date_sk) &gt; 60L) and ((cs_ship_date_sk - cs_sold_date_sk) &lt;= 90L))) THEN (1) ELSE (0) END (type: int), CASE WHEN ((((cs_ship_date_sk - cs_sold_date_sk) &gt; 90L) and ((cs_ship_date_sk - cs_sold_date_sk) &lt;= 120L))) THEN (1) ELSE (0) END (type: int), CASE WHEN (((cs_ship_date_sk - cs_sold_date_sk) &gt; 120L)) THEN (1) ELSE (0) END (type: int)
                      outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                      Statistics: Num rows: 14114136778 Data size: 731676998328 Basic stats: COMPLETE Column stats: COMPLETE
                      Map Join Operator
                        condition map:
                             Inner Join 0 to 1
                        keys:
                          0 _col0 (type: bigint)
                          1 _col0 (type: bigint)
                        outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                        input vertices:
                          1 Map 4
                        Statistics: Num rows: 2629426947 Data size: 114001268476 Basic stats: COMPLETE Column stats: COMPLETE
                        Map Join Operator
                          condition map:
                               Inner Join 0 to 1
                          keys:
                            0 _col2 (type: bigint)
                            1 _col0 (type: bigint)
                          outputColumnNames: _col1, _col3, _col4, _col5, _col6, _col7, _col8, _col11
                          input vertices:
                            1 Map 5
                          Statistics: Num rows: 2629426947 Data size: 335437683696 Basic stats: COMPLETE Column stats: COMPLETE
                          Map Join Operator
                            condition map:
                                 Inner Join 0 to 1
                            keys:
                              0 _col3 (type: bigint)
                              1 _col0 (type: bigint)
                            outputColumnNames: _col1, _col4, _col5, _col6, _col7, _col8, _col11, _col13
                            input vertices:
                              1 Map 6
                            Statistics: Num rows: 2629426947 Data size: 575280133025 Basic stats: COMPLETE Column stats: COMPLETE
                            Map Join Operator
                              condition map:
                                   Inner Join 0 to 1
                              keys:
                                0 _col1 (type: bigint)
                                1 _col0 (type: bigint)
                              outputColumnNames: _col4, _col5, _col6, _col7, _col8, _col11, _col13, _col15
                              input vertices:
                                1 Map 7
                              Statistics: Num rows: 2629426947 Data size: 812492926623 Basic stats: COMPLETE Column stats: COMPLETE
                              Top N Key Operator
                                sort order: +++
                                keys: _col13 (type: string), _col11 (type: char(30)), _col15 (type: varchar(50))
                                null sort order: zzz
                                Statistics: Num rows: 2629426947 Data size: 812492926623 Basic stats: COMPLETE Column stats: COMPLETE
                                top n: 100
                                Group By Operator
                                  aggregations: sum(_col4), sum(_col5), sum(_col6), sum(_col7), sum(_col8)
                                  keys: _col13 (type: string), _col11 (type: char(30)), _col15 (type: varchar(50))
                                  minReductionHashAggr: 0.99
                                  mode: hash
                                  outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                                  Statistics: Num rows: 12854700 Data size: 4229196300 Basic stats: COMPLETE Column stats: COMPLETE
                                  Reduce Output Operator
                                    key expressions: _col0 (type: string), _col1 (type: char(30)), _col2 (type: varchar(50))
                                    null sort order: zzz
                                    sort order: +++
                                    Map-reduce partition columns: _col0 (type: string), _col1 (type: char(30)), _col2 (type: varchar(50))
                                    Statistics: Num rows: 12854700 Data size: 4229196300 Basic stats: COMPLETE Column stats: COMPLETE
                                    TopN Hash Memory Usage: 0.04
                                    value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 4 
            Map Operator Tree:
                TableScan
                  alias: date_dim
                  filterExpr: d_month_seq BETWEEN 1178 AND 1189 (type: boolean)
                  Statistics: Num rows: 73049 Data size: 876588 Basic stats: COMPLETE Column stats: COMPLETE
                  Filter Operator
                    predicate: d_month_seq BETWEEN 1178 AND 1189 (type: boolean)
                    Statistics: Num rows: 359 Data size: 4308 Basic stats: COMPLETE Column stats: COMPLETE
                    Select Operator
                      expressions: d_date_sk (type: bigint)
                      outputColumnNames: _col0
                      Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
                      Reduce Output Operator
                        key expressions: _col0 (type: bigint)
                        null sort order: a
                        sort order: +
                        Map-reduce partition columns: _col0 (type: bigint)
                        Statistics: Num rows: 359 Data size: 2872 Basic stats: COMPLETE Column stats: COMPLETE
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 5 
            Map Operator Tree:
                TableScan
                  alias: ship_mode
                  Statistics: Num rows: 20 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: sm_ship_mode_sk (type: bigint), sm_type (type: char(30))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 20 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 20 Data size: 2000 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: char(30))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 6 
            Map Operator Tree:
                TableScan
                  alias: warehouse
                  Statistics: Num rows: 25 Data size: 2700 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: w_warehouse_sk (type: bigint), substr(w_warehouse_name, 1, 20) (type: string)
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 25 Data size: 2675 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 25 Data size: 2675 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: string)
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Map 7 
            Map Operator Tree:
                TableScan
                  alias: call_center
                  Statistics: Num rows: 54 Data size: 5724 Basic stats: COMPLETE Column stats: COMPLETE
                  Select Operator
                    expressions: cc_call_center_sk (type: bigint), cc_name (type: varchar(50))
                    outputColumnNames: _col0, _col1
                    Statistics: Num rows: 54 Data size: 5724 Basic stats: COMPLETE Column stats: COMPLETE
                    Reduce Output Operator
                      key expressions: _col0 (type: bigint)
                      null sort order: a
                      sort order: +
                      Map-reduce partition columns: _col0 (type: bigint)
                      Statistics: Num rows: 54 Data size: 5724 Basic stats: COMPLETE Column stats: COMPLETE
                      value expressions: _col1 (type: varchar(50))
            Execution mode: vectorized, llap
            LLAP IO: may be used (ACID table)
        Reducer 2 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Group By Operator
                aggregations: sum(VALUE._col0), sum(VALUE._col1), sum(VALUE._col2), sum(VALUE._col3), sum(VALUE._col4)
                keys: KEY._col0 (type: string), KEY._col1 (type: char(30)), KEY._col2 (type: varchar(50))
                mode: mergepartial
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 4050 Data size: 1332450 Basic stats: COMPLETE Column stats: COMPLETE
                Select Operator
                  expressions: _col1 (type: char(30)), _col2 (type: varchar(50)), _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint), _col0 (type: string)
                  outputColumnNames: _col1, _col2, _col3, _col4, _col5, _col6, _col7, _col8
                  Statistics: Num rows: 4050 Data size: 1733400 Basic stats: COMPLETE Column stats: COMPLETE
                  Reduce Output Operator
                    key expressions: _col8 (type: string), _col1 (type: char(30)), _col2 (type: varchar(50))
                    null sort order: zzz
                    sort order: +++
                    Statistics: Num rows: 4050 Data size: 1733400 Basic stats: COMPLETE Column stats: COMPLETE
                    TopN Hash Memory Usage: 0.04
                    value expressions: _col3 (type: bigint), _col4 (type: bigint), _col5 (type: bigint), _col6 (type: bigint), _col7 (type: bigint)
        Reducer 3 
            Execution mode: vectorized, llap
            Reduce Operator Tree:
              Select Operator
                expressions: KEY.reducesinkkey0 (type: string), KEY.reducesinkkey1 (type: char(30)), KEY.reducesinkkey2 (type: varchar(50)), VALUE._col0 (type: bigint), VALUE._col1 (type: bigint), VALUE._col2 (type: bigint), VALUE._col3 (type: bigint), VALUE._col4 (type: bigint)
                outputColumnNames: _col0, _col1, _col2, _col3, _col4, _col5, _col6, _col7
                Statistics: Num rows: 4050 Data size: 1733400 Basic stats: COMPLETE Column stats: COMPLETE
                Limit
                  Number of rows: 100
                  Statistics: Num rows: 100 Data size: 42800 Basic stats: COMPLETE Column stats: COMPLETE
                  File Output Operator
                    compressed: false
                    Statistics: Num rows: 100 Data size: 42800 Basic stats: COMPLETE Column stats: COMPLETE
                    table:
                        input format: org.apache.hadoop.mapred.SequenceFileInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat
                        serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe

  Stage: Stage-0
    Fetch Operator
      limit: -1
      Processor Tree:
        ListSink

</responseData>
  <samplerData class="java.lang.String">[Select Statement] -- query99
explain select substr(w_warehouse_name,1,20) ,sm_type ,cc_name ,sum(case when (cs_ship_date_sk - cs_sold_date_sk &lt;= 30 ) then 1 else 0 end)  as `30 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk &gt; 30) and (cs_ship_date_sk - cs_sold_date_sk &lt;= 60) then 1 else 0 end )  as `31-60 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk &gt; 60) and (cs_ship_date_sk - cs_sold_date_sk &lt;= 90) then 1 else 0 end)  as `61-90 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk &gt; 90) and (cs_ship_date_sk - cs_sold_date_sk &lt;= 120) then 1 else 0 end)  as `91-120 days` ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  &gt; 120) then 1 else 0 end)  as `&gt;120 days` from catalog_sales ,warehouse ,ship_mode ,call_center ,date_dim where d_month_seq between 1178 and 1178 + 11 and cs_ship_date_sk   = d_date_sk and cs_warehouse_sk   = w_warehouse_sk and cs_ship_mode_sk   = sm_ship_mode_sk and cs_call_center_sk = cc_call_center_sk group by substr(w_warehouse_name,1,20) ,sm_type ,cc_name order by substr(w_warehouse_name,1,20) ,sm_type ,cc_name limit 100

</samplerData>
</sample>

</testResults>
